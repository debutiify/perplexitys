(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9303],{7:(e,t,a)=>{"use strict";a.d(t,{H:()=>l});let l=(0,a(27773).w)({path:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0 M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6",name:"IconEye",variant:"stroked"})},667:(e,t,a)=>{"use strict";a.d(t,{X:()=>n});var l=a(85860),r=a(13820),s=a(14475),i=a(30002);let n=e=>{let{reason:t,enabled:a=!0}=e,{connectors:n,isLoading:o,isStale:d,refetch:c}=(0,s.u)({reason:t,enabled:a}),{connectorsMap:u}=(0,r.k)({reason:t,enabled:a}),m=(0,l.useMemo)(()=>{var e;return(null!==(e=null==n?void 0:n.connectors)&&void 0!==e?e:[]).filter(e=>i.q0d.includes(e.name)&&u[e.name]&&u[e.name].connected)},[u,n]),p=(0,l.useMemo)(()=>{var e;return(null!==(e=null==n?void 0:n.connectors)&&void 0!==e?e:[]).filter(e=>!i.q0d.includes(e.name)&&u[e.name]&&u[e.name].connected)},[u,n]),h=(0,l.useMemo)(()=>{var e;return(null!==(e=null==n?void 0:n.connectors)&&void 0!==e?e:[]).filter(e=>u[e.name]&&u[e.name].connected)},[u,n]);return(0,l.useMemo)(()=>({enabledFileConnectors:m,enabledNonFileConnectors:p,enabledConnectors:h,isConnectorsLoading:o,isConnectorsStale:d,refetchConnectors:c}),[h,m,p,o,d,c])}},1298:(e,t,a)=>{"use strict";a.d(t,{L:()=>f});var l=a(25576),r=a(85860),s=a(83081),i=a(80567),n=a(62869),o=a(18507),d=a(60410),c=a(28554),u=a(76315);let m={in:{opacity:1,scale:1},out:{opacity:0,scale:.9}},p=r.memo(e=>{let{cancelButton:t,confirmButton:a,description:r,title:s,ref:p}=e,{handleCancel:h,handleConfirm:v}=(0,u.KI)();return(0,l.jsx)(i.UC,{asChild:!0,onEscapeKeyDown:e=>{e.stopPropagation()},ref:p,children:(0,l.jsxs)(o.P.div,{animate:"in",className:"border-subtlest bg-base p-lg rounded-lg border shadow-lg",exit:"out",initial:"out",transition:{duration:.2},variants:m,children:[(0,l.jsxs)(n.s6,{children:[(0,l.jsx)(i.hE,{children:s}),(0,l.jsx)(i.VY,{children:r})]}),(0,l.jsxs)("div",{className:"gap-md flex flex-col items-center",children:[(0,l.jsx)(d.A,{children:r}),(0,l.jsxs)("div",{className:"gap-md mx-auto flex",children:[(0,l.jsx)(c.A,{variant:"common",onClick:h,testId:"confirm-close-modal-cancel-button",...t}),(0,l.jsx)(c.A,{variant:"rejected",onClick:v,testId:"confirm-close-modal-confirm-button",...a})]})]})]},"confirm-close-modal-content")})});p.displayName="ConfirmCloseModalContent";var h=a(64299),v=a.n(h);let g=r.memo(e=>{let{children:t,className:a="",motionProps:r,ref:s}=e;return(0,l.jsx)(i.hJ,{asChild:!0,ref:s,children:(0,l.jsx)(o.P.div,{className:v()("bg-backdrop/25 fixed inset-0 flex flex-col items-center justify-center backdrop-blur-[1px]",a),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},...r,children:t},"confirm-close-modal-overlay")})});g.displayName="ConfirmCloseModalOverlay";let f=r.memo(function(){let{$t:e}=(0,s.A)(),t=(0,r.useMemo)(()=>({text:e({defaultMessage:"Cancel",id:"47FYwba+bI"}),testId:"default-confirm-modal-cancel-button"}),[e]),a=(0,r.useMemo)(()=>({text:e({defaultMessage:"Discard",id:"nmpevlUATU"}),testId:"default-confirm-modal-discard-button"}),[e]);return(0,l.jsx)(g,{children:(0,l.jsx)(p,{cancelButton:t,confirmButton:a,description:e({defaultMessage:"Discard any unsaved changes?",id:"p7u+eL35XP"}),title:e({defaultMessage:"Discard changes?",id:"41zpq3nBvm"})})})});f.displayName="DefaultConfirmModal"},1407:(e,t,a)=>{"use strict";a.d(t,{b:()=>l});let l=(0,a(27773).w)({path:"M7 10h10 M9 14h5 M12.4 3a5.34 5.34 0 0 1 4.906 3.239a5.333 5.333 0 0 1 -1.195 10.6a4.26 4.26 0 0 1 -5.28 1.863l-3.831 2.298v-3.134a2.668 2.668 0 0 1 -1.795 -3.773a4.8 4.8 0 0 1 2.908 -8.933a5.33 5.33 0 0 1 4.287 -2.16",name:"IconBubbleText",variant:"stroked"})},1861:(e,t,a)=>{"use strict";a.d(t,{V:()=>l});let l=(0,a(27773).w)({path:"M15 15m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0 M13 17.5v4.5l2 -1.5l2 1.5v-4.5 M10 19h-5a2 2 0 0 1 -2 -2v-10c0 -1.1 .9 -2 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -1 1.73 M6 9l12 0 M6 12l3 0 M6 15l2 0",name:"IconCertificate",variant:"stroked"})},1863:(e,t,a)=>{"use strict";a.d(t,{b:()=>l});let l=(0,a(27773).w)({path:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0 M12 9v4 M12 16v.01",name:"IconExclamationCircle",variant:"stroked"})},2241:(e,t,a)=>{"use strict";var l;a.d(t,{P:()=>r}),function(e){e[e.NONE=0]="NONE",e[e.READER=1]="READER",e[e.WRITER=2]="WRITER",e[e.EDITOR=5]="EDITOR",e[e.ADMIN=3]="ADMIN",e[e.OWNER=4]="OWNER",e[e.OWNER_DEFAULT_BOOKMARKS=6]="OWNER_DEFAULT_BOOKMARKS",e[e.INVITED_READER=11]="INVITED_READER",e[e.INVITED_WRITER=12]="INVITED_WRITER",e[e.INVITED_EDITOR=15]="INVITED_EDITOR",e[e.INVITED_ADMIN=13]="INVITED_ADMIN"}(l||(l={}));let r="CLIENT_SEARCH_PLACEHOLDER"},2870:(e,t,a)=>{"use strict";a.d(t,{T:()=>j});var l=a(85860),r=a(83081),s=a(83105),i=a(61851),n=a(98188),o=a(96420),d=a(94105);let c=(e,t)=>{let{value:a,loading:r}=(0,d.Hl)({flag:"maybe-student-domains-regex",defaultValue:e,extraAttributes:t,subjectType:"visitor_id"});return(0,l.useMemo)(()=>({variation:a,loading:r}),[a,r])};var u=a(15492),m=a(77917),p=a(11129),h=a(3041);let v=async e=>{let{reason:t,headers:a}=e;try{return(await m.By.GET("/rest/academic/check-edu-institution",t,{timeoutMs:m.dS.HIGH,headers:a})).data}catch(e){return h.vF.error("Failed to check institution",e),null}},g=e=>{let{reason:t}=e;return(0,u.useQuery)({queryKey:(0,p.mo)(),queryFn:()=>v({reason:t})})},f=e=>{var t,a;let{reason:r}=e,{session:s}=(0,n.N)(),i=null!==(a=null==s?void 0:null===(t=s.user)||void 0===t?void 0:t.email)&&void 0!==a?a:"",{isStudent:d,loading:u}=(0,o.W)({email:i,reason:r}),{variation:m,loading:p}=c(!1),{data:h,isLoading:v}=g({reason:r});return(0,l.useMemo)(()=>v||p||u?{isLoading:!0,signals:{isVerifiedStudent:null,isPossibleStudentByEmail:null,isPossibleStudentByIP:null}}:{isLoading:!1,signals:{isVerifiedStudent:!!d,isPossibleStudentByEmail:!!m,isPossibleStudentByIP:!!(null==h?void 0:h.institution)}},[v,p,u,m,d,null==h?void 0:h.institution])};var y=a(76523),x=a(80892),b=a(51244),w=a(64512),_=a(87147),M=a(43627);let C=(e,t)=>t.isFromStudentCometGrowthCountry?M.Kw.GROW_COMET_STUDENTS_COUNTRY:t.isFromStudentCometGrowth?M.Kw.GROW_COMET_STUDENTS:t.isFromStudentReferral?M.Kw.STUDENT_REFERRAL_LANDING_PAGE:t.isFromStudentLanding?M.Kw.STUDENT_LANDING_PAGE:e,j=e=>{let{origin:t,customCallbacks:a}=e,{$t:n}=(0,r.A)(),o=(0,s.L)(),{trackEvent:d}=(0,x.yw)(),{openVisitorLoginUpsell:c}=(0,i.P)({enabled:!o}),{insertStepAndNavigate:u,currentIndex:m,handleComplete:p}=(0,w.j)(),{openModal:h}=(0,b.u)(),v=(0,y.j)(),{signals:g,isLoading:M}=f({reason:"combined_paywall"}),j=(0,l.useCallback)(e=>{if(e){if(v.isFromStudentCometGrowth){p();return}"/onboarding"===window.location.pathname?(_.h.setItem("student_verification_id",e),u("onboarding-student-referrals",m+1)):setTimeout(()=>{h("studentReferrals",{verificationId:e})},150)}},[u,m,h,v,p]),A=(0,l.useCallback)(e=>{var l;d("sheerid form redirect",{verificationLocationSource:C(t,v),verificationRoleType:e}),h("sheerIdModal",{type:e,onSuccess:null!==(l=null==a?void 0:a.onSuccess)&&void 0!==l?l:j,onClose:null==a?void 0:a.onClose})},[j,t,d,v,h,a]),E=(0,l.useCallback)(e=>{if(!o){c({title:n({defaultMessage:"Sign in to unlock Education Pro",id:"UNeU1Y4Zdu"}),origin:t,disallowedMethods:["apple"]});return}A(e)},[o,c,A,n,t]),S=v.isFromStudentFlow||!!g.isVerifiedStudent||!!g.isPossibleStudentByEmail||!!g.isPossibleStudentByIP;return{isLoading:!!M,isVerifiedStudent:!!g.isVerifiedStudent,handleStudentTierClick:E,handleVerificationSuccess:j,shouldDefaultToStudent:S,signals:g}}},4732:(e,t,a)=>{"use strict";a.d(t,{I3:()=>v,_X:()=>h});var l=a(9006),r=a(77936),s=a(90768),i=a(10910);let n=(0,a(27773).w)({path:"M14 3v4a1 1 0 0 0 1 1h4 M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z M9 9l1 0 M9 13l6 0 M9 17l6 0",name:"IconFileText",variant:"stroked"});var o=a(10544),d=a(95734),c=a(91458),u=a(12928),m=a(89450);let p={PDF:"pdf",TXT:"txt",CSV:"csv",XLSX:"xlsx",DOCX:"docx",PPTX:"pptx",MARKDOWN:"md",JPG:"jpg",JPEG:"jpeg",PNG:"png"},h=e=>!!((0,l.jC)(e)===p.PDF||(0,r.O8)(e)),v=e=>{let t=(0,l.jC)(e);if((0,r.O8)(e))return c.m;switch(t){case p.TXT:case p.MARKDOWN:return n;case p.PDF:return c.m;case p.XLSX:return i._;case p.CSV:return o.Q;case p.DOCX:return d.I;case p.PPTX:return u.K;case p.JPG:case p.JPEG:case p.PNG:return m.Q;default:return s.g}}},5551:(e,t,a)=>{"use strict";a.d(t,{k:()=>o});var l=a(25576),r=a(85860),s=a(61350);let i=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")},n={default:"default"},o=r.memo(e=>{let{indicatorClassName:t,indeterminate:a,className:o,value:d=0,max:c=100,variant:u=n.default,ref:m,...p}=e,h=r.useMemo(()=>{let e={default:"bg-inverse",super:"bg-super"};return i("size-full transition-transform duration-300 ease-in-out",e[u]||e.default,a&&"animate-indeterminate",t)},[u,a,t]);return(0,l.jsx)(s.bL,{ref:m,className:i("bg-subtle relative h-1 w-full overflow-hidden rounded-[1px]",o),...p,children:(0,l.jsx)(s.C1,{className:h,style:{transform:"translateX(-".concat(100-(null!=d?d:0)/c*100,"%)")}})})});o.displayName="Progress"},5826:(e,t,a)=>{"use strict";a.d(t,{Cx:()=>k,Dz:()=>_,F2:()=>h,KW:()=>C,L0:()=>p,N6:()=>A,Pf:()=>m,T7:()=>x,Tr:()=>u,V$:()=>b,VH:()=>M,X3:()=>v,ZA:()=>j,_Y:()=>w,dg:()=>c,gh:()=>y,nY:()=>E,nk:()=>g,pG:()=>S,r1:()=>f});var l=a(50698),r=a(3041);let s="rwTokenStorage",i=e=>{let t=JSON.stringify(e);try{l.U.setItem(s,t)}catch(e){r.vF.warn("Could not put rw token storage"),r.vF.warn(e)}},n=()=>{let e=null;try{e=l.U.getItem(s)}catch(e){r.vF.warn("Could not access local storage"),r.vF.warn(e)}if(!e)return i({}),{};try{var t;return null!==(t=JSON.parse(e))&&void 0!==t?t:{}}catch(e){return r.vF.warn("Could not deserialize rw token storage"),r.vF.warn(e),i({}),{}}},o=(e,t)=>{if(!e||!t)return;let a=n(),l=Object.keys(a);if(l.length>=20){let e=l[Math.floor(Math.random()*l.length)];e&&delete a[e]}(l=Object.keys(a)).length>25&&(r.vF.warn("Too many rw tokens stored; resetting"),a={}),a[e]=t,i(a)},d=e=>e?n()[e]:void 0,c=e=>{let t=e.context_uuid;if(!t)return;let a=d(t);if(a)return a;let l=null==e?void 0:e.read_write_token;if(l)return o(t,l),l},u=e=>{var t;return null!==(t=null==e?void 0:e.context_uuid)&&void 0!==t?t:void 0},m=e=>{var t;return null!==(t=null==e?void 0:e.frontend_context_uuid)&&void 0!==t?t:void 0},p=e=>{var t;return null!==(t=null==e?void 0:e.thread_title)&&void 0!==t?t:""},h=e=>{var t;return null!==(t=null==e?void 0:e.query_str)&&void 0!==t?t:void 0},v=e=>{var t;return null!==(t=null==e?void 0:e.search_focus)&&void 0!==t?t:void 0},g=e=>{var t,a;return null!==(a=null===(t=e.sources)||void 0===t?void 0:t.sources)&&void 0!==a?a:void 0},f=e=>{var t;return null!==(t=null==e?void 0:e.author_id)&&void 0!==t?t:void 0},y=e=>{var t;return null!==(t=null==e?void 0:e.author_username)&&void 0!==t?t:void 0},x=e=>{var t;return null!==(t=null==e?void 0:e.author_image)&&void 0!==t?t:void 0},b=e=>{if(e.parent_info)return e.parent_info},w=e=>{var t;return null!==(t=null==e?void 0:e.mode)&&void 0!==t?t:null},_=e=>{var t;return null!==(t=null==e?void 0:e.personalized)&&void 0!==t?t:void 0},M=e=>{var t;return null!==(t=null==e?void 0:e.collection_info)&&void 0!==t?t:void 0},C=e=>{var t;return null!==(t=null==e?void 0:e.bookmark_state)&&void 0!==t?t:void 0},j=e=>{var t;return null!==(t=null==e?void 0:e.thread_access)&&void 0!==t?t:void 0},A=e=>{var t;return null!==(t=null==e?void 0:e.thread_url_slug)&&void 0!==t?t:void 0},E=e=>{var t;return null!==(t=null==e?void 0:e.updated_datetime)&&void 0!==t?t:void 0},S=e=>{var t;return null!==(t=null==e?void 0:e.expiry_time)&&void 0!==t?t:null},k=e=>{var t;return null!==(t=null==e?void 0:e.privacy_state)&&void 0!==t?t:void 0}},6433:(e,t,a)=>{"use strict";a.d(t,{S:()=>p});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(12839),o=a(60410),d=a(98540),c=a(74858),u=a(49427);let m={"my.apps.factset.com":"www.factset.com"},p=r.memo(e=>{let{domain:t,overrideIconUrl:a,size:s=16,hideBorder:p=!1,className:h,...v}=e,g=m[t]||t,f=(0,d.Ld)(g,128),y=(0,r.useMemo)(()=>a||f,[a,f]),[x,b]=(0,r.useState)(!0);(0,r.useEffect)(()=>{b(!0)},[y]);let w=(0,r.useMemo)(()=>({width:s,height:s}),[s]),_=(0,r.useMemo)(()=>({width:.7*s,height:.7*s}),[s]);return(0,l.jsxs)("div",{style:{width:s,height:s},className:i()("relative shrink-0 overflow-hidden rounded-full",h),...v,children:[x?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:i()("rounded-inherit absolute inset-0",!p&&"bg-white")}),(0,l.jsx)("img",{className:"relative block",src:y,alt:"".concat(t," favicon"),width:s,height:s,onLoad:e=>{let l=e.target;b(void 0!==a||16!==l.naturalWidth||16!==l.naturalHeight||t!==g)},onError:()=>{b(!1)},style:{width:s,height:s}})]}):(0,l.jsx)(n.Ay,{variant:"subtler",style:w,className:"flex items-center justify-center",children:(0,l.jsx)(o.A,{color:"ultraLight",children:(0,l.jsx)(u.e,{icon:c.U,className:"relative block",style:_})})}),!p&&(0,l.jsx)("div",{className:"rounded-inherit absolute inset-0 border border-[black]/10 dark:border-transparent"})]})});p.displayName="CitationFavicon"},6602:(e,t,a)=>{"use strict";a.d(t,{e$:()=>s});let l=RegExp("<q>(.*?)<\\/q>","s"),r=(e,t)=>{if(!e||!t)return e;let a=e.trim(),l=a[a.length-1];return l&&!["!","?",".",":",";"].includes(l)?"".concat(a,". ").concat(t):"".concat(a," ").concat(t)};function s(e,t){if(!e)return{quote:null,actualQuery:null};if(!l.test(e)){let a=null==t?void 0:t.join(" ").trim();return{quote:null,actualQuery:a?r(e,a):e}}let a=e.match(l),s=(null==a?void 0:a[1])||null,i=e.replace(l,"").trim(),n=null==t?void 0:t.join(" ").trim();return n&&(i=r(i,n)),{quote:s,actualQuery:i}}},6866:(e,t,a)=>{"use strict";a.d(t,{bo:()=>n,lc:()=>i});var l=a(88304),r=a(43627),s=a(30002);let i=["onboarding-pro","onboarding-mobile"],n=e=>{let{searchParams:t,cleanRedirect:a}=e;if(!t)return null;let i=t.get("redirect"),n=a?(0,l.s4)({redirect:i}):i,o=null;try{o=n&&new URL(n).searchParams.get(s.cp2)}catch(e){return null}return o?o===r.Kw.GROW_COMET_STUDENTS_COUNTRY?r.Kw.GROW_COMET_STUDENTS_COUNTRY:o===r.Kw.GROW_COMET_STUDENTS?r.Kw.GROW_COMET_STUDENTS:null:null}},7038:(e,t,a)=>{"use strict";a.d(t,{x:()=>s});var l=a(85860),r=a(94105);let s=(e,t)=>{let{value:a,loading:s}=(0,r.Hl)({flag:"file-manager-ui-redesign",defaultValue:e,extraAttributes:t,subjectType:"visitor_id"});return(0,l.useMemo)(()=>({variation:a,loading:s}),[a,s])}},7616:(e,t,a)=>{"use strict";a.d(t,{v:()=>l});class l extends Date{getTimezoneOffset(){return 0}constructor(e){let t=e?new Date(e):new Date;super(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))}}},7631:(e,t,a)=>{"use strict";a.d(t,{Ox:()=>l,_r:()=>r}),a(30002);let l=(e,t)=>e.filter(e=>e.name===t).map(e=>e.connection_uuid).filter(e=>null!=e),r=e=>"LINEAR"===e||"NOTION_MCP"===e||"LINEAR_ALT"===e||"SLACK"===e||"GITHUB_MCP_DIRECT"===e||"ASANA_MCP_DIRECT"===e||"ASANA_MCP_MERGE"===e||"ATLASSIAN_MCP_DIRECT"===e||"SLACK_DIRECT"===e||"JIRA_MCP_MERGE"===e||"CONFLUENCE_MCP_MERGE"===e||"MICROSOFT_TEAMS_MCP_MERGE"===e},7695:(e,t,a)=>{"use strict";a.d(t,{J:()=>_});var l=a(85860),r=a(95641),s=a(4428),i=a(83081),n=a(63137),o=a(26976),d=a(11129),c=a(14036),u=a(60010),m=a(46524);let p=e=>{let{fileRepositoryType:t,offset:a,searchTerm:l,ownerId:p,reason:h}=e,{$t:v}=(0,i.A)(),g=(0,r.useQueryClient)(),f=(0,m.g)(),{deprecatedOpenToast:y}=(0,u.G)(),{isEnterprise:x}=(0,c.fE)({reason:h}),b=(0,d.Dj)(),w=(0,d.$8)(t,p,n.g8,a,l),_=(0,d.Q)(p),M=Array.isArray(null==f?void 0:f.slug)?f.slug[0]:null==f?void 0:f.slug,C=M?(0,d.Ci)(M):void 0,j="USER"===t||"ORG"===t||"COLLECTION"===t&&!!p;return{...(0,s.useMutation)({mutationFn:async e=>{if(!j){y(v({defaultMessage:"Unable to delete files.",id:"QYfmPDehhb"}),"error",3);return}return(0,o.Iv)({request:{file_uuids:e,file_repository_info:{file_repository_type:t,owner_id:p}},reason:h})},onMutate:async e=>{await g.cancelQueries({queryKey:w});let t=g.getQueryData(w);return t&&g.setQueryData(w,t=>({...t,completedFiles:t.completedFiles.filter(t=>!e.includes(t.file_uuid)),processingFiles:t.processingFiles.filter(t=>!e.includes(t.file_uuid)),failedFiles:t.failedFiles.filter(t=>!e.includes(t.file_uuid)),numTotalFiles:Math.max((t.numTotalFiles||0)-e.length,0)})),{previousData:t}},onSuccess:()=>{x&&g.invalidateQueries({queryKey:b}),g.invalidateQueries({queryKey:w}),M&&g.invalidateQueries({queryKey:C}),g.invalidateQueries({queryKey:_})},onError:(e,t,a)=>{(null==a?void 0:a.previousData)&&g.setQueryData(w,a.previousData),y(v({defaultMessage:"Failed to delete file",id:"aJlra1/tgY"}),"error",3)}}),isDeleteEnabled:j}};var h=a(83312),v=a(80314);let g=e=>{let{fileRepoInfo:t,reason:a}=e,l=(0,r.useQueryClient)(),i=(0,m.g)(),o=(0,d.Dj)(),c=Array.isArray(null==i?void 0:i.slug)?i.slug[0]:null==i?void 0:i.slug,u=c?(0,d.Ci)(c):void 0,p=(0,d.$8)(t.file_repository_type,t.owner_id,n.g8,0,""),h=["list_file_directory",t.file_repository_type,t.owner_id];return(0,s.useMutation)({mutationFn:async e=>{await (0,v._J)({request:{file_repository_info:t,file_index_params:[{file_s3_url:e.file_s3_url,file_size:e.size,filename:e.name,file_uuid:e.file_uuid,replace_existing:!0}]},reason:a})},onMutate:async e=>{await l.cancelQueries({queryKey:p});let t={...e,state:"PROCESSING",error:void 0};return l.setQueriesData({queryKey:p},e=>{if(!e)return e;let a=e.completedFiles.filter(e=>e.name!==t.name),l=e.failedFiles.filter(e=>e.file_uuid!==t.file_uuid),r=[...e.processingFiles||[],t];return{...e,completedFiles:a,processingFiles:r,failedFiles:l}}),t},onSettled:()=>{l.invalidateQueries({queryKey:h}),"ORG"===t.file_repository_type&&l.invalidateQueries({queryKey:o}),c&&l.invalidateQueries({queryKey:u})}})};var f=a(98188),y=a(42826),x=a(14475);let b=async(e,t)=>{let a=new FormData;Object.entries(t.fields).forEach(e=>{let[t,l]=e;a.append(t,l)}),a.append("file",e);let l=null;for(let e=0;e<1;e++)try{e>0&&await new Promise(e=>setTimeout(e,2e3));let l=await fetch(t.s3_bucket_url,{method:"POST",body:a});if(!l.ok)throw Error("HTTP error ".concat(l.status,": ").concat(l.statusText));return}catch(e){l=e instanceof Error?e:Error(String(e))}throw Error("UPLOAD_FAILED after ".concat(1," attempts: ").concat((null==l?void 0:l.message)||"Unknown error"))},w=e=>{var t,a;let{fileRepoInfo:l,setTotalFilesUploading:n,replaceExisting:o,reason:c,onLocalFileUploadSuccess:p}=e,{$t:h}=(0,i.A)(),g=(0,r.useQueryClient)(),w=(0,d.Dj)(),_=(0,m.g)(),M=Array.isArray(null==_?void 0:_.slug)?_.slug[0]:null==_?void 0:_.slug,C=M?(0,d.Ci)(M):void 0,{deprecatedOpenToast:j}=(0,u.G)(),{session:A}=(0,f.N)(),E=null!==(a=null==A?void 0:null===(t=A.user)||void 0===t?void 0:t.email)&&void 0!==a?a:"",S=(0,x.u)({reason:c}),k=["list_file_directory",l.file_repository_type,l.owner_id],N=["list_file_directory_infinite",l.file_repository_type,l.owner_id],T="USER"===l.file_repository_type||"ORG"===l.file_repository_type||"COLLECTION"===l.file_repository_type&&!!l.owner_id&&l.owner_id!==y.Ox;return{...(0,s.useMutation)({mutationFn:async e=>{if(!T){j(h({defaultMessage:"Unable to upload files.",id:"GrtfijFWiu"}),"error",3);return}n(e.length);for(let t=0;t<e.length;t+=10){let a=e.slice(t,t+10),r=await (0,v.WZ)({request:{file_upload_params:a.map(e=>({filename:e.name,content_type:e.type,file_size:e.size})),file_repository_info:l},reason:c}),s=r.limits_reached[0];if("FILE_REPOSITORY_LIMIT_EXCEEDED"===s){j(h({defaultMessage:"You have reached the file limit of {limit} files per repository.",id:"J0uyf2gB1u"},{limit:S.maxFilesPerRepository}),"error",3);break}if("USER_FILE_LIMIT_EXCEEDED"===s){j(h({defaultMessage:"You've reached your total file limit of {limit} files across My Files and all Spaces. Delete some files or upgrade your plan to add more",id:"3CuAQ4xs/C"},{limit:S.maxFilesPerUser}),"error",3);break}let i=(await Promise.allSettled(r.file_url_params.map((e,t)=>e&&a[t]?{fileUploadUrlInfo:e,file:a[t]}:null).filter(e=>null!==e).map(async e=>{let{fileUploadUrlInfo:t,file:a}=e;try{return await b(a,t),{file_s3_url:t.s3_object_url,filename:a.name,file_size:a.size,file_uuid:t.file_uuid,replace_existing:o}}catch(e){throw j(h({defaultMessage:"Failed to upload file",id:"x2gE8tKhMn"}),"error",3),e}}))).filter(e=>"fulfilled"===e.status).map(e=>e.value);if(i.length>0&&await (0,v._J)({request:{file_repository_info:l,file_index_params:i},reason:c}),r.limits_reached.length>0)break}},onMutate:async e=>{await g.cancelQueries({queryKey:k});let t=g.getQueryData(k),a=e.map(e=>({name:e.name,file_s3_url:"",file_title:null,file_description:null,file_uuid:crypto.randomUUID(),uploadedBy:E,state:"PROCESSING",size:e.size,date:new Date().toLocaleString(),isOptimistic:!0}));return g.setQueriesData({queryKey:k},e=>e?{...e,processingFiles:[...e.processingFiles||[],...a]}:e),{previousData:t,optimisticFiles:a,uploadedFilesCount:e.length}},onError:(e,t,a)=>{j(h({defaultMessage:"Failed to upload file",id:"x2gE8tKhMn"}),"error",3),(null==a?void 0:a.previousData)&&g.setQueriesData({queryKey:k},a.previousData)},onSettled:()=>{g.invalidateQueries({queryKey:k}),g.invalidateQueries({queryKey:N}),g.invalidateQueries({queryKey:["connector-files"]}),g.invalidateQueries({queryKey:["connector-files-infinite"]}),"ORG"===l.file_repository_type&&g.invalidateQueries({queryKey:w}),M&&g.invalidateQueries({queryKey:C})},onSuccess:()=>{null==p||p()}}),isUploadEnabled:T}},_=e=>{let{reason:t,onLocalFileUploadSuccess:a,collectionSlugOverride:s}=e,i=(0,r.useQueryClient)(),{fileRepoInfo:o}=(0,h.y)({reason:t,collectionSlugOverride:s}),[d,c]=(0,l.useState)(0),[u,m]=(0,l.useState)(""),[v,f]=(0,l.useState)(0),{mutate:y}=w({fileRepoInfo:o,setTotalFilesUploading:f,reason:t,onLocalFileUploadSuccess:a}),{mutate:x}=p({fileRepositoryType:o.file_repository_type,offset:d,searchTerm:u,ownerId:o.owner_id,reason:t}),{mutate:b}=g({fileRepoInfo:o,reason:t}),_=(0,l.useCallback)(e=>{x(e),v>0&&f(v-e.length)},[x,v]),M=(0,l.useCallback)(e=>{f(e=>e+1),b(e)},[b]),C=(0,l.useCallback)(e=>{i.setQueryData(["list_file_directory",o.file_repository_type,o.owner_id,n.g8,d,u],t=>{var a;return{...t,processingFiles:[],failedFiles:[],numTotalFiles:Math.max(0,(null!==(a=null==t?void 0:t.numTotalFiles)&&void 0!==a?a:0)-e.length)}}),x(e.map(e=>e.file_uuid))},[o.file_repository_type,o.owner_id,d,u,i,x]),j=(0,l.useCallback)(async e=>{let t=[],a=async e=>{if(e.isFile){let a=await new Promise(t=>e.file(t));""!==a.type&&t.push(a)}else if(e.isDirectory){let t=e.createReader(),l=await new Promise(e=>t.readEntries(e));await Promise.all(l.map(a))}};e instanceof FileList?Array.from(e).forEach(e=>t.push(e)):await Promise.all(Array.from(e).map(async e=>{if("file"===e.kind){let t=e.webkitGetAsEntry();t&&await a(t)}})),t.length>0&&y(t)},[y]);return(0,l.useMemo)(()=>({offset:d,setOffset:c,searchTerm:u,setSearchTerm:m,totalFilesUploading:v,setTotalFilesUploading:f,handleRemoveFiles:_,handleReplaceExistingFile:M,handleClearAllFiles:C,handleFileSelect:j}),[C,j,_,M,d,u,v])}},8114:(e,t,a)=>{"use strict";a.d(t,{k:()=>r});var l=a(94105);function r(){let{value:e}=(0,l.Hl)({flag:"spaces-creation-redesign",subjectType:"user_nextauth_id",defaultValue:!1});return e}},9006:(e,t,a)=>{"use strict";function l(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(null==e)return"";let l=e.includes(".")?e.slice(e.lastIndexOf(".")):"",r=e.substring(0,e.length-l.length);return r.length>t?r.substring(0,t-l.length-3)+".".repeat(a)+l:r+l}a.d(t,{Nf:()=>s,ZD:()=>l,jC:()=>r});let r=e=>{var t,a;try{let a=new URL(e).pathname.split("/").pop()||"";return null===(t=a.split(".").pop())||void 0===t?void 0:t.toLowerCase()}catch(t){return null===(a=e.split(".").pop())||void 0===a?void 0:a.toLowerCase()}},s={txt:"text/plain",pdf:"application/pdf",jpeg:"image/jpeg",jpg:"image/jpeg",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",md:"text/markdown",png:"image/png",csv:"text/csv"}},9126:(e,t,a)=>{"use strict";a.d(t,{$s:()=>u,A_:()=>p,GD:()=>m,Jd:()=>x,On:()=>g,VU:()=>d,bx:()=>o,dm:()=>n,mm:()=>y,nP:()=>v,o1:()=>c,xC:()=>f});var l=a(25576);a(85860);var r=a(70714),s=a(57023),i=a(66723);let n=(0,l.jsx)(r.A,{defaultMessage:"Start for free, no credit card needed.",id:"uzjbT1FGfk"}),o=(0,l.jsx)(r.A,{defaultMessage:"Upgrade productivity and learning with additional access.",id:"PnQLpmbknU"}),d=(0,l.jsx)(r.A,{defaultMessage:"Unlock the full capabilities of Perplexity at a discount after verifying educational status.",id:"8fdSFzTbg5"}),c=(0,l.jsx)(r.A,{defaultMessage:"Unlock Perplexity's full capabilities with early access to new products.",id:"XvAk63xTH/"}),u=(0,l.jsx)(r.A,{defaultMessage:"Unlock the full capabilities of Perplexity for your team and enjoy new perks as they are added.",id:"fyHXg6ONTT"}),m=[(0,l.jsx)(r.A,{defaultMessage:"Limited file uploads and image generation",id:"Yajq3Us4wf"},"ei4z2Aep9t"),(0,l.jsx)(r.A,{defaultMessage:"Limited access to Perplexity Research",id:"rxiI86annI"},"Q4n6qAgIjm"),(0,l.jsx)(r.A,{defaultMessage:"Limited access to advanced AI models",id:"Um2NQaGAN2"},"k+gSVpF51l"),(0,l.jsx)(r.A,{defaultMessage:"Access to voice mode",id:"yzxI9mX7Ne"},"yzxI9mX7Ne")],p=[(0,l.jsx)(r.A,{defaultMessage:"10x as many citations in answers",id:"D0fULpN8/D"},"ei4z2Aep9t"),(0,l.jsx)(r.A,{defaultMessage:"Access to Perplexity Labs",id:"umi6FCpljx"},"LicOGayBYr"),(0,l.jsx)(r.A,{defaultMessage:"Unlimited file and photo uploads",id:"9mQ544QaNG"},"9mQ544QaNG"),(0,l.jsx)(r.A,{defaultMessage:"Extended access to Perplexity Research",id:"N+s4bfYMOJ"},"+tC8PdouYw"),(0,l.jsx)(r.A,{defaultMessage:"Extended access to image generation",id:"YLNO5T8j3R"},"YLNO5T8j3R"),(0,l.jsx)(r.A,{defaultMessage:"Limited access to video generation",id:"cuh0Xv/sI7"},"cuh0Xv/sI7"),(0,l.jsx)(r.A,{defaultMessage:"One subscription for all the latest AI models including GPT-5 and Claude Sonnet 4",id:"PjThV/+cRD"},"PjThV/+cRD")],h=[(0,l.jsx)(r.A,{defaultMessage:"Unlock free Pro",id:"ce/kjT07p9"},"unlock-free-pro"),(0,l.jsx)(r.A,{defaultMessage:"Access to Study Mode for interactive flashcards and quizzes",id:"wvFgbv8SQM"},"study-mode"),(0,l.jsx)(r.A,{defaultMessage:"10x as many citations in answers",id:"D0fULpN8/D"},"ei4z2Aep9t"),(0,l.jsx)(r.A,{defaultMessage:"Access to Perplexity Labs",id:"umi6FCpljx"},"LicOGayBYr"),(0,l.jsx)(r.A,{defaultMessage:"Unlimited file and photo uploads",id:"9mQ544QaNG"},"9mQ544QaNG"),(0,l.jsx)(r.A,{defaultMessage:"Extended access to Perplexity Research",id:"N+s4bfYMOJ"},"+tC8PdouYw"),(0,l.jsx)(r.A,{defaultMessage:"One subscription for all the latest AI models including GPT-5 and Claude Sonnet 4",id:"PjThV/+cRD"},"PjThV/+cRD"),(0,l.jsx)(r.A,{defaultMessage:"{credits} in API credits",id:"RDoR9eeHom",values:{credits:(0,l.jsx)(s.Gr,{value:5,style:"currency",currency:"USD"})}},"RDoR9eeHom")],v=()=>h,g=h,f=[(0,l.jsx)(r.A,{defaultMessage:"Everything in Pro",id:"EQO1QOs7ln"},"EQO1QOs7ln"),(0,l.jsx)(r.A,{defaultMessage:"Early access to our newest products",id:"WM5nzt3hTc"},"ju0j9rjkOw"),(0,l.jsx)(r.A,{defaultMessage:"Unlimited access to Perplexity Labs",id:"Vc+NmvcKpa"},"8jDdpmfeqS"),(0,l.jsx)(r.A,{defaultMessage:"Unlimited access to Perplexity Research",id:"+tC8PdouYw"},"8jDdpmfeqS"),(0,l.jsx)(r.A,{defaultMessage:"Use advanced AI models like OpenAI o3-pro and Anthropic Claude Opus 4.1",id:"RrdqLnZKqo"},"RrdqLnZKqo"),(0,l.jsx)(r.A,{defaultMessage:"Enhanced access to video generation",id:"VSNs3zFEjy"},"VSNs3zFEjy"),(0,l.jsx)(r.A,{defaultMessage:"Priority support",id:"3sSrKzxPrc"},"3sSrKzxPrc")],y=[(0,l.jsx)(r.A,{defaultMessage:"Unlimited Pro searches",id:"isnJxc1XxM"},"UnlimitedProSearches"),(0,l.jsx)(r.A,{defaultMessage:"Unlimited uploads for files and images",id:"y5R/L7qsi/"},"UnlimitedUploads"),(0,l.jsx)(r.A,{defaultMessage:"Unlimited collaborators in Spaces",id:"EZFr73mN/d"},"UnlimitedCollaborators"),(0,l.jsx)(r.A,{defaultMessage:"Connect Google Drive, Sharepoint, Dropbox, OneDrive, and Box",id:"ALW0u9e/Ps"},"ConnectCloudServices"),(0,l.jsx)(r.A,{defaultMessage:"Powered by the latest top AI models",id:"ZSiV9iYVeG"},"LatestAIModels"),(0,l.jsx)(r.A,{defaultMessage:"Dedicated enterprise support",id:"6ojq3KOETz"},"DedicatedSupport"),(0,l.jsx)(r.A,{defaultMessage:"Integrate with your identity provider",id:"NEWodUzDlf"},"IdentityProvider"),(0,l.jsx)(r.A,{defaultMessage:"User permissioning",id:"oEuCJfg2fr"},"UserPermissioning"),(0,l.jsx)(r.A,{defaultMessage:"SOC 2 Type II security compliance",id:"j84mT5pXG7"},"SOC2TypeII")],x=[(0,l.jsx)(r.A,{defaultMessage:"Everything in Enterprise Pro",id:"agavcX8Joo"},"EverythingInEnterprisePro"),...i.zJ.map(e=>(0,l.jsx)(r.A,{...e},e.id))]},9362:(e,t,a)=>{"use strict";a.d(t,{R:()=>h});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(12839),o=a(60410),d=a(28554),c=a(93902),u=a(26085),m=a(40758),p=a(18360);let h=r.memo(e=>{let{title:t,subtitle:a,subtitleClassname:s,centerTitle:h,children:v,actionList:g=p.Ml,variant:f="centered-sheet",onClose:y,noPadding:x,onIsClosing:b,footerContent:w,overlayVariant:_,titleLeadingButtonProps:M,showCloseButton:C=!0,...j}=e,[A,E]=(0,r.useState)(!1),[S,k]=(0,r.useState)(!1),N=(0,r.useMemo)(()=>i()("shadow-md overflow-y-auto scrollbar-subtle fill-mode-both",{"bg-none dark:bg-none bg-backdrop/25 backdrop-blur-sm":"full-sheet-blurred"===f,"bg-gradient-to-t from-base from-45% to-transparent":"bottom-sheet-gradient"===f,"w-screen md:h-screen h-[100dvh] flex flex-col":"full-sheet-blurred"===f||"full-sheet"===f,"w-screen min-h-[60dvh] md:min-h-[60vh] max-h-[96dvh] md:max-h-[96vh] flex flex-col fixed bottom-0 left-0 right-0 bg-none dark:bg-none bg-backdrop/70 backdrop-blur-md":"bottom-sheet-blurred"===f,"flex items-center justify-end w-screen h-[100dvh] md:max-h-[96vh] flex flex-col fixed bottom-0 left-0 right-0":"bottom-sheet-gradient"===f,"animate-in slide-in-from-bottom ease-in":"bottom-sheet-blurred"===f&&!S,"animate-out slide-out-to-bottom ease-out":"bottom-sheet-blurred"===f&&S,"animate-in fade-in ease-in duration-300":"bottom-sheet-gradient"===f&&!S,"animate-out fade-out ease-out duration-300":"bottom-sheet-gradient"===f&&S,"bg-base":"full-sheet"===f,"bg-base rounded-lg md:min-w-[600px] max-w-screen-lg max-h-[100vh]":"centered-sheet"===f,"bg-base rounded-2xl max-w-[90dvw] max-h-[90dvh]":"inset-centered-sheet"===f}),[f,S]),T=(0,r.useMemo)(()=>i()("p-md grow flex flex-col",{"justify-center":"bottom-sheet-gradient"!==f,"justify-end":"bottom-sheet-gradient"===f,"md:pt-lg":void 0===t,"md:pb-lg":(null==g?void 0:g.length)===0,"px-0":x,"py-0":x}),[null==g?void 0:g.length,x,t,f]),I=(0,r.useMemo)(()=>g.map((e,t)=>{let{text:a,onClick:l,variant:s,disabled:i,isLoading:n,testId:o,icon:c}=e,u={key:t,text:a,chevron:void 0!==c,disabled:i,isLoading:n,onClick:l,testId:o,chevronIcon:c};return s?(0,r.createElement)(d.A,{fullWidthMobile:!0,variant:s,...u,key:u.key}):(0,r.createElement)(d.A,{fullWidthMobile:!0,...u,key:u.key})}),[g]),R=(0,r.useCallback)(()=>{null==b||b(),k(!0)},[k,b]),P=(0,r.useCallback)(()=>{k(!1),E(!1),null==y||y()},[k,E,y]),O=(0,r.useCallback)(()=>{k(!1),E(!1),null==y||y()},[E,k,y]),D=(0,r.useMemo)(()=>{switch(f){case"full-sheet-blurred":case"full-sheet":return"full-sheet";case"bottom-sheet-blurred":case"bottom-sheet-gradient":return"bottom-sheet";default:return"default"}},[f]),L=(0,r.useMemo)(()=>"bottom-sheet-blurred"===f||"bottom-sheet-gradient"===f,[f]);return(0,l.jsx)(m.h,{transparent:L,canOutsideClickClose:!0,childVariant:D,shouldClose:A,onIsClosing:R,onClose:P,variant:_,...j,children:(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:N,children:[(0,l.jsx)("div",{className:"right-sm top-sm fixed z-[23] md:absolute"}),(0,l.jsxs)(n.Ay,{className:i()("flex h-full grow flex-col rounded-none md:w-[unset] md:grow-[unset]","inset-centered-sheet"===f?"w-[90dvw]":"w-screen",{"border-t":"bottom-sheet-gradient"!==f}),children:[(0,l.jsxs)(n.Ay,{variant:"transparent",className:i()("px-md py-sm md:py-md sticky top-0 z-[22] w-full shrink-0",{"border-b":t&&!h,"text-center":h,"h-8":!t&&C}),children:[(0,l.jsxs)("div",{className:"gap-sm md:gap-md flex items-center",children:[M&&(0,l.jsx)(u.A,{extraCSS:"-ml-sm",...M,size:"small",variant:"common"}),t&&(0,l.jsx)(o.A,{variant:"page-title",className:i()("line-clamp-1 md:line-clamp-2",{"pt-lg grow":h,"mr-lg":!h}),children:t}),!L&&"full-sheet-blurred"!==f&&C&&(0,l.jsx)(c.A,{onClick:O,testId:"close-modal"})]}),a&&(0,l.jsx)(o.A,{variant:"base",color:"light",className:i()("mt-xs line-clamp-3",s),children:a})]}),(0,l.jsx)("div",{className:T,children:v}),((null==I?void 0:I.length)>0||w)&&(0,l.jsxs)(n.Ay,{variant:"background",className:i()("gap-x-sm p-sm pb-md md:pb-sm sticky bottom-0 z-10 flex items-center border-t",{"justify-end":!w},{"justify-between":w}),children:[w,I]})]})]})})})});h.displayName="SheetModal"},9758:(e,t,a)=>{"use strict";var l;a.d(t,{X:()=>l}),function(e){e.GOOGLE_DRIVE="GOOGLE_DRIVE",e.ONEDRIVE="ONEDRIVE",e.SHAREPOINT="SHAREPOINT",e.DROPBOX="DROPBOX",e.BOX="BOX",e.WILEY="WILEY",e.GCAL="GCAL",e.GENERATED_IMAGE="GENERATED_IMAGE",e.GENERATED_VIDEO="GENERATED_VIDEO",e.NOTION="NOTION",e.NOTION_MCP="NOTION_MCP",e.OUTLOOK="OUTLOOK",e.LINEAR="LINEAR",e.LINEAR_ALT="LINEAR_ALT",e.SLACK="SLACK",e.GITHUB_MCP_DIRECT="GITHUB_MCP_DIRECT",e.ASANA_MCP_DIRECT="ASANA_MCP_DIRECT",e.ASANA_MCP_MERGE="ASANA_MCP_MERGE",e.ATLASSIAN_MCP_DIRECT="ATLASSIAN_MCP_DIRECT",e.LOCAL="LOCAL",e.SLACK_DIRECT="SLACK_DIRECT",e.JIRA_MCP_MERGE="JIRA_MCP_MERGE",e.CONFLUENCE_MCP_MERGE="CONFLUENCE_MCP_MERGE",e.MICROSOFT_TEAMS_MCP_MERGE="MICROSOFT_TEAMS_MCP_MERGE",e.FACTSET="FACTSET"}(l||(l={}))},10173:(e,t,a)=>{"use strict";a.d(t,{G:()=>d});var l=a(85860),r=a(83081),s=a(26976),i=a(60010),n=a(99390),o=a(62615);let d=e=>{let{reason:t}=e,a=(0,o.ok)(),d=null==a?void 0:a.get("referrer"),c=null==a?void 0:a.get("referrerId"),{$t:u}=(0,r.A)(),{deprecatedOpenToast:m}=(0,i.G)(),p=(0,l.useCallback)(async e=>{var a,l;let{connectorName:r,redirectPath:i,customReferrer:o,customReferrerId:p,unauthedRedirectPath:h}=e,v=await (0,s.Di)({name:r,referrer:null!==(a=null!=o?o:d)&&void 0!==a?a:void 0,referrerId:null!==(l=null!=p?p:c)&&void 0!==l?l:void 0,redirectPath:null!=i?i:void 0,unauthedRedirectPath:null!=h?h:void 0,reason:t});if(!v){m(u({defaultMessage:"Unable to start connection.",id:"SPIzcd/Xa2"}),"error",3);return}(0,n.x)(v,"File connector")},[t,d,c,u,m]);return(0,l.useMemo)(()=>({handleConnect:p}),[p])}},10544:(e,t,a)=>{"use strict";a.d(t,{Q:()=>l});let l=(0,a(27773).w)({path:"M14 3v4a1 1 0 0 0 1 1h4 M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4 M7 16.5a1.5 1.5 0 0 0 -3 0v3a1.5 1.5 0 0 0 3 0 M10 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75 M16 15l2 6l2 -6",name:"IconFileTypeCsv",variant:"stroked"})},10748:(e,t,a)=>{"use strict";a.d(t,{A:()=>x,v:()=>y});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(12839),o=a(60410),d=a(28554),c=a(38683),u=a(17147),m=a(87327),p=a(39808),h=a(12718),v=a(12422),g=a(49427),f=a(72811);let y=r.memo(e=>{let{isOpen:t,onClose:a,imgProps:s,alt:y,width:x,height:b,origin:w,onDownload:_,footer:M}=e,{url:C,name:j,showCitation:A=!0}=w||{},E=(0,c.tT)(),S=(0,r.useCallback)(e=>{e.stopPropagation(),null==_||_()},[_]);return(0,l.jsxs)(u.A,{onClose:a,isOpen:t,variant:"hide-chrome",disableAnimation:!1,removeScroll:!E,modalClassname:"z-[100]",children:[(0,l.jsx)("div",{className:"flex h-screen w-screen place-content-center",onClick:a,children:(0,l.jsxs)("div",{className:i()("gap-md p-md md:p-lg flex w-full flex-col",{"md:pb-md":A&&(C||_)}),children:[(0,l.jsx)("div",{className:"relative grow",children:(0,l.jsx)("div",{className:"absolute inset-0 size-full",children:(0,l.jsx)("img",{width:x,height:b,...s,alt:y,className:"size-full object-contain"})})}),A&&(C||_)?(0,l.jsxs)("div",{className:"gap-sm flex w-full flex-row justify-center",children:[C&&(0,l.jsx)(f.N,{href:C,target:"_blank",children:(0,l.jsxs)(n.Ay,{variant:"subtle",className:"gap-x-xs p-sm flex items-center rounded-full",children:[(0,l.jsx)(m.E,{url:C,source:j,isAttachment:!1}),(0,l.jsx)(o.A,{variant:"small",className:"pr-xs",children:(0,l.jsx)(g.e,{icon:p.q,size:"xs"})})]})}),_&&(0,l.jsx)(n.Ay,{as:"button",onClick:S,variant:"subtle",className:"gap-x-xs p-sm flex !aspect-square w-9 items-center justify-center rounded-full",children:(0,l.jsx)(g.e,{icon:h.i,size:"sm"})})]}):null,M]})}),(0,l.jsx)(d.A,{onClick:a,icon:v.M,extraCSS:"!fixed top-md right-md shadow-sm",size:"small",pill:!0,ariaLabel:"Close"})]})});y.displayName="LightboxImage";let x=y},10910:(e,t,a)=>{"use strict";a.d(t,{_:()=>l});let l=(0,a(27773).w)({path:"M14 3v4a1 1 0 0 0 1 1h4 M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z M8 11h8v7h-8z M8 15h8 M11 11v7",name:"IconFileSpreadsheet",variant:"stroked"})},10924:(e,t,a)=>{"use strict";a.d(t,{tH:()=>e$,tM:()=>eZ,VF:()=>eJ});var l=a(25576),r=a(85860),s=a(90873),i=a(46304),n=a(95641),o=a(4428),d=a(80314);let c=e=>{let{reason:t}=e,a=(0,n.useQueryClient)();return(0,o.useMutation)({mutationFn:e=>{let{fileUuids:a,fileRepoInfo:l}=e;return(0,d.EB)({request:{file_repository_info:l,filters:{uuids:a,connection_ids:[],connection_types:[],file_types:[],ids:[],parent_uuids:[],remote_file_ids:[],root_files_only:!1,status:[],upload_ids:[]}},reason:t})},onSuccess:()=>{a.invalidateQueries({queryKey:["connector-files"]})}})};var u=a(21753),m=a(83081);let p=e=>{let{reason:t}=e,a=(0,n.useQueryClient)();return(0,o.useMutation)({mutationFn:e=>{let{fileUuids:a,fileRepoInfo:l}=e;return(0,d.h_)({request:{file_repository_info:l,filters:{uuids:a,connection_ids:[],connection_types:[],file_types:[],ids:[],parent_uuids:[],remote_file_ids:[],root_files_only:!1,status:[],upload_ids:[]}},reason:t})},onSuccess:()=>{a.invalidateQueries({queryKey:["connector-files"]})}})};var h=a(97618),v=a(12839),g=a(60410),f=a(26085),y=a(38683),x=a(26890),b=a(18811),w=a(9758),_=a(16850),M=a(7),C=a(63825),j=a(62492),A=a(81467),E=a(49427);let S=r.memo(e=>{let{files:t,fileRepoInfo:a,isLoadingConnectorFiles:s,allowEditSources:i,onFolderClick:n}=e,o="connectors-table-files",d=(0,m.A)(),{locale:u}=(0,m.A)(),{isMobileStyle:S}=(0,y.al)(),{mutate:k}=c({reason:o}),{mutate:N}=p({reason:o}),T=(0,r.useCallback)(e=>{(0,h.jO)(e)?n(e.uuid,e.name):e.connection_file_url&&window.open(e.connection_file_url,"_blank")},[n]),I=(0,r.useCallback)(e=>[{type:"default",text:d.formatMessage({defaultMessage:"View",id:"FgydNeoT78"}),icon:M.H,onClick:t=>{t.stopPropagation(),e.connection_file_url&&window.open(e.connection_file_url,"_blank")},show:!!e.connection_file_url},{type:"default",text:d.formatMessage({defaultMessage:"Remove",id:"G/yZLul6P1"}),icon:j.E,onClick:t=>{t.stopPropagation(),k({fileUuids:[e.uuid],fileRepoInfo:a})},show:i},{type:"default",text:d.formatMessage({defaultMessage:"Resync",id:"yr3UuWC6qt"}),icon:C.H,onClick:t=>{t.stopPropagation(),N({fileUuids:[e.uuid],fileRepoInfo:a})},show:i&&e.connection_type!==w.X.LOCAL}],[d,i,k,N,a]);return s?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:5,className:"py-sm",children:(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)(b.A,{variant:"subtle",size:"regular",blockCount:8,noLines:!0,divider:!0,className:"w-full"})})})}):(0,l.jsx)(l.Fragment,{children:t.map((e,t)=>{var a;return(0,l.jsx)(r.Fragment,{children:(0,l.jsxs)("tr",{className:"border-subtler animate-in fade-in border-b align-middle duration-500",onClick:()=>T(e),children:[(0,l.jsx)("td",{className:"py-sm cursor-pointer overflow-hidden whitespace-nowrap",children:(0,l.jsx)(v.Ay,{className:"shrink-0",children:e.connection_type===w.X.LOCAL?(0,l.jsx)(E.e,{icon:A.n,size:"lg"}):(0,l.jsx)("img",{src:null!==(a=(0,h.cC)(e.connection_type))&&void 0!==a?a:"",alt:e.name,width:24,height:24})})}),(0,l.jsx)("td",{className:"py-sm cursor-pointer overflow-hidden whitespace-nowrap",children:(0,l.jsxs)("div",{className:"gap-x-sm flex items-center",children:[(0,l.jsx)(g.A,{children:(0,l.jsx)(E.e,{icon:(0,h.oP)(e)})}),(0,l.jsx)(g.A,{variant:"small",color:"light",className:"truncate",children:e.name})]})}),(0,l.jsx)("td",{className:"py-sm cursor-pointer overflow-hidden whitespace-nowrap",children:(0,l.jsx)(g.A,{variant:"small",color:"light",className:"truncate",children:(0,h.tj)(e.updated,u)})}),(0,l.jsx)("td",{className:"py-sm cursor-pointer overflow-hidden whitespace-nowrap",children:(0,l.jsx)(g.A,{variant:"small",color:"SYNC_ERROR"===e.status?"red":"light",className:"truncate",children:(0,h.cS)(e.status,d)})}),(0,l.jsx)("td",{className:"py-sm",children:(0,l.jsx)("span",{className:"flex justify-end",children:(0,l.jsx)(x.n,{isMobileStyle:S,placement:"bottom-end",items:I(e),children:(0,l.jsx)(f.A,{noPadding:!0,size:"small",icon:_.O})})})})]})},t)})})});S.displayName="ConnectorsTableFiles";var k=a(63137),N=a(57162);let T=r.memo(e=>{let{files:t,fileRepoInfo:a,isLoadingConnectorFiles:s,allowEditSources:i,selectedFiles:n,currentPath:o,setSelectedFiles:d,setCurrentPath:c,handleFolderClick:u,handleResetSearch:p}=e,h=(0,m.A)(),v=(0,r.useMemo)(()=>r.memo(()=>{let e=(0,r.useCallback)(()=>{c([]),p()},[]);return 0===o.length?null:(0,l.jsxs)("div",{className:"mb-md gap-x-xs flex items-center",children:[(0,l.jsx)(g.A,{variant:"tiny",color:0===o.length?void 0:"light",className:"cursor-pointer hover:underline",onClick:e,children:h.formatMessage({defaultMessage:"All",id:"zQvVDJ+j59"})}),o.map((e,t)=>(0,l.jsx)(I,{item:e,index:t,currentPathLength:o.length,handleResetSearch:p,setCurrentPath:c},e.uuid))]})}),[o,p,h,c]);return(0,l.jsxs)("div",{style:{minHeight:k.B_},className:"px-sm pt-md flex flex-col",children:[(0,l.jsx)(v,{}),(0,l.jsx)("div",{className:"grow-0",children:(0,l.jsxs)("table",{className:"w-full table-fixed",children:[(0,l.jsx)("thead",{className:"border-subtler border-b",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"pb-sm w-[10%] text-left",children:(0,l.jsx)(g.A,{variant:"smallBold",children:h.formatMessage({defaultMessage:"Source",id:"aH4De2Y20k"})})}),(0,l.jsx)("th",{className:"pb-sm w-[45%] text-left",children:(0,l.jsx)(g.A,{variant:"smallBold",children:h.formatMessage({defaultMessage:"Name",id:"HAlOn1ZsuY"})})}),(0,l.jsx)("th",{className:"pb-sm w-1/4 text-left",children:(0,l.jsx)(g.A,{variant:"smallBold",children:h.formatMessage({defaultMessage:"Date",id:"P7PLVjLe4f"})})}),(0,l.jsx)("th",{className:"pb-sm w-1/5 text-left",children:(0,l.jsx)(g.A,{variant:"smallBold",children:h.formatMessage({defaultMessage:"Status",id:"tzMNF3jWoU"})})})]})}),(0,l.jsx)("tbody",{children:(0,l.jsx)(S,{allowEditSources:i,files:t,fileRepoInfo:a,isLoadingConnectorFiles:s,selectedFiles:n,setSelectedFiles:d,onFolderClick:u})})]})}),!s&&0===t.length&&(0,l.jsx)("div",{className:"flex grow items-center justify-center",children:(0,l.jsx)(g.A,{color:"light",variant:"small",className:"text-center",children:h.formatMessage({defaultMessage:"Files that you sync will be found here",id:"uT32Xg01/F"})})})]})});T.displayName="ConnectorsTableContent";let I=r.memo(e=>{let{item:t,index:a,currentPathLength:s,handleResetSearch:i,setCurrentPath:n}=e,o=(0,r.useCallback)(()=>{n(e=>e.slice(0,a+1)),i()},[i,a,n]);return(0,l.jsxs)("div",{className:"gap-x-xs flex items-center",children:[(0,l.jsx)(g.A,{variant:"small",color:"light",children:"/"}),(0,l.jsx)(E.e,{icon:N.k}),(0,l.jsx)(g.A,{variant:"tiny",color:a===s-1?void 0:"light",className:"cursor-pointer hover:underline",onClick:o,children:t.name})]},t.uuid)});I.displayName="PathBlockFactory";var R=a(9006);let P=[".txt",".pdf",".docx",".pptx",".xlsx",".md",".csv"],O=[".txt",".pdf",".jpg",".jpeg",".png",".docx",".pptx",".xlsx",".md",".csv"],D=[".mp3",".wav",".aiff",".ogg",".flac",".mp4",".mpeg",".mov",".avi",".flv",".mpg",".webm",".wmv",".3gp"],L=!1,U=null,F=()=>{let e=(0,r.useRef)(null),t=(0,r.useRef)(null),l="";l="localhost"===window.location.hostname?"".concat(window.location.protocol,"//").concat(window.location.hostname,":").concat(window.location.port,"/account/connectors"):"".concat(window.location.protocol,"//").concat(window.location.hostname,"/account/connectors");let s=(0,r.useCallback)(e=>!!e&&36===e.length&&5===e.split("-").length,[]),i=(0,r.useCallback)((e,t,a,l,r)=>{if(!t&&"sharepoint"===e&&a){let e=a.match(/^https?:\/\/([^.]+)\.sharepoint\.com/i);if(e)return e[1]}if(!t&&"onedrive"===e&&s(r)&&l){let e=l.match(/@([^.]+)\./);if(e)return e[1]+"-my"}return t?"sharepoint"===e?t:t+"-my":null},[s]),n=(0,r.useCallback)(async(e,t)=>{t.success=!1;let r=i(e.connector,e.tenantName,e.webUrl,e.loginHint,e.accountIdentifier);if(t.tenant=r,!U){let t=(await a.e(2888).then(a.bind(a,22888))).PublicClientApplication;U=await t.createPublicClientApplication({auth:{authority:r?"https://login.microsoftonline.com/common":"https://login.microsoftonline.com/consumers",clientId:e.clientId,redirectUri:l},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}})}let s=r?["https://".concat(r,".sharepoint.com/.default")]:["OneDrive.ReadWrite"];t.scopes=s;let n={scopes:s,login_hint:e.loginHint,prompt:"select_account"},o=null,d=U.getActiveAccount();if(!d){var c;d=null!==(c=U.getAllAccounts().find(t=>t.username===e.loginHint))&&void 0!==c?c:null}if(t.hasActiveAccount=!!(null==d?void 0:d.username),d)try{U.setActiveAccount(d),o=(await U.acquireTokenSilent(n)).accessToken}catch(e){t.silentAcquisitionError=e instanceof Error?e.toString():e}if(o||L)o||(t.interactiveAuthenticationSkipped=!0);else try{L=!0;let e=await U.loginPopup(n);U.setActiveAccount(e.account),o=(await U.acquireTokenSilent(n)).accessToken}catch(e){t.interactiveAcquisitionError=e instanceof Error?e.toString():e}finally{L=!1}if(o)return t.success=!0,t.accessTokenLength=o.length,o;throw Error("Access token not acquired")},[l,i]),o=(0,r.useCallback)(e=>{let t=i(e.connector,e.tenantName,e.webUrl,e.loginHint,e.accountIdentifier),a="source"===e.mode?P:O;a=e.isAudioVideoFilesEnabled?a.concat(D):a;let r="sharepoint"===e.connector?{recent:!0,oneDrive:!1,sharedLibraries:!0}:{recent:!0,oneDrive:!0,sharedLibraries:!1},s=new URLSearchParams({filePicker:JSON.stringify({sdk:"8.0",messaging:{origin:l,channelId:27},authentication:{},entry:"sharepoint"===e.connector?{sharePoint:{}}:{oneDrive:{}},typesAndSources:{mode:"attachment"===e.mode?"files":"all",filters:a,pivots:r},selection:{mode:"multiple"}})});return e.webUrl?"".concat(e.webUrl,"/_layouts/15/FilePicker.aspx?").concat(s):t?"https://".concat(t,".sharepoint.com/_layouts/15/FilePicker.aspx?").concat(s):"https://onedrive.live.com/picker?".concat(s)},[l,i]),d=(0,r.useCallback)(async a=>{let l;let r=l=>{var r,s,n,o,c;window.removeEventListener("message",d),null===(r=t.current)||void 0===r||r.removeEventListener("message",i),null===(s=t.current)||void 0===s||s.close(),null===(n=e.current)||void 0===n||n.close(),l?null===(o=a.onError)||void 0===o||o.call(a,l):null===(c=a.onCancel)||void 0===c||c.call(a)},s=async(e,t)=>await new Promise((a,l)=>{let r=setTimeout(()=>{l(Error("Request timed out"))},2e4);n(e,t).then(e=>{clearTimeout(r),a(e)}).catch(e=>{clearTimeout(r),l(e)})}),i=async e=>{let l={};if("command"===e.data.type){var i,n,o,d,c,u;null===(i=t.current)||void 0===i||i.postMessage({type:"acknowledge",id:e.data.id});let m=e.data.data;switch(m.command){case"authenticate":try{let r=await s(a,l);null===(n=t.current)||void 0===n||n.postMessage({type:"result",id:e.data.id,data:{result:"token",token:r}})}catch(e){l.errorStep="authenticateCommand",l.error=e instanceof Error?e.toString():e,r(e)}finally{null===(o=a.log)||void 0===o||o.call(a,null!==(d=a.connectionType)&&void 0!==d?d:a.connector.toUpperCase(),l)}break;case"pick":null===(c=t.current)||void 0===c||c.postMessage({type:"result",id:e.data.id,data:{result:"success"}}),null===(u=a.onPicked)||void 0===u||u.call(a,m.items),r();break;default:r()}}},d=async a=>{if(a.source&&a.source===e.current){let e=a.data;"initialize"===e.type&&27===e.channelId&&(t.current=a.ports[0],t.current.addEventListener("message",i),t.current.start(),t.current.postMessage({type:"activate"}))}},c={};try{l=await n(a,c)}catch(e){c.errorStep="initialization",c.error=e instanceof Error?e.toString():e,r(e);return}finally{var u,m;null===(u=a.log)||void 0===u||u.call(a,null!==(m=a.connectionType)&&void 0!==m?m:a.connector.toUpperCase(),c)}let p=document.getElementById("microsoft-file-picker");if(!p||(e.current=p.contentWindow,!(null==e?void 0:e.current))){r();return}let h=e.current.document.createElement("form");h.setAttribute("action",o(a)),h.setAttribute("method","POST"),e.current.document.body.append(h);let v=e.current.document.createElement("input");v.setAttribute("type","hidden"),v.setAttribute("name","access_token"),v.setAttribute("value",l),h.appendChild(v),e.current.document.body.appendChild(h),h.submit(),window.addEventListener("message",d)},[n,o]),c=(0,r.useCallback)((e,t)=>{var a;let l;l=(null===(a=e.parentReference.sharepointIds)||void 0===a?void 0:a.siteId)&&"sharepoint"===t?JSON.stringify({item_id:e.id,drive_id:e.parentReference.driveId,site_id:e.parentReference.sharepointIds.siteId}):e.id;let r=(0,R.jC)(e.name);return r?{id:l,name:e.name,sizeBytes:e.size,mimeType:R.Nf[r]}:null},[]);return(0,r.useMemo)(()=>({openPicker:d,toPickerDocument:c}),[d,c])};var z=a(30002);let B="box-file-picker",H=null,q=!1,G=()=>H||(H=new Promise((e,t)=>{let a=document.createElement("link");a.rel="stylesheet",a.href="https://cdn01.boxcdn.net/platform/elements/17.1.0/en-US/picker.css";let l=document.createElement("script");l.src="https://cdn01.boxcdn.net/platform/elements/17.1.0/en-US/picker.js",l.onload=()=>{if(!q){let e=document.createElement("style");e.textContent='\n                .be .be-header input[type="search"] {\n                    background: white;\n                }\n\n                .btn-content {\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n                }\n            ',document.head.appendChild(e),q=!0}e()},l.onerror=t,a.onload=()=>document.body.appendChild(l),document.head.appendChild(a)})),Q=e=>{let{apiKey:t,mode:a,isAudioVideoFilesEnabled:l,onPicked:s,onCancel:i,onError:n}=e,o=(0,r.useRef)(null),d=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"file";try{let r;if(await G(),!document.getElementById(B)){null==n||n("Attempted to open picker when container isn't ready");return}let d="source"===a?P:O,c=[...d=l?d.concat(D):d,".gdocs",".gsheets",".gslides"];o.current&&(o.current.removeListener("choose",s),o.current.removeListener("cancel",i),o.current.hide(),o.current=null),r="folder"===e?new window.Box.FolderPicker:new window.Box.FilePicker,o.current=r,r.addListener("choose",s),r.addListener("cancel",i),r.show("0",t,{container:"#".concat(B),logoUrl:z.Mgl,extensions:c.join(","),canUpload:!1,canSetShareAccess:!1,canCreateNewFolder:!1,chooseButtonLabel:"Select",cancelButtonLabel:"Cancel"})}catch(e){null==n||n(e);return}},[t,n,a,i,s,l]),c=(0,r.useCallback)(()=>{o.current&&(o.current.removeListener("choose",s),o.current.removeListener("cancel",i),o.current.hide(),o.current=null)},[s,i]);return(0,r.useMemo)(()=>({openPicker:d,cleanupPicker:c}),[d,c])};var V=a(17147);let K=r.memo(e=>{let{isOpen:t,onClose:a,cleanupPicker:s}=e;return(0,r.useEffect)(()=>()=>{s()},[s]),(0,l.jsx)(V.A,{variant:"wide",isOpen:t,onClose:a,renderCloseButton:!0,children:(0,l.jsx)("div",{id:B,style:{height:"800px"}})})});K.displayName="BoxFilePickerModal";var W=a(26976),Y=a(11129),X=a(60010);function Z(e){let{reason:t,onConnectorFileUploadSuccess:a}=e,l=(0,n.useQueryClient)(),{openToast:s}=(0,X.G)(),i=(0,m.A)(),d=(0,r.useRef)(null),c=(0,r.useRef)(null);return(0,r.useEffect)(()=>()=>{d.current&&clearTimeout(d.current),c.current&&clearTimeout(c.current)},[]),(0,o.useMutation)({mutationFn:async e=>{let{connectorName:a,fileIds:l,fileRepoInfo:r,folder_ids:s}=e;return await (0,W.Cb)({connectorName:a,fileIds:l,fileRepoInfo:r,folder_ids:s,reason:t})},onSuccess:()=>{let e=()=>{l.invalidateQueries({predicate:e=>e.queryKey[0]===Y.Zz||e.queryKey[0]===Y.Cj||e.queryKey[0]===Y.ZW||e.queryKey[0]===Y.Nw})};d.current=setTimeout(e,1e3),c.current=setTimeout(e,5e3),s({message:i.formatMessage({defaultMessage:"You'll receive an email when the sync is complete",id:"in8zoTTNmN"}),variant:"success",timeout:5}),null==a||a()}})}var J=a(21978),$=a(3041);let ee=e=>{let{initialApiKey:t,expiresAtString:a,mode:l,isSpace:s=!1,fileRepoInfo:i,isAudioVideoFilesEnabled:d,reason:c}=e,u=(0,J.rd)(),p=(0,m.A)(),{deprecatedOpenToast:h}=(0,X.G)(),{mutateAsync:v}=Z({reason:c}),{mutateAsync:g}=function(e){let{reason:t}=e,a=(0,n.useQueryClient)();return(0,o.useMutation)({mutationFn:()=>(0,W.J7)({reason:t}),onSuccess:()=>{a.invalidateQueries({queryKey:["get_user_settings"]})}})}({reason:c}),[f,y]=(0,r.useState)(!1),[x,b]=(0,r.useState)(""),[w,_]=(0,r.useState)("file"),M=(0,r.useCallback)(()=>y(!1),[]),C=(0,r.useCallback)(e=>{$.vF.error("".concat(z.PHf," file picker failed to open: ").concat(e)),h(p.formatMessage({defaultMessage:"{formattedName} is not responding. Please try again later.",id:"oF/tZmXBik"},{formattedName:z.PHf}),"error",5)},[p,h]),{openPicker:j,cleanupPicker:A}=Q({apiKey:x||t,mode:l,onPicked:(0,r.useCallback)(e=>{let t=e.map(e=>e.id);v({connectorName:"box",fileIds:"file"==w?t:[],fileRepoInfo:s?i:void 0,folder_ids:"folder"==w?t:[]}),s||u.push("/account/files?connector=box&uploadCount=".concat(t.length)),M()},[u,v,s,i,M,w]),onCancel:M,onError:C,isAudioVideoFilesEnabled:d}),E=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"file";if(a){let e=new Date(a);if(isNaN(e.getTime())){$.vF.error("Unparsable expiration timestamp from Box connector"),y(!0);return}e<new Date&&b((await g()).api_key)}y(!0),_(e)},[a,g]);return(0,r.useEffect)(()=>{f&&setTimeout(()=>{j(w)},100)},[f,j,w]),(0,r.useMemo)(()=>({isOpen:f,onOpen:E,onClose:M,cleanupPicker:A}),[A,f,M,E])};var et=a(57936);let ea=e=>{let{clientId:t}=e,[a,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!t)return;let e=document.createElement("script");return e.src="https://www.dropbox.com/static/api/2/dropins.js",e.id="dropboxjs",e.setAttribute("data-app-key",t),e.onload=()=>l(!0),e.onerror=()=>l(!1),document.body.appendChild(e),()=>{let e=document.getElementById("dropboxjs");e&&document.body.removeChild(e)}},[t]);let s=(0,r.useCallback)(e=>{if(!a)return;let t="source"===e.mode?P:O;t=e.isAudioVideoFilesEnabled?t.concat(D):t,window.Dropbox.choose({success:e.onPicked,error:t=>{var a;return null===(a=e.onError)||void 0===a?void 0:a.call(e,t)},multiselect:!0,extensions:t,folderselect:"source"===e.mode})},[a]);return(0,r.useMemo)(()=>({isReady:a,openPicker:s}),[a,s])},el=e=>{let{clientId:t,isSpace:a=!1,fileRepoInfo:l,isAudioVideoFilesEnabled:s,reason:i}=e,n=(0,J.rd)(),o=(0,m.A)(),{deprecatedOpenToast:d}=(0,X.G)(),{mutateAsync:c}=Z({reason:i}),{openPicker:u}=ea({clientId:t}),p=(0,et.F)(),h=(0,r.useCallback)(e=>{let t=e.map(e=>e.id);c({connectorName:"dropbox",fileIds:t,fileRepoInfo:a?l:void 0}),a||n.push("".concat(p,"/files?connector=dropbox&uploadCount=").concat(t.length))},[n,c,a,l,p]),v=(0,r.useCallback)(e=>{$.vF.error("A Dropbox file picker error occured:",e),d(o.formatMessage({defaultMessage:"{formattedName} is not responding. Please try again later.",id:"oF/tZmXBik"},{formattedName:z.mSO}),"error",5)},[o,d]),g=(0,r.useCallback)(e=>{u({mode:e,onPicked:h,onError:v,isAudioVideoFilesEnabled:s})},[u,h,v,s]);return(0,r.useMemo)(()=>({openPicker:g}),[g])};var er=a(51244);let es=e=>{let{reason:t,mode:a}=e,l=(0,m.A)(),[s,i]=(0,r.useState)(!1),[n,d]=(0,r.useState)(null),{deprecatedOpenToast:c}=(0,X.G)(),{openModal:u,closeModal:p}=(0,er.u)(),{openPicker:h,toPickerDocument:v}=F(),{mutateAsync:g}=function(e){let{reason:t}=e;return(0,o.useMutation)({mutationFn:async e=>{let{connectionType:a,content:l}=e;await (0,W.Qy)({connectionType:a,content:l,reason:t})}})}({reason:t}),f=(0,r.useCallback)(e=>{"sharepoint"===e.connector&&"attachment"===a?u("sharepointSiteModal",{onSelectSite:t=>{p(),e&&(i(!0),d({...e,webUrl:t}),h({...e,webUrl:t}))}}):(i(!0),d(e),"onedrive"===e.connector&&h(e))},[p,a,u,h]),y=(0,r.useCallback)(()=>{i(!1),d(null)},[i,d]),x=(0,r.useCallback)(e=>{$.vF.error("A Microsoft file picker error occured:",e),y(),c(l.formatMessage({defaultMessage:"{formattedName} is not responding. Please try again later.",id:"oF/tZmXBik"},{formattedName:z.Uqb}),"error",5)},[y,c,l]),b=(0,r.useCallback)((e,t)=>{g({connectionType:e,content:t})},[g]),w=(0,r.useCallback)(e=>{n&&(d({...n,webUrl:e}),h({...n,webUrl:e}))},[n,h]);return(0,r.useMemo)(()=>({onOpen:f,onClose:y,onError:x,onSelectSite:w,toPickerDocument:v,log:b,isOpen:s,options:n}),[s,b,y,x,f,w,n,v])};var ei=a(13820),en=a(14475);let eo=e=>{let{reason:t}=e,{connectors:a}=(0,en.u)({reason:t}),{connectorsMap:l}=(0,ei.k)({reason:t}),s=(0,r.useMemo)(()=>{var e;return(null!==(e=null==a?void 0:a.connectors)&&void 0!==e?e:[]).filter(e=>{var t;return("google_drive"===e.name||"onedrive"===e.name||"sharepoint"===e.name||"dropbox"===e.name||"box"===e.name)&&!(null===(t=l[e.name])||void 0===t?void 0:t.connected)})},[l,a]),i=(0,r.useMemo)(()=>{var e;return(null!==(e=null==a?void 0:a.connectors)&&void 0!==e?e:[]).filter(e=>{var t;return!(null===(t=l[e.name])||void 0===t?void 0:t.connected)})},[l,a]);return(0,r.useMemo)(()=>({disabledFileConnectors:s,disabledConnectors:i}),[i,s])};var ed=a(10173),ec=a(76197),eu=a(83312),em=a(7695),ep=a(41383),eh=a(89479);let ev=r.memo(e=>{let{children:t,uploadSources:a,placement:s,isMobileStyle:i,isOpen:n=!1,onOpen:o,onClose:d}=e,{$t:c}=(0,m.A)(),u=(0,r.useCallback)(()=>{null==o||o()},[o]),p=(0,r.useCallback)(()=>{null==d||d()},[d]),h=(0,r.useMemo)(()=>(0,l.jsx)(v.Ay,{className:"w-[200px]",children:(0,l.jsx)(ep.W,{items:a})}),[a]);return i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(V.A,{subtitle:c({defaultMessage:"Attach",id:"Ye0Clmvfec"}),subtitleClassname:"ml-sm mt-sm font-medium",variant:"bottom-left-sheet",isOpen:n,onClose:p,children:(0,l.jsx)(v.Ay,{className:"p-xs w-full",children:(0,l.jsx)(ep.W,{textColor:"light",items:a})})}),(0,l.jsx)("span",{onClick:u,children:t})]}):(0,l.jsx)(eh.A,{isOpen:n,placement:s,onOpen:u,onClose:p,content:h,children:t})});ev.displayName="AttachDropdown";var eg=a(92132);let ef=r.memo(e=>{let{isOpen:t,options:a,onClose:s,onSelectSite:i}=e,{$t:n}=(0,m.A)(),o=(0,r.useMemo)(()=>(null==a?void 0:a.connector)==="sharepoint"&&!a.webUrl,[null==a?void 0:a.connector,null==a?void 0:a.webUrl]),d=(0,r.useMemo)(()=>{if(o)return(0,l.jsx)(g.A,{variant:"entry-title-200",className:"ml-md line-clamp-3 text-pretty",children:n({defaultMessage:"Select a site",id:"NLmDBthOaZ"})})},[n,o]);return(0,l.jsxs)(V.A,{variant:o?"medium":"wide",isOpen:t,onClose:s,renderCloseButton:!o,titleContent:d,children:[o&&(0,l.jsx)(eg.y,{onNext:i,onCancel:s}),!o&&(0,l.jsx)("iframe",{id:"microsoft-file-picker",height:"800px"})]})});ef.displayName="MicrosoftFilePickerModal";var ey=a(667),ex=a(33496),eb=a(52758),ew=a(80892),e_=a(7038),eM=a(91679),eC=a(28554),ej=a(46186),eA=a(68294),eE=a(18360);let eS=["application/vnd.google-apps.file","application/vnd.google-apps.folder","application/vnd.google-apps.document","application/vnd.google-apps.presentation","application/vnd.google-apps.spreadsheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","application/pdf","text/csv","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/markdown"],ek=["text/plain","application/pdf","text/csv","text/markdown","image/png","image/jpeg","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.google-apps.document","application/vnd.google-apps.presentation","application/vnd.google-apps.spreadsheet"],eN=["audio/mpeg","audio/wav","audio/aiff","audio/ogg","audio/flac","audio/mp3","video/mp4","video/mpeg","video/mov","video/avi","video/x-flv","video/mpg","video/webm","video/wmv","video/3gpp","video/quicktime"],eT=e=>{let{clientId:t,loginHint:a,isAudioVideoFilesEnabled:l,onError:s}=e,[i,n]=(0,r.useState)(!1);(0,ej.A)(i);let o=(0,r.useCallback)((e,t)=>{var a;let r=null===(a=window.google)||void 0===a?void 0:a.picker;if(r)try{let a=new r.DocsView().setIncludeFolders(!0).setSelectFolderEnabled(!0).setMode(r.DocsViewMode.LIST),s=new r.ViewGroup(a),i="source"===t.mode?eS:ek;i=l?i.concat(eN):i,new r.PickerBuilder().setSize(1051,650).addViewGroup(s).setSelectableMimeTypes(i.join(",")).enableFeature(r.Feature.MULTISELECT_ENABLED).setOAuthToken(e).setCallback(e=>{if(e.action===r.Action.PICKED){if(t.onPicked){var a;t.onPicked(null!==(a=e.docs)&&void 0!==a?a:eE.Ml)}}else(e.action===r.Action.CANCEL||e.action===r.Action.ERROR)&&(e.action===r.Action.CANCEL&&t.onCancel&&t.onCancel(),n(!1))}).build().setVisible(!0),n(!0)}catch(e){null==s||s()}},[l,s]),d=(0,r.useCallback)(async e=>{try{await Promise.all([(0,eA.y)(),(0,eA.A)()])}catch(e){null==s||s();return}window.google.accounts.oauth2.initTokenClient({client_id:t,login_hint:a,scope:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/drive.metadata.readonly",prompt:"none",callback:t=>{if(void 0!==t.error)throw Error(t.error);try{o(t.access_token,e)}catch(e){console.log(e)}}}).requestAccessToken()},[o,t,a,s]);return(0,r.useMemo)(()=>({openPicker:d}),[d])};var eI=a(39808);let eR=(0,a(27773).w)({path:"M14 3v4a1 1 0 0 0 1 1h4 M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z M12 11v6 M9.5 13.5l2.5 -2.5l2.5 2.5",name:"IconFileUpload",variant:"stroked"});var eP=a(87569);function eO(e,t){return!!(e.connection_type&&t.includes(e.connection_type))}let eD=r.memo(e=>{var t,a,s,i,n,o,d,c,u,p,v,x,b,_,M,C,j;let{repoFileLimitReached:S,addFilesTooltipMessage:k,isAudioVideoFilesEnabled:N,handleSourcesEdit:T,variant:I="primary",collectionSlugOverride:R,connectionTypes:P=eZ}=e,O="file-upload-selector",D=(0,m.A)(),{variation:L}=(0,e_.x)(!1),{$t:U}=(0,m.A)(),{startMonitoring:F}=(0,eb.o)(),{isMobileStyle:z}=(0,y.al)(),[B,H]=(0,r.useState)(!1),{fileRepoInfo:q}=(0,eu.y)({reason:O,collectionSlugOverride:R}),G="COLLECTION"===q.file_repository_type,{mutateAsync:Q}=Z({reason:O,onConnectorFileUploadSuccess:()=>{let e=L?"files":"connectors";null==T||T(e)}}),V=(0,r.useCallback)(function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];F({fileRepoInfo:q,collectionSlug:R,isFileManagerUiRedesignEnabled:L}),Q(...t)},[F,q,Q,R,L]),W=(0,r.useRef)(null),{handleFileSelect:Y}=(0,em.J)({reason:O,onLocalFileUploadSuccess:()=>{let e=L?"files":"localFiles";null==T||T(e)}}),{referrer:X,referrerId:J}=(0,ec.s)({}),{connectorsMap:$}=(0,ei.k)({reason:O}),{enabledFileConnectors:et}=(0,ey.X)({reason:O}),{disabledFileConnectors:ea}=eo({reason:O}),{trackEvent:er}=(0,ew.yw)(),[en,ep]=(0,r.useState)(!1),[eh,eg]=(0,r.useState)(!1),ej=(0,ex.w)({feature:ex.o.SPACES}),eA=(0,r.useCallback)(e=>e.preventDefault(),[]),{onOpen:eE,onClose:eS,onError:ek,options:eN,onSelectSite:eD,isOpen:eL,log:eU}=es({reason:O,mode:"persistent"}),{openPicker:eF}=eT({clientId:null!==(b=null==$?void 0:null===(a=$.google_drive)||void 0===a?void 0:null===(t=a.picker_credentials)||void 0===t?void 0:t.client_id)&&void 0!==b?b:"",loginHint:null!==(_=null==$?void 0:null===(s=$.google_drive)||void 0===s?void 0:s.connection_display_name)&&void 0!==_?_:"",isAudioVideoFilesEnabled:N}),ez=(0,r.useCallback)((e,t)=>{"onedrive"===t?V({connectorName:"onedrive",fileIds:e.map(e=>e.id),fileRepoInfo:G?q:void 0}):"sharepoint"===t&&V({connectorName:"sharepoint",fileIds:e.map(e=>{var t,a,l,r;return{item_id:null!==(a=e.id)&&void 0!==a?a:"",drive_id:null!==(l=e.parentReference.driveId)&&void 0!==l?l:"",site_id:null!==(r=null===(t=e.parentReference.sharepointIds)||void 0===t?void 0:t.siteId)&&void 0!==r?r:""}}),fileRepoInfo:G?q:void 0}),eS()},[V,eS,G,q]),{openPicker:eB}=el({clientId:null!==(M=null==$?void 0:null===(n=$.dropbox)||void 0===n?void 0:null===(i=n.picker_credentials)||void 0===i?void 0:i.client_id)&&void 0!==M?M:"",isSpace:G,fileRepoInfo:q,isAudioVideoFilesEnabled:N,reason:O}),{onOpen:eH,isOpen:eq,onClose:eG,cleanupPicker:eQ}=ee({initialApiKey:null!==(C=null==$?void 0:null===(d=$.box)||void 0===d?void 0:null===(o=d.picker_credentials)||void 0===o?void 0:o.api_key)&&void 0!==C?C:"",expiresAtString:null!==(j=null==$?void 0:null===(u=$.box)||void 0===u?void 0:null===(c=u.picker_credentials)||void 0===c?void 0:c.expires_at)&&void 0!==j?j:"",mode:"source",isSpace:G,fileRepoInfo:q,isAudioVideoFilesEnabled:N,reason:O}),eV=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file";if(er("attempt connector file upload",{connectorName:e}),"google_drive"===e)eF({mode:"source",onPicked:async e=>{let t=e.map(e=>e.id);await V({connectorName:"google_drive",fileIds:t,fileRepoInfo:G?q:void 0})}});else if("onedrive"===e||"sharepoint"===e){var a,l,r,s,i,n;let t=null==$?void 0:$[e];eE({mode:"source",connector:e,clientId:null!==(s=null==t?void 0:null===(a=t.picker_credentials)||void 0===a?void 0:a.client_id)&&void 0!==s?s:"",tenantName:null!==(i=null==t?void 0:null===(l=t.picker_credentials)||void 0===l?void 0:l.tenant_name)&&void 0!==i?i:"",loginHint:null!==(n=null==t?void 0:t.connection_display_name)&&void 0!==n?n:"",accountIdentifier:null==t?void 0:null===(r=t.picker_credentials)||void 0===r?void 0:r.account_identifier,onPicked:t=>ez(t,e),onError:ek,onCancel:eS,log:eU,isAudioVideoFilesEnabled:N})}else"dropbox"===e?eB("source"):"box"===e&&eH(t)},[er,eF,eE,$,q,G,eS,ek,ez,V,eB,eH,eU,N]),{handleConnect:eK}=(0,ed.G)({reason:O}),eW=(0,r.useCallback)(e=>{"notion"===e&&(er("attempt connector authentication",{connectorName:e}),eK({connectorName:e}))},[er,eK]),eY=(()=>{let e=[],t={type:"default",text:U({defaultMessage:"Local files",id:"xMmQ4F7z3A"}),icon:eR,onMouseDown:eA,onClick:()=>{var e;null===(e=W.current)||void 0===e||e.click()}};if(P.includes(w.X.LOCAL)&&e.push(t),ej){let t=et.filter(e=>eO(e,P)).map(e=>{var t,a,r,s,i,n;let o=e.name;return"box"===o?{type:"nested",text:null!==(t=(0,h.wg)(o))&&void 0!==t?t:"",avatar:(0,l.jsx)("img",{src:null!==(a=(0,h.xx)(o))&&void 0!==a?a:"",alt:(0,h.wg)(o),width:20,height:20}),isSubmenuOpen:en,onSubmenuOpen:()=>ep(!0),onSubmenuClose:()=>ep(!1),onMouseDown:eA,submenu:[{type:"default",text:D.formatMessage({defaultMessage:"Upload files",id:"2jjdVzJX0c"}),onMouseDown:eA,onClick:()=>eV("box","file")},{type:"default",text:D.formatMessage({defaultMessage:"Upload folders",id:"qMKglS/Epo"}),onMouseDown:eA,onClick:()=>eV("box","folder")}]}:"notion"!==o||G?{type:"default",text:null!==(i=(0,h.wg)(o))&&void 0!==i?i:"",avatar:(0,l.jsx)("img",{src:null!==(n=(0,h.xx)(o))&&void 0!==n?n:"",alt:(0,h.wg)(o),width:20,height:20}),onMouseDown:eA,onClick:()=>eV(o)}:{type:"default",text:null!==(r=(0,h.wg)(o))&&void 0!==r?r:"",avatar:(0,l.jsx)("img",{src:null!==(s=(0,h.xx)(o))&&void 0!==s?s:"",alt:(0,h.wg)(o),width:20,height:20}),onMouseDown:eA,onClick:()=>eW(o)}}).filter(e=>null!==e);if(e.push(...t),ea.length>0&&!z){let t=ea.filter(e=>eO(e,P)),a={type:"nested",submenu:t.map(e=>{var t;return{type:"default",size:"small",text:(0,h.wg)(e.name),avatar:(0,l.jsx)("img",{src:null!==(t=(0,h.xx)(e.name))&&void 0!==t?t:"",alt:(0,h.wg)(e.name),width:20,height:20}),rightElement:(0,l.jsx)("div",{className:"flex items-center justify-center",children:(0,l.jsx)(E.e,{icon:eI.q,size:"sm"})}),onClick:()=>eK({connectorName:e.name,customReferrer:null!=X?X:void 0,customReferrerId:null!=J?J:void 0})}}),isSubmenuOpen:eh,onSubmenuOpen:()=>eg(!0),onSubmenuClose:()=>eg(!1),text:U({defaultMessage:"Add connectors",id:"2dXigF1Pil"}),icon:eP.V,onMouseDown:eA};t.length>0&&e.push(a)}}return e})(),eX=(0,r.useCallback)(()=>H(!1),[]),eJ=(0,r.useCallback)(()=>{let e=eY.at(0);if(1===eY.length&&function(e){return void 0!==e&&"onClick"in e}(e)){e.onClick();return}H(!0)},[eY]),e$=(0,r.useMemo)(()=>(0,l.jsx)(g.A,{color:"light",children:(0,l.jsx)(E.e,{icon:A.n,size:"sm"})}),[]),e0=(0,r.useMemo)(()=>(0,l.jsx)(g.A,{variant:"tiny",color:"light",children:D.formatMessage({defaultMessage:"Add files",id:"xrAjmQ72mN"})}),[D]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ev,{uploadSources:eY,placement:"bottom-start",isMobileStyle:z,isOpen:B,onOpen:eJ,onClose:eX,children:"primary"===I?(0,l.jsx)(eC.A,{variant:"primary",size:"small",extraCSS:"py-[18px]",text:"+ ".concat(D.formatMessage({defaultMessage:"Add files",id:"xrAjmQ72mN"})),disabled:S,toolTip:k}):(0,l.jsx)(f.A,{size:"small",leadingComponent:e$,text:e0,toolTip:k,testId:"add-files-button"})}),((null==$?void 0:null===(p=$.onedrive)||void 0===p?void 0:p.connected)||(null==$?void 0:null===(v=$.sharepoint)||void 0===v?void 0:v.connected))&&(0,l.jsx)(ef,{options:eN,isOpen:eL,onClose:eS,onSelectSite:eD}),(null==$?void 0:null===(x=$.box)||void 0===x?void 0:x.connected)&&(0,l.jsx)(K,{isOpen:eq,onClose:eG,cleanupPicker:eQ}),(0,l.jsx)("input",{type:"file",ref:W,className:"hidden",onChange:e=>{e.target.files&&Y(e.target.files)},onClick:e=>{e.target instanceof HTMLInputElement&&(e.target.value="")},multiple:!0,accept:eM.j})]})});eD.displayName="FileUploadSelector";var eL=a(36733);let eU=r.memo(e=>{let{statusToFilter:t,handleSelectStatus:a}=e,{isMobileStyle:r}=(0,y.al)(),s=(0,m.A)(),i={ALL:s.formatMessage({defaultMessage:"All",id:"zQvVDJ+j59"}),QUEUED:s.formatMessage({defaultMessage:"Queued",id:"Cnm0QAkWnp"}),SYNCING:s.formatMessage({defaultMessage:"Syncing",id:"eOnwqs6QFY"}),SYNC_ERROR:s.formatMessage({defaultMessage:"Sync error",id:"N1cqoEe4CZ"}),READY:s.formatMessage({defaultMessage:"Ready",id:"IZFEUgrg25"})},n=Object.entries(i).map(e=>{let[l,r]=e;return{text:r,type:"default",selected:t===l,onClick:()=>a("ALL"===l?null:l)}});return(0,l.jsx)(x.n,{isMobileStyle:r,placement:"bottom",items:n,children:(0,l.jsx)(eC.A,{variant:"border",size:"small",extraCSS:"py-[18px]",text:t?i[t]:"Status",chevron:!0,chevronIcon:eL.r})})});eU.displayName="StatusDropdown";var eF=a(20041);let ez=r.memo(e=>{let{allowEditSources:t,searchTerm:a,statusToFilter:r,selectedFiles:s,handleDeleteFiles:i,handleOnSearchValueChange:n,handleSelectStatus:o,isAudioVideoFilesEnabled:d,collectionSlugOverride:c,connectionTypes:u}=e,{$t:p}=(0,m.A)(),{isMobileUserAgent:h}=(0,y.al)();return(0,l.jsxs)("div",{className:"mx-sm pt-md gap-sm flex flex-wrap items-center justify-between",children:[(0,l.jsx)(eF.Ay,{type:"search",isMobileUserAgent:h,placeholder:p({defaultMessage:"Search files",id:"8xPuGUna7W"}),value:a,className:"bg-subtle rounded-md border-none",onChange:n,pill:!1}),(0,l.jsxs)("div",{className:"gap-x-sm flex",children:[0!==s.length&&(0,l.jsx)(f.A,{variant:"primary",onClick:i,icon:j.E,extraCSS:"h-[36px]"}),(0,l.jsx)(eU,{statusToFilter:r,handleSelectStatus:o}),t&&(0,l.jsx)(eD,{repoFileLimitReached:!1,isAudioVideoFilesEnabled:d,collectionSlugOverride:c,connectionTypes:u})]})]})});ez.displayName="ConnectorsTableHeader";var eB=a(64473),eH=a(5551),eq=a(39053),eG=a(6108),eQ=a(33477);let eV=r.memo(e=>{let{hasPreviousPage:t,hasNextPage:a,handlePrevPage:r,handleNextPage:s,shouldShowPlaceholder:i,fileRepoInfo:n}=e,{$t:o}=(0,m.A)(),d="border-subtler pt-md mx-sm flex translate-y-[1px] items-center justify-between";return i?(0,l.jsx)("div",{className:"".concat(d," h-[42px]")}):(0,l.jsx)("div",{className:"".concat(d," border-t"),children:(0,l.jsxs)("div",{className:"flex w-full justify-between",children:[(0,l.jsx)(eK,{fileRepoInfo:n}),(0,l.jsxs)("div",{className:"gap-x-md flex",children:[(0,l.jsx)(f.A,{text:o({defaultMessage:"Prev",id:"LYaNlLTdL2"}),size:"small",noPadding:!0,disabled:!t,onClick:r,icon:eG.g}),(0,l.jsx)(f.A,{text:o({defaultMessage:"Next",id:"9+DdtuCqLw"}),size:"small",noPadding:!0,disabled:!a,onClick:s,icon:eQ.V})]})]})})});eV.displayName="SourcesTableCursorPagination";let eK=e=>{let{fileRepoInfo:t}=e,{$t:a}=(0,m.A)(),s=(0,n.useQueryClient)(),{variation:i}=(0,e_.x)(!1),{pending:o,total:d}=(0,eB.j)({enablePolling:!0,fileRepoInfo:t,reason:"upload-progress"}),c=d-o,u=(0,r.useRef)(0),p=a({defaultMessage:"Uploading {uploaded, number} of {total, number} files...",id:"XRDZYoRWzL"},{uploaded:c,total:d});return((0,r.useEffect)(()=>{u.current>0&&0===o&&0===d&&(s.invalidateQueries({queryKey:["connector-files"]}),s.invalidateQueries({queryKey:["connector-files-infinite"]})),u.current=d},[o,d,s]),!i||o<=0)?(0,l.jsx)("div",{}):(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsx)(eH.k,{variant:"super",value:c,max:d,className:"h-2 w-48 rounded-full"}),(0,l.jsxs)("div",{className:"gap-sm flex items-center",children:[(0,l.jsx)(g.A,{color:"super",children:(0,l.jsx)(eq.y,{size:14})}),(0,l.jsx)(g.A,{variant:"tiny",color:"default",children:p})]})]})};var eW=a(77268),eY=a(35179),eX=a(46524);let eZ=[w.X.GOOGLE_DRIVE,w.X.ONEDRIVE,w.X.SHAREPOINT,w.X.DROPBOX,w.X.BOX,w.X.NOTION],eJ=e=>[...eZ,...e],e$=r.memo(e=>{var t;let{fileRepoInfo:a,collectionSlugOverride:n,connectionTypes:o=eZ}=e,d="connectors-source-section",m=(0,eX.g)(),p=null!=n?n:Array.isArray(null==m?void 0:m.slug)?m.slug[0]:null==m?void 0:m.slug,{collection:h}=(0,i.U)({collectionSlug:p,reason:d}),v=!!h&&(0,eY.o2)(h.user_permission),g="COLLECTION"===a.file_repository_type,f=(0,r.useMemo)(()=>({file_repository_type:"USER",owner_id:""}),[]),y=g?a:f,[x,b]=(0,r.useState)(""),[w,_]=(0,r.useState)(null),[M,C]=(0,r.useState)([]),[j,A]=(0,r.useState)(!1),[E,S]=(0,r.useState)([]),[N,I]=(0,r.useState)(null),[R,P]=(0,r.useState)([]),O=E.length>0?null===(t=E[E.length-1])||void 0===t?void 0:t.uuid:void 0,{mutate:D}=c({reason:d}),L=x.trim().length>0?{parentUuids:[],rootFilesOnly:!1}:{parentUuids:O?[O]:[],rootFilesOnly:!O},{data:U,isLoading:F}=(0,u.u)({connectionTypes:o,status:w?[w]:[],pageSize:k.g8,searchKeyword:x,...L,cursor:N,pollingEnabled:!0,fileRepoInfo:y,reason:d}),{files:z,nextCursor:B}=(0,r.useMemo)(()=>({files:(null==U?void 0:U.files)||[],nextCursor:null==U?void 0:U.next_cursor}),[U]),H=!!B,q=R.length>0,G=!g||v,Q=(0,r.useCallback)(()=>{b(""),_(null)},[]),V=(0,r.useCallback)(e=>{_(e)},[]),K=(0,r.useCallback)(e=>{b(e)},[b]),W=(0,r.useCallback)(()=>{D({fileUuids:M,fileRepoInfo:y}),C([]),A(!1)},[D,M,y]),Y=(0,r.useCallback)(e=>{A(e),e?C(z.map(e=>e.uuid)):C([])},[z,C]),X=(0,r.useCallback)((e,t)=>{Q(),S(a=>[...a,{uuid:e,name:t}])},[Q]),Z=(0,r.useCallback)(()=>{B&&(P(e=>[...e,null!=N?N:""]),I(B))},[B,N]),J=(0,r.useCallback)(()=>{R.length>0&&P(e=>{var t;let a=[...e];return I(null!==(t=a.pop())&&void 0!==t?t:null),a})},[R.length]);return(0,r.useEffect)(()=>{I(null),P([])},[x,w,O]),(0,l.jsxs)(eW.w,{onDrop:s.A,disabled:!G,children:[(0,l.jsx)(ez,{allowEditSources:G,searchTerm:x,statusToFilter:w,selectedFiles:M,handleDeleteFiles:W,handleOnSearchValueChange:K,handleSelectStatus:V,isAudioVideoFilesEnabled:!1,collectionSlugOverride:n,connectionTypes:o}),(0,l.jsx)(T,{files:z,fileRepoInfo:y,isLoadingConnectorFiles:F,allowEditSources:G,selectedFiles:M,currentPath:E,isHeaderCheckboxChecked:j,setSelectedFiles:C,setCurrentPath:S,handleSelectAll:Y,handleFolderClick:X,handleResetSearch:Q}),(0,l.jsx)(eV,{fileRepoInfo:y,hasPreviousPage:q,hasNextPage:H,handlePrevPage:J,handleNextPage:Z,shouldShowPlaceholder:F||!z.length})]})});e$.displayName="ConnectorsSourceSection"},11237:(e,t,a)=>{"use strict";a.d(t,{m:()=>d});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(77936),o=a(72811);let d=r.memo(function(e){let{className:t,children:a,result:r,trackEvent:s,...d}=e,c=i()("group flex size-full cursor-pointer items-stretch",t);return(0,n.oh)(r)?(0,l.jsx)(o.N,{target:"_blank",rel:"noopener",className:c,href:r.url,...d,children:(0,l.jsx)("div",{className:"w-full",children:a})}):(0,l.jsx)(l.Fragment,{children:a})});d.displayName="CitationCardLink"},11500:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var l=a(25576),r=a(85860),s=a(41290);let i={xlarge:[64,"h-[64px] w-auto leading-[64px]"],large:[48,"h-[48px] w-auto leading-[48px]"],regular:[32,"h-[32px] w-auto leading-[32px]"],small:[18,"h-[18px] w-auto leading-[18px]"],tiny:[12,"h-[12px] w-auto leading-[12px]"]},n=(0,s.Q)(async()=>{let{Emoji:e}=await a.e(9072).then(a.bind(a,79072));return{default:e}},{nextFrame:!0}),o=r.memo(e=>{var t;let{unified:a,size:r}=e,[s,o]=null!==(t=i[r])&&void 0!==t?t:[];return a?(0,l.jsx)("div",{className:"relative align-middle ".concat(o),children:(0,l.jsx)(n,{emojiStyle:"native",unified:a,size:s})}):null});o.displayName="PerplexityEmoji"},12835:(e,t,a)=>{"use strict";a.d(t,{S:()=>r});var l=a(3041);function r(e){l.vF.info("Reloading window",{reason:e,url:window.location.href}),window.location.reload()}},12928:(e,t,a)=>{"use strict";a.d(t,{K:()=>l});let l=(0,a(27773).w)({path:"M14 3v4a1 1 0 0 0 1 1h4 M14 3v4a1 1 0 0 0 1 1h4 M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6 M11 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6 M16.5 15h3 M18 15v6 M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4",name:"IconFileTypePpt",variant:"stroked"})},13484:(e,t,a)=>{"use strict";a.d(t,{nm:()=>h});var l=a(25576),r=a(85860),s=a(83081),i=a(70714),n=a(30760),o=a(64299),d=a.n(o),c=a(14489),u=a(75919),m=a(60410);let p=e=>e.toISOString().split("T")[0],h=e=>{var t,a,o,p,h;let{stripeTaxAmount:y,tier:x="monthly",paymentMethodType:b,discountAmounts:w,subtotal:_,total:M,currency:C,promotionCode:j,applyPromotionCode:A,choices:E,isApplyingPromo:S,promoError:k,clearPromoError:N,subscriptionTier:T,recurring:I,cohorts:R}=e,[P,O]=(0,r.useState)(null!=j?j:""),{$t:D,formatNumber:L}=(0,s.A)();(0,r.useEffect)(()=>{O(null!=j?j:"")},[j]);let U=(0,r.useCallback)(e=>{"Enter"===e.key&&e.currentTarget instanceof HTMLInputElement&&(null==A||A(e.currentTarget.value,b))},[A,b]),F=null!==(o=null==I?void 0:null===(t=I.trial)||void 0===t?void 0:t.trialPeriodDays)&&void 0!==o?o:0,z=null==I?void 0:null===(a=I.trial)||void 0===a?void 0:a.trialEnd,B=F>0,H=C?(0,n.hb)(C):void 0,q=null!==(p=null==w?void 0:w.reduce((e,t)=>e+t.amount,0))&&void 0!==p?p:0,G=(0,r.useMemo)(()=>f(D,L,B,w,C,H,I,R),[w,C,H,B,I,D,L,R]),Q=(0,r.useMemo)(()=>{let e=E.find(e=>"monthly"===e.tier),t=E.find(e=>"yearly"===e.tier);return(null==e?void 0:e.price)&&(null==t?void 0:t.price)?12*e.price-t.price:0},[E]),V="monthly"===x&&null!=H,K=E.find(e=>e.tier===x);return(null==R?void 0:R.some(e=>e.includes("HALF_OFF")))&&K&&H&&G?(0,l.jsx)(g,{stripeTaxAmount:y,recurring:I,minorUnits:H,isMonthly:V,total:M,currency:C,trialEnd:z,choice:K,discountTerms:G,discount:q}):(0,l.jsxs)("ul",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("li",{className:"border-subtler gap-4 border-b pb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Billing cycle",id:"zQ0j7Fn5rx",description:"row label"})}),V?(0,l.jsx)("div",{className:"flex flex-col items-end gap-2",children:(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{tagName:"span",defaultMessage:"Monthly",id:"bocWt/njES",description:"Monthly label"})})}):(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Annually",id:"ZSCbZACJ+n"})})]}),(0,l.jsx)(v,{minorUnits:H,tier:x,choices:E,currency:null!=C?C:"",recurring:I}),V&&"pro"===T&&!B&&(0,l.jsx)(m.A,{color:"super",variant:"small",className:"text-right",children:(0,l.jsx)(i.A,{defaultMessage:"Switch to annual and save {savings} per year",id:"yMvMzC7HUF",values:{savings:L(Q/H,{style:"currency",currency:C})}})})]}),(0,l.jsxs)("li",{className:"flex justify-between gap-4",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Subtotal",id:"u2ix90UrRg",description:"Subtotal label in the pricing table"})}),(0,l.jsx)(m.A,{children:null==H||null==_?(0,l.jsx)(c.W,{className:"h-full",children:(0,l.jsx)("div",{className:"bg-subtler h-[20px] w-20"})}):L(_/H,{style:"currency",currency:C})})]}),(0,l.jsxs)("li",{className:"flex items-center justify-between gap-8",children:[(0,l.jsx)("div",{className:d()("w-full",{"md:w-2/3":q>0}),children:(0,l.jsx)(u.n,{promo:P,setPromo:O,clearPromoError:N,applyPromotionCode:A,isApplyingPromo:S,handleOnKeyDown:U,paymentMethodType:b,promoError:k,discountTerms:G})}),q>0&&(0,l.jsx)("div",{className:"flex h-full items-center",children:(0,l.jsx)(m.A,{color:"super",variant:"small",children:null==H?(0,l.jsx)(c.W,{className:"h-full",children:(0,l.jsx)("div",{className:"bg-subtler h-[20px] w-20"})}):L(-(q||0)/H,{style:"currency",currency:C,signDisplay:"exceptZero"})})})]}),(0,l.jsxs)("li",{className:"flex justify-between gap-4",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:null!==(h=null==y?void 0:y.displayName)&&void 0!==h?h:(0,l.jsx)(i.A,{defaultMessage:"Tax",id:"xH0NmqnfwA",description:"Tax label in the pricing table"})}),(0,l.jsx)(m.A,{color:"light",variant:"small",children:null==H?(0,l.jsx)(c.W,{className:"h-full",children:(0,l.jsx)("div",{className:"bg-subtler h-[20px] w-20"})}):L(((null==y?void 0:y.amount)||0)/H,{style:"currency",currency:C})})]}),(0,l.jsxs)("li",{className:"border-subtler flex items-center justify-between gap-4 border-t pt-4",children:[(0,l.jsx)(m.A,{variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Total due today",id:"Xa8E/3myWL",description:"Total label in the pricing table"})}),(0,l.jsx)(m.A,{variant:"entry-title",children:null==H?(0,l.jsx)(c.W,{className:"h-full",children:(0,l.jsx)("div",{className:"bg-subtler h-[20px] w-20"})}):L((M||0)/H,{style:"currency",currency:C})})]})]})},v=e=>{var t,a,r,n;let{minorUnits:o,tier:c,choices:u,currency:h,textClassName:v,recurring:g}=e,{formatNumber:f}=(0,s.A)(),y=null!==(n=null==g?void 0:null===(t=g.trial)||void 0===t?void 0:t.trialPeriodDays)&&void 0!==n?n:0,x=null==g?void 0:null===(a=g.trial)||void 0===a?void 0:a.trialEnd;return void 0===y||0===y||void 0===x?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Billing start date",id:"I5Ux4EgYEU",description:"row label"})}),(0,l.jsx)(m.A,{color:"light",variant:"small",children:p(new Date(1e3*x))})]}),(0,l.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Plan Rate",id:"rURh2EGj6H",description:"row label"})}),(0,l.jsx)(m.A,{variant:"smallBold",color:"light",className:d()(v,{"flex items-center justify-end gap-2":!v}),children:o&&(0,l.jsx)(i.A,{defaultMessage:"{price} per {billingCycle}",id:"HnAayYToEt",values:{billingCycle:"monthly"===c?"month":"year",price:f(((null===(r=u.find(e=>e.tier===c))||void 0===r?void 0:r.price)||0)/o,{style:"currency",currency:h})}})})]}),y>=28&&(0,l.jsxs)("div",{className:"mt-2 flex justify-between gap-2",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Promotion",id:"C6f1N+J808",description:"row label"})}),(0,l.jsx)(m.A,{color:"super",variant:"smallBold",children:(0,l.jsx)(i.A,{defaultMessage:"{trialPeriodMonths, plural, one {# additional free month} other {# additional free months}}",id:"PE155CWnti",values:{trialPeriodMonths:Math.round(y/30.44)}})})]})]})},g=e=>{var t,a;let{stripeTaxAmount:r,recurring:o,minorUnits:d,isMonthly:u,total:h,currency:v,trialEnd:g,choice:f,discountTerms:y,discount:x}=e,{formatNumber:b}=(0,s.A)(),w=b((g?(null==o?void 0:null===(t=o.dueNext)||void 0===t?void 0:t.amountDiscount)||0:x)/d,{style:"currency",currency:v});return(0,l.jsxs)("ul",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("li",{className:"border-subtler gap-4 space-y-2 border-b pb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Billing cycle",id:"zQ0j7Fn5rx",description:"row label"})}),u?(0,l.jsx)("div",{className:"flex flex-col items-end gap-2",children:(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{tagName:"span",defaultMessage:"Monthly",id:"bocWt/njES",description:"Monthly label"})})}):(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Annually",id:"ZSCbZACJ+n"})})]}),g&&(0,l.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Billing start date",id:"I5Ux4EgYEU",description:"row label"})}),(0,l.jsx)(m.A,{color:"light",variant:"small",children:p(new Date(1e3*g))})]}),(0,l.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Plan Rate",id:"rURh2EGj6H",description:"row label"})}),(0,l.jsx)(m.A,{color:"light",variant:"small",children:b(f.price/(0,n.hb)(f.currency),{style:"currency",currency:v})})]}),(0,l.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Promotion",id:"C6f1N+J808",description:"row label"})}),(0,l.jsx)(m.A,{color:"super",variant:"small",children:y})]})]}),0===h&&(0,l.jsxs)("li",{className:"flex justify-between gap-4 border-b pb-4",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Discounted plan rate",id:"nwpvOaI+i7",description:"Discounted plan rate label in the pricing table"})}),(0,l.jsx)(m.A,{children:w})]}),(0,l.jsxs)("li",{className:"border-subtler items-center gap-4 pt-4",children:[r&&r.amount>0&&(0,l.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,l.jsx)(m.A,{color:"light",variant:"small",children:null!==(a=null==r?void 0:r.displayName)&&void 0!==a?a:(0,l.jsx)(i.A,{defaultMessage:"Tax",id:"xH0NmqnfwA",description:"Tax label in the pricing table"})}),(0,l.jsx)(m.A,{color:"light",variant:"small",children:null==d?(0,l.jsx)(c.W,{className:"h-full",children:(0,l.jsx)("div",{className:"bg-subtler h-[20px] w-20"})}):b(((null==r?void 0:r.amount)||0)/d,{style:"currency",currency:v})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsx)(m.A,{variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Total due today",id:"Xa8E/3myWL",description:"Total label in the pricing table"})}),(0,l.jsx)(m.A,{variant:"entry-title",children:null==d?(0,l.jsx)(c.W,{className:"h-full",children:(0,l.jsx)("div",{className:"bg-subtler h-[20px] w-20"})}):b((h||0)/d,{style:"currency",currency:v})})]})]})]})},f=(e,t,a,l,r,s,i,n)=>null==l?void 0:l.map(l=>{var o,d,c;if(void 0==s||void 0==r)return"";let u=t((l.amount||0)/s,{style:"currency",currency:r});return(null==n?void 0:n.some(e=>e.includes("HALF_OFF")))?e({defaultMessage:"50% off one payment",id:"icUhRxOdmR",description:"Discount terms for half off"}):(null===(o=l.recurring)||void 0===o?void 0:o.type)==="repeating"?(a&&(u=t(((null==i?void 0:null===(c=i.dueNext)||void 0===c?void 0:c.amountDiscount)||0)/s,{style:"currency",currency:r})),e({defaultMessage:"{amountOff} off for {durationInMonths} months",id:"IQBeqzhV80",description:"Discount terms for recurring discount"},{amountOff:u,durationInMonths:l.recurring.durationInMonths})):(null===(d=l.recurring)||void 0===d?void 0:d.type)==="forever"?e({defaultMessage:"{amountOff} off forever",id:"eJ4azeDZe2",description:"Discount terms for lifetime discount"},{amountOff:u}):""}).join(", ")},13820:(e,t,a)=>{"use strict";a.d(t,{k:()=>s});var l=a(85860),r=a(14475);let s=e=>{let{reason:t,enabled:a=!0}=e,{connectors:s}=(0,r.u)({reason:t,enabled:a}),i=(0,l.useMemo)(()=>{var e;return(null!==(e=null==s?void 0:s.connectors)&&void 0!==e?e:[]).reduce((e,t)=>(e[t.name]=t,e),{})},[s]);return(0,l.useMemo)(()=>({connectorsMap:i}),[i])}},14337:(e,t,a)=>{"use strict";a.d(t,{jX:()=>w,Zh:()=>x,Zp:()=>b}),a(25576);var l=a(85860);a(98188),a(94105),a(60760),a(24065),a(89334);var r=a(68088),s=a(84447),i=a(36206),n=a(3041);class o{get shouldUseMobileProxyForMCP(){var e;if(null===this._shouldUseMobileProxyForMCP){if((0,i.z8)())this._shouldUseMobileProxyForMCP=!0;else if((0,i.bf)())this._shouldUseMobileProxyForMCP=!1;else{let e=this.mobileProxy.isAvailable;void 0!==e&&(this._shouldUseMobileProxyForMCP=e)}}return null!==(e=this._shouldUseMobileProxyForMCP)&&void 0!==e&&e}async getMcpTools(e){if(this.shouldUseMobileProxyForMCP){let t=this.mobileProxy.bridge.get_mcp_tools({server_name:e});return t.catch(e=>{n.vF.error("get_mcp_tools failed:",e)}),t.then(e=>e.tools)}return this.cometAdapter.getMcpTools(e)}async callMcpTool(e,t){if(this.shouldUseMobileProxyForMCP){let t=this.mobileProxy.bridge.call_mcp_tool({params:e});return t.catch(e=>{n.vF.error("call_mcp_tool failed:",e)}),t.then(e=>({content:e.result}))}return this.cometAdapter.callMcpTool(e,t)}async getMcpStdioServers(){if(this.shouldUseMobileProxyForMCP){let e=this.mobileProxy.bridge.get_mcp_servers();return e.catch(e=>{n.vF.error("get_mcp_servers failed:",e)}),e.then(e=>(this.cometAdapter.getStore().getState().actions.setMcpStdioServers(e.servers),e.servers))}return this.cometAdapter.getMcpStdioServers()}async getInstalledDxts(){return this.shouldUseMobileProxyForMCP?[]:this.cometAdapter.getInstalledDxts()}async refreshDxtAndMcpState(){await Promise.all([this.getMcpStdioServers(),this.getInstalledDxts()])}initializeFromWindowTools(e){try{if(!(null==e?void 0:e.servers))return;let t=this.cometAdapter.getStore();Object.entries(e.servers).forEach(e=>{let[a,l]=e;l&&Array.isArray(l)&&t.getState().actions.setMcpTools(a,l)})}catch(e){n.vF.error("Failed to initialize MCP tools from window",e)}}constructor(e,t){(0,s._)(this,"mobileProxy",void 0),(0,s._)(this,"cometAdapter",void 0),(0,s._)(this,"_shouldUseMobileProxyForMCP",null),this.mobileProxy=e,this.cometAdapter=t}}var d=a(49611),c=a(91866);let u=(0,d.A)(function(){let e=(0,c.Ri)("native_bridge");if(e)return function(e){try{var t,a;let l=JSON.parse(e);return{info_version:"string"==typeof l.info_version?l.info_version:void 0,local_mcp:{call:(null===(t=l.local_mcp)||void 0===t?void 0:t.call)===!0,edit:(null===(a=l.local_mcp)||void 0===a?void 0:a.edit)===!0}}}catch(e){n.vF.warn("[NativeClientCapabilities] Invalid JSON",e);return}}(e)},()=>Math.floor(Date.now()/36e5));(0,d.A)(function(){let e=u();return e||((0,i.z8)()?void 0:(0,i.bf)()?{info_version:"1",local_mcp:{call:!0,edit:!0}}:void 0)},()=>Math.floor(Date.now()/36e5));var m=a(92988);a(67121),a(21978);var p=a(96983);a(24915);let h=new r.o;new o(h.getMobileProxy(),h);let{Provider:v,useTrackedState:g}=(0,p.Rv)("CometContext",()=>h.getStore()),f=(0,m.j)("EntropyBrowserContext",void 0),y=(0,m.j)("McpAdapterContext",void 0);function x(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,l.useContext)(f);if(!t&&e)throw Error("useEntropyBrowser must be used inside EntropyBrowserProvider");return t}function b(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,l.useContext)(y);if(!t&&e)throw Error("useMcpAdapter must be used inside EntropyBrowserProvider");return t}let w=g},14479:(e,t,a)=>{"use strict";a.d(t,{oL:()=>c,rm:()=>d});var l=a(85860),r=a(79756),s=a(18360),i=a(96983),n=a(57874);let o=(0,i.Rv)("AskInputContext",()=>(0,n.v)((e,t)=>({activeMenu:null,fileUploadUpsellTooltipOpen:!1,suggestions:s.Ml,blankStateSuggestions:{[r.k0.SEARCH]:null,[r.k0.RESEARCH]:null,[r.k0.STUDIO]:null,[r.k0.STUDY]:null},showSuggestDropdown:!1,actions:{onActiveMenuChange:t=>{e({activeMenu:t})},setFileUploadUpsellTooltipOpen:t=>{e({fileUploadUpsellTooltipOpen:t})},setSuggestions:t=>{e({suggestions:t})},setBlankStateSuggestions:(a,l)=>{e({blankStateSuggestions:{...t().blankStateSuggestions,[l]:a}})},setShowSuggestDropdown:t=>{e({showSuggestDropdown:t})}},inputRef:(0,l.createRef)()}))),d=o.Provider;o.useSelector;let c=o.useTrackedState},15925:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var l=a(25576),r=a(85860),s=a(36814),i=a(64299),n=a.n(i),o=a(60410),d=a(86661),c=a(10748),u=a(77936);let m=(0,a(27773).w)({path:"M5 5m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z M8 10v-2h2m6 6v2h-2m-4 0h-2v-2m8 -4v-2h-2 M3 10h2 M3 14h2 M10 3v2 M14 3v2 M21 10h-2 M21 14h-2 M14 21v-2 M10 21v-2",name:"IconCpu2",variant:"stroked"});var p=a(49427),h=a(72811);let v=r.memo(e=>{let{src:t,lightboxSrc:a,alt:i,fadeIn:v,fallbackSrc:g,fallback:f,hasShadow:y=!1,includeLightBoxModal:x=!0,lightboxFooter:b,origin:w,draggable:_=!0,imageClassName:M,maskClassName:C,containerClassName:j,rounded:A="md",onClick:E,AIProps:S,authorName:k,authorUrl:N,onLoad:T,onFail:I,softBlockSaveImage:R=!1,imageRef:P,imageProps:O,testId:D,onDownload:L,...U}=e,[F,z]=(0,r.useState)(!1),[B,H]=(0,r.useState)(!1),[q,G]=(0,r.useState)(!1),Q=(0,r.useRef)(null),{isAI:V,AILabel:K}=S||{isAI:!1,AILabel:""},W=(0,r.useCallback)(()=>{z(!0),null==I||I()},[]),Y=(0,r.useCallback)(()=>{H(!0),null==T||T()},[H,T]);(0,r.useEffect)(()=>{if(Q.current){if(Q.current.complete){Y();return}!Q.current.src&&(Q.current.src=t)}},[t,Y,Q]);let X=n()(M,"transition-all ease-in-out",{"opacity-100 duration-200 scale-100":B&&v,"opacity-0 scale-[0.98]":!B&&v,"hidden opacity-0":F&&!g,"max-h-[90vh]":x,"cursor-zoom-in hover:shadow-lg duration-200 ":x&&!q}),Z=(0,r.useMemo)(()=>({className:X,src:t,alt:i,onError:W,onClick:()=>G(!0),...O}),[i,X,O,W,t]),J=(0,r.useMemo)(()=>({ref:Q,onLoad:Y,...Z}),[Y,Z]),$=(0,r.useMemo)(()=>({...Z,src:null!=a?a:t}),[a,Z,t]),ee=(0,r.useCallback)(e=>{e.stopPropagation()},[]),et=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.A,{variant:"tiny",color:"white",className:"px-xs py-two h-5 rounded-md bg-black/60 opacity-0 transition-all group-hover:opacity-100",children:(0,l.jsxs)(d.b,{className:"gap-xs",children:[(0,l.jsx)(d.q,{id:"authorName",children:k}),N?(0,l.jsx)(d.q,{id:"authorDomain",children:(0,u.Aw)(N)}):null]})}),(0,l.jsx)("div",{className:"size-xs bg-black/60 opacity-0 transition-all group-hover:opacity-100"})]}),ea=(0,r.useCallback)(()=>G(!1),[]);if(F){if(g&&Q.current)Q.current.src=g;else if(void 0!==f)return f}return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{onClick:E,className:j,"data-testid":D,children:(0,l.jsxs)("div",{className:n()("bg-subtler group relative size-full overflow-hidden",C,{"shadow-md":y&&B,"transition-all duration-200 ease-in-out hover:scale-[1.02] hover:shadow-lg":y,"rounded-sm":"sm"===A,"rounded-md":"md"===A,rounded:!0===A}),children:[V&&(0,l.jsxs)("div",{className:"bottom-xs right-xs absolute z-10 flex items-center justify-center",children:[(0,l.jsx)("div",{children:(0,l.jsx)(o.A,{variant:"tiny",color:"white",className:"gap-x-two px-xs py-two flex h-5 items-center rounded-md bg-black/60 opacity-0 transition-all group-hover:opacity-100",children:(0,l.jsx)("span",{children:K})})}),(0,l.jsx)("div",{className:"size-xs bg-black/60 opacity-0 transition-all group-hover:opacity-100"}),(0,l.jsx)("div",{children:(0,l.jsx)(o.A,{variant:"tiny",color:"white",className:"gap-x-two p-two flex h-5 items-center rounded-md bg-black/60",children:(0,l.jsx)(p.e,{icon:m,size:"xs"})})})]}),k&&(N?(0,l.jsx)(h.N,{href:null!=N?N:"",target:"_blank",onClick:ee,className:"bottom-xs right-xs absolute z-10 flex items-center justify-center",children:et}):(0,l.jsx)("div",{onClick:ee,className:"bottom-xs right-xs absolute z-10 flex items-center justify-center",children:et})),R&&!V&&(0,l.jsx)("div",{className:"absolute inset-0",onClick:x?()=>G(!0):void 0}),(0,l.jsx)("img",{width:U.width,height:U.height,alt:i,...J,ref:(0,s.P)([P,Q]),draggable:_})]})}),x&&(0,l.jsx)(c.v,{onClose:ea,isOpen:q,imgProps:$,origin:w,width:U.width,height:U.height,alt:i,onDownload:L,footer:b})]})});v.displayName="Image";let g=v},16077:(e,t,a)=>{"use strict";a.d(t,{l:()=>h});var l=a(25576),r=a(85860),s=a(83081),i=a(80892),n=a(71849),o=a(60410),d=a(28554),c=a(3041),u=a(66516);let m=e=>{let{loading:t,onClick:a}=e,{$t:r}=(0,s.A)();return(0,l.jsx)(d.A,{extraCSS:"shrink-0",fullWidth:!0,fullWidthMobile:!0,size:"xl",variant:"primary",isLoading:t,disabled:t,onClick:a,text:r({defaultMessage:"Subscribe",id:"hEa5MFH9J3",description:"button label"})})},p=e=>{let{confirm:t,paymentMethodType:a,subscriptionTier:s}=e,[d,p]=(0,r.useState)(!1),{trackEvent:h}=(0,i.yw)(),[v,g]=(0,r.useState)(),f=(0,r.useCallback)(async()=>{var e,l;if(!t)return;let r=(0,u.Ip)();p(!0),h("pro checkout attempt",{subscriptionTier:s,paymentMethodType:a});try{let l=await t();if("error"===l.type)g(l.error),h("pro checkout error",{subscriptionTier:s,error:null!==(e=l.error.code)&&void 0!==e?e:"unknown",paymentMethodType:a}),c.vF.warn("Error confirming payment",l.error),r.addTiming("web.payment_page.payment_error");else{h("pro checkout success",{subscriptionTier:s,paymentMethodType:a}),r.addTiming("web.payment_page.payment_success"),g(void 0);try{await (0,n.fi)({reason:"inner-pay-button-with-checkout"})}catch(e){c.vF.warn("Error refreshing subscription status",e)}r.addTiming("web.payment_page.subscription_refreshed")}}catch(e){g(e),h("pro checkout error",{subscriptionTier:s,error:null!==(l=e.code)&&void 0!==l?l:"unknown",paymentMethodType:a}),r.addTiming("web.payment_page.payment_error")}p(!1)},[t,h,a,s]);return(0,l.jsxs)(l.Fragment,{children:[!!v&&(0,l.jsx)(o.A,{variant:"small",color:"red",children:null==v?void 0:v.message}),(0,l.jsx)(m,{onClick:f,loading:d})]})},h=e=>{let{confirm:t,paymentMethodType:a,isExpressCheckoutLoading:r,subscriptionTier:s}=e;return!t||r?(0,l.jsx)(m,{loading:!0}):(0,l.jsx)(p,{confirm:t,paymentMethodType:a,subscriptionTier:s})}},16540:(e,t,a)=>{"use strict";a.d(t,{Gm:()=>v,KX:()=>h,LS:()=>i,WZ:()=>p,XX:()=>c,Yj:()=>u,Yl:()=>f,aP:()=>m,h9:()=>n,hI:()=>g,n8:()=>o,p1:()=>d});var l=a(77150),r=a(77917);a(18360);var s=a(3041);let i=async e=>{let{shipping_address:t,amount:a,reason:s}=e,{data:i,error:n}=await r.By.POST("/rest/shopping/calculate-tax-and-shipping",s,{body:{shipping_address:t,amount:a},timeoutMs:(0,r.e4)(),numRetries:1});if(n)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to calculate tax and shipping",cause:n});return i},n=async e=>{let{reason:t}=e,{data:a,error:s}=await r.By.GET("/rest/shopping/retrieve-customer-shopping-info",t,{timeoutMs:(0,r.e4)({productionMs:5e3})});if(s)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to get customer shopping info",cause:s});return a};async function o(e){let{body:t,reason:a}=e;try{let e=await r.By.POST("/rest/shopping/create-shopping-order",a,{headers:{"content-type":"application/json"},body:t,timeoutMs:1e4,numRetries:0});if(e.error)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to create shopping order",cause:e.error});return e.data}catch(e){throw s.vF.log("Error in ".concat("createShoppingOrder",":"),e),e}}let d=async e=>{let{request:t,reason:a}=e,{data:s,error:i}=await r.By.POST("/rest/shopping/create-shopping-payment-intent",a,{body:t,timeoutMs:6e3,numRetries:0});if(i)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to create shopping payment intent",cause:i});if("success"!==s.status)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to create payment intent",cause:s});return s},c=async e=>{let{orderId:t,reason:a}=e,{data:s,error:i}=await r.By.POST("/rest/shopping/update-shopping-order",a,{body:{order_id:t,order_status:"cancelled"},timeoutMs:2e4});if(i)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to cancel shopping order",cause:i});return s},u=async e=>{let{request:t,reason:a}=e,{data:s,error:i}=await r.By.POST("/rest/shopping/create-firmly-cart",a,{body:t,timeoutMs:(0,r.e4)({clientSideMs:5e3})});if(i)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to create firmly cart",cause:i});return s},m=async e=>{let{request:t,reason:a}=e,{data:s,error:i}=await r.By.POST("/rest/shopping/set-firmly-shipping-info",a,{body:t,timeoutMs:(0,r.e4)({clientSideMs:7e3})});if(i)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to set firmly shipping info",cause:i});return s},p=async e=>{let{reason:t}=e,{data:a,error:s}=await r.By.GET("/rest/shopping/create-firmly-session",t,{timeoutMs:(0,r.e4)()});if(s)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to create firmly session",cause:s});return a},h=async e=>{let{request:t,reason:a}=e,{data:s,error:i}=await r.By.POST("/rest/stripe/update-customer-shipping-address",a,{body:t,timeoutMs:(0,r.e4)()});if(i)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to update customer shipping address",cause:i});return s},v=async e=>{let{optionKey:t,reason:a}=e,{data:s,error:i}=await r.By.POST("/rest/shopping/fetch-product-details",a,{body:{option_key:t},timeoutMs:4e3});if(i)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to fetch product details",cause:i});return s},g=async e=>{let{request:t,reason:a}=e,{data:s,error:i}=await r.By.POST("/rest/shopping/search-shopping-for-entry",a,{body:{query:t.query,read_write_token:t.read_write_token,entry_uuid:t.entry_uuid},timeoutMs:r.dS.HIGH});if(i)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to search for additional products",cause:i});return s&&"failure"!==s.status?[...s.shopping_widgets]:[]},f=async e=>{let{reason:t}=e,{error:a,data:l}=await r.By.GET("/rest/shopping/try-on-photo/get",t,{timeoutMs:(0,r.e4)()});return a?{status:"error",try_on_photo_url:null}:l}},16683:(e,t,a)=>{"use strict";a.d(t,{V:()=>lv,b:()=>rs});var l,r=a(25576),s=a(85860),i=a(90873),n=a(47575),o=a(83081),d=a(80892),c=a(60760),u=a(12839),m=a(60410),p=a(28554),h=a(69744),v=a(17147),g=a(60010);let f=s.memo(e=>{let{isOpen:t,onClose:a,uuidOrSlug:l}=e,{$t:i}=(0,o.A)(),{deprecatedOpenToast:n}=(0,g.G)(),{trackEvent:f}=(0,d.yw)();(0,s.useEffect)(()=>{f("thread access modal viewed",{uuidOrSlug:l})},[f,l]);let y=(0,s.useCallback)(e=>{f("thread access modal requested",{uuidOrSlug:l}),(0,c.ec)({slugOrUUID:l,reason:"request-access-modal"}).then(()=>{a(),n(i({defaultMessage:"Access request sent",id:"STvLV+qKiH"}),"success",3)})},[l,i,a,n,f]),x=(0,s.useCallback)(()=>y(l),[y,l]);return(0,r.jsx)(v.A,{isOpen:t,onClose:a,variant:"thin",children:(0,r.jsx)(u.Ay,{className:"px-md mx-auto text-center",children:(0,r.jsxs)("div",{className:"gap-y-md flex flex-col",children:[(0,r.jsx)("div",{className:"mb-lg flex justify-center",children:(0,r.jsx)(h.g,{variant:"full",size:"large",color:"foreground"})}),(0,r.jsxs)("div",{className:"mx-auto max-w-sm",children:[(0,r.jsx)(m.A,{variant:"section-title",className:"-mt-md",children:i({defaultMessage:"This answer is private",id:"cA+GFbHP/s"})}),(0,r.jsx)(m.A,{variant:"base",color:"light",className:"-mb-md",children:i({defaultMessage:"You can access this page if the owner accepts your request.",id:"SOJ/6nzOoc"})})]}),(0,r.jsxs)("div",{className:"mt-lg mb-md mx-auto flex w-full max-w-sm flex-col gap-y-2",children:[(0,r.jsx)(p.A,{variant:"primary",text:i({defaultMessage:"Request access",id:"vkHRp5q6Wi"}),onClick:x}),(0,r.jsx)(p.A,{variant:"common",text:i({defaultMessage:"Back to Perplexity",id:"r89PhWwooe"}),onClick:a,textClassName:"font-normal"})]})]})})})});f.displayName="RequestAccessModal";var y=a(57833),x=a(77917),b=a(3041);let w=async(e,t,a,l)=>await _({headers:{},reason:"Report Bug",bugText:e,url:t,email:a,category:l}),_=async e=>{let{headers:t,reason:a,bugText:l,url:r,email:s,category:i}=e;try{let e=await x.By.POST("/webhooks/slack-web-debugger/web",a,{body:{bug_text:l,url:r,email:null!=s?s:"",category:null!=i?i:""},headers:t,timeoutMs:1e4});if(e.data)return e.data;return null}catch(e){return b.vF.error("Failed to make bug report request",e),null}},M=e=>{if(!e.includes("/sidecar/"))return e;let t=new URL(e);return t.searchParams.delete("erp"),t.pathname=t.pathname.replace("/sidecar",""),t.toString()},C=async(e,t)=>{try{await x.By.PUT("/rest/thread/{entry_uuid_or_slug}","remove-thread-expiry",{params:{path:{entry_uuid_or_slug:e}},body:{expired:!1}}),null==t||t()}catch(e){throw Error("Failed to remove thread expiry")}},j=e=>{let{slugOrUUID:t}=e,a=(0,s.useCallback)(async()=>{t&&await C(t)},[t]);return(0,s.useMemo)(()=>({handleRemoveExpiry:a}),[a])};var A=a(74924),E=a(95641),S=a(83105),k=a(42826);async function N(e){let{contextUUID:t,updatedAccess:a,rwToken:l,callback:r,reason:s}=e;try{let e=await x.By.POST("/rest/thread/update_thread_access",s,{body:{context_uuid:null!=t?t:"",updated_access:a,read_write_token:null!=l?l:""}}),i=await (null==e?void 0:e.data);null==r||r(null==i?void 0:i.access)}catch(e){b.vF.error(e),null==r||r(e)}}var T=a(46972),I=a(46708),R=a(43627),P=a(26085),O=a(40027),D=a(26890),L=a(36733),U=a(49427);let F=[{label:"Comet Assistant",value:"AGENT",description:"Use cases where Comet Assistant is acting on your behalf and does the wrong thing. For general Comet issues please use Comet Browser instead."},{label:"Comet Browser",value:"BROWSER",description:"General Comet UI/UX issues. For general Perplexity web issues please use Web instead."},{label:"Product",value:"PRODUCT",description:"General product features, UI/UX issues, or user experience problems"},{label:"AI",value:"AI",description:"Core AI model issues, accuracy problems, or response quality"},{label:"Enterprise",value:"ENTERPRISE",description:"Enterprise-specific features"},{label:"Platform",value:"PLATFORM",description:"Infrastructure, performance, or system-level issues"},{label:"Mobile",value:"MOBILE",description:"Mobile app functionality or design issues"},{label:"Search",value:"SEARCH",description:"Search functionality, results quality, or indexing problems"},{label:"Web",value:"WEB",description:"General Web UI/UX issues."}],z=e=>{let{value:t,onSelect:a,options:l,placeholder:s="Select a category..."}=e,i=l.find(e=>e.value===t),n=(null==i?void 0:i.label)||s,o=l.map(e=>({type:"default",text:e.label,tooltipText:e.description,onClick:()=>a(e.value),show:!0})),d={text:n,variant:"common",size:"small",trailingComponent:(0,r.jsx)(U.A,{icon:L.r,size:"xs"}),extraCSS:"w-full justify-between border-subtler bg-base p-sm dark:border-subtle dark:bg-subtler"};return(0,r.jsx)(D.n,{items:o,isMobileStyle:!1,placement:"bottom-start",children:(0,r.jsx)(P.A,{...d})})},B=e=>{let{isOpen:t,onClose:a}=e,[l,i]=(0,s.useState)(""),[n,o]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[p,h]=(0,s.useState)(!1),[g,f]=(0,s.useState)(null),{firstResult:{context_uuid:y,backend_uuid:x,expiry_time:_,collection_info:{slug:C}={}}={}}=(0,T.E)(),{handleAccessChange:P}=function(e){let{threadAccess:t,contextUUID:a,rwToken:l,collectionSlug:r,reason:i}=e,{trackEvent:n}=(0,d.yw)(),o=(0,S.L)(),c=(0,E.useQueryClient)(),u=(0,T.Oc)(),m=(0,I.Iv)(t),p=(0,s.useCallback)((e,s)=>{a&&l&&o&&t!==e&&N({contextUUID:a,updatedAccess:e,rwToken:l,reason:i,callback:l=>{if(l===e){if(u(e=>{if(e)return e.map(e=>({...e,thread_access:l}))}),t&&n("thread privacy changed",{oldPrivacy:(0,I.Ap)(t),newPrivacy:(0,I.Ap)(l),contextUUID:a}),r){let e=[k.d8,{collection_slug:r.slice(-22)}];c.invalidateQueries({queryKey:e})}null==s||s(l)}}})},[a,l,t,o,u,n,r,c,i]),h=(0,s.useCallback)(e=>{o&&!m&&(n("click share thread to space"),p(R.hx.COLLECTION_READ,e))},[o,m,p,n]),v=(0,s.useCallback)(e=>{o&&m&&(n("click make thread private"),p(R.hx.PRIVATE_READ,e))},[o,m,p,n]);return(0,s.useMemo)(()=>({isShareable:m,currentAccess:t,onShareThreadToSpace:h,onMakeThreadPrivate:v,handleAccessChange:p}),[m,p,v,h,t])}({contextUUID:y,rwToken:(0,A.k)(),collectionSlug:C,reason:"Bug Report"}),{handleRemoveExpiry:D}=j({slugOrUUID:x}),L=async()=>{if(!l.trim()){f("Please describe the bug");return}h(!0),f(null);try{let e=M(window.location.href),t=await w(l,e,n,c);a(),(null==t?void 0:t.status)==="success"&&t.linear_url&&window.open(t.linear_url,"_blank"),P(R.hx.PUBLIC_READ),_&&await D(),i(""),u("")}catch(e){b.vF.error("Failed to submit bug report",e),f("Failed to submit bug report. Please try again.")}finally{h(!1)}},U=()=>{i(""),u(""),o(""),f(null),a()};return(0,r.jsx)(v.A,{isOpen:t,onClose:U,title:"Report a Bug",variant:"large",actionList:[{text:"Cancel",onClick:U,variant:"common"},{text:p?"Submitting...":"Submit Bug Report",onClick:L,variant:"primary",disabled:p||!l.trim(),isLoading:p}],children:(0,r.jsxs)("div",{className:"space-y-md",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(m.A,{variant:"base",className:"mb-sm",children:"Category (optional)"}),(0,r.jsx)(z,{value:c,onSelect:u,options:F,placeholder:"Select a category..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.A,{variant:"base",className:"mb-sm",children:"Who should we assign this bug to? (optional)"}),(0,r.jsx)(O.A,{value:n,onChange:e=>o(e),placeholder:"Please provide the email address. E.g. johnny@perplexity.ai",className:"w-full",isMobileUserAgent:!1,isMobileStyle:!1,minRows:1})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.A,{variant:"base",className:"mb-sm",children:"Please describe the bug you encountered:"}),(0,r.jsx)(O.A,{value:l,onChange:e=>i(e),placeholder:"Describe what happened, steps to reproduce, and any other relevant details...",className:"w-full",isMobileUserAgent:!1,isMobileStyle:!1,minRows:1})]}),g&&(0,r.jsx)(m.A,{variant:"smallMono",color:"red",className:"text-sm",children:g})]})})};var H=a(88364),q=a(26941),G=a(40758);let Q=e=>{let{label:t,keys:a}=e;return(0,r.jsxs)(m.A,{color:"light",className:"py-md flex place-content-between items-center",children:[(0,r.jsx)(m.A,{as:"dd",variant:"small",color:"light",className:"line-clamp-1 overflow-hidden text-clip",children:t}),(0,r.jsx)(u.Ay,{as:"dl",className:"space-x-two flex items-center",children:a.map(e=>(0,r.jsx)(u.Ay,{className:"px-xs flex h-5 min-w-5 items-center justify-center rounded border font-mono",children:e},e))})]})},V=s.memo(e=>{let{closeModal:t,isOpen:a}=e,l=(0,o.A)(),{device:{isMacOS:i,isWindowsApp:n}}=(0,q.L)(),d=(0,S.L)(),c=i?H.bq.MACOS:H.bq.WINDOWS,p=(0,s.useMemo)(()=>(0,H.hd)(l,n,d),[l,n,d]);return(0,r.jsx)(G.h,{childVariant:"hide-chrome",isOpen:a,canOutsideClickClose:!0,onClose:t,children:(0,r.jsx)(u.Ay,{variant:"background",className:"relative w-[90vw] max-w-screen-sm overflow-hidden rounded-xl",children:(0,r.jsxs)(u.Ay,{variant:"subtler",className:"p-md inset-0",children:[(0,r.jsx)(m.A,{className:"mb-2",variant:"section-title",as:"h2",children:l.formatMessage({defaultMessage:"Keyboard Shortcuts",id:"nFkLBjIGMy"})}),(0,r.jsx)(u.Ay,{as:"dl",className:"divide-y",children:p.map(e=>(0,r.jsx)(Q,{label:e.label,keys:e[c]},e.type))})]})})})});V.displayName="KeyboardShortcutHelperModal";var K=a(10924),W=a(46304),Y=a(35179),X=a(46524);function Z(e){let{reason:t,collectionSlugOverride:a}=e,l=(0,X.g)(),r=null!=a?a:Array.isArray(null==l?void 0:l.slug)?l.slug[0]:null==l?void 0:l.slug,{collection:i}=(0,W.U)({collectionSlug:r,reason:t}),n=!!i&&(0,Y.u8)(i.user_permission),o=!!i&&(0,Y.GO)(i.user_permission),d=!!i&&(0,Y.QK)(i.user_permission),c=!!i&&(0,Y.qX)(i.user_permission),u=!!i&&(0,Y.o2)(i.user_permission);return(0,s.useMemo)(()=>({isUserOwner:n,isUserInvited:o,isUserReader:d,isUserAtLeastReader:c,isUserAtLeastWriter:u}),[c,u,o,n,d])}var J=a(15492),$=a(53121),ee=a(88209),et=a(21978);let ea=e=>{let{reason:t}=e;return(0,J.useQuery)({queryKey:["list_space_templates"],queryFn:()=>(0,ee.qE)({reason:t})})},el=e=>{let{collectionSlug:t,reason:a}=e,{data:l,isLoading:r}=ea({reason:a});return(0,s.useMemo)(()=>(null==l?void 0:l.templates)&&t?{templateSpace:l.templates.find(e=>e.collection.slug===t),isLoading:r}:{templateSpace:void 0,isLoading:r},[t,null==l?void 0:l.templates,r])};var er=a(18606),es=a(21753),ei=a(65308),en=a(94122),eo=a(83312),ed=a(7695),ec=a(64265),eu=a(6366);let em=e=>{let{title:t,actionIcon:a=eu.u,onAction:l,testId:s,children:i}=e;return(0,r.jsxs)(u.Ay,{children:[(0,r.jsxs)("div",{className:"my-xs py-xs pl-sm flex items-center justify-between",children:[(0,r.jsx)(m.A,{variant:"smallBold",children:t}),l&&(0,r.jsx)(P.A,{variant:"common",size:"small",icon:a,pill:!0,onClick:l,"data-testid":s})]}),i]})};var ep=a(57023),eh=a(70714),ev=a(7038),eg=a(80314),ef=a(11129),ey=a(51244);let ex=e=>{var t;let{reason:a,collectionSlug:l}=e,{variation:r}=(0,ev.x)(!1),{openModal:i}=(0,ey.u)(),{fileRepoInfo:n}=(0,eo.y)({reason:a,collectionSlugOverride:l}),{data:o}=(0,J.useQuery)({queryKey:(0,ef.PB)(n),queryFn:()=>(0,eg.nN)({reason:a,request:{file_repository_info:n,filters:{connection_ids:[],connection_types:[],parent_uuids:[],remote_file_ids:[],uuids:[],ids:[],file_types:[],upload_ids:[],status:["SYNC_ERROR"],root_files_only:!1,search_keyword:""},order_by:"created",order_dir:"asc",pagination:{page_size:0}}})}),d=(0,s.useCallback)(()=>{i("spaceUploadFilesModal",{initialTab:r?"files":"connectors",collectionSlug:l})},[l,i,r]),c=null!==(t=null==o?void 0:o.total)&&void 0!==t?t:0;return(0,s.useMemo)(()=>({errorCount:c,handleSeeDetails:d}),[c,d])};var eb=a(1863);let ew=(0,ep.YK)({errorCount:{defaultMessage:"{errorCount, plural, one {# file failed to upload} other {# files failed to upload}}",id:"5s+s5GJuN7"},seeDetails:{defaultMessage:"See details",id:"RQfEXO7ZCr"}}),e_=e=>{let{collectionSlug:t}=e,{$t:a}=(0,o.A)(),{errorCount:l,handleSeeDetails:s}=ex({reason:"upload-error-banner",collectionSlug:t});return l<=0?null:(0,r.jsxs)(u.Ay,{variant:"subtle",className:"px-sm py-xs flex items-baseline gap-2 rounded-md",children:[(0,r.jsx)(m.A,{color:"red",className:"self-center",children:(0,r.jsx)(U.e,{icon:eb.b,size:"md"})}),(0,r.jsx)(m.A,{variant:"small",color:"default",children:(0,r.jsx)(eh.A,{...ew.errorCount,values:{errorCount:l}})}),(0,r.jsx)("div",{className:"ml-auto",children:(0,r.jsx)(P.A,{variant:"noBackground",size:"small",text:a(ew.seeDetails),onClick:s})})]})};var eM=a(63137),eC=a(40993),ej=a(97618),eA=a(18811),eE=a(9758),eS=a(24645),ek=a(30002),eN=a(27773);let eT=(0,eN.w)({path:"M14 3v4a1 1 0 0 0 1 1h4m-5-5H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3m4-18 5 5m0 0v3",name:"IconBadgeFile",variant:"stroked"});var eI=a(90768),eR=a(81467);let eP=e=>{let{totalLocalFiles:t,totalRepoFiles:a,isFileManagerUiRedesignEnabled:l}=e,r=a-t;return l?"files":0===t&&r>0?"connectors":t>0&&0===r?"localFiles":t>0&&r>0?"localFiles":"localFiles"},eO=s.memo(e=>{let{icon:t,badge:a}=e,l=(0,s.useMemo)(()=>a&&(0,r.jsx)(eS.A,{size:"tiny",showBackground:!1,rounded:!1,user:a}),[a]);return(0,r.jsx)(U.e,{icon:t,size:18,stroke:2,color:"#64645F",badge:l})});eO.displayName="BadgedIconFactory";let eD=e=>{let{collection:t,onSourcesEdit:a}=e,l=(0,o.A)(),i="files-section",{isUserInvited:n,isUserAtLeastWriter:d}=Z({collectionSlugOverride:t.slug,reason:i}),{variation:c}=(0,ev.x)(!1),p=(0,s.useRef)(null),{fileRepoInfo:h}=(0,eo.y)({reason:i,collectionSlugOverride:t.slug}),{searchTerm:v}=(0,ed.J)({reason:i}),{completedFiles:g,totalFiles:f,hasNextPage:y,fetchNextPage:x}=(0,en.n)({fileRepoInfo:h,searchTerm:v,limit:eM.c5,reason:i}),{data:b,hasNextPage:w,fetchNextPage:_}=(0,es.m)({connectionTypes:[eE.X.GOOGLE_DRIVE,eE.X.ONEDRIVE,eE.X.SHAREPOINT,eE.X.DROPBOX,eE.X.BOX],status:["READY"],fileRepoInfo:h,pageSize:eM.c5,fileTypes:["FILE"],reason:i}),{connectorFiles:M,totalRepoFiles:C}=(0,s.useMemo)(()=>{var e;let t=b?b.pages[b.pages.length-1]:null;return{connectorFiles:(null==b?void 0:b.pages.map(e=>e.files).flat())||[],totalRepoFiles:null!==(e=null==t?void 0:t.files_in_repo)&&void 0!==e?e:0}},[b]),j=(0,s.useMemo)(()=>(0,er.A)(()=>{y?x():w&&_()},500),[y,x,w,_]);(0,ec.B)(p,j,{threshold:.5});let A=(0,s.useCallback)(()=>{a&&a(eP({totalLocalFiles:f,totalRepoFiles:C,isFileManagerUiRedesignEnabled:c}))},[a,f,C,c]),E=y||w,S=(0,s.useCallback)(()=>{let e=d?l.formatMessage({defaultMessage:"Upload or sync files to be used as sources in every search.",id:"yF+cGexY2F"}):l.formatMessage({defaultMessage:"No files included.",id:"wZ9qntul+a"}),t=null;if(d){let e=[(0,r.jsx)(eS.A,{user:ek.D_m,showBackground:!1,size:"small"},"gdrive"),(0,r.jsx)(eS.A,{user:ek.L84,showBackground:!1,size:"small"},"onedrive"),(0,r.jsx)(eS.A,{user:ek.YAi,showBackground:!1,size:"small"},"sharepoint"),(0,r.jsx)(U.e,{icon:eR.n,size:"sm"},"upload")];t=(0,eC.P)(e,{isOverlapping:!0,maxVisuals:4,size:"xl",stackDirection:"right"})}return(0,r.jsxs)(u.Ay,{className:"px-sm py-md gap-y-xs flex flex-col items-center",children:[t&&(0,r.jsx)(u.Ay,{className:"mb-xs",children:t}),(0,r.jsx)(m.A,{variant:"small",color:"light",className:"text-center",children:e})]})},[l,d]),k=0===C,N=!n&&d,T=l.formatMessage({defaultMessage:"Files",id:"m4vqJl0/FT"});return(0,r.jsx)(em,{title:C?"".concat(T," (").concat(C,")"):T,onAction:N?A:void 0,testId:"space-context-files-add-button",children:k?S():(0,r.jsxs)("div",{className:"gap-y-sm flex flex-col",children:[(0,r.jsx)(e_,{collectionSlug:t.slug}),(0,r.jsxs)("div",{children:[(0,r.jsx)(eL,{localFiles:g}),(0,r.jsx)(eU,{connectorFiles:M}),E&&(0,r.jsx)(eA.A,{ref:p,size:"small",className:"my-xs"})]})]})})};eD.displayName="FilesSection";let eL=e=>{let{localFiles:t}=e,{mutate:a}=(0,ei.e)({reason:"local-files-list"}),l=(0,s.useCallback)(e=>e.file_s3_url?()=>a({file_url:e.file_s3_url}):null,[a]);return t.map((e,t)=>{let a=(0,r.jsx)(u.Ay,{className:"flex size-6 flex-none items-center justify-center",children:(0,r.jsx)(eO,{icon:eI.g,badge:null})}),s=l(e);return(0,r.jsx)(u.Ay,{children:s?(0,r.jsx)(P.A,{variant:"positive",text:e.name,leadingComponent:a,onClick:s,textClassName:"font-sans font-normal text-sm",layout:"left",fullWidth:!0}):(0,r.jsxs)(u.Ay,{className:"pl-sm gap-x-xs flex w-full items-center py-[10px]",children:[a,(0,r.jsx)(m.A,{variant:"small",color:"light",className:"line-clamp-1 pl-px",children:e.name})]})},"local-".concat(t))})};eL.displayName="LocalFilesList";let eU=e=>{let{connectorFiles:t}=e,a=(0,s.useCallback)(e=>()=>{e.connection_file_url&&window.open(e.connection_file_url,"_blank")},[]);return t.map((e,t)=>{let l=(0,r.jsx)(u.Ay,{className:"flex size-6 flex-none items-center justify-center",children:(0,r.jsx)(eO,{icon:eT,badge:(0,ej.cC)(e.connection_type)})}),s=a(e);return(0,r.jsx)(u.Ay,{children:(0,r.jsx)(P.A,{variant:"positive",text:e.name,leadingComponent:l,onClick:s,textClassName:"font-sans font-normal text-sm",layout:"left",fullWidth:!0})},"connector-".concat(t))})};eU.displayName="ConnectorFilesList";var eF=a(11594);let ez=e=>{let{collection:t,onEdit:a}=e,l=(0,o.A)(),{isUserInvited:i,isUserAtLeastWriter:n}=Z({collectionSlugOverride:t.slug,reason:"instructions-section"}),d=!t.instructions,c=(0,s.useMemo)(()=>{let e=l.formatMessage({defaultMessage:"Add instructions to format, scope, and add relevance to your search results.",id:"JnYU6ctsCn"});return(0,r.jsx)(u.Ay,{className:"px-sm py-md gap-y-xs flex flex-col items-center",children:(0,r.jsx)(m.A,{variant:"small",color:"light",className:"text-center",children:e})})},[l]);return(0,r.jsx)(em,{title:l.formatMessage({defaultMessage:"Instructions",id:"sV2v5LjRpX"}),actionIcon:eF.G,onAction:!i&&n?a:void 0,testId:"space-context-instructions-edit-button",children:d?c:(0,r.jsx)(u.Ay,{className:"pl-sm gap-x-xs flex w-full items-center py-[10px]",children:(0,r.jsx)(m.A,{variant:"small",color:"light",className:"line-clamp-4 pl-px",children:t.instructions})})})};var eB=a(74638);let eH=e=>{var t;let{collection:a,onSourcesEdit:l}=e,i=(0,o.A)(),{isUserInvited:n,isUserAtLeastWriter:d}=Z({collectionSlugOverride:a.slug,reason:"links-section"}),{focusedWebLinks:c,totalFocusedWebLinks:p}=(0,s.useMemo)(()=>{var e,t;let l=null!==(t=null===(e=a.focused_web_config)||void 0===e?void 0:e.link_configs)&&void 0!==t?t:[];return{focusedWebLinks:l,totalFocusedWebLinks:l.length}},[null===(t=a.focused_web_config)||void 0===t?void 0:t.link_configs]),h=(0,s.useCallback)(e=>()=>window.open("https://".concat(e.link),"_blank"),[]),v=(0,s.useCallback)(()=>{l&&l("links")},[l]),g=(0,s.useCallback)(()=>{let e=d?i.formatMessage({defaultMessage:"Add URLs to be used as sources in every search.",id:"FTItpgdarF"}):i.formatMessage({defaultMessage:"No links included.",id:"Qid6Kgk2jz"});return(0,r.jsx)(u.Ay,{className:"px-sm py-md gap-y-xs flex flex-col items-center",children:(0,r.jsx)(m.A,{variant:"small",color:"light",className:"text-center",children:e})})},[i,d]),f=!n&&d;return(0,r.jsx)(em,{title:i.formatMessage({defaultMessage:"Links",id:"qCcwo3DU78"}),onAction:f?v:void 0,testId:"space-context-links-add-button",children:0===p?g():(0,r.jsx)(r.Fragment,{children:c.map((e,t)=>{let a=(0,r.jsx)(u.Ay,{className:"flex size-6 flex-none items-center justify-center",children:(0,r.jsx)(U.e,{icon:eB.A,size:18,stroke:2,color:"#64645F"})}),l=h(e);return(0,r.jsx)(u.Ay,{children:(0,r.jsx)(P.A,{variant:"positive",text:e.link,leadingComponent:a,onClick:l,textClassName:"font-sans font-normal text-sm",layout:"left",fullWidth:!0})},t)})})})},eq=s.memo(e=>{let{collectionSlug:t,handleSpaceEdit:a,handleSourcesEdit:l}=e,s="space-context",{collection:i}=(0,W.U)({collectionSlug:t,reason:s}),{isUserAtLeastWriter:n,isUserInvited:o,isUserReader:d}=Z({collectionSlugOverride:t,reason:s}),{templateSpace:c}=el({collectionSlug:null!=t?t:"",reason:s});return i?(0,r.jsxs)(u.Ay,{className:"hideScroll h-full flex-col overflow-y-auto",children:[(!o&&n||d&&!!c)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ez,{collection:i,onEdit:a}),(0,r.jsx)("hr",{className:"my-sm"})]}),(0,r.jsx)(eD,{collection:i,onSourcesEdit:l}),(0,r.jsx)("hr",{className:"my-sm"}),(0,r.jsx)(eH,{collection:i,onSourcesEdit:l})]}):null});eq.displayName="SpaceContext";let eG=s.memo(e=>{let{closeModal:t,isOpen:a,collectionSlug:l}=e,i="space-context-modal",n=(0,o.A)(),{openModal:d}=(0,ey.u)(),{collection:c}=(0,W.U)({collectionSlug:l,reason:i}),{isUserAtLeastWriter:u,isUserAtLeastReader:p}=Z({reason:i,collectionSlugOverride:l}),h=(0,E.useQueryClient)(),g=(0,s.useCallback)(()=>{if(l){let e=["get_collection",{collection_slug:l.slice(-22)}];h.invalidateQueries({queryKey:e})}t()},[t,l,h]),f=(0,s.useCallback)(()=>{c&&d("spaceSettings",{existingSpace:c})},[c,d]),y=(0,s.useCallback)(e=>{c&&d("spaceUploadFilesModal",{initialTab:e,collectionSlug:l})},[c,l,d]),x=(0,s.useMemo)(()=>(0,r.jsx)(m.A,{variant:"section-title",className:"px-sm",children:n.formatMessage({defaultMessage:"Context",id:"V2qutIKrxy"})}),[n]);return(0,r.jsx)(v.A,{variant:"side-sheet",isOpen:a,onClose:g,includeBlur:!1,titleContent:x,modalClassname:"!min-w-[365px] !w-[25vw]",closeButtonClassname:"right-sm absolute",fixedTitle:!0,children:(0,r.jsx)(eq,{collectionSlug:l,handleSpaceEdit:u?f:void 0,handleSourcesEdit:p?y:void 0})})});eG.displayName="SpaceContextModal";var eQ=a(93902);let eV=e=>{let{children:t,title:a,handleClose:l,experimentalImageDesign:s}=e,{image:i,imageAlt:n}=s;return(0,r.jsx)(u.Ay,{variant:"background",className:"max-w-[400px] overflow-hidden rounded-xl md:flex md:max-w-[960px]",children:(0,r.jsxs)(u.Ay,{variant:"subtler",className:"inset-0 md:flex",children:[(0,r.jsx)("div",{className:"md:w-[55%]",children:(0,r.jsx)("img",{src:i,alt:n,className:"md:object-cover"})}),(0,r.jsxs)("div",{className:"p-lg md:p-xl relative flex flex-col md:w-[45%]",children:[(0,r.jsx)(eQ.A,{testId:"close-modal",variant:"common",size:"small",onClick:l}),(0,r.jsx)("div",{className:"mb-lg grow",children:(0,r.jsx)(m.A,{color:"default",variant:"page-title",className:"font-editorial my-sm text-center text-[2rem] font-light leading-none tracking-tight",children:a})}),t]})]})})};var eK=a(55776),eW=a(38683),eY=a(9362),eX=a(18360),eZ=a(30571),eJ=a(72811);let e$=s.memo(e=>{var t,a;let{pitchMessage:l,origin:i,isOpen:n,closeModal:c,closeCallback:u,experimentalImageDesign:p,sheetModalDesign:h,overrideRedirectUrl:g,disallowedMethods:f,loginButtonsStyle:y,renderCloseButton:x,preEnteredEmail:b,autoFocus:w=!0}=e,{$t:_}=(0,o.A)(),M=(0,S.L)(),[C,j]=(0,s.useState)(""),{trackEvent:A}=(0,d.yw)(),{isMobileStyle:E}=(0,eW.al)(),k=null!==(t=null==l?void 0:l.title)&&void 0!==t?t:_({defaultMessage:"Welcome",id:"PwaN2oE2pC"}),[N]=(0,s.useState)(!1),T=(0,s.useCallback)(()=>{c(),null==u||u()},[c,u]);return(0,s.useEffect)(()=>{n&&A("login modal opened",{origin:i})},[n,i,A]),(0,s.useEffect)(()=>{!M&&i&&j((0,eZ.Qv)(null!=g?g:window.location.href,ek.cp2,i))},[M,i,g]),(0,r.jsx)(r.Fragment,{children:p?(0,r.jsx)(v.A,{isOpen:n,onClose:T,centerTitle:!!l,actionList:eX.Ml,variant:"hide-chrome",renderCloseButton:x,children:(0,r.jsx)(eV,{title:k,handleClose:T,experimentalImageDesign:p,children:(0,r.jsx)(eK.A,{autoFocus:w,onClose:T,redirectUrl:C,disallowedMethods:f,loginButtonsStyle:y,showCloseButton:!1,preEnteredEmail:b})})}):(0,r.jsx)(eY.R,{isOpen:n,onClose:T,shouldClose:N,centerTitle:!!l,actionList:eX.Ml,variant:h,showCloseButton:x,children:(0,r.jsxs)("div",{onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"px-lg mx-auto max-w-sm md:max-w-lg",children:[(0,r.jsx)(m.A,{variant:"page-title",className:"font-editorial text-pretty text-center !font-light !leading-snug tracking-tight md:text-4xl",children:null!==(a=null==l?void 0:l.title)&&void 0!==a?a:(0,r.jsx)(eh.A,{defaultMessage:"Sign up below to <italic>unlock</italic> the full {br} potential of Perplexity",id:"exZDTeIaG0",values:{italic:e=>(0,r.jsx)("span",{className:"italic",children:e}),br:(0,r.jsx)("br",{})}})}),(null==l?void 0:l.subtitle)&&(0,r.jsx)(m.A,{className:"mt-xs text-pretty text-center",children:l.subtitle}),(0,r.jsx)(m.A,{className:"mt-md text-pretty text-center",children:(null==l?void 0:l.description)?l.description:(0,r.jsx)(eh.A,{defaultMessage:"By continuing, you agree to our {privacyPolicyLink}.",id:"cE5rUKm7fb",values:{privacyPolicyLink:(0,r.jsx)(eJ.N,{className:"underline",target:"_blank",href:"https://www.perplexity.ai/hub/legal/privacy-policy",children:(0,r.jsx)(eh.A,{defaultMessage:"privacy policy",id:"LIDXd2UwSl"})})}})}),(0,r.jsx)("div",{className:"mt-lg"})]}),(0,r.jsx)(eK.A,{autoFocus:w&&!E,onClose:T,redirectUrl:C,showInternal:!0,disallowedMethods:f,loginButtonsStyle:y,preEnteredEmail:b})]})})})});e$.displayName="LoginModal";var e0=a(64299),e1=a.n(e0),e2=a(37652),e3=a(99390),e4=a(12718),e5=a(67121);let e8=s.memo(e=>{var t;let{upsellInformation:a,inFlight:l,position:i,onButtonClick:n,isLoading:d,textButtonIfSecondary:c=!1,hideUpsell:u,verticalLayout:m=!1}=e,{$t:h}=(0,o.A)(),v=(0,e2.e)(a,l,{hideUpsell:u}),g=(0,s.useCallback)(()=>{null==n||n(),v()},[n,v]),f=(0,s.useMemo)(()=>{if("router_steps"===i)return"inverted";switch(null==a?void 0:a.button_color){case e5.mq.MAX_COLOR:return"maxGold";case e5.mq.PRIMARY_COLOR:return"primary";case e5.mq.INVERTED:return"inverted";default:return"common"}},[null==a?void 0:a.button_color,i]),y=(0,s.useCallback)(e=>{let t;(null==a?void 0:a.icon_reference)==="labs"?t=(0,r.jsx)(U.A,{icon:eu.u,size:"sm"}):(null==a?void 0:a.icon_reference)==="comet_download"&&(t=(0,r.jsx)(e4.i,{size:16}));let l={size:e?"regular":"small",onClick:g,text:null==a?void 0:a.button_text,leadingComponent:t,textClassName:e?"!text-sm":void 0,fullWidth:!0,isLoading:d};return c&&(null==a?void 0:a.button_color)===e5.mq.SECONDARY_COLOR?(0,r.jsx)(P.A,{...l,variant:"super",noPadding:!0}):(0,r.jsx)(p.A,{...l,variant:f})},[f,g,null==a?void 0:a.button_color,null==a?void 0:a.button_text,null==a?void 0:a.icon_reference,c,d]);if(null==a?void 0:null===(t=a.cta_information)||void 0===t?void 0:t.secondary_permalink){let e=a.cta_information.secondary_permalink,t=a.cta_information.secondary_permalink_new_tab,l=(0,r.jsx)(P.A,{text:h({defaultMessage:"Learn more",id:"TdTXXf940t"}),fullWidth:!0,variant:"super",textClassName:"!text-sm",noPadding:!0,onClick:()=>{t?window.open(e,"_blank"):(0,e3.x)(e,"Learn more from upsell")}});return(0,r.jsx)("div",{className:"gap-md flex ".concat(m?"flex-col":"flex-row"),children:m?(0,r.jsxs)(r.Fragment,{children:[y(!0),l]}):(0,r.jsxs)(r.Fragment,{children:[l,y(!0)]})})}return y(!1)});function e6(e){let{onClose:t,announcementImageModal:a}=e,{imageUrlHd:l,imageUrlLowRes:i,title:n,description:o,upsellInformation:d}=a,[c,p]=(0,s.useState)(!1),[h,g]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=new Image;e.src=i,e.onload=()=>g(!0);let t=new Image;return t.src=l,t.onload=()=>p(!0),()=>{e.onload=null,t.onload=null}},[i,l]),(0,r.jsx)(v.A,{isOpen:!0,onClose:t,variant:"hide-chrome",actionList:eX.Ml,children:(0,r.jsxs)(u.Ay,{variant:"background",className:e1()("p-sm mx-auto flex w-[32rem] max-w-lg flex-col overflow-hidden rounded-xl transition-opacity duration-150 ease-in",{"opacity-100":h,"opacity-0":!h}),children:[(0,r.jsxs)("div",{className:"relative w-full overflow-hidden rounded-lg",children:[(0,r.jsx)("img",{src:i,alt:n,className:"w-full scale-[1.01] blur-[0.5px]"}),(0,r.jsx)("img",{src:l,alt:n,className:e1()("absolute inset-0 w-full transition-opacity duration-200 ease-out",{"opacity-100":c,"opacity-0":!c})})]}),(0,r.jsxs)("div",{className:"p-md gap-sm flex flex-col items-center text-center",children:[n&&(0,r.jsx)(m.A,{variant:"entry-title-200",children:n}),o&&(0,r.jsx)(m.A,{variant:"small",color:"light",className:"mb-sm px-1",children:o}),(0,r.jsx)("div",{className:"w-1/2",children:(0,r.jsx)(e8,{upsellInformation:d,hideUpsell:t,verticalLayout:!0})})]})]})})}e8.displayName="UpsellButton";var e7=a(15925);let e9=(0,eN.w)({path:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2 M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",name:"IconCamera",variant:"stroked"}),te=s.memo(e=>{let{isOpen:t,onClose:a,onCapture:l}=e,i=(0,s.useRef)(null),n=(0,s.useRef)(null),o=(0,s.useRef)(null),[d,c]=(0,s.useState)(!1),[u,h]=(0,s.useState)(null),[g,f]=(0,s.useState)(null),y=(0,s.useCallback)(async()=>{try{o.current&&o.current.getTracks().forEach(e=>e.stop());let e=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"user"}});o.current=e,i.current&&(i.current.srcObject=e,c(!0),f(null))}catch(e){f("Unable to access camera. Please check your permissions."),c(!1)}},[]),x=(0,s.useCallback)(()=>{o.current&&(o.current.getTracks().forEach(e=>e.stop()),o.current=null,c(!1)),i.current&&(i.current.srcObject=null)},[]),b=(0,s.useCallback)(()=>{if(i.current&&n.current){let e=i.current,t=n.current,a=t.getContext("2d");a&&(t.width=e.videoWidth,t.height=e.videoHeight,a.drawImage(e,0,0,t.width,t.height),h(t.toDataURL("image/jpeg",.95)),x())}},[x]),w=(0,s.useCallback)(()=>{h(null),y()},[y]),_=(0,s.useCallback)(()=>{f(null),y()},[y]),M=(0,s.useCallback)(()=>{x(),h(null),f(null),a()},[x,a]),C=(0,s.useCallback)(async()=>{if(u)try{let e=await fetch(u),t=await e.blob(),a=new File([t],"selfie.jpg",{type:"image/jpeg"});l(a),M()}catch(e){f("Failed to process the image. Please try again.")}},[u,l,M,f]);return(0,s.useEffect)(()=>(!t||u||g||y(),()=>{x()}),[t,u,g,y,x]),(0,r.jsxs)(v.A,{isOpen:t,onClose:M,title:"Take a Selfie",children:[(0,r.jsx)("div",{className:"p-lg",children:g?(0,r.jsxs)("div",{className:"gap-md flex h-[400px] flex-col items-center justify-center",children:[(0,r.jsx)(m.A,{variant:"base",color:"red",children:g}),(0,r.jsx)(p.A,{text:"Try again",variant:"primary",onClick:_})]}):u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-subtler relative aspect-video overflow-hidden rounded-lg",children:(0,r.jsx)(e7.A,{src:u,alt:"Captured selfie",className:"size-full object-contain"})}),(0,r.jsxs)("div",{className:"mt-lg gap-sm flex justify-center",children:[(0,r.jsx)(p.A,{text:"Retake",variant:"border",onClick:w}),(0,r.jsx)(p.A,{text:"Use this photo",variant:"primary",onClick:C})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-subtler relative aspect-video overflow-hidden rounded-lg",children:[(0,r.jsx)("video",{ref:i,autoPlay:!0,playsInline:!0,muted:!0,className:"size-full object-contain"}),!d&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)(m.A,{variant:"small",color:"light",children:"Starting camera..."})})]}),(0,r.jsxs)("div",{className:"mt-md gap-xs flex flex-col items-center",children:[(0,r.jsx)(m.A,{variant:"small",color:"light",className:"text-center",children:"Position your face in the center of the frame"}),(0,r.jsx)(m.A,{variant:"tiny",color:"ultraLight",className:"text-center",children:"Make sure your face is well-lit and clearly visible"})]}),(0,r.jsx)("div",{className:"mt-lg flex justify-center",children:(0,r.jsx)(p.A,{text:"Take photo",icon:e9,variant:"primary",onClick:b,disabled:!d})})]})}),(0,r.jsx)("canvas",{ref:n,className:"hidden"})]})});te.displayName="CameraCaptureModal";var tt=a(23095),ta=a(39053),tl=a(7);let tr=(0,eN.w)({path:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0 M13 12h5 M13 15h4 M13 18h1 M13 9h4 M13 6h1",name:"IconShadow",variant:"stroked"}),ts=(0,eN.w)({path:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0 M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",name:"IconSun",variant:"stroked"});var ti=a(63689);let tn=s.memo(e=>{let{setViewState:t}=e,{$t:a}=(0,o.A)(),l=(0,s.useCallback)(()=>t("create_avatar"),[t]);return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"mb-lg relative -mx-6 h-[600px] overflow-hidden rounded-lg",children:[(0,r.jsx)(e7.A,{src:"https://r2cdn.perplexity.ai/virtual-tryon-intro-avatars.png",alt:"Avatar preview",imageClassName:"h-full w-full object-cover object-top pointer-events-none bg-base",containerClassName:"flex-shrink-0",includeLightBoxModal:!1,className:"pointer-events-none"}),(0,r.jsxs)("div",{className:"from-base gap-md p-lg absolute inset-x-0 bottom-0 flex h-1/2 flex-col items-center justify-end bg-gradient-to-t from-35% to-transparent",children:[(0,r.jsx)("span",{className:"font-editorial text-3xl font-light",children:(0,r.jsx)(eh.A,{defaultMessage:"Skip the guesswork",id:"xUwopw2/ud"})}),(0,r.jsx)(m.A,{variant:"small",className:"max-w-[350px] text-pretty text-center",color:"light",children:(0,r.jsx)(eh.A,{defaultMessage:"Upload a photo, create your avatar, and explore how outfits look on your digital self.",id:"Mtc6VpYStx"})})]})]}),(0,r.jsx)("div",{className:"-mt-md flex justify-center",children:(0,r.jsx)(p.A,{text:a({defaultMessage:"Create your avatar",id:"pkptzIeNWN"}),variant:"primary",onClick:l})})]})});tn.displayName="IntroView";let to=s.memo(e=>{let{setViewState:t,uploadSelfie:a,setLocalPreviewUrl:l,isSelfieUploading:i}=e,{$t:n}=(0,o.A)(),[d,c]=(0,s.useState)(!1),u=(0,s.useCallback)(async e=>{var r;let s=null===(r=e.target.files)||void 0===r?void 0:r[0];s&&(l(URL.createObjectURL(s)),await a(s)&&t("choose_body")),e.target.value=""},[a,l,t]),h=(0,s.useCallback)(async e=>{l(URL.createObjectURL(e)),await a(e)&&t("choose_body")},[a,l,t]),v=(0,s.useCallback)(()=>{c(!0)},[]),g=(0,s.useCallback)(()=>{c(!1)},[]);return(0,r.jsxs)("div",{className:"gap-lg -mb-sm -mt-md flex flex-col",children:[(0,r.jsxs)("div",{className:"gap-sm flex flex-col items-center",children:[(0,r.jsx)(td,{step:2,totalSteps:4}),(0,r.jsx)("span",{className:"font-editorial text-3xl font-light",children:(0,r.jsx)(eh.A,{defaultMessage:"Take a selfie",id:"0H3vV1IwP1"})}),(0,r.jsx)(m.A,{variant:"small",className:"max-w-[400px] text-pretty text-center",color:"light",children:(0,r.jsx)(eh.A,{defaultMessage:"To create a personalized avatar, please upload a well lit, front-facing selfie.",id:"2hp5WUjFRc"})})]}),(0,r.jsxs)("div",{className:"gap-sm grid grid-cols-2 grid-rows-4",children:[(0,r.jsx)(tv,{image:"https://r2cdn.perplexity.ai/virtual-tryon-selfie.png",title:n({defaultMessage:"Front facing selfie",id:"v5qKOPNOwM"}),description:n({defaultMessage:"Simple front facing photo is all we need.",id:"7sBIYn49Jb"}),className:"!col-start-1 !row-span-4 !row-start-1"}),(0,r.jsx)(th,{title:n({defaultMessage:"Face fully visible",id:"I+I2q2Gn3a"}),icon:ti.v}),(0,r.jsx)(th,{title:n({defaultMessage:"Looking Forward",id:"79tlG9DGSR"}),icon:tl.H}),(0,r.jsx)(th,{title:n({defaultMessage:"Even natural light",id:"2OWeBoZV0d"}),icon:ts}),(0,r.jsx)(th,{title:n({defaultMessage:"No harsh shadows",id:"vXaeUswXsx"}),icon:tr})]}),(0,r.jsx)("div",{className:"gap-sm flex justify-center",children:i?(0,r.jsxs)("div",{className:"px-md py-sm gap-sm bg-subtle flex items-center rounded-lg",children:[(0,r.jsx)(ta.y,{}),(0,r.jsx)(m.A,{variant:"baseSemi",children:(0,r.jsx)(eh.A,{defaultMessage:"Uploading...",id:"JEsxDwhXPG"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"file",accept:"image/*",className:"absolute hidden",id:"shopping-try-on-file-input",onChange:u}),(0,r.jsx)(p.A,{text:n({defaultMessage:"Take a selfie",id:"0H3vV1IwP1"}),icon:e9,variant:"common",onClick:v}),(0,r.jsxs)("label",{htmlFor:"shopping-try-on-file-input",className:"px-md py-sm gap-sm bg-super active:ease-outExpo group flex origin-center transform-gpu cursor-pointer select-none flex-row items-center whitespace-nowrap rounded-lg duration-300 hover:opacity-80 active:scale-[0.97] active:duration-150",children:[(0,r.jsx)(m.A,{children:(0,r.jsx)(U.A,{icon:eR.n,size:"md",className:"text-white dark:text-black"})}),(0,r.jsx)(m.A,{variant:"baseSemi",color:"defaultInverted",children:(0,r.jsx)(eh.A,{defaultMessage:"Upload a selfie",id:"bODqv8TA31"})})]})]})}),(0,r.jsx)(te,{isOpen:d,onClose:g,onCapture:h})]})});to.displayName="CreateAvatarView";let td=e=>{let{step:t,totalSteps:a}=e;return(0,r.jsx)(u.Ay,{className:"py-xs flex flex-row items-center justify-center rounded",children:(0,r.jsx)("div",{className:"bg-subtle w-xl h-xs relative overflow-hidden rounded-full",children:(0,r.jsx)("div",{className:"bg-dark h-full transition-all duration-300",style:{width:"".concat(t/a*100,"%")}})})})},tc=s.memo(e=>{let{setViewState:t,generateDefaultAvatar:a,selfieUrl:l,uploadPhoto:i,generateCustomAvatar:n,setLocalPreviewUrl:c}=e,{$t:u}=(0,o.A)(),{trackEvent:h}=(0,d.yw)(),[v,g]=(0,s.useState)("default"),[f,y]=(0,s.useState)(!1),x=(0,s.useCallback)(()=>{l&&(h("selfie provided"),t("generating_avatar"),a(l),h("avatar generated"))},[t,a,l,h]),b=(0,s.useCallback)(()=>{let e=document.getElementById("choose-body-file-input");e&&e.click()},[]),w=(0,s.useCallback)(()=>{"default"===v?x():b()},[v,x,b]),_=(0,s.useCallback)(()=>{g("default")},[]),M=(0,s.useCallback)(()=>{g("your")},[]),C=(0,s.useCallback)(async e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(r){if(!l)return;h("full body provided"),c(URL.createObjectURL(r));try{y(!0);let e=await i(r);e&&(t("generating_avatar"),n(l,e),h("avatar generated"))}finally{y(!1)}}e.target.value=""},[i,n,l,c,t,h]);return(0,r.jsxs)("div",{className:"gap-xl flex flex-col",children:[(0,r.jsxs)("div",{className:"gap-sm flex flex-col items-center",children:[(0,r.jsx)(td,{step:4,totalSteps:4}),(0,r.jsx)("span",{className:"font-editorial text-3xl font-light",children:(0,r.jsx)(eh.A,{defaultMessage:"Choose your avatar body",id:"+VyjlR/lAC"})}),(0,r.jsx)(m.A,{variant:"small",className:"max-w-[400px] text-pretty text-center",color:"light",children:(0,r.jsx)(eh.A,{defaultMessage:"You can continue with a default body or create a more personalized avatar with your body.",id:"cWLZ08Ydju"})})]}),(0,r.jsxs)("div",{className:"gap-md grid grid-cols-2",children:[(0,r.jsx)(tu,{onClick:_,title:u({defaultMessage:"Default body",id:"vO54ZADRPV"}),description:u({defaultMessage:"Uses a generic body shape, no photo needed",id:"ZuGM1SxB8y"}),selected:"default"===v}),(0,r.jsx)(tu,{onClick:M,title:u({defaultMessage:"Your body",id:"7ZKFrdUySm"}),description:u({defaultMessage:"Uses a full body photo to create a custom body",id:"ddPGzyfCV3"}),selected:"your"===v})]}),(0,r.jsxs)("div",{className:"flex justify-center",children:[(0,r.jsx)("input",{type:"file",accept:"image/*",className:"absolute hidden",id:"choose-body-file-input",onChange:C}),(0,r.jsx)(p.A,{text:u(f?{defaultMessage:"Uploading full body photo...",id:"Xg5+S5kxLh"}:"default"===v?{defaultMessage:"Continue with default",id:"zlYIh9m2kM"}:{defaultMessage:"Upload full body photo",id:"VD13bqnxFO"}),icon:"default"===v?ti.v:eR.n,isLoading:f,disabled:f,variant:"primary",onClick:w})]})]})});tc.displayName="ChooseBodyView";let tu=e=>{let{onClick:t,title:a,description:l,selected:s}=e;return(0,r.jsxs)(u.Ay,{className:e1()("gap-xs p-md !ring-super relative flex cursor-pointer flex-col rounded-xl border duration-150",s?"!border-transparent ring-2":"ring-0"),onClick:t,children:[(0,r.jsx)("div",{className:"mb-sm aspect-square overflow-hidden rounded-md",children:(0,r.jsx)(e7.A,{src:"/static/images/tryon/avatar_body.png",alt:"Default body",imageClassName:"size-full object-contain invert opacity-10",containerClassName:"size-full",maskClassName:"bg-transparent",includeLightBoxModal:!1,draggable:!1})}),(0,r.jsx)(m.A,{variant:"baseSemi",className:"text-center",children:a}),(0,r.jsx)(m.A,{variant:"small",className:"px-md text-pretty text-center",color:"light",children:l})]})},tm=s.memo(e=>{let{status:t,onClose:a,onBack:l,resultUrl:i,saveAvatar:n,onSuccessfulOnboarding:c}=e,{$t:h}=(0,o.A)(),[v,g]=(0,s.useState)(!1),{trackEvent:f}=(0,d.yw)(),y=(0,s.useCallback)(async()=>{f("avatar retry clicked"),l()},[f,l]),x=(0,s.useCallback)(async()=>{if(i&&"success"===t&&!v){g(!0);let e=await n(i);a(),g(!1),c(e)}else g(!1),a()},[a,i,t,n,c,v]);return(0,r.jsxs)("div",{className:"gap-lg flex flex-col",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(u.Ay,{className:e1()("gap-sm relative isolate flex flex-col overflow-hidden rounded-lg border"),children:i&&(0,r.jsx)(e7.A,{src:i,alt:"Your Avatar",imageClassName:"max-h-[500px] max-w-full object-contain",containerClassName:"flex justify-center",includeLightBoxModal:!1})})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)(m.A,{variant:"page-title",className:"text-center",children:(0,r.jsx)(eh.A,{defaultMessage:"Your new virtual you",id:"LoEf9iMkXR"})}),(0,r.jsx)(m.A,{variant:"small",className:"text-center",color:"light",children:(0,r.jsx)(eh.A,{defaultMessage:"Your personalized avatar is ready",id:"MLiXNgEouW"})})]}),(0,r.jsxs)("div",{className:"gap-sm flex justify-center",children:[(0,r.jsx)(p.A,{text:h({defaultMessage:"Retry",id:"62nsdyMyIO"}),variant:"border",onClick:y,disabled:v}),(0,r.jsx)(p.A,{text:h({defaultMessage:"Start Shopping",id:"BRgXJINE++"}),variant:"primary",onClick:x,disabled:"success"!==t||v,isLoading:v})]})]})});tm.displayName="ConfirmAvatarView";let tp=s.memo(e=>{let{localPreviewUrl:t,onClose:a}=e,{$t:l}=(0,o.A)(),i=(0,s.useMemo)(()=>{if(t)return{image:t,name:"Avatar Preview",status:e5.kp.IN_PROGRESS,type:"image",medium:"image",author_name:"PPLX",author_url:"https://pplx.ai",image_width:100,image_height:100,url:t,source:"pplx",thumbnail:t,dark_image_url:t,locations:[],thumbnail_height:100,thumbnail_width:100,sponsored_uuid:"",ad_content_uuid:"",modal_url:"",low_res_image:"",generated_media_metadata:void 0}},[t]);return(0,r.jsxs)("div",{className:"gap-lg flex flex-col",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)(m.A,{variant:"page-title",className:"text-center",children:(0,r.jsx)(eh.A,{defaultMessage:"Working on your avatar",id:"9nXG80mtI6"})}),(0,r.jsx)(m.A,{variant:"small",className:"text-center",color:"light",children:(0,r.jsx)(eh.A,{defaultMessage:"You can continue shopping while we create your virtual you. It shouldn't be long.",id:"Z5TNVvv3SP"})})]}),(0,r.jsxs)("div",{className:"gap-lg flex flex-col items-center",children:[(0,r.jsx)(u.Ay,{className:"gap-sm relative isolate flex aspect-[252/336] w-full max-w-[400px] flex-col overflow-hidden rounded-lg border",children:(0,r.jsx)(tt.j,{generating:!0,media:i})}),(0,r.jsx)(p.A,{text:l({defaultMessage:"Continue shopping",id:"Yywm0pqtZa"}),variant:"primary",onClick:a})]})]})});tp.displayName="GeneratingAvatarView";let th=s.memo(e=>{let{title:t,icon:a}=e;return(0,r.jsx)(u.Ay,{className:"gap-sm p-sm flex flex-col items-center justify-center rounded-lg border",children:(0,r.jsxs)(m.A,{variant:"smallBold",className:"gap-xs flex flex-row items-center",children:[(0,r.jsx)(U.A,{icon:a,size:"md"}),t]})})});th.displayName="InfoCell";let tv=s.memo(e=>{let{image:t,title:a,className:l,description:s}=e;return(0,r.jsxs)(u.Ay,{className:e1()("gap-sm relative col-start-2 row-start-2 flex flex-col overflow-hidden rounded-lg border",l),children:[t&&(0,r.jsx)(e7.A,{src:t,alt:"Intro",imageClassName:"w-full object-cover object-top pointer-events-none max-h-[175px]",containerClassName:"flex-shrink-0",includeLightBoxModal:!1,className:"pointer-events-none"}),(0,r.jsxs)("div",{className:"from-base gap-xs p-md absolute inset-0 flex flex-col items-center justify-end bg-gradient-to-t from-5% to-transparent",children:[(0,r.jsx)(m.A,{variant:"smallBold",className:"flex items-end justify-center text-center",children:a}),s&&(0,r.jsx)(m.A,{variant:"tinyRegular",className:"text-pretty text-center leading-tight",color:"light",children:s})]})]})});tv.displayName="InstructionCell";var tg=a(35190);let tf=s.memo(e=>{let{isOpen:t,onClose:a,onSuccessfulOnboarding:l}=e,{status:i,resultUrl:n,selfieUrl:o,uploadSelfie:d,generateDefaultAvatar:c,generateCustomAvatar:u,uploadPhoto:m,saveAvatar:p,resetState:h,setShouldAutoSaveAvatar:g}=(0,tg.Q)({reason:"shopping-try-on-onboarding"}),[f,y]=(0,s.useState)("intro"),[x,b]=(0,s.useState)(null),[w,_]=(0,s.useState)(null),M=(0,s.useCallback)(e=>{b(t=>(t&&t!==e&&URL.revokeObjectURL(t),e))},[]),C=(0,s.useCallback)(()=>{"processing"===i&&"generating_avatar"===f?g(!0):h(),y("intro"),_(null),a()},[a,h,i,f,g]);(0,s.useEffect)(()=>{!t&&x&&(URL.revokeObjectURL(x),b(null))},[t,x]),(0,s.useEffect)(()=>{"generating_avatar"===f&&("success"===i&&n?y("confirm_avatar"):"error"===i&&(y("choose_body"),_(null)))},[f,i,n]);let j=(0,s.useCallback)(()=>y("create_avatar"),[]),A=(0,s.useCallback)(e=>(_("selfie"),d(e)),[d]),E=(0,s.useCallback)(e=>(_("body"),m(e)),[m]);return(0,r.jsx)(v.A,{isOpen:t,onClose:C,modalClassname:"light",children:(0,r.jsxs)("div",{className:"size-full",children:["intro"===f&&(0,r.jsx)(tn,{setViewState:y}),"create_avatar"===f&&(0,r.jsx)(to,{setViewState:y,uploadSelfie:A,setLocalPreviewUrl:M,isSelfieUploading:"uploading"===i&&"selfie"===w}),"choose_body"===f&&(0,r.jsx)(tc,{setViewState:y,generateDefaultAvatar:c,selfieUrl:o,uploadPhoto:E,generateCustomAvatar:u,setLocalPreviewUrl:M}),"generating_avatar"===f&&(0,r.jsx)(tp,{localPreviewUrl:x,onClose:C}),"confirm_avatar"===f&&(0,r.jsx)(tm,{status:i,onClose:C,onBack:j,resultUrl:n,saveAvatar:p,onSuccessfulOnboarding:l})]})})});tf.displayName="ShoppingTryOnOnboardingModal";var ty=a(14479);let tx=s.memo(()=>(0,r.jsx)("div",{className:"bg-base fixed inset-0 z-[999] flex h-screen w-screen items-center justify-center opacity-50"}));tx.displayName="VoiceToVoiceModalLoader";var tb=a(89744),tw=a(41290);let t_=(0,tw.Q)(async()=>{let{MarkSpinner:e}=await a.e(5638).then(a.bind(a,63257));return{default:e}}),tM=s.memo(e=>{var t;let{entryUUID:a,frontendContextUUID:l,contextUUID:i,webResults:n,isOpen:c,onClose:p,extendedBeforeContext:h,beforeContext:g,selectedText:f,afterContext:y,state:x}=e,{$t:b}=(0,o.A)(),{isMobileStyle:w}=(0,eW.al)(),{trackEvent:_}=(0,d.yw)(),M=(0,s.useCallback)((e,t)=>{_(e,{entryUUID:a,frontendContextUUID:l,contextUUID:i,selectedTextExtendedBeforeContext:h,selectedTextBeforeContext:g,selectedText:f,selectedTextAfterContext:y,...t})},[a,l,i,h,g,f,y,_]),C=null!==(t=null==n?void 0:n.length)&&void 0!==t?t:0,j="completed"===x?0===C?b({defaultMessage:"No sources",id:"tN3HZvczgp"}):b({defaultMessage:"{sources, plural, one {# source} other {# sources}}",id:"oWRBjE1HK2"},{sources:C}):b("loading"===x?{defaultMessage:"Checking...",id:"1SvspNS1us"}:{defaultMessage:"Error",id:"KN7zKn8z4F"}),A=(0,s.useMemo)(()=>(0,r.jsxs)("div",{className:"gap-sm md:gap-md flex items-center",children:[(0,r.jsx)(t_,{size:32,shouldAnimate:"loading"===x}),(0,r.jsx)(m.A,{variant:"page-title",className:e1()("mr-lg line-clamp-1 md:line-clamp-2"),children:j})]}),[x,j]);return(0,r.jsxs)(v.A,{isOpen:c,variant:w?"bottom-left-sheet":"side-sheet",onClose:p,titleContent:A,children:[(0,r.jsxs)(m.A,{children:[(0,r.jsx)("span",{children:g}),(0,r.jsx)("span",{className:"bg-super/30 font-bold",children:f}),(0,r.jsx)("span",{children:y})]}),(0,r.jsx)("hr",{className:"border-subtlest my-4 w-full border-t"}),(0,r.jsx)(u.Ay,{className:"gap-md flex h-full flex-col items-start",children:null==n?void 0:n.map((e,t)=>(0,r.jsx)("div",{className:"gap-sm flex w-full min-w-0 flex-row-reverse",children:(0,r.jsx)(tb.g,{result:e,idx:t,isSelected:!1,variant:"modal",trackEvent:M})},t))})]})});tM.displayName="CheckSourcesModal";var tC=a(93887),tj=a(53511),tA=a(4428),tE=a(89573),tS=a(65811);let tk={linear_alt:{name:"Linear",tagline:(0,ep.zR)({defaultMessage:"Plan and track projects, issues, and team workflows in Linear",id:"6u9Zf65BGW"}),bullets:[(0,ep.zR)({defaultMessage:"Search across Linear issues, projects, and teams",id:"MicGE6HssU"}),(0,ep.zR)({defaultMessage:"Create and update Linear issues and projects",id:"scUqB1LbKr"}),(0,ep.zR)({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Linear whenever you query in Perplexity",id:"b/8mLQxIqE"})],developer:(0,ep.zR)({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://www.linear.app",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12167711-linear-connector-for-enterprise-pro",footnote:{link:"https://www.perplexity.ai/help-center/en/articles/12167711-linear-connector-for-enterprise-pro",text:(0,ep.zR)({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},google_drive:{name:"Google Drive",tagline:(0,ep.zR)({defaultMessage:"Get in-depth answers from your Google Drive content",id:"CDmY5AQsRD"}),bullets:[(0,ep.zR)({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),(0,ep.zR)({defaultMessage:"Updates to your Google Drive files are automatically synced to Perplexity",id:"k0B4qzv3NH"}),(0,ep.zR)({defaultMessage:"File and folder selection is based on your existing Google Drive permissions",id:"J1Fu/3n3pb"})],consumerBullets:[(0,ep.zR)({defaultMessage:"Attach files from Google Drive to your query",id:"aUk7jts0tb"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://drive.google.com",supportUrl:null,documentationUrl:null,footnote:null},sharepoint:{name:"SharePoint",tagline:(0,ep.zR)({defaultMessage:"Get in-depth answers from your SharePoint content",id:"H/XGo2cLQi"}),bullets:[(0,ep.zR)({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),(0,ep.zR)({defaultMessage:"Updates to your SharePoint files are automatically synced to Perplexity",id:"3asA6JKlOn"}),(0,ep.zR)({defaultMessage:"File and folder selection is based on your existing SharePoint permissions",id:"m2/iFnRhkg"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://microsoft.sharepoint.com/",supportUrl:null,documentationUrl:null,footnote:null},onedrive:{name:"OneDrive",tagline:(0,ep.zR)({defaultMessage:"Get in-depth answers from your OneDrive content",id:"6HI2ZlxJGV"}),bullets:[(0,ep.zR)({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),(0,ep.zR)({defaultMessage:"Updates to your OneDrive files are automatically synced to Perplexity",id:"gCHhNKes4R"}),(0,ep.zR)({defaultMessage:"File and folder selection is based on your existing OneDrive permissions",id:"YCVPoXax40"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.microsoft.com/en-us/microsoft-365/onedrive/online-cloud-storage",documentationUrl:null,supportUrl:null,footnote:null},box:{name:"Box",tagline:(0,ep.zR)({defaultMessage:"Get in-depth answers from your Box content",id:"vj5W7AIDE6"}),bullets:[(0,ep.zR)({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),(0,ep.zR)({defaultMessage:"Updates to your Box files are automatically synced to Perplexity",id:"tkl3HRlwOf"}),(0,ep.zR)({defaultMessage:"File and folder selection is based on your existing Box permissions",id:"LuX1iT7lFa"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"http://www.box.com/",documentationUrl:null,supportUrl:null,footnote:null},dropbox:{name:"Dropbox",tagline:(0,ep.zR)({defaultMessage:"Get in-depth answers from your Dropbox content",id:"+RPvqEE51/"}),bullets:[(0,ep.zR)({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),(0,ep.zR)({defaultMessage:"Updates to your Dropbox files are automatically synced to Perplexity",id:"Qnsbs8527p"}),(0,ep.zR)({defaultMessage:"File and folder selection is based on your existing Dropbox permissions",id:"kzOZ3ZFcW4"})],consumerBullets:[(0,ep.zR)({defaultMessage:"Attach files from Dropbox to your query",id:"E/rzAALT5B"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"http://www.dropbox.com/",documentationUrl:null,supportUrl:null,footnote:null},notion_mcp:{name:"Notion",tagline:(0,ep.zR)({defaultMessage:"Search and create content on your Notion pages",id:"rXdfDrSVlj"}),bullets:[(0,ep.zR)({defaultMessage:"Search across your pages and data ",id:"Ib2j2yH5wv"}),(0,ep.zR)({defaultMessage:"Create new pages in your teamspace from Perplexity",id:"Ltbp+B60OB"}),(0,ep.zR)({defaultMessage:"Update your data on existing pages directly from Perplexity",id:"ldpNlZAKLQ"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Notion whenever you query in Perplexity",id:"nbLEAiWYzT"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"http://www.notion.so/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12167654-notion-connector-for-enterprise-pro",footnote:null},github_mcp_direct:{name:"GitHub",tagline:(0,ep.zR)({defaultMessage:"Search and manage your GitHub repositories ",id:"4miSrKjLad"}),bullets:[(0,ep.zR)({defaultMessage:"Search, analyze, and summarize your repositories and issues",id:"hi8CvW/ld8"}),(0,ep.zR)({defaultMessage:"Create, update, and manage issues and pull requests ",id:"6eZgVvjZEw"}),(0,ep.zR)({defaultMessage:"Monitor workflows ",id:"EduR5immBI"}),(0,ep.zR)({defaultMessage:"Search and manage notifications to streamline communication",id:"+zOuCOpAH8"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to GitHub whenever you query in Perplexity",id:"9EQO9mj0sd"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://github.com/",supportUrl:"https://www.perplexity.ai/help-center/en/articles/12275669-github-connector-for-enterprise",documentationUrl:null,footnote:null},asana_mcp_direct:{name:"Asana",tagline:(0,ep.zR)({defaultMessage:"Plan and track projects, tasks, and team workflows in Asana",id:"9AhVP0Y+6c"}),bullets:[(0,ep.zR)({defaultMessage:"Search across Asana tasks, projects, and teams",id:"GKC+Sx/2dm"}),(0,ep.zR)({defaultMessage:"Create and update Asana tasks and projects",id:"TnQ0Far/ZY"}),(0,ep.zR)({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Asana whenever you query in Perplexity",id:"9NNVAEg7U3"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://asana.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12524801-connecting-perplexity-with-asana",footnote:null},asana_mcp_merge:{name:"Asana",tagline:(0,ep.zR)({defaultMessage:"Plan and track projects, tasks, and team workflows in Asana",id:"9AhVP0Y+6c"}),bullets:[(0,ep.zR)({defaultMessage:"Search across Asana tasks, projects, and teams",id:"GKC+Sx/2dm"}),(0,ep.zR)({defaultMessage:"Create and update Asana tasks and projects",id:"TnQ0Far/ZY"}),(0,ep.zR)({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Asana whenever you query in Perplexity",id:"9NNVAEg7U3"})],developer:(0,ep.zR)({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://asana.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12524801-connecting-perplexity-with-asana",footnote:{link:"https://www.perplexity.ai/help-center/en/articles/12524801-connecting-perplexity-with-asana",text:(0,ep.zR)({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},atlassian_mcp_direct:{name:"Atlassian",tagline:(0,ep.zR)({defaultMessage:"Plan and track projects, tasks, and team workflows in Atlassian",id:"OKCrVfJwqD"}),bullets:[(0,ep.zR)({defaultMessage:"Search across Atlassian tasks, projects, and teams",id:"3UDuuWRtR5"}),(0,ep.zR)({defaultMessage:"Create and update Atlassian tasks and projects",id:"u+44P4c8w+"}),(0,ep.zR)({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Atlassian whenever you query in Perplexity",id:"7gmOJCXim3"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.atlassian.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/collections/15347354-app-connectors",footnote:null},jira_mcp_merge:{name:"Jira",tagline:(0,ep.zR)({defaultMessage:"Plan and track projects, tasks, and team workflows in Jira",id:"DBNOet3M55"}),bullets:[(0,ep.zR)({defaultMessage:"Search across Jira tasks, projects, and teams",id:"nWIt8qYQz1"}),(0,ep.zR)({defaultMessage:"Create and update Jira tasks and projects",id:"mUCQ5Z26EF"}),(0,ep.zR)({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Jira whenever you query in Perplexity",id:"CfzDXfmKKD"})],developer:(0,ep.zR)({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://www.atlassian.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12524825-connecting-perplexity-with-jira",footnote:{link:"https://www.perplexity.ai/help-center/en/articles/12524825-connecting-perplexity-with-jira",text:(0,ep.zR)({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},confluence_mcp_merge:{name:"Confluence",tagline:(0,ep.zR)({defaultMessage:"Search and create content on your Confluence pages",id:"7maYua4COa"}),bullets:[(0,ep.zR)({defaultMessage:"Search across your pages and data ",id:"Ib2j2yH5wv"}),(0,ep.zR)({defaultMessage:"Create new pages in your teamspace from Perplexity",id:"Ltbp+B60OB"}),(0,ep.zR)({defaultMessage:"Update your data on existing pages directly from Perplexity",id:"ldpNlZAKLQ"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Confluence whenever you query in Perplexity",id:"Ifp49Im16y"})],developer:(0,ep.zR)({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://www.atlassian.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12524852-connecting-perplexity-with-confluence",footnote:{link:"https://www.perplexity.ai/help-center/en/articles/12524852-connecting-perplexity-with-confluence",text:(0,ep.zR)({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},microsoft_teams_mcp_merge:{name:"Microsoft Teams",tagline:(0,ep.zR)({defaultMessage:"Search and send messages in Microsoft Teams",id:"Rfl+yanh+2"}),bullets:[(0,ep.zR)({defaultMessage:"Search across Microsoft Teams messages and channels",id:"LF+Ow88sFq"}),(0,ep.zR)({defaultMessage:"Send and receive messages in Microsoft Teams",id:"1t8qQ+bxf2"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Microsoft Teams whenever you query in Perplexity",id:"+bTrwFjG66"})],developer:(0,ep.zR)({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://teams.microsoft.com",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/collections/15347354-app-connectors",footnote:{link:"https://www.perplexity.ai/help-center/en/collections/15347354-app-connectors",text:(0,ep.zR)({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},slack_direct:{name:"Slack",tagline:(0,ep.zR)({defaultMessage:"Search and post messages across your Slack workspace",id:"eGJ5wb/MzJ"}),bullets:[(0,ep.zR)({defaultMessage:"Search messages across DMs, private channels, and public channels you have access to in Slack",id:"Om6FOnY7N3"}),(0,ep.zR)({defaultMessage:"Post messages directly to Slack",id:"UOgLjThccO"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Slack whenever you run a query in Perplexity",id:"Fy/OA6Fd79"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://slack.com",supportUrl:"https://www.perplexity.ai/help-center/en/articles/12167980-using-the-connector-for-slack",documentationUrl:null,footnote:null},gcal:{name:"Gmail with Calendar",tagline:(0,ep.zR)({defaultMessage:"Search, create, and manage your emails and calendar events",id:"R3VofVJjT+"}),bullets:[(0,ep.zR)({defaultMessage:"Search your Gmail and calendar",id:"GCr38D/MA3"}),(0,ep.zR)({defaultMessage:"Draft and send emails",id:"rMtvi6WyKE"}),(0,ep.zR)({defaultMessage:"Manage and monitor emails and events",id:"p70DVe/3eQ"}),(0,ep.zR)({defaultMessage:"Create and update calendar events",id:"ZLhGXocN5/"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Gmail and Gcal whenever you query in Perplexity",id:"HsjdaQ7NYa"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://accounts.google.com/InteractiveLogin?emr=1&ltmpl=default&nojavascript=1&rm=false&service=mail&ss=1",documentationUrl:null,supportUrl:null,footnote:null},outlook:{name:"Outlook",tagline:(0,ep.zR)({defaultMessage:"Search your emails and calendar events",id:"zNVRcAj90b"}),bullets:[(0,ep.zR)({defaultMessage:"Search your Outlook e-mail and calendar",id:"z5Tw6ljNsF"}),(0,ep.zR)({defaultMessage:"Manage and monitor emails and events",id:"p70DVe/3eQ"}),(0,ep.zR)({defaultMessage:"Data is retrieved from and written back to Outlook whenever you query in Perplexity",id:"xX8KEtSv2M"})],developer:(0,ep.zR)({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.microsoft.com/en-us/microsoft-365/outlook/log-in",documentationUrl:null,supportUrl:null,footnote:null}};var tN=a(14036),tT=a(83991),tI=a(76825);let tR=e=>e in tk,tP=e=>{let{$t:t}=(0,o.A)(),{isEnterprise:a}=(0,tN.zm)({reason:"connectors-enable-modal"}),{data:l}=(0,tS.i)(),r=(0,s.useMemo)(()=>null==l?void 0:l.find(t=>t.id===e),[l,e]);return(0,s.useMemo)(()=>{if(tR(e)){let{websiteUrl:l,documentationUrl:r,tagline:s,supportUrl:i="https://www.perplexity.ai/help-center/en/articles/10672063-introduction-to-file-connectors-for-enterprise-organizations",footnote:n,consumerBullets:o,bullets:d}=tk[e],c=[{label:"Website",url:l,icon:eB.A}];return r&&c.push({label:"Documentation",url:r,icon:tT.L}),i&&c.push({label:"Support",url:i,icon:tI.L}),{name:(0,ej.wg)(e),tagline:s?t(s):null,footnote:n?{link:n.link,text:t(n.text)}:null,bullets:(!a&&o?o:d).map(e=>t(e)),links:c}}if(r){var l;let{name:e,display_name:t,description:a,long_description:s,homepage:i}=r.manifest,n=[];return i&&n.push({label:"Website",url:i,icon:eB.A}),{name:null!=t?t:e,tagline:a,footnote:null,bullets:null!==(l=null==s?void 0:s.split("\n").map(e=>e.trim()).filter(Boolean))&&void 0!==l?l:[],links:n}}return{name:e,tagline:null,footnote:null,bullets:[],links:[]}},[t,e,a,r])};var tO=a(10173),tD=a(34819);let tL=async e=>{let{connectionType:t,reason:a,referrer:l,referrerId:r}=e;try{let e={connection_type:t};l&&(e.referrer=l),r&&(e.referrer_id=r);let{data:s,error:i}=await x.By.GET("/rest/connections/connect",a,{params:{query:e},timeoutMs:(0,x.e4)()});if(i)throw Error("Failed to get ".concat(t," connection url"),{cause:i});return s}catch(e){throw b.vF.error("Error fetching ".concat(t," connection url:"),e),e}},tU=async e=>{let{connectionType:t,reason:a}=e;try{let{data:e,error:l}=await x.By.GET("/rest/connections/oauth_callback_merge",a,{params:{query:{connection_type:t}},timeoutMs:(0,x.e4)()});if(l)throw Error("Failed to handle OAuth callback for ".concat(t),{cause:l});return e}catch(e){throw b.vF.error("Error handling OAuth callback for ".concat(t,":"),e),e}};var tF=a(92988),tz=a(47603);let tB=(0,tF.j)("MergeAgentHandlerContext",null),tH=()=>{let e=(0,s.useContext)(tB);if(!e)throw Error("useMergeAgentHandler must be used within a MergeAgentHandlerProvider");return e},tq=e=>{let{children:t}=e,a=(0,E.useQueryClient)(),[l,i]=(0,s.useState)(null),n=(0,s.useCallback)(async()=>{let{connectionType:e,onError:t,onSuccess:r}=null!=l?l:{};if(!e){let e=Error("Connection type is not defined for OAuth callback");tz.vF.error("Connection type is not defined for OAuth callback"),null==t||t(e);return}try{await tU({reason:"merge_oauth_success",connectionType:e}),a.invalidateQueries({queryKey:(0,ef.U_)()}),null==r||r()}catch(e){tz.vF.error("Failed to handle OAuth callback:",e),null==t||t(e)}finally{i(null)}},[l,a]),o=(0,s.useCallback)(()=>{let{onExit:e}=null!=l?l:{};i(null),null==e||e()},[l]),d=(0,tD.n)({linkToken:(null==l?void 0:l.token)||"",onSuccess:n,onExit:o});(0,s.useEffect)(()=>{(null==l?void 0:l.token)&&d()},[null==l?void 0:l.token,d]);let c=(0,s.useCallback)(e=>{i(e)},[]),u=(0,s.useCallback)(()=>{i(null)},[]),m=(0,s.useMemo)(()=>({startMergeAuth:c,clearActiveAuth:u}),[c,u]);return(0,r.jsx)(tB.Provider,{value:m,children:t})};var tG=a(7631),tQ=a(62615);class tV extends Error{constructor(){super("Merge auth cancelled")}}let tK=e=>{let{reason:t}=e,{trackEvent:a}=(0,d.yw)(),{deprecatedOpenToast:l}=(0,g.G)(),{$t:r}=(0,o.A)(),i=(0,tQ.a8)(),{startMergeAuth:n}=tH(),{handleConnect:c}=(0,tO.G)({reason:t}),u=(0,s.useCallback)(async(e,s,o)=>{if(!s){b.vF.error("Connection type is not defined for OAuth callback",{connectorId:e});return}if((0,tG._r)(s)){try{let{redirect_url:a,token:l}=await tL({connectionType:s,reason:t,referrer:null==o?void 0:o.referrer,referrerId:null==o?void 0:o.referrerId});if(a)(0,e3.x)(a,"Enabling connector");else if(l)await new Promise((t,a)=>{n({token:l,connectionType:s,connectorName:e,onSuccess:t,onExit:()=>a(new tV)})});else throw Error("No redirect URL or token received")}catch(e){if(e instanceof tV)throw e;l(r({defaultMessage:"Unable to start connection.",id:"SPIzcd/Xa2"}),"error",3)}return}if("GCAL"===s){await c({connectorName:e,redirectPath:i||void 0,unauthedRedirectPath:i||void 0});return}await c({connectorName:e}),a("attempt connector authentication",{connectorName:e})},[r,i,t,c,l,a,n]);return(0,s.useMemo)(()=>({enableConnection:u}),[u])},tW=e=>(0,r.jsx)(tq,{children:(0,r.jsx)(tY,{...e})}),tY=e=>{let{connectorName:t,connectorAvatar:a,showModal:l,setShowModal:i,connectionType:n,reason:d,referrer:c,referrerId:h,badge:g,handleEnable:f}=e,{$t:y}=(0,o.A)(),{name:x,tagline:b,footnote:w,bullets:_,links:M}=tP(t),{enableConnection:C}=tK({reason:d}),{mutate:j,isPending:A}=(0,tA.useMutation)({mutationFn:async()=>{f?await f():await C(t,n,{referrer:c,referrerId:h})},onSuccess:()=>{i(!1)}}),E=(0,s.useCallback)(()=>{j()},[j]);return(0,r.jsx)(v.A,{isOpen:l,onClose:()=>i(!1),variant:"large",modalContentClassname:"!py-0 w-full",modalClassname:"!max-w-2xl !w-screen",wrapperClassname:"w-full",noPadding:!0,children:(0,r.jsxs)(u.Ay,{className:"flex flex-col gap-6 px-3 pb-6 pt-2",children:[(0,r.jsxs)(u.Ay,{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[a&&(0,r.jsx)(tE.h,{serverName:x,iconUrl:a,border:!0}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.A,{variant:"section-title",children:x}),g]}),b&&(0,r.jsx)(m.A,{variant:"small",color:"light",className:"text-pretty",children:b})]})]}),(0,r.jsx)(p.A,{text:y(A?{defaultMessage:"Adding...",id:"Nvr5CeqKuU"}:{defaultMessage:"Add connector",id:"QDa8Q+GNMs"}),size:"small",variant:"primary",isLoading:A,disabled:A,onClick:E,extraCSS:"rounded-full sm:ml-auto"})]}),(null==_?void 0:_.length)>0&&(0,r.jsxs)("section",{className:"flex flex-col gap-2",children:[(0,r.jsx)(m.A,{variant:"baseSemi",children:y({defaultMessage:"Overview:",id:"75gRjsa29W"})}),(0,r.jsx)("ul",{children:_.map((e,t)=>(0,r.jsx)(m.A,{variant:"small",as:"li",className:"mb-xs ml-4 list-disc text-pretty last:mb-0",children:e},t))})]}),M.length>0&&(0,r.jsxs)("section",{className:"flex flex-col gap-2",children:[(0,r.jsx)(m.A,{variant:"baseSemi",children:y({defaultMessage:"Links",id:"qCcwo3DU78"})}),(0,r.jsx)("ul",{className:"flex flex-col gap-2",children:M.map((e,t)=>{if(!e.url)return null;let a=e.icon;return(0,r.jsx)("li",{className:"text-super group w-fit",children:(0,r.jsxs)(eJ.N,{href:e.url,target:"_blank",className:"flex items-center gap-1",children:[(0,r.jsx)(U.A,{icon:a,size:14}),(0,r.jsx)(m.A,{variant:"small",className:"text-inherit group-hover:underline",children:e.label})]})},t)})})]}),w&&(0,r.jsx)("section",{className:"border-t py-2",children:(0,r.jsxs)(m.A,{variant:"tinyRegular",className:"text-pretty",children:[(0,r.jsx)(m.A,{as:"span",variant:"tinyRegular",color:"light",children:w.text}),(0,r.jsx)(eJ.N,{href:w.link,target:"_blank",className:"text-super ml-1",children:y({defaultMessage:"Learn more",id:"TdTXXf940t"})})]})})]})})};function tX(e){let{isOpen:t,onContinue:a,onClose:l}=e;return(0,r.jsx)(v.A,{isOpen:t,onClose:l,title:"",variant:"small",children:(0,r.jsxs)(u.Ay,{className:"mx-auto w-full rounded-2xl px-4 py-0",children:[(0,r.jsx)(m.A,{variant:"section-title",className:"mb-2",children:(0,r.jsx)(eh.A,{defaultMessage:"We need more access to help with your Google calendar and email",id:"qfQz160ySM"})}),(0,r.jsx)(m.A,{variant:"small",color:"light",className:"mb-6",children:(0,r.jsx)(eh.A,{defaultMessage:"These permissions let us help you schedule meetings, find important messages, manage your inbox, and provide personalized assistance based on your real schedule and communication needs.",id:"yN/31P429t"})}),(0,r.jsx)(m.A,{variant:"small",color:"light",className:"mb-6",children:(0,r.jsx)(eh.A,{defaultMessage:"Important: Please select <b>all permission boxes</b> on the next screen to enable these features.",id:"sr/jqAmxMK",values:{b:e=>(0,r.jsx)("span",{className:"font-semibold",children:e})}})}),(0,r.jsx)(p.A,{text:(0,r.jsx)(eh.A,{defaultMessage:"Grant access to calendar and email",id:"SLN8GewG3+"}),variant:"primary",size:"regular",onClick:a,extraCSS:"w-full rounded-xl mb-4"})]})})}var tZ=a(71825);let tJ=e=>{let{isOpen:t,onClose:a}=e,l=(0,o.A)(),{mutate:i}=(0,tZ.rV)(),{trackEvent:n}=(0,d.yw)(),c=(0,s.useMemo)(()=>[{text:l.formatMessage({defaultMessage:"Cancel",id:"47FYwba+bI"}),onClick:a,variant:"common"},{text:l.formatMessage({defaultMessage:"Delete",id:"K3r6DQW7h+"}),onClick:()=>{n("cleared all memories",{}),i({reason:"delete-all-memories-modal"}),a()},variant:"rejected"}],[i,l,a,n]);return(0,r.jsx)(v.A,{isOpen:t,onClose:a,actionList:c,titleTextVariant:"smallBold",renderCloseButton:!1,modalClassname:"!min-w-0 max-w-[324px] p-0",headerClassname:"pt-6 px-6  md:px-6 border-b-0 !pb-0",modalContentClassname:"pt-0",footerClassname:"border-t-0 pt-2 px-6 !pb-6 md:pt-2 md:px-6 md:pb-6",title:l.formatMessage({defaultMessage:"Delete all memories",id:"wViT4HVZZG"}),children:(0,r.jsx)("div",{className:"w-full justify-start px-2 py-1",children:(0,r.jsx)(m.A,{variant:"tinyRegular",children:l.formatMessage({defaultMessage:"Are you sure you want to delete all of your memories? Memories cannot be recovered once deleted.",id:"2xMxdqIgTQ"})})})})},t$=e=>{let{isOpen:t,onClose:a,memoryId:l,onDeleteSuccess:i}=e,n=(0,o.A)(),{mutate:c}=(0,tZ.Ko)({reason:"delete-memory-modal"}),{trackEvent:u}=(0,d.yw)(),{isMobileStyle:p}=(0,eW.al)(),h=(0,s.useMemo)(()=>[{text:n.formatMessage({defaultMessage:"Cancel",id:"47FYwba+bI"}),onClick:a,variant:"common",shouldShowConfirmDialog:!0},{text:n.formatMessage({defaultMessage:"Delete",id:"K3r6DQW7h+"}),onClick:()=>{l&&(u("delete memory",{memoryId:l}),c(l,{onSuccess:()=>{null==i||i(),a()}}))},variant:"rejected"}],[c,n,l,a,i,u]);return(0,r.jsx)(v.A,{isOpen:t,onClose:a,actionList:h,titleTextVariant:"smallBold",renderCloseButton:!1,modalClassname:"!min-w-0 p-0",variant:p?"bottom-sheet":"default",title:n.formatMessage({defaultMessage:"Delete memory",id:"767lMfHCVm"}),children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(m.A,{variant:"small",children:n.formatMessage({defaultMessage:"Are you sure you want to delete this memory? Memories cannot be recovered once deleted.",id:"bJP46nmx6X"})})})})};var t0=a(98188);s.memo(e=>{let{backgroundVariant:t="subtler"}=e;return(0,r.jsx)(u.Ay,{variant:t,className:"inline-flex h-5 items-center rounded px-[6px] py-px",children:(0,r.jsx)(m.A,{color:"light",variant:"micro",className:"translate-y-half uppercase tracking-wider",children:(0,r.jsx)(eh.A,{defaultMessage:"Beta",id:"riw/yc06Nq"})})})}).displayName="BetaBadge",s.memo(()=>(0,r.jsx)("div",{className:"bg-super dark inline-flex h-5 items-center justify-center rounded px-[6px] py-px",children:(0,r.jsx)(m.A,{color:"white",variant:"tinyRegular",children:(0,r.jsx)(eh.A,{defaultMessage:"New",id:"bW7B87wFFp"})})})).displayName="NewBadge",a(70610),a(94105);var t1=a(38481),t2=a(71849);a(27093);var t3=a(65651);a(33477);var t4=a(63825);let t5=e=>{let{isOpen:t,onClose:a,personalizationStatusItems:l}=e,{$t:i}=(0,o.A)(),n=(0,E.useQueryClient)(),{openToast:d}=(0,g.G)(),c=(0,s.useMemo)(()=>[{text:i({defaultMessage:"Cancel",id:"47FYwba+bI"}),onClick:a,variant:"common"},{text:i({defaultMessage:"Done",id:"JXdbo8Vnlw"}),onClick:a,variant:"inverted"}],[i,a]),u=(0,tA.useMutation)({mutationFn:t1.g0,onMutate:async e=>{await n.cancelQueries({queryKey:ef.B$});let t=n.getQueryData(ef.B$);if(t){let a={...t,payment_methods:t.payment_methods.map(t=>t.payment_method_uuid===e.paymentMethodUUID?{...t,personalization_status:e.optedIn}:t)};n.setQueryData(ef.B$,a)}return{previousData:t}},onError:(e,t,a)=>{d({variant:"error",message:i({defaultMessage:"Failed to update setting",id:"N1E0Ht/+Mu"}),description:i({defaultMessage:"Please try again.",id:"VjB59sDdPt"})}),(null==a?void 0:a.previousData)&&n.setQueryData(ef.B$,a.previousData)},onSettled:()=>{n.invalidateQueries({queryKey:ef.B$})}});return(0,r.jsx)(v.A,{isOpen:t,onClose:a,modalClassname:"h-[600px] md:max-w-lg md:!min-w-0",modalContentClassname:e1()("grow overflow-hidden py-0 !px-0 md:!pb-0"),title:i({defaultMessage:"Third Party Personalization",id:"ymBdPtFQKe"}),titleTextVariant:"baseSemi",actionList:c,children:(0,r.jsxs)("div",{className:"flex flex-col gap-4 pt-1",children:[(0,r.jsxs)("div",{className:"text-quiet flex items-center gap-2",children:[(0,r.jsx)(t4.H,{size:16,className:"shrink-0"}),(0,r.jsx)(m.A,{variant:"tinyRegular",color:"light",children:i({defaultMessage:"Perplexity will automatically sync personalization tokens from the following providers when you enable them. Disable each provider to remove the data.",id:"ECjwvYNI+3"})})]}),null==l?void 0:l.map(e=>(0,r.jsx)(t8,{item:e,onUpdate:e=>{u.mutate({paymentMethodUUID:e.id,optedIn:e.isEnabled})}},e.payment_method_uuid))]})})},t8=e=>{let{item:t,onUpdate:a}=e,l=(0,s.useMemo)(()=>"visa"===t.payment_method_source?"/static/images/partners/visa/visa-logo.png":null,[t.payment_method_source]),i=(0,s.useCallback)(e=>{a({id:t.payment_method_uuid,isEnabled:e})},[t.payment_method_uuid,a]);return(0,r.jsxs)("label",{className:"pr-sm flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"bg-subtler relative flex size-8 items-center justify-center rounded-md",children:l&&(0,r.jsx)("img",{src:l,alt:"Visa Logo",className:"absolute size-6 object-contain"})}),(0,r.jsx)("div",{className:"flex flex-col gap-1",children:(0,r.jsx)(m.A,{variant:"small",className:"capitalize",children:t.payment_method_source})})]}),(0,r.jsx)(t3.d,{active:"enabled"===t.personalization_status,onChange:i})]})},t6={title:(0,ep.zR)({defaultMessage:"Watchlist",id:"b+DoOaU7zT"}),saveWatchlist:(0,ep.zR)({defaultMessage:"Save",id:"jvo0vs3nF0"}),cancel:(0,ep.zR)({defaultMessage:"Cancel",id:"47FYwba+bI"}),settingsTitle:(0,ep.zR)({defaultMessage:"Categories",id:"VKb1MSJZP+"}),sports:(0,ep.YK)({title:{defaultMessage:"Sports",id:"qEuXjx1B4z"},settingsCtaText:{defaultMessage:"Add teams",id:"kapmPqUzuB"},searchPlaceholder:{defaultMessage:"Search for a team",id:"yve+fFGCVl"},widgetDescription:{defaultMessage:"Choose your teams",id:"6ZVPGK17cb"},settingsDescription:{defaultMessage:"Event updates, breaking news, and live scores",id:"yBBV27kmkn"},modalDescription:{defaultMessage:"Get event updates, breaking news, and live scores",id:"VLVunZTFAF"}}),finance:(0,ep.YK)({title:{defaultMessage:"Finance",id:"Fm3M+yFIbr"},settingsCtaText:{defaultMessage:"Add stocks",id:"IrqguKbukF"},searchPlaceholder:{defaultMessage:"Search...",id:"0BUTMvePvK"},widgetDescription:{defaultMessage:"Set your watchlist",id:"Uh4Ex766Qm"},settingsDescription:{defaultMessage:"Set your watchlist for daily updates and summaries",id:"7SMcHmFldb"},modalDescription:{defaultMessage:"Updates and news about stocks and more",id:"uJAhXQDitL"}}),f1:(0,ep.YK)({title:{defaultMessage:"Sports",id:"qEuXjx1B4z"},settingsCtaText:{defaultMessage:"Add drivers",id:"R9U03Vy8bO"},searchPlaceholder:{defaultMessage:"Search for a driver",id:"lE7oUWeeV1"},widgetDescription:{defaultMessage:"Choose your drivers",id:"sCVGGM0Ka3"},settingsDescription:{defaultMessage:"Event updates, breaking news, and live scores",id:"yBBV27kmkn"},modalDescription:{defaultMessage:"Get event updates, breaking news, and live scores",id:"VLVunZTFAF"}})};var t7=a(83453),t9=a(77150);let ae=async e=>{var t;let{query:a,watchlistType:l,limit:r,category:s,cometRenderPlace:i,reason:n}=e,o=encodeURIComponent(a),{data:d,error:c}=await x.By.GET("/rest/homepage-widgets/watchlist/list-autosuggest",n,{params:{query:{type:l,query:o,limit:r,category:s,entropy_render_place:i}},timeoutMs:1500,numRetries:1});if(c)throw new t9.T("API_CLIENTS_ERROR",{message:"Failed to get watchlist autosuggestions",cause:c});return null!==(t=d.results)&&void 0!==t?t:eX.Ml},at=async e=>{let{watchlistType:t,reason:a}=e;try{var l;let{error:e,data:r}=await x.By.GET("/rest/homepage-widgets/watchlist/subscription",a,{params:{query:{type:t}},headers:{"content-type":"application/json"},numRetries:1});if(e)throw new t9.T("API_CLIENTS_ERROR",{message:"Failed to get watchlist subscriptions",cause:e});return null!==(l=r.results)&&void 0!==l?l:[]}catch(e){return b.vF.error(e),[]}},aa=async e=>{let{watchlistType:t,reason:a}=e;try{var l;let{error:e,data:r}=await x.By.GET("/rest/homepage-widgets/watchlist/categories",a,{params:{query:{type:t}},numRetries:1});if(e)throw new t9.T("API_CLIENTS_ERROR",{message:"Failed to get watchlist categories",cause:e});return null!==(l=null==r?void 0:r.results)&&void 0!==l?l:[]}catch(e){return b.vF.error(e),[]}},al=async e=>{let{watchlistType:t,identifier:a,category:l,reason:r}=e;try{let{error:e}=await x.By.PUT("/rest/homepage-widgets/watchlist/subscription",r,{params:{query:{type:t,identifier:null!=a?a:"",category:l}},headers:{"content-type":"application/json"}});if(e)throw new t9.T("API_CLIENTS_ERROR",{message:"Failed to add watchlist subscription",cause:e});return!0}catch(e){return b.vF.error(e),!1}},ar=async e=>{let{watchlistType:t,identifier:a,category:l,reason:r}=e;try{let{error:e}=await x.By.DELETE("/rest/homepage-widgets/watchlist/subscription",r,{params:{query:{type:t,identifier:a,category:l}},headers:{"content-type":"application/json"}});if(e)throw new t9.T("API_CLIENTS_ERROR",{message:"Failed to remove watchlist subscription",cause:e});return!0}catch(e){return b.vF.error(e),!1}},as=async e=>{let{watchlistType:t,identifier:a,order:l,reason:r}=e;try{let{error:e}=await x.By.PATCH("/rest/homepage-widgets/watchlist/subscription",r,{params:{query:{type:t,identifier:a}},body:{order:l},headers:{"content-type":"application/json"}});if(e)throw new t9.T("API_CLIENTS_ERROR",{message:"Failed to update watchlist subscription order",cause:e});return!0}catch(e){return b.vF.error(e),!1}},ai=e=>["watchlist",e,"subscriptions"],an=e=>["watchlist",e,"addSubscription"],ao=e=>["watchlist",e,"removeSubscription"],ad=e=>["watchlist",e,"updateSubscription"],ac=e=>{let{watchlistType:t,reason:a}=e,l=(0,S.L)(),r=ai(t);return(0,J.useQuery)({queryKey:r,queryFn:()=>at({watchlistType:t,reason:a}),staleTime:0,enabled:l})},au=e=>{let{watchlistType:t,queryClient:a,reason:l}=e,r=ai(t);return(0,tA.useMutation)({mutationKey:an(t),mutationFn:async e=>al({watchlistType:t,reason:l,...e}),onMutate:async e=>{let{identifier:l,category:s,description:i,image:n,title:o}=e;await a.cancelQueries({queryKey:r});let d=a.getQueryData(["watchlist",t]);return a.setQueryData(r,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[{identifier:null!=l?l:"",category:s,description:null!=i?i:"",image_url:null!=n?n:"",title:null!=o?o:"",subscribed:!0,order:Date.now()},...e.filter(e=>e.identifier!==l)]}),{previousSubscriptions:d}},onError:(e,t,l)=>{b.vF.error("Error adding watchlist subscription",e),a.setQueryData(r,null==l?void 0:l.previousSubscriptions)},onSuccess:()=>{a.invalidateQueries({queryKey:r})}})},am=e=>{let{watchlistType:t,queryClient:a,reason:l}=e,r=ai(t);return(0,tA.useMutation)({mutationKey:ao(t),mutationFn:async e=>ar({watchlistType:t,reason:l,...e}),onSuccess:()=>{a.invalidateQueries({queryKey:r})},onMutate:async e=>{let{identifier:l}=e;await a.cancelQueries({queryKey:r});let s=a.getQueryData(["watchlist",t]);return a.setQueryData(r,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.filter(e=>e.identifier!==l)}),{previousSubscriptions:s}},onError:(e,t,l)=>{b.vF.error("Error removing watchlist subscription",e),a.setQueryData(r,null==l?void 0:l.previousSubscriptions)}})},ap=e=>{let{watchlistType:t,queryClient:a,reason:l}=e,r=ai(t);return(0,tA.useMutation)({mutationKey:ad(t),mutationFn:async e=>as({watchlistType:t,reason:l,...e}),onMutate:async e=>{let{newOrderedList:t}=e;await a.cancelQueries({queryKey:r});let l=a.getQueryData(r);return a.setQueryData(r,t),{previousSubscriptions:l}},onError:(e,t,l)=>{b.vF.error("Error updating watchlist subscription order",e),(null==l?void 0:l.previousSubscriptions)&&a.setQueryData(r,l.previousSubscriptions)},onSuccess:()=>{a.invalidateQueries({queryKey:r})}})},ah=(0,eN.w)({path:"M15 9l-6 6 M10 12l2 2 M12 10l2 2 M8 21a5 5 0 0 0 -5 -5 M16 3c-7.18 0 -13 5.82 -13 13a5 5 0 0 0 5 5c7.18 0 13 -5.82 13 -13a5 5 0 0 0 -5 -5 M16 3a5 5 0 0 0 5 5",name:"IconBallAmericanFootball",variant:"stroked"});var av=a(46640);let ag=(0,eN.w)({path:"M11.105 18.79l-1 .992a4.159 4.159 0 0 1 -6.038 -5.715l.157 -.166l8.282 -8.401l1.5 1.5l3.45 -3.391a2.08 2.08 0 0 1 3.057 2.815l-.116 .126l-3.391 3.45l1.5 1.5l-3.668 3.617 M10.5 7.5l6 6 M14 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",name:"IconCricket",variant:"stroked"}),af=(0,eN.w)({path:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",name:"IconFilter",variant:"stroked"}),ay={nba:av.c,nfl:ah,cricket:ag,ncaam:av.c,ncaaw:av.c},ax=e=>{var t;let{watchlistType:a,selectedCategory:l,setSelectedCategory:i}=e,{isMobileStyle:n}=(0,eW.al)(),{$t:d}=(0,o.A)(),[c,u]=(0,s.useState)([]);(0,s.useEffect)(()=>{(async()=>{u(await aa({watchlistType:a,reason:"watchlist-category-dropdown"}))})()},[a]);let m=d({defaultMessage:"All Categories",id:"1X6HtI/EN/"}),h=(0,s.useMemo)(()=>[{text:m,icon:af,onClick:()=>i(void 0),type:"default",active:void 0===l,size:R.or.tiny},...c.map(e=>({text:e.display_name,icon:ay[e.category]||af,onClick:()=>i(e),type:"default",active:(null==l?void 0:l.category)===e.category,size:R.or.tiny}))],[c,i,l,m]);return 0===c.length?null:(0,r.jsx)(D.n,{isMobileStyle:n,items:h,placement:"bottom-end",children:(0,r.jsx)(p.A,{icon:ay[null==l?void 0:l.category]||af,size:R.or.tiny,text:null!==(t=null==l?void 0:l.display_name)&&void 0!==t?t:m})})};var ab=a(14489),aw=a(26970);a(79756);var a_=a(24065),aM=a(20041),aC=a(11702),aj=a(12422);let aA=(0,tw.Q)(async()=>{let{WatchlistSelections:e}=await Promise.all([a.e(5305),a.e(2619)]).then(a.bind(a,62619));return{default:e}},{loading:()=>(0,r.jsx)(aN,{})}),aE=e=>{let{isSelected:t}=e;return(0,r.jsx)("div",{className:"flex h-full flex-col items-center justify-center",children:(0,r.jsx)(P.A,{icon:t?aC.i:eu.u,size:"small",pill:!0})})},aS=e=>{let{onClear:t}=e;return(0,r.jsx)(P.A,{icon:aj.M,size:"tiny",pill:!0,onClick:t})},ak=e=>{let{isOpen:t,onClose:a,watchlistType:l,origin:n}=e,{isMobileStyle:c,isMobileUserAgent:u}=(0,eW.al)(),m="watchlist-modal",{$t:p}=(0,o.A)(),h=(0,E.useQueryClient)(),{trackEvent:f}=(0,d.yw)(),{deprecatedOpenToast:y}=(0,g.G)(),x=(0,s.useRef)(null),[b,w]=(0,s.useState)(""),[_,M]=(0,s.useState)(eX.Ml),[C,j]=(0,s.useState)(-1),[A,S]=(0,s.useState)(!1),[k,N]=(0,s.useState)(!1),[T,I]=(0,s.useState)();(0,s.useEffect)(()=>{f("watchlist modal viewed",{origin:n,watchlistType:l})},[n,l,f]);let R=(e=>"sports"===e||"finance"===e||"f1"===e)(null==T?void 0:T.category)?T.category:l.toLowerCase(),P=(0,s.useCallback)(()=>{A&&h.invalidateQueries({queryKey:["homepage-widgets"]}),a()},[A,h,a]),{data:O,isLoading:D}=ac({watchlistType:l,reason:m}),{mutate:L}=au({watchlistType:l,queryClient:h,reason:m}),{mutate:U}=am({watchlistType:l,queryClient:h,reason:m}),{mutate:F}=ap({watchlistType:l,queryClient:h,reason:"watchlist-reorder"}),z="FINANCE"===l,B=[{text:p({defaultMessage:"Done",id:"JXdbo8Vnlw"}),variant:"inverted",onClick:P}],H=(0,s.useCallback)(async(e,t)=>{let a=(0,a_.x)().erp;M((await h.fetchQuery({queryKey:["watchlist",l,e,null==t?void 0:t.category],queryFn:()=>ae({query:e,watchlistType:l,limit:5,category:null==t?void 0:t.category,cometRenderPlace:a,reason:m}),staleTime:0})).map(e=>{var t,a,l;return{query:e.title,title:e.title,image:null!==(t=e.image_url)&&void 0!==t?t:void 0,imageDark:null!==(a=e.image_url_dark)&&void 0!==a?a:void 0,description:e.description,identifier:e.identifier,category:null!==(l=e.category)&&void 0!==l?l:void 0,subscribed:e.subscribed}}))},[h,l]),q=(0,er.A)(H,100,{leading:!0,trailing:!0}),G=(0,s.useCallback)((e,t)=>{q(e,t)},[q]),Q=(0,s.useCallback)(e=>{w(e),G(e,T)},[G,T]),V=e1()("h-10 rounded-md dark:border-0 dark:border-transparent dark:bg-subtle p-4 dark:[&:focus]:ring-0",{"rounded-t-md rounded-b-none":k&&_.length>0}),K=(0,s.useCallback)(e=>{var t;if(S(!0),M(eX.Ml),w(""),(null!==(t=null==O?void 0:O.length)&&void 0!==t?t:0)>=50){y(p({defaultMessage:"Watchlist full (max {maxItems} items).",id:"mdbFzAw6E5"},{maxItems:50}),"error",2);return}e.subscribed||L(e)},[L,null==O?void 0:O.length,y,p]),W=(0,s.useCallback)((e,t)=>{U({identifier:e,category:t}),S(!0)},[U]),Y=(0,s.useCallback)(function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];F(...t),S(!0)},[F]),X=(0,s.useMemo)(()=>e=>{let{image:t,imageDark:a,alt:s}=e;return(0,r.jsx)(t7.f,{image:t,imageDark:a,alt:s,watchlistType:l,className:"mr-sm bg-subtler !size-8 overflow-hidden rounded",imageClassName:"inset-xs"})},[l]);return(0,r.jsx)(v.A,{isOpen:t,onClose:P,title:p(t6[R].title),titleTextVariant:"baseSemi",subtitle:p(t6[R].settingsDescription),subtitleClassname:"text-sm",actionList:B,variant:c?"bottom-sheet":"medium",renderCloseButton:!1,delayClose:!1,noPadding:!0,children:(0,r.jsxs)("div",{className:"pt-md flex h-[50vh] min-h-0 shrink-0 flex-col",children:[(0,r.jsx)("div",{className:"px-md flex flex-row items-center justify-between",children:(0,r.jsx)(ax,{watchlistType:l,selectedCategory:T,setSelectedCategory:I})}),(0,r.jsxs)("div",{className:"h-full",children:[(0,r.jsx)("div",{className:"px-md",children:(0,r.jsx)(aw.G,{isOpen:k&&_.length>0,suggestedQueries:_,focusedIndex:C,setFocusedIndex:j,handlePasteQuery:i.A,handleSubmit:(e,t)=>{K(e),w(""),M([]),N(!1)},value:b,components:{RightIconComponent:aE,LeftIconComponent:X},dropdownClassName:"dark:border-none dark:ml-0 dark:mr-0 dark:w-full",dropdownType:"select",popoverClassName:"dark:!border-none",children:(0,r.jsx)(aM.Ay,{onFocus:()=>{N(!0),G(b,T)},onBlur:()=>{N(!1)},className:V,pill:!1,ref:x,isMobileUserAgent:u,placeholder:p(t6[R].searchPlaceholder),value:b,onChange:Q,ClearIcon:aS,...b.length>0?{onClear:()=>{w(""),M([])}}:{}})})}),D?(0,r.jsx)(aN,{}):(0,r.jsx)(aA,{subscriptions:null!=O?O:eX.Ml,onRemove:W,onUpdateOrder:Y,watchlistType:l,selectedCategory:T,isReorderingEnabled:z,isMobile:c})]})]})})},aN=()=>(0,r.jsx)(ab.W,{children:(0,r.jsx)("div",{style:{maskImage:"linear-gradient(to bottom, black 50%, transparent)"},className:"flex flex-col items-center",children:Array.from({length:4}).map((e,t)=>(0,r.jsx)(aT,{},t))})}),aT=()=>(0,r.jsx)(u.Ay,{className:"gap-sm mt-2 flex w-full flex-col px-6 py-2",children:(0,r.jsx)(u.Ay,{variant:"subtle",className:"h-10 w-full rounded-md"})});var aI=a(91766);let aR=s.memo(e=>{let{message:t,subtitle:a,...l}=e;return(0,r.jsx)(v.A,{title:t,subtitle:a,closeButtonClassname:"right-sm top-md flex self-start justify-end grow",...l})});aR.displayName="ConfirmationModal";let aP=e=>{let{isOpen:t,onClose:a,config:l}=e,{$t:i}=(0,o.A)(),n=(0,E.useQueryClient)(),[d,c]=(0,s.useState)(!1),{userTryOnPhotoUrl:h,isUserTryOnPhotoLoading:g}=(0,aI.l)({reason:"avatar_management"}),{deleteAvatar:f}=(0,tg.Q)({reason:"avatar_management"}),y=async()=>{await f(),n.setQueryData((0,ef.rO)(),{try_on_photo_url:null}),c(!1),a()},x=(null==l?void 0:l.source)==="toast";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.A,{isOpen:t,onClose:a,title:i({defaultMessage:"Your avatar photo",id:"fXPKMrv34o"}),centerTitle:!0,modalClassname:"max-w-lg mx-auto",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-6 p-6",children:[g?(0,r.jsx)(ta.y,{}):h?(0,r.jsx)(u.Ay,{className:"gap-sm relative isolate flex flex-col overflow-hidden rounded-lg border",children:h&&(0,r.jsx)(e7.A,{src:h,alt:"Your Avatar",imageClassName:"max-h-[500px] max-w-full object-contain",containerClassName:"flex justify-center",includeLightBoxModal:!1})}):(0,r.jsx)(m.A,{variant:"smallMono",children:i({defaultMessage:"No avatar uploaded",id:"RDTTX4AfZg"})}),(0,r.jsx)("div",{className:"flex gap-3",children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.A,{variant:"border",onClick:()=>{a(),(null==l?void 0:l.onRetry)&&l.onRetry()},text:i({defaultMessage:"Retry",id:"62nsdyMyIO"})}),(0,r.jsx)(p.A,{variant:"primary",onClick:()=>{a()},text:i({defaultMessage:"Continue shopping",id:"Yywm0pqtZa"})})]}):h&&(0,r.jsx)(p.A,{variant:"common",onClick:()=>c(!0),text:i({defaultMessage:"Delete",id:"K3r6DQW7h+"})})})]})}),(0,r.jsx)(aR,{isOpen:d,onClose:()=>c(!1),message:i({defaultMessage:"Are you sure you want to delete?",id:"y7o4RnAvXG"}),subtitle:i({defaultMessage:"Once deleted, your avatar cannot be recovered.",id:"CtPvgMBMh3"}),children:(0,r.jsxs)("div",{className:"-mb-lg flex justify-center gap-3 p-6",children:[(0,r.jsx)(p.A,{variant:"common",onClick:()=>c(!1),text:i({defaultMessage:"No",id:"oUWADlOjJt"})}),(0,r.jsx)(p.A,{variant:"primary",onClick:y,text:i({defaultMessage:"Yes",id:"a5msuh5ORp"})})]})})]})};var aO=a(16672);let aD=()=>{let e=(0,tQ.ok)();return(0,s.useMemo)(()=>{let t=(null==e?void 0:e.get("pt"))||(0,aO.xd)();if(t)try{let e=atob(t);return JSON.parse(e).title}catch(e){return}},[e])};var aL=a(32971),aU=a(6271),aF=a(38806),az=a(18507);let aB=["sso"],aH=s.memo(()=>(0,r.jsxs)("div",{className:"flex flex-row items-center",children:[(0,r.jsx)(h.g,{variant:"mark",color:"foreground",size:"small"}),(0,r.jsx)("div",{className:"ml-2",children:(0,r.jsx)(h.g,{variant:"text",color:"foreground",size:"small"})})]}));aH.displayName="PerplexityLogo",s.memo(e=>{let{headerTextLineOne:t="Get answers, not links.",headerTextLineTwo:a="Search smarter today.",modalOrigin:l=R.Kw.MARKETING_LANDING_PAGE}=e,{isMobileStyle:i}=(0,eW.al)(),[n,o]=(0,s.useState)("");return(0,s.useEffect)(()=>{o((0,eZ.Qv)(window.location.origin,ek.cp2,l))},[l]),(0,r.jsxs)("div",{className:"px-lg py-xl flex min-h-screen flex-col items-center justify-between overflow-y-auto",children:[(0,r.jsx)(aH,{}),(0,r.jsxs)("div",{className:"py-2xl flex flex-col items-center justify-center",children:[t&&(0,r.jsx)(m.A,{variant:i?"entry-title":"display",color:"default",className:"text-center",children:t}),a&&(0,r.jsx)(m.A,{variant:i?"entry-title":"display",color:"default",className:"text-center",children:a}),(0,r.jsx)(m.A,{variant:"base",color:"light",className:"mt-4 max-w-[400px] text-center",children:(0,r.jsx)(eh.A,{defaultMessage:"Join millions who have switched to Perplexity, the modern search engine.",id:"n7AYVi1U68"})}),(0,r.jsx)(eK.A,{autoFocus:!0,redirectUrl:n,showInternal:!0,className:"mt-xl w-full",disallowedMethods:aB})]}),(0,r.jsxs)(m.A,{variant:"small",color:"light",children:["\xa9 ",new Date().getFullYear()," Perplexity AI"]})]})}).displayName="MainContent";var aq=a(74884),aG=a(67205);let aQ=async e=>{let{stringProperties:t,headers:a,reason:l}=e;if(!a["accept-language"])return b.vF.warn("No accept-language header provided for translation request"),t;let r=await x.By.POST("/rest/translation/translate",l,{body:{texts:t},headers:{...a}});if(r.response.ok){var s;let e=r.data;return null!==(s=null==e?void 0:e.translated_texts)&&void 0!==s?s:[]}return b.vF.error("Failed to fetch translations for ".concat(t.join(", "),"}")),[]},aV=e=>null==e||""===e;async function aK(e){let{originalContent:t,keysToTranslate:a,reason:l}=e,r=(0,aq.t)();if(r===aG.X)return t;let s=a.map(e=>t[e]);if(s.some(aV))return t;let i=await aQ({stringProperties:s,headers:{"accept-language":r},reason:l});if(i.length===s.length){let e={...t};return a.forEach((t,a)=>{e[t]=i[a]}),e}return t}var aW=a(57346),aY=a(16079),aX=a(2928),aZ=a(36234),aJ=a(28566);let a$=()=>{let{device:{isAndroid:e}}=(0,q.L)();return(0,r.jsxs)("div",{className:"gap-sm flex items-center",children:[(0,r.jsx)("div",{className:"flex items-center",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsx)(U.e,{icon:aJ.S,size:16,className:"text-super"},"rating-star-full-".concat(t)))}),(0,r.jsx)("div",{children:(0,r.jsx)(m.A,{variant:"tiny",color:"light",className:"mt-2xs flex items-end text-center",children:(0,r.jsx)(eh.A,{defaultMessage:"{amount} Ratings",id:"8lpjhgQpdU",values:{amount:e?"960K":"252K"}})})})]})};s.memo(e=>{let{campaignData:t,dismiss:a,translated:l}=e,{device:{isIOS:i}}=(0,q.L)(),[n,o]=(0,s.useState)(!!l),[c,u]=(0,s.useState)(t),{trackEvent:h}=(0,d.yw)();(0,s.useEffect)(()=>{!l&&(async()=>{u(await aK({originalContent:t,keysToTranslate:["title_1","subtext_1","button_text"],reason:"reviews"})),o(!0)})()},[t,l]),(0,s.useEffect)(()=>{h("mweb splash page viewed",{})},[h]);let{title_1:v,subtext_1:g,button_text:f,button_link:y}=c,x=(0,s.useCallback)(()=>{h("app download button selected",{downloadAppDestination:"mobile",origin:"marketingLandingPage"}),(0,aY.Vt)(),window.open(y,"_blank")},[y,h]);return(0,r.jsxs)("div",{className:e1()("p-lg fixed inset-0 mb-auto flex h-full flex-col items-center justify-between overflow-y-auto"),children:[a&&(0,r.jsx)("div",{className:"right-sm top-sm absolute",children:(0,r.jsx)(P.A,{pill:!0,variant:"noBackground",size:"small",icon:aj.M,extraCSS:"text-foreground md:hover:text-quiet ",onClick:a})}),(0,r.jsx)(aH,{}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)(aW.z9,{displayAs:i?"ios":"android",allowBgImage:!1}),(0,r.jsxs)("div",{className:e1()("flex flex-col items-center"),children:[(0,r.jsx)(aF.N,{children:n?(0,r.jsxs)(az.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},className:"flex flex-col items-center",children:[(0,r.jsx)(m.A,{variant:"entry-title",color:"default",textCenter:!0,children:v}),(0,r.jsx)(m.A,{variant:"base",color:"light",textCenter:!0,className:"mt-4 max-w-[400px]",children:g})]}):(0,r.jsxs)("div",{className:"invisible flex flex-col items-center",children:[(0,r.jsx)(m.A,{variant:"entry-title",color:"default",textCenter:!0,children:t.title_1}),(0,r.jsx)(m.A,{variant:"base",color:"light",textCenter:!0,className:"mt-4 max-w-[400px]",children:t.subtext_1})]})}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(a$,{})})]})]}),(0,r.jsx)("div",{className:"flex w-full flex-col items-center",children:(0,r.jsx)(aF.N,{children:n?(0,r.jsx)(az.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},className:"flex w-full flex-col items-center",children:(0,r.jsx)(p.A,{variant:"inverted",size:"large",text:f,icon:i?aX.P:aZ.A,fullWidth:!0,extraCSS:"max-w-xs rounded-xl mx-auto",onClick:x})}):(0,r.jsx)("div",{className:"invisible flex w-full flex-col items-center",children:(0,r.jsx)(p.A,{variant:"inverted",size:"large",text:t.button_text})})})})]})}).displayName="Reviews";let a0=e=>{let{origin:t}=e,{device:{isIOS:a}}=(0,q.L)(),{downloadAppLink:l}=(0,aU.D)(t),{$t:s}=(0,o.A)();return(0,r.jsx)(eJ.N,{href:l,children:(0,r.jsxs)("div",{className:"gap-x-md py-lg flex items-center justify-center",children:[(0,r.jsx)("div",{"data-color-scheme":"dark",className:e1()("border-subtler bg-base inline-block border",{"p-sm rounded-xl":a,"p-md rounded-full":!a}),children:(0,r.jsx)("div",{className:"flex aspect-square w-12 items-center justify-center",children:(0,r.jsx)(h.g,{variant:"mark",size:"md",color:"white"})})}),(0,r.jsxs)("div",{className:"-mt-xs",children:[(0,r.jsx)(m.A,{variant:"baseSemi",children:"Perplexity"}),(0,r.jsx)(m.A,{variant:"small",color:"light",children:s({defaultMessage:"Search and discovery with AI",id:"n3oaAt293P"})}),(0,r.jsx)(a$,{})]})]})})};var a1=a(96359);let a2=e=>{let{origin:t,isOpen:a,onClose:l,sheetModalVariant:i}=e,{trackEventOnce:n,trackEvent:c}=(0,d.yw)(),{$t:u}=(0,o.A)(),{handleAppDownloadClicked:h}=(0,aU.D)("install-gate-modal-upsell"),v=aD(),g=(0,aL.V)({origin:"install-gate"}),{mwebUpsellWhatsApp:f}=(0,a1.a)();(0,s.useEffect)(()=>{n("install modal opened",{origin:t})},[t,n]);let y=(0,s.useCallback)(()=>{c("install modal closed",{origin:t}),l()},[l,t,c]);return(0,r.jsx)(eY.R,{isOpen:a,onClose:y,variant:i,showCloseButton:!1,overlayVariant:"default-less-blur",children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{variant:"section-title",className:"px-sm text-center",children:(0,r.jsx)(eh.A,{defaultMessage:"Keep the conversation going.",id:"4/VUgNnQik"})}),(0,r.jsx)(m.A,{variant:"section-title",className:"px-sm text-center",children:(0,r.jsx)(eh.A,{defaultMessage:"Try Perplexity on WhatsApp",id:"YTg7pt2IE4"})}),(0,r.jsxs)("div",{className:"mt-md mb-lg flex flex-row items-center justify-center gap-4",children:[(0,r.jsx)("div",{className:"aspect-square size-10 overflow-hidden rounded-full shadow-lg",children:(0,r.jsx)("img",{src:"https://r2cdn.perplexity.ai/whatsapp.jpg",alt:"WhatsApp"})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)(m.A,{children:"Perplexity"}),(0,r.jsx)(m.A,{variant:"smallMono",color:"super",textCenter:!0,children:"+1 (833) 436-3285"})]})]}),(0,r.jsx)(p.A,{variant:"primary",text:u({defaultMessage:"Continue on WhatsApp",id:"I7Lrfco0vS"}),size:"small",extraCSS:"h-[44px] mb-md",onClick:()=>{c("whatsapp button clicked",{origin:"install-gate"}),g()}})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{variant:"page-title",className:"px-sm text-center",children:null!=v?v:(0,r.jsx)(eh.A,{defaultMessage:"One verified answer to any question",id:"C+F6JBwTvO"})}),(0,r.jsx)(a0,{origin:"install-gate-modal-upsell"}),(0,r.jsx)(p.A,{variant:"primary",text:u({defaultMessage:"Open Perplexity app",id:"u0MSV+x6J3"}),size:"small",extraCSS:"h-[44px] mb-md",onClick:()=>{c("app download button clicked",{origin:"install-gate"}),h()}})]})})};var a3=a(91360),a4=a(1298);let a5=s.memo(e=>{var t,a,l,i,n,d,c,u,m,p;let{isOpen:h,closeModal:g,existingCollection:f,entryUUID:y,frontendContextUUID:x,onCreate:b,content:w}=e,{$t:_}=(0,o.A)(),{isMobileStyle:M,isMobileUserAgent:C}=(0,eW.al)(),{createCollection:j,createCollectionForThread:A}=(0,$.W)({reason:"space-create-modal"}),[E,S]=(0,s.useState)({title:null!==(a=null!==(t=null==w?void 0:w.title)&&void 0!==t?t:null==f?void 0:f.title)&&void 0!==a?a:"",description:null!==(i=null!==(l=null==w?void 0:w.description)&&void 0!==l?l:null==f?void 0:f.description)&&void 0!==i?i:"",instructions:null!==(d=null!==(n=null==w?void 0:w.instructions)&&void 0!==n?n:null==f?void 0:f.instructions)&&void 0!==d?d:"",emoji:null!==(u=null!==(c=null==w?void 0:w.emoji)&&void 0!==c?c:null==f?void 0:f.emoji)&&void 0!==u?u:"",accessLevel:null!==(m=null==f?void 0:f.access)&&void 0!==m?m:ek.lF6,enableWebByDefault:null===(p=null==f?void 0:f.enable_web_by_default)||void 0===p||p}),[k,N]=(0,s.useState)(!1),{title:T,description:I,emoji:R,instructions:P}=E,D=(null==T?void 0:T.length)===0||(null==T?void 0:T.length)>ek._WW||(null==I?void 0:I.length)>ek.ucN||(null==P?void 0:P.length)>ek.ttC,L=e=>{S(t=>({...t,...e})),N(!0)},U=(0,et.rd)(),F=(0,s.useCallback)(e=>{L({title:"",description:"",instructions:"",emoji:"",accessLevel:ek.lF6}),g(),U.push("/spaces/".concat(e.slug)),null==b||b(e)},[g,U,b]),z=(0,s.useCallback)(()=>{y?A({...E,entryUUID:y,frontendContextUUID:null!=x?x:"",callback:F}):j({...E,callback:F})},[y,A,E,x,F,j]),B=(0,s.useMemo)(()=>[{text:_({defaultMessage:"Cancel",id:"47FYwba+bI"}),variant:"common",onClick:g,shouldShowConfirmDialog:!0},{text:_({defaultMessage:"Continue",id:"acrOozm08x"}),variant:"primary",disabled:D,onClick:()=>z()}],[g,_,D,z]),H=(0,s.useCallback)(e=>L({title:e}),[]),q=(0,s.useCallback)(e=>L({emoji:e}),[]),G=(0,s.useCallback)(e=>L({description:e}),[]),Q=(0,s.useCallback)(e=>L({instructions:e}),[]);return(0,r.jsx)(v.A,{title:_({defaultMessage:"Create a Space",id:"SqVNRzqwJz"}),isOpen:h,onClose:g,actionList:B,confirmOnClose:k?(0,r.jsx)(a4.L,{}):void 0,children:(0,r.jsxs)("div",{className:"space-y-md",children:[(0,r.jsxs)("div",{className:"space-x-sm flex items-center",children:[(0,r.jsx)("div",{className:"grow",children:(0,r.jsx)(aM.Ay,{isMobileUserAgent:C,label:_({defaultMessage:"Title",id:"9a9+wwWy4u"}),value:T,autoFocus:!0,onChange:H,placeholder:_({defaultMessage:"Team Space...",id:"CR3RufeyCu"}),maxLength:ek._WW})}),(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)(a3.A,{emoji:R,setEmoji:q,size:"medium"})})]}),(0,r.jsx)(O.A,{isMobileStyle:M,isMobileUserAgent:C,placeholder:_({defaultMessage:"A collaborative space for discussing latest insights...",id:"r+xI8TGuu9"}),label:_({defaultMessage:"Description",id:"Q8Qw5BZ1VA"}),isOptional:!0,minRows:2,value:I,onChange:G,maxLength:ek.ucN}),(0,r.jsx)(O.A,{isMobileStyle:M,isMobileUserAgent:C,placeholder:_({defaultMessage:"Always respond in a formal tone and prioritize data-driven insights...",id:"ERATUnZFe3"}),label:_({defaultMessage:"Custom Instructions",id:"nRK52SgZ/p"}),subtitle:_({defaultMessage:"Give instructions to the AI that affects every thread in this space.",id:"6peDHp5LgI"}),isOptional:!0,value:P,minRows:2,onChange:Q,maxLength:ek.ttC})]})})});a5.displayName="SpaceCreateModal";var a8=a(30760);let a6=e=>e?(0,a8.hb)(e):void 0,a7=(e,t)=>{if(!e)return"";let a=a6(e.currency);return void 0==a?"":t(e.price_minor_units/a,{style:"currency",currency:e.currency})};var a9=a(28325);let le=e=>{let{billingInterval:t}=e;return"monthly"===t?(0,r.jsx)(eh.A,{defaultMessage:"/ month",id:"Vn2ud4qKOl"}):"yearly"===t?(0,r.jsx)(eh.A,{defaultMessage:"/ year",id:"8hNOud/igo"}):"unknown"===t?(0,r.jsx)(eh.A,{defaultMessage:"/ month",id:"Vn2ud4qKOl"}):null},lt=e=>{let{planName:t,price:a,formatNumber:l,isHighlighted:s=!1,className:i="",billingInterval:n}=e;return(0,r.jsxs)(u.Ay,{variant:"subtler",className:"px-md h-xl my-sm flex items-center justify-between rounded-md ".concat(i),children:[(0,r.jsx)(m.A,{variant:"baseSemi",color:s?"default":"light",children:(0,r.jsx)(eh.A,{...t})}),(0,r.jsxs)("div",{className:"gap-xs flex items-center",children:[(0,r.jsx)(m.A,{variant:"small",children:a?a7(a,l):""}),n&&(0,r.jsxs)(m.A,{variant:"tinyRegular",children:[(0,r.jsx)(a9.X,{}),(0,r.jsx)(le,{billingInterval:n})]})]})]})};var la=a(84607);let ll=e=>{let{isOpen:t,onClose:a}=e,{data:l}=(0,t1.Q_)({reason:"downgrade-modal"}),{update:i}=(0,t0.N)(),{currentOpenModals:n}=(0,ey.u)(),{deprecatedOpenToast:c}=(0,g.G)(),{formatNumber:h,formatDate:f,$t:y}=(0,o.A)(),{trackEvent:x}=(0,d.yw)();(0,s.useEffect)(()=>{t&&x("subscription downgrade modal rendered")},[t,x]);let b=(0,s.useCallback)(async()=>{await (0,t2.fi)({reason:"downgrade-to-pro-modal"}),await i(),a(),x("subscription downgrade success"),n.length>0&&a(),(0,la.MM)({downgrade:"success"}),c(y({defaultMessage:"Subscription updated",id:"Eq5gCUdVyJ"}),"success",5)},[a,n,i,c,y,x]),{mutate:w,isPending:_}=(0,t1.Me)({reason:"downgrade-modal"},{onSuccess:b}),M=null==l?void 0:l.next_billing_start_ts,C=M?f(1e3*M):"";return(0,r.jsx)(v.A,{isOpen:t,onClose:a,renderCloseButton:!1,headerClassname:"hidden",modalClassname:"!w-[416px] !min-w-[416px] !max-w-[416px] !p-0",modalContentClassname:"!p-0",noPadding:!0,children:(0,r.jsxs)(u.Ay,{className:"p-ml",children:[(0,r.jsx)(m.A,{variant:"baseSemi",children:(0,r.jsx)(eh.A,{defaultMessage:"Confirm changes",id:"AnPtOvcf8f"})}),(0,r.jsx)(lt,{planName:{id:"kkjl2vQekD",defaultMessage:"Max"},price:null==l?void 0:l.old_product_price,formatNumber:h,billingInterval:null==l?void 0:l.old_product_interval}),(0,r.jsx)(u.Ay,{children:(0,r.jsxs)(m.A,{variant:"tinyRegular",color:"light",className:"flex items-center justify-center gap-1",children:[(0,r.jsx)("div",{className:"border-subtlest flex-1 border-t"}),(0,r.jsx)(eh.A,{defaultMessage:"Downgrade",id:"SduMNm+0em"}),(0,r.jsx)("div",{className:"border-subtlest flex-1 border-t"})]})}),(0,r.jsx)(lt,{planName:{id:"R/eOkjWqNU",defaultMessage:"Pro"},price:null==l?void 0:l.new_product_price,formatNumber:h,billingInterval:null==l?void 0:l.new_product_interval,isHighlighted:!0,className:"mb-0 !rounded-b-none rounded-t-md"}),(0,r.jsx)(u.Ay,{variant:"subtler",className:"px-md pb-sm flex items-center justify-between rounded-b-md",children:(0,r.jsx)(m.A,{variant:"small",color:"light",children:(0,r.jsx)(eh.A,{defaultMessage:"Your current Max subscription will remain active until {date} when it will change to Pro.",id:"2C6tgt4MMg",values:{date:C}})})}),(0,r.jsxs)(u.Ay,{className:"gap-sm mt-ml flex justify-end",children:[(0,r.jsx)(P.A,{text:(0,r.jsx)(eh.A,{defaultMessage:"Cancel",id:"47FYwba+bI"}),onClick:a}),(0,r.jsx)(p.A,{variant:"primary",text:(0,r.jsx)(eh.A,{defaultMessage:"Confirm",id:"N2IrpMDHDB"}),disabled:_,onClick:()=>w()})]})]})})};var lr=a(92093);let ls=e=>{let{lineItems:t}=e,{$t:a,formatNumber:l}=(0,o.A)(),i=(0,s.useMemo)(()=>[{title:(0,ep.zR)({defaultMessage:"Payment method",id:"BVTni9A2ca"}),value:t.payment_method,separator:!0},{title:(0,ep.zR)({defaultMessage:"Perplexity Max Subscription",id:"zmPIe7d+w+"}),value:t.new_product_price?a7(t.new_product_price,l):""},{title:(0,ep.zR)({defaultMessage:"Adjustment",id:"LaLTJRqloA"}),value:t.adjustment_price?a7(t.adjustment_price,l):"",separator:!0},{title:(0,ep.zR)({defaultMessage:"Subtotal",id:"L8seEcJFZ7"}),value:a7(t.subtotal_price,l)},{title:(0,ep.zR)({defaultMessage:"Taxes",id:"r+dgivP2Od"}),value:a7(t.tax_price,l),separator:!0},{title:(0,ep.zR)({defaultMessage:"Total due today",id:"MxAykvkF+r"}),value:a7(t.total_due_today_price,l),color:"default",size:"small"}],[t,l]);return(0,r.jsx)("ul",{className:"flex flex-col",children:i.map(e=>{var t,l;return(0,r.jsxs)("li",{className:"flex items-center justify-between ".concat(e.separator?"border-subtlest py-sm mb-sm border-b":"pb-sm"),children:[(0,r.jsx)(m.A,{variant:"tinyRegular",color:"light",children:a(e.title)}),(0,r.jsx)(m.A,{variant:null!==(t=e.size)&&void 0!==t?t:"tinyRegular",color:null!==(l=e.color)&&void 0!==l?l:"light",children:e.value})]},e.title.id)})})};var li=a(55759);let ln=()=>{let e=(0,et.rd)(),{env:{isProduction:t,isBeta:a}}=(0,q.L)(),l=(0,s.useCallback)(async l=>{let{locale:r,reason:s}=l,i=await (0,t1.jh)({locale:r,reason:s});i?e.push(i):e.push(t||a?"https://billing.stripe.com/p/login/6oEeXaewnb3z1facMM":"https://billing.stripe.com/p/login/test_7sIdSS7ioeNSdpe9AA")},[e,t,a]);return(0,s.useMemo)(()=>({navigateToCustomerPortal:l}),[l])};var lo=a(31049);!function(e){e.UNSUPPORTED="unsupported",e.MISSING_PAYMENT_METHOD="missingPaymentMethod",e.PAYMENT_FAILED="paymentFailed",e.ANDROID="android",e.IOS="ios",e.UPGRADE_TO_CONTINUE="upgradeToContinue",e.GENERIC_PAYMENT_ERROR="genericPaymentError"}(l||(l={}));let ld=e=>{if(e){if(e instanceof t9.T&&"details"in e){let t=e.details;if((null==t?void 0:t.errorDetail)&&"object"==typeof t.errorDetail&&"error_code"in t.errorDetail)return t.errorDetail.error_code}return e.message}},lc=()=>(0,r.jsx)("ul",{className:"flex flex-col",children:Array.from({length:6}).map((e,t)=>{let a=t%2==0;return(0,r.jsx)("li",{className:e1()({"border-subtlest py-sm mb-sm border-b":a,"pb-sm":!a}),children:(0,r.jsx)(ab.W,{children:(0,r.jsx)(u.Ay,{variant:"subtler",className:e1()("h-4 w-full rounded",{"py-0.5":5===t})})})},t)})}),lu=e=>{var t;let{isOpen:a,onClose:i}=e,n=(0,o.A)(),{session:c}=(0,t0.N)(),h=null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.subscription_source,g="stripe"===h,{data:f,isLoading:y,status:x,error:b}=(0,t1.XU)({reason:"upgrade-modal",enabled:g}),{data:w,isLoading:_}=(0,t1.YA)({currency:lr.U,reason:"upgrade-modal",subscriptionTier:"max"}),{data:M,isLoading:C}=(0,t1.YA)({currency:lr.U,reason:"upgrade-modal",subscriptionTier:"pro"}),{formatNumber:j,locale:A}=(0,o.A)(),{update:E}=(0,t0.N)(),{currentOpenModals:S}=(0,ey.u)(),{trackEvent:k}=(0,d.yw)(),{navigateToCustomerPortal:N}=ln(),T=(0,s.useMemo)(()=>{var e,t;return null!==(t=null==w?void 0:null===(e=w.prices)||void 0===e?void 0:e.find(e=>{let{tier:t}=e;return"monthly"===t}))&&void 0!==t?t:null},[w]),I=(0,s.useMemo)(()=>{var e,t;return null!==(t=null==M?void 0:null===(e=M.prices)||void 0===e?void 0:e.find(e=>{let{tier:t}=e;return"monthly"===t}))&&void 0!==t?t:null},[M]),O=(0,s.useMemo)(()=>"error"===x?ld(b):null,[x,b]),D=(0,s.useCallback)(async()=>{await (0,t2.fi)({reason:"upgrade-to-max-modal"}),await E(),i(),k("subscription upgrade success"),S.length>0&&i(),(0,la.MM)({upgrade_max:"success",subscription_tier:"max"})},[i,S,E,k]),L=(0,t1.le)({reason:"upgrade-modal"},{onSuccess:D}),U="missing_payment_method"===O,F="stripe_upgrade_payment_error"===O;(0,s.useEffect)(()=>{a&&k("subscription upgrade modal rendered")},[a,k]);let z=function(e){let{subscriptionSource:t,isMissingPaymentMethod:a,paymentFailed:r,upgradeError:s}=e;return"android"===t?l.ANDROID:"ios"===t?l.IOS:a?l.MISSING_PAYMENT_METHOD:r?l.PAYMENT_FAILED:s?l.GENERIC_PAYMENT_ERROR:l.UPGRADE_TO_CONTINUE}({subscriptionSource:h,isMissingPaymentMethod:U,paymentFailed:F,upgradeError:ld(null==L?void 0:L.error)}),B=(0,s.useCallback)(async()=>{await N({locale:A,reason:"upgrade-modal-add-payment"})},[N,A]),H=!!(null==f?void 0:f.payment_method),q=U||F||!!L.error,G=(0,s.useMemo)(()=>!g||L.isPending||!H||y||!!L.error,[g,L.isPending,H,y,L.error]),Q=(0,s.useCallback)(async()=>{!L.isPending&&await L.mutateAsync()},[L]),V=(0,s.useMemo)(()=>U?(0,r.jsx)(eh.A,{defaultMessage:"Add payment method",id:"+EIsonKmCI"}):L.error?(0,r.jsx)(eh.A,{defaultMessage:"Continue to Stripe",id:"W2hJP+kQGf"}):(0,r.jsx)(eh.A,{defaultMessage:"Update payment method",id:"iIM9E+ynde"}),[U,L.error]);return(0,r.jsx)(v.A,{isOpen:a,onClose:i,renderCloseButton:!1,headerClassname:"hidden",modalClassname:"!w-[416px] !min-w-[416px] !max-w-[416px] !p-0",modalContentClassname:"!p-0",noPadding:!0,children:(0,r.jsxs)(u.Ay,{className:"p-ml",children:[(0,r.jsx)(m.A,{variant:"baseSemi",children:(0,r.jsx)(eh.A,{defaultMessage:"Confirm changes",id:"AnPtOvcf8f"})}),(0,r.jsx)(lt,{planName:{id:"R/eOkjWqNU",defaultMessage:"Pro"},price:"error"!==x&&g?null==f?void 0:f.old_product_price:I,formatNumber:j,billingInterval:"error"!==x&&g?null==f?void 0:f.old_product_interval:"monthly"}),(0,r.jsx)(u.Ay,{children:(0,r.jsxs)(m.A,{variant:"tinyRegular",color:"light",className:"flex items-center justify-center gap-1",children:[(0,r.jsx)("div",{className:"border-subtlest flex-1 border-t"}),(0,r.jsx)(eh.A,{defaultMessage:"Upgrade",id:"0h/lPMeYkq"}),(0,r.jsx)("div",{className:"border-subtlest flex-1 border-t"})]})}),(0,r.jsx)(lt,{planName:{id:"kkjl2vQekD",defaultMessage:"Max"},price:U||!g?T:null==f?void 0:f.new_product_price,formatNumber:j,billingInterval:U||!g?"monthly":null==f?void 0:f.new_product_interval,isHighlighted:!0,className:"mb-ml"}),y?(0,r.jsx)(lc,{}):f&&(0,r.jsx)(ls,{lineItems:f}),(0,r.jsxs)(u.Ay,{variant:"subtler",className:"px-md py-sm mt-ml gap-sm flex flex-col rounded-md",children:[(0,r.jsx)(m.A,{variant:"small",color:"light",children:(0,r.jsx)(eh.A,{...function(e){switch(e){case l.UNSUPPORTED:return(0,ep.zR)({defaultMessage:"Max subscriptions are not supported by carrier billing.",id:"Ux4ivT++jB"});case l.MISSING_PAYMENT_METHOD:return(0,ep.zR)({defaultMessage:"Please add a payment method to upgrade to Max.",id:"W6HVT1BPC8"});case l.PAYMENT_FAILED:return(0,ep.zR)({defaultMessage:"Payment failed. Please update payment to continue.",id:"b0rdlbJ3AI"});case l.ANDROID:return(0,ep.zR)({defaultMessage:"You subscribed on the Google Play Store. Upgrade your subscription via settings on the Android app.",id:"97MQ1Swe7/"});case l.IOS:return(0,ep.zR)({defaultMessage:"You subscribed on the App Store. Upgrade your subscription via settings on the iOS app.",id:"JGkQSWrZEy"});case l.UPGRADE_TO_CONTINUE:return(0,ep.zR)({defaultMessage:"You will be charged now and immediately get access to Max.",id:"9x1isMahOJ"});case l.GENERIC_PAYMENT_ERROR:return(0,ep.zR)({defaultMessage:"Something went wrong. Please continue to Stripe and complete your payment.",id:"xdKfV2F++4"});default:(0,lo.s)(e)}}(z)})}),!g&&(0,r.jsx)(li.Ay,{origin:R.Kw.UPGRADE_MODAL,variant:"primary",fullWidth:!0}),q&&(0,r.jsx)(p.A,{size:"small",fullWidth:!0,variant:"primary",text:V,onClick:B})]}),(0,r.jsxs)(u.Ay,{className:"gap-sm mt-ml flex justify-end",children:[(0,r.jsx)(P.A,{text:n.formatMessage({defaultMessage:"Cancel",id:"47FYwba+bI"}),onClick:i}),(0,r.jsx)(p.A,{variant:"primary",text:n.formatMessage({defaultMessage:"Confirm",id:"N2IrpMDHDB"}),isLoading:L.isPending,disabled:G,onClick:Q})]})]})})};var lm=a(54192),lp=a(80182),lh=a(24915);let lv=s.memo(()=>(0,r.jsx)("div",{className:"bg-backdrop/70 fixed inset-0 z-[999] flex items-center justify-center backdrop-blur-sm",children:(0,r.jsx)(ta.y,{})}));lv.displayName="ModalLoader";let lg=s.memo(()=>(0,r.jsx)("p",{children:"An error has occurred"}));lg.displayName="ErrorFallback";let lf=(0,tw.Q)(async()=>{let{LocationPermissionModal:e}=await a.e(2570).then(a.bind(a,22570));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),ly=(0,tw.Q)(async()=>{let{FileUploadModal:e}=await a.e(3330).then(a.bind(a,73330));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lx=(0,tw.Q)(async()=>{let{CometDownloadInstructionsModal:e}=await a.e(9659).then(a.bind(a,79659));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lb=(0,tw.Q)(async()=>{let{CollectionCreateEditModal:e}=await a.e(5916).then(a.bind(a,55916));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lw=(0,tw.Q)(async()=>{let{CollectionSelectModal:e}=await a.e(4813).then(a.bind(a,14813));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),l_=(0,tw.Q)(async()=>{let{OnboardingModal:e}=await Promise.all([a.e(6745),a.e(9591),a.e(5745),a.e(4347),a.e(2163),a.e(5638),a.e(1153),a.e(9182),a.e(3979),a.e(958)]).then(a.bind(a,63703));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lM=(0,tw.Q)(async()=>{let{PurchaseConfirmationToast:e}=await Promise.all([a.e(4628),a.e(3312)]).then(a.bind(a,13312));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lC=(0,tw.Q)(async()=>{let{ThreadLossAversionModal:e}=await Promise.resolve().then(a.bind(a,79095));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lj=(0,tw.Q)(async()=>{let{CompanyDataPrivacyModal:e}=await a.e(7946).then(a.bind(a,77946));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lA=(0,tw.Q)(async()=>{let{SpaceVideoModal:e}=await a.e(3076).then(a.bind(a,23076));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lE=(0,tw.Q)(async()=>{let{PricingTableModal:e}=await Promise.all([a.e(9591),a.e(5638),a.e(3979),a.e(456)]).then(a.bind(a,456));return{default:e}}),lS=(0,tw.Q)(async()=>{let{MapModal:e}=await Promise.all([a.e(3616),a.e(4936),a.e(6322),a.e(317)]).then(a.bind(a,50317));return{default:e}}),lk=(0,tw.Q)(()=>a.e(4949).then(a.bind(a,84949))),lN=(0,tw.Q)(()=>Promise.all([a.e(2711),a.e(5101),a.e(3616),a.e(9864),a.e(6322),a.e(4923),a.e(864),a.e(1419),a.e(6409)]).then(a.bind(a,6409)),{loading:()=>(0,r.jsx)(lv,{})}),lT=(0,tw.Q)(async()=>{let{ShoppingOnboardingModal:e}=await Promise.all([a.e(2711),a.e(5101),a.e(3616),a.e(9864),a.e(6322),a.e(4923),a.e(864),a.e(1419),a.e(6409),a.e(2767)]).then(a.bind(a,2767));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lI=(0,tw.Q)(async()=>{let{PurchaseDetailsModal:e}=await a.e(2918).then(a.bind(a,92918));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lR=(0,tw.Q)(async()=>{let{ReservationDetailsModal:e}=await Promise.all([a.e(2711),a.e(5638),a.e(9730)]).then(a.bind(a,9730));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lP=(0,tw.Q)(async()=>{let{SpaceSettingsModal:e}=await a.e(8368).then(a.bind(a,38368));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lO=(0,tw.Q)(async()=>{let{UsernameModal:e}=await a.e(2844).then(a.bind(a,72844));return{default:e}}),lD=(0,tw.Q)(async()=>{let{FullNameModal:e}=await a.e(7411).then(a.bind(a,27411));return{default:e}}),lL=(0,tw.Q)(async()=>{let{KeyboardShortcutEditorModal:e}=await Promise.all([a.e(3719),a.e(1587)]).then(a.bind(a,65895));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lU=(0,tw.Q)(async()=>{let{VoiceToVoiceModal:e}=await Promise.all([a.e(8096),a.e(7914),a.e(559)]).then(a.bind(a,10559));return{default:e}},{loading:()=>(0,r.jsx)(tx,{})}),lF=(0,tw.Q)(async()=>{let{MemoryListModal:e}=await a.e(706).then(a.bind(a,40706));return{default:e}}),lz=(0,tw.Q)(async()=>{let{MemoryDetailModal:e}=await a.e(1279).then(a.bind(a,13660));return{default:e}}),lB=(0,tw.Q)(async()=>{let{HotelRoomDetailsModal:e}=await a.e(3230).then(a.bind(a,83230));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lH=(0,tw.Q)(async()=>{let{PaymentModal:e}=await a.e(1615).then(a.bind(a,71615));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),lq=(0,tw.Q)(async()=>{let{FreeTrialModal:e}=await a.e(4380).then(a.bind(a,51999));return{default:e}}),lG=(0,tw.Q)(async()=>{let{ProReferralModal:e}=await a.e(5058).then(a.bind(a,15058));return{default:e}}),lQ=(0,tw.Q)(async()=>{let{MeetingDefaultsModal:e}=await Promise.all([a.e(7457),a.e(2346)]).then(a.bind(a,42346));return{default:e}}),lV=(0,tw.Q)(async()=>{let{AvailabilityModal:e}=await Promise.all([a.e(8009),a.e(4060)]).then(a.bind(a,84060));return{default:e}}),lK=(0,tw.Q)(async()=>{let{ProMessageModal:e}=await a.e(263).then(a.bind(a,50263));return{default:e}}),lW=(0,tw.Q)(async()=>{let{MemorySearchHistoryIntroModal:e}=await a.e(5833).then(a.bind(a,95833));return{default:e}}),lY=(0,tw.Q)(async()=>a.e(9566).then(a.bind(a,99566))),lX=(0,tw.Q)(async()=>a.e(4975).then(a.bind(a,34975))),lZ=(0,tw.Q)(async()=>a.e(480).then(a.bind(a,40480))),lJ=(0,tw.Q)(async()=>a.e(4388).then(a.bind(a,94388))),l$=(0,tw.Q)(async()=>{let{StudentReferralsModal:e}=await Promise.all([a.e(5638),a.e(9182),a.e(426)]).then(a.bind(a,60426));return{default:e}}),l0=(0,tw.Q)(async()=>{let{SheerIDModal:e}=await Promise.all([a.e(5638),a.e(3165)]).then(a.bind(a,83165));return{default:e}}),l1=(0,tw.Q)(async()=>a.e(8658).then(a.bind(a,28658))),l2=(0,tw.Q)(async()=>{let{RestaurantBookingModal:e}=await Promise.all([a.e(2711),a.e(2884),a.e(3616),a.e(7252),a.e(6322),a.e(864),a.e(5070),a.e(3130)]).then(a.bind(a,13130));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),l3=(0,tw.Q)(async()=>a.e(2436).then(a.bind(a,62436))),l4=(0,tw.Q)(async()=>{let{EnterprisePremiumSecureUpgradeModal:e}=await a.e(1096).then(a.bind(a,61096));return{default:e}}),l5=(0,tw.Q)(async()=>{let{ShortcutModal:e}=await Promise.all([a.e(9591),a.e(2884),a.e(3945),a.e(3719),a.e(9090),a.e(3809)]).then(a.bind(a,13809));return{default:e}}),l8=(0,tw.Q)(async()=>Promise.all([a.e(9591),a.e(2884),a.e(3945),a.e(3719),a.e(9090),a.e(7380)]).then(a.bind(a,37380))),l6=(0,tw.Q)(async()=>{let{AutomationModal:e}=await Promise.all([a.e(8096),a.e(2711),a.e(9591),a.e(2884),a.e(3719),a.e(9090),a.e(7625)]).then(a.bind(a,11294));return{default:e}}),l7=(0,tw.Q)(async()=>{let{FinanceAlertModal:e}=await Promise.all([a.e(8096),a.e(2711),a.e(9591),a.e(2884),a.e(3719),a.e(9090),a.e(7625),a.e(8979)]).then(a.bind(a,58979));return{default:e}}),l9=(0,tw.Q)(async()=>{let{PlatformOptionsModal:e}=await a.e(5435).then(a.bind(a,5435));return{default:e}}),re=(0,tw.Q)(async()=>{let{SharepointSiteModal:e}=await a.e(5488).then(a.bind(a,15488));return{default:e}}),rt=(0,tw.Q)(async()=>{let{MCPServerModal:e}=await a.e(2971).then(a.bind(a,52971));return{default:e}}),ra=(0,tw.Q)(async()=>{let{MemberSetTierModal:e}=await a.e(7409).then(a.bind(a,57409));return{default:e}}),rl=(0,tw.Q)(async()=>{let{MCPServiceToolsModal:e}=await a.e(7028).then(a.bind(a,17028));return{default:e}}),rr=(0,tw.Q)(async()=>{let{PlaceModal:e}=await Promise.all([a.e(2711),a.e(3616),a.e(6322),a.e(864),a.e(5070),a.e(1041)]).then(a.bind(a,35070));return{default:e}},{loading:()=>(0,r.jsx)(lv,{})}),rs=s.memo(e=>{let{}=e,{currentOpenModals:t}=(0,ey.u)(),[a,l]=(0,s.useState)(t.length);(0,s.useEffect)(()=>{setTimeout(()=>{l(t.length)},100)},[t.length]);let i=a!=t.length;return t.map((e,a)=>(0,r.jsx)(ri,{modal:e,canOutsideClickClose:!i&&a+1==t.length},a))});rs.displayName="Modals";let ri=s.memo(e=>{let{modal:t,canOutsideClickClose:a}=e,l=(0,s.useMemo)(()=>({canOutsideClickClose:a}),[a]);return(0,r.jsx)(v.I.Provider,{value:l,children:(0,r.jsx)(rn,{modal:t})})});ri.displayName="SingleModalWrapper";let rn=s.memo(e=>{var t,a,l,s,o,c;let{modal:u}=e,{closeModal:m}=(0,ey.u)(),{hasActiveSubscription:p}=(0,n.E)(),h=u.modalName,{pricingModal:v,loginModal:g,installModal:x,cometDownloadInstructionsModal:b,requestAccessModal:w,collectionSelectModal:_,collectionCreateOrEdit:M,collectionCreateForThread:C,spaceCreate:j,spaceCreateForThread:A,spaceSettings:E,companyDataPrivacyModal:S,citationListModal:k,checkSourcesModal:N,mapModal:T,inputPaymentModal:I,shoppingPaymentModal:R,purchaseConfirmationModal:P,shoppingOnboardingModal:O,shoppingOrderDetailsModal:D,lossAversionModal:L,spaceVideoModal:U,uploadFilesModal:F,spaceUploadFilesModal:z,spaceContextModal:H,locationPermissionModal:q,watchlistModal:G,reservationDetailsModal:Q,deleteMemoryModal:W,memoryDetailModal:Y,hotelRoomDetailsModal:X,memoryListModal:Z,proSubscriptionPaymentModal:J,proMessageModal:$,memorySearchHistoryModal:ee,gmailFailedPermissionsModal:et,subSuccessModal:ea,incentiveProModal:el,restaurantBookingModal:er,sheerIdRedirectModal:es,enterprisePremiumSecureUpgradeModal:ei,taskShortcutModal:en,financeAlertModal:eo,scheduledTaskModal:ed,automationModal:ec,referralSuccessModal:eu,sharepointSiteModal:em,avatarManagementModal:ep,shoppingTryOnOnboardingModal:eh,braintreeSubscriptionModal:ev,announcementImageModal:eg,studentReferrals:ef,sheerIdModal:ex,meetingDefaultsModal:eb,availabilityModal:ew,mcpServerModal:e_,mcpServiceToolsModal:eM,memberSetTierModal:eC,connectorsEnableModal:ej,placeModal:eA,thirdPartyPersonalizationModal:eE}=function(e){return e?{[e.modalName]:e.arg}:{}}(u),{trackEvent:eS}=(0,d.yw)();return(0,r.jsxs)(r.Fragment,{children:["loginModal"===h&&(null==g?void 0:g.origin)&&(0,r.jsx)(e$,{pitchMessage:null==g?void 0:g.pitchMessage,origin:g.origin,isOpen:"loginModal"===h,experimentalImageDesign:g.experimentalImageDesign,sheetModalDesign:g.sheetModalDesign,closeModal:m,closeCallback:null==g?void 0:g.closeCallback,overrideRedirectUrl:null==g?void 0:g.overrideRedirectUrl,disallowedMethods:null==g?void 0:g.disallowedMethods,loginButtonsStyle:null==g?void 0:g.loginButtonsStyle,renderCloseButton:null==g?void 0:g.renderCloseButton,preEnteredEmail:null==g?void 0:g.preEnteredEmail,autoFocus:null==g?void 0:g.autoFocus}),!lh.env.NEXT_PUBLIC_IS_SIDECAR_BUILD&&(0,r.jsx)(lm.w,{isSamsungBrowser:!0,isFirefoxDefaultSearch:!0,isPartnershipCampaign:!0,children:"installModal"===h&&x&&(0,r.jsx)(a2,{isOpen:"installModal"===h,onClose:()=>{var e;m(),null===(e=x.closeCallback)||void 0===e||e.call(x)},origin:x.origin,sheetModalVariant:x.sheetModalVariant})}),"cometDownloadInstructionsModal"===h&&b&&b.requestedPlatform&&(0,r.jsx)(lx,{isOpen:"cometDownloadInstructionsModal"===h,onClose:m,requestedPlatform:b.requestedPlatform}),"pricingModal"===h&&v&&(0,r.jsx)(lE,{isOpen:"pricingModal"===h,pitchMessage:null==v?void 0:v.pitchMessage,closeModal:m,origin:v.origin,showFreeTier:v.showFreeTier,defaultSegment:v.defaultSegment}),"collectionSelectModal"===h&&(null==_?void 0:_.entryUUID)&&(0,r.jsx)(lw,{isOpen:"collectionSelectModal"===h,currentCollection:_.currentCollection,entryUUID:_.entryUUID,searchTerm:_.searchTerm,frontendContextUUID:_.frontendContextUUID,closeModal:m}),"collectionCreateOrEdit"===h&&(0,r.jsx)(lb,{isOpen:"collectionCreateOrEdit"===h,existingCollection:null==M?void 0:M.existingCollection,frontendContextUUID:null==M?void 0:M.frontendContextUUID,closeModal:m,onCreate:null==M?void 0:M.onCreate}),"spaceCreate"===h&&(0,r.jsx)(a5,{isOpen:"spaceCreate"===h,closeModal:m,existingCollection:null==j?void 0:j.existingCollection,onCreate:null==j?void 0:j.onCreate,content:null==j?void 0:j.content}),"spaceCreateForThread"===h&&(null==A?void 0:A.entryUUID)&&(0,r.jsx)(a5,{isOpen:"spaceCreateForThread"===h,closeModal:m,existingCollection:null==j?void 0:j.existingCollection,frontendContextUUID:null==A?void 0:A.frontendContextUUID,entryUUID:null==A?void 0:A.entryUUID,onCreate:null==A?void 0:A.onCreate}),"spaceSettings"===h&&(0,r.jsx)(lP,{isOpen:"spaceSettings"===h,existingSpace:null==E?void 0:E.existingSpace,closeModal:m}),"spaceVideoModal"===h&&U&&(0,r.jsx)(lA,{isOpen:"spaceVideoModal"===h,setIsOpen:m,type:U.type}),"uploadFilesModal"===h&&F&&(0,r.jsx)(ly,{...F,isOpen:"uploadFilesModal"===h,closeModal:m}),"spaceUploadFilesModal"===h&&z&&(0,r.jsx)(ly,{...z,connectionTypes:(0,K.VF)(["LOCAL"]),isOpen:"spaceUploadFilesModal"===h,closeModal:m}),"spaceContextModal"===h&&(0,r.jsx)(eG,{isOpen:"spaceContextModal"===h,closeModal:m,collectionSlug:null==H?void 0:H.collectionSlug}),"requestAccessModal"===h&&(null==w?void 0:w.uuidOrSlug)&&(0,r.jsx)(f,{isOpen:"requestAccessModal"===h,onClose:m,uuidOrSlug:w.uuidOrSlug}),"mapModal"===h&&(0,r.jsx)(lp.t,{fallback:lg,children:(0,r.jsx)(lS,{isOpen:"mapModal"===h,closeModal:m,locations:T&&T.locations,header:T.header,entryUUID:T.entryUUID,searchByLocationOverride:null==T?void 0:T.searchByLocationOverride})}),"collectionCreateForThread"===h&&(null==C?void 0:C.entryUUID)&&(0,r.jsx)(lb,{isOpen:"collectionCreateForThread"===h,existingCollection:null==M?void 0:M.existingCollection,frontendContextUUID:null==C?void 0:C.frontendContextUUID,closeModal:m,entryUUID:null==C?void 0:C.entryUUID}),"inputPaymentModal"===h&&I&&(0,r.jsx)(lk,{isOpen:"inputPaymentModal"===h,closeModal:m,isUpdating:I.isUpdating}),"shoppingPaymentModal"===h&&R&&(0,r.jsx)(lN,{isOpen:"shoppingPaymentModal"===h,closeModal:m,product:R.product,onSuccess:R.onSuccess}),"companyDataPrivacyModal"===h&&(0,r.jsx)(lj,{organizationName:S.organizationName,isOpen:"companyDataPrivacyModal"===h,closeModal:m,onContinue:S.onContinue}),"citationListModal"===h&&k&&k.webResults&&(0,r.jsx)(tC.t,{isOpen:"citationListModal"===h,onClose:m,entry:k.entry,webResults:k.webResults,submit:k.submit}),"checkSourcesModal"===h&&N&&(0,r.jsx)(tM,{isOpen:"checkSourcesModal"===h,onClose:m,entryUUID:N.entryUUID,frontendContextUUID:N.frontendContextUUID,contextUUID:N.contextUUID,webResults:N.webResults,extendedBeforeContext:N.extendedBeforeContext,beforeContext:N.beforeContext,selectedText:N.selectedText,afterContext:N.afterContext,state:null==N?void 0:N.state}),"keyboardShortcutEditorModal"===h&&(0,r.jsx)(lL,{isOpen:"keyboardShortcutEditorModal"===h,closeModal:m}),"keyboardShortcutHelperModal"===h&&(0,r.jsx)(V,{isOpen:"keyboardShortcutHelperModal"===h,closeModal:m}),"onboardingModal"===h&&(0,r.jsx)(l_,{isOpen:"onboardingModal"===h,closeModal:m}),"lossAversionModal"===h&&L&&(0,r.jsx)(lC,{isOpen:"lossAversionModal"===h,onClose:()=>{var e;m(),null===(e=L.callback)||void 0===e||e.call(L)},origin:L.origin}),"shoppingOnboardingModal"===h&&O&&(0,r.jsx)(lT,{isOpen:"shoppingOnboardingModal"===h,onClose:m,onContinue:O.onContinue}),"shoppingOrderDetailsModal"===h&&(0,r.jsx)(lI,{isOpen:"shoppingOrderDetailsModal"===h,onClose:m,item:null==D?void 0:D.item,userIntercomHash:null==D?void 0:D.userIntercomHash}),"purchaseConfirmationModal"===h&&P&&(0,r.jsx)(lM,{isOpen:"purchaseConfirmationModal"===h,onClose:m,order:P.order}),"watchlistModal"===h&&G&&(0,r.jsx)(ak,{isOpen:"watchlistModal"===h,onClose:m,watchlistType:G.watchlistType,origin:G.origin}),"locationPermissionModal"===h&&q&&(0,r.jsx)(lf,{isOpen:"locationPermissionModal"===h,onClose:m,onPermissionGranted:null!==(t=q.onPermissionGranted)&&void 0!==t?t:i.A,origin:q.origin}),"reservationDetailsModal"===h&&Q&&(0,r.jsx)(lR,{isOpen:"reservationDetailsModal"===h,onClose:m,reservation:Q.reservation,userIntercomHash:Q.userIntercomHash}),"usernameModal"===h&&(0,r.jsx)(lO,{isOpen:"usernameModal"===h,onClose:m}),"userFullNameModal"===h&&(0,r.jsx)(lD,{isOpen:"userFullNameModal"===h,onClose:m}),"deleteMemoryModal"===h&&(0,r.jsx)(t$,{isOpen:"deleteMemoryModal"===h,onClose:m,memoryId:null==W?void 0:W.memoryId,onDeleteSuccess:null==W?void 0:W.onDeleteSuccess}),"deleteAllMemoriesModal"===h&&(0,r.jsx)(tJ,{isOpen:"deleteAllMemoriesModal"===h,onClose:m}),"voiceToVoiceModal"===h&&(0,r.jsx)(lU,{isOpen:"voiceToVoiceModal"===h,onClose:m}),"hotelRoomDetailsModal"===h&&X&&(0,r.jsx)(lB,{isOpen:"hotelRoomDetailsModal"===h,onClose:m,...X}),"memoryListModal"===h&&(0,r.jsx)(lF,{isOpen:"memoryListModal"===h,onClose:m,isMemoryEnabled:null!==(a=null==Z?void 0:Z.isMemoryEnabled)&&void 0!==a&&a}),"memoryDetailModal"===h&&Y&&(0,r.jsx)(lz,{isOpen:"memoryDetailModal"===h,onClose:m,memoryKey:Y.memoryKey,displayValue:Y.displayValue}),"thirdPartyPersonalizationModal"===h&&eE&&(0,r.jsx)(t5,{isOpen:"thirdPartyPersonalizationModal"===h,onClose:m,...eE}),"proSubscriptionPaymentModal"===h&&J&&(0,r.jsx)(lH,{isOpen:"proSubscriptionPaymentModal"===h,onClose:m,...J}),"proReferralModal"===h&&(0,r.jsx)(lG,{isOpen:"proReferralModal"===h,onClose:m}),"proMessageModal"===h&&$&&(0,r.jsx)(lK,{isOpen:"proMessageModal"===h,onClose:m,...$}),"freeTrialModal"===h&&(0,r.jsx)(lq,{isOpen:"freeTrialModal"===h,onClose:m}),"memorySearchHistoryModal"===h&&(0,r.jsx)(tj.N,{isOpen:"memorySearchHistoryModal"===h,onClose:m,snippet:null!==(l=null==ee?void 0:ee.snippet)&&void 0!==l?l:"",type:null!==(s=null==ee?void 0:ee.type)&&void 0!==s?s:"memory",url:null!==(o=null==ee?void 0:ee.url)&&void 0!==o?o:"",memoryKey:null==ee?void 0:ee.memoryKey,entryUuid:null==ee?void 0:ee.entryUuid,title:null==ee?void 0:ee.title,timestamp:null==ee?void 0:ee.timestamp}),"memorySearchHistoryIntroModal"===h&&(0,r.jsx)(lW,{isOpen:"memorySearchHistoryIntroModal"===h,onClose:m}),"gmailFailedPermissionsModal"===h&&et&&(0,r.jsx)(tX,{isOpen:"gmailFailedPermissionsModal"===h,onContinue:null!==(c=et.onContinue)&&void 0!==c?c:i.A,onClose:m}),"subSuccessModal"===h&&ea&&(0,r.jsx)(lY,{isOpen:"subSuccessModal"===h,onClose:m,flowType:ea.flowType,upgradeMax:ea.upgradeMax,subscriptionTier:ea.subscriptionTier,confirmationRedirectsToHomepage:ea.confirmationRedirectsToHomepage}),"referralErrorModal"===h&&(0,r.jsx)(lX,{isOpen:"referralErrorModal"===h,onClose:m}),"referralSuccessModal"===h&&eu&&(0,r.jsx)(lZ,{isOpen:"referralSuccessModal"===h,onClose:m,monthsAwarded:eu.monthsAwarded}),"incentiveProModal"===h&&(0,r.jsx)(lJ,{isOpen:"incentiveProModal"===h,onClose:m,...el}),"braintreeSubscriptionModal"===h&&ev&&(0,r.jsx)(l1,{isOpen:"braintreeSubscriptionModal"===h,onClose:m,origin:ev.origin}),"sheerIdRedirectModal"===h&&es&&(0,r.jsx)(l3,{isOpen:"sheerIdRedirectModal"===h,onContinue:()=>{m(),(0,e3.x)(es.sheerIdUrl,"sheerIdRedirectModal")},onCancel:m}),"upgradeModal"===h&&(0,r.jsx)(lu,{isOpen:"upgradeModal"===h,onClose:m}),"downgradeModal"===h&&(0,r.jsx)(ll,{isOpen:"downgradeModal"===h,onClose:m}),"restaurantBookingModal"===h&&er&&(0,r.jsx)(l2,{isOpen:"restaurantBookingModal"===h,onClose:m,...er}),"bugReportModal"===h&&(0,r.jsx)(B,{isOpen:"bugReportModal"===h,onClose:m}),"enterprisePremiumSecureUpgradeModal"===h&&(0,r.jsx)(l4,{isOpen:"enterprisePremiumSecureUpgradeModal"===h,onClose:m,onUpgradeSuccess:null==ei?void 0:ei.onUpgradeSuccess}),"taskShortcutModal"===h&&en&&(0,r.jsx)(l5,{open:"taskShortcutModal"===h,onClose:()=>{var e;m(),null===(e=en.onClose)||void 0===e||e.call(en)},onCreated:en.onCreated,source:en.source,shortcut:en.shortcut}),"financeAlertModal"===h&&eo&&(0,r.jsx)(l7,{isOpen:"financeAlertModal"===h,onClose:()=>{var e;m(),null===(e=eo.onClose)||void 0===e||e.call(eo)},symbol:eo.symbol,task:eo.task}),"scheduledTaskModal"===h&&ed&&(0,r.jsx)(ty.rm,{children:(0,r.jsx)(l8,{open:"scheduledTaskModal"===h,onClose:()=>{var e;m(),null===(e=ed.onClose)||void 0===e||e.call(ed)},onSuccess:ed.onSuccess,source:ed.source,initial:ed.initial,prefill:ed.prefill})}),"automationModal"===h&&ec&&(0,r.jsx)(ty.rm,{children:(0,r.jsx)(l6,{open:"automationModal"===h,onClose:()=>{var e;m(),null===(e=ec.onClose)||void 0===e||e.call(ec)},source:ec.source,initialConfiguration:ec.initial?(0,y.to)({selectedTask:ec.initial}):ec.prefill?(0,y.wj)(ec.prefill):ec.initialConfiguration||(0,y.XT)(p),onSave:e=>{var t,a;null===(t=ec.onSuccess)||void 0===t||t.call(ec,e),m(),null===(a=ec.onClose)||void 0===a||a.call(ec)},errorMessage:ec.errorMessage,trackEvent:eS})}),"platformOptionsModal"===h&&(0,r.jsx)(l9,{isOpen:"platformOptionsModal"===h,onClose:m}),"sharepointSiteModal"===h&&em&&(0,r.jsx)(re,{isOpen:"sharepointSiteModal"===h,onClose:m,onSelectSite:em.onSelectSite}),"avatarManagementModal"===h&&ep&&(0,r.jsx)(aP,{isOpen:"avatarManagementModal"===h,onClose:m,config:null!=ep?ep:{source:"settings"}}),"shoppingTryOnOnboardingModal"===h&&(0,r.jsx)(tf,{isOpen:"shoppingTryOnOnboardingModal"===h,onClose:(null==eh?void 0:eh.onClose)||m,onSuccessfulOnboarding:(null==eh?void 0:eh.onSuccessfulOnboarding)||(()=>{})}),"announcementImageModal"===h&&eg&&(0,r.jsx)(lm.w,{isSamsungBrowser:!0,isFirefoxDefaultSearch:!0,isPartnershipCampaign:!0,children:(0,r.jsx)(e6,{onClose:m,announcementImageModal:eg})}),"studentReferrals"===h&&(0,r.jsx)(l$,{isOpen:"studentReferrals"===h,verificationId:null==ef?void 0:ef.verificationId}),"sheerIdModal"===h&&(0,r.jsx)(l0,{isOpen:"sheerIdModal"===h,onClose:()=>{var e;null==ex||null===(e=ex.onClose)||void 0===e||e.call(ex),m()},onVerificationSuccess:e=>{var t;null==ex||null===(t=ex.onSuccess)||void 0===t||t.call(ex,e),m()},type:(null==ex?void 0:ex.type)||"student"}),"meetingDefaultsModal"===h&&(0,r.jsx)(lQ,{currentDuration:null==eb?void 0:eb.currentDuration,currentBuffer:null==eb?void 0:eb.currentBuffer,onSave:null==eb?void 0:eb.onSave}),"availabilityModal"===h&&(0,r.jsx)(lV,{currentAvailability:null==ew?void 0:ew.currentAvailability,onSave:null==ew?void 0:ew.onSave}),"mcpServerModal"===h&&e_&&(0,r.jsx)(rt,{isOpen:"mcpServerModal"===h,onClose:m,server:e_.server,onSave:e_.onSave,onDelete:e_.onDelete}),"mcpServiceToolsModal"===h&&eM&&(0,r.jsx)(rl,{isOpen:"mcpServiceToolsModal"===h,onClose:m,server:eM.server,onEditServer:eM.onEditServer,onToggleToolEnabled:eM.onToggleToolEnabled}),"memberSetTierModal"===h&&eC&&(0,r.jsx)(ra,{isOpen:"memberSetTierModal"===h,...eC,onClose:()=>{var e;m(),null===(e=eC.onClose)||void 0===e||e.call(eC)}}),"connectorsEnableModal"===h&&ej&&(0,r.jsx)(tW,{connectorName:ej.connectorName,connectorAvatar:ej.connectorAvatar,showModal:"connectorsEnableModal"===h,setShowModal:()=>m(),connectionType:ej.connectionType,reason:ej.reason,referrer:ej.referrer,referrerId:ej.referrerId,badge:ej.badge,handleEnable:ej.handleEnable}),"placeModal"===h&&eA&&(0,r.jsx)(rr,{isOpen:"placeModal"===h,onClose:m,place:eA.place,mode:eA.mode,entryUUID:eA.entryUUID,contextUUID:eA.contextUUID})]})});rn.displayName="SingleModal"},16850:(e,t,a)=>{"use strict";a.d(t,{O:()=>l});let l=(0,a(27773).w)({path:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0 M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0 M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",name:"IconDots",variant:"stroked"})},17304:(e,t,a)=>{"use strict";a.d(t,{O:()=>g});var l=a(25576),r=a(85860),s=a(35419),i=a(89573),n=a(65811);a(4092);var o=a(14337),d=a(36206),c=a(30571);a(60410),a(17147);let u=(0,a(92988).j)("CometMcpModalStateContext",{askPermissionsModalState:null,openAskPermissionsModal:()=>{},closeAskPermissionsModal:()=>{}}),m=()=>(0,r.useContext)(u),p=e=>{var t,a;return Object.fromEntries(Object.entries(null!==(a=null===(t=e.compatibility)||void 0===t?void 0:t.permissions)&&void 0!==a?a:{}).filter(e=>{let[t,a]=e;return!!a}).map(e=>{let[t,a]=e;return"object"==typeof a?[t,a]:[t,{}]}))},h=e=>Object.entries(p(e)).filter(e=>{let[,{for_tools:t}]=e;return!t}).map(e=>{let[t]=e;return t}),v=e=>{let{cometState:t}=e;return(0,r.useMemo)(()=>t.installedDxts?Array.from(new Set(t.installedDxts.flatMap(e=>{let{manifest:t}=e;return h(t)}))):[],[t.installedDxts])},g=()=>{let e=(0,o.jX)(),{data:t}=(0,n.i)(),{openAskPermissionsModal:a}=m(),u=v({cometState:e}),p=(0,o.Zh)(),g=(0,s.useQueries)({queries:u.map(e=>({queryKey:["comet/permission",e],queryFn:()=>p.hasPermission(e)}))}).map(e=>e.data),f=(0,r.useMemo)(()=>{let e;return t=>((0,c.bN)(e,t)||(e=t),e)},[])(g),y=(0,r.useMemo)(()=>{var t;return new Set(null===(t=e.mcpStdioServers)||void 0===t?void 0:t.filter(t=>{let a=(0,d.tL)(e.installedDxts,t);return(a?h(a):[]).some(e=>{let t=u.indexOf(e);return -1!==t&&!1===f[t]})}).map(e=>e.name))},[e.mcpStdioServers,e.installedDxts,u,f]),x=(0,r.useMemo)(()=>{var a,r;return Object.fromEntries(null!==(r=null===(a=e.mcpStdioServers)||void 0===a?void 0:a.map(a=>{var r,s;let o=(0,d.tL)(e.installedDxts,a),c=(0,n.C)(t,a),u=null!==(s=null!==(r=null==o?void 0:o.display_name)&&void 0!==r?r:null==o?void 0:o.name)&&void 0!==s?s:a.name,m=y.has(a.name);return[a.name,{icon:void 0,avatar:(0,l.jsx)(i.h,{serverName:u,iconUrl:c,size:"sm"}),text:u,disabled:"running"!==a.status||!a.tools_count||m,description:"",type:"toggle",iconUrl:c}]}))&&void 0!==r?r:[])},[e.mcpStdioServers,e.installedDxts,t,y]),b=(0,r.useCallback)((t,l)=>{var r;if(!y.has(t)){l();return}let s=null===(r=e.mcpStdioServers)||void 0===r?void 0:r.find(e=>e.name===t);if(!s)return;let i=(0,d.tL)(e.installedDxts,s);i&&a({serverName:t,permissions:h(i),onPermissionsGranted:l})},[e.mcpStdioServers,e.installedDxts,y,a]),w=(0,r.useCallback)(t=>{b(t,()=>{var a;let l=null!==(a=e.mcpDisabledServers)&&void 0!==a?a:new Set,r=new Set(l);l.has(t)?r.delete(t):r.add(t),e.actions.setMcpDisabledServers(r)})},[e.actions,e.mcpDisabledServers,b]),_=(0,r.useCallback)(t=>{b(t,()=>{var a;let l=new Set(null!==(a=e.mcpDisabledServers)&&void 0!==a?a:new Set);l.delete(t),e.actions.setMcpDisabledServers(l)})},[e.actions,e.mcpDisabledServers,b]),M=(0,r.useCallback)(t=>{var a;let l=new Set(null!==(a=e.mcpDisabledServers)&&void 0!==a?a:new Set);l.add(t),e.actions.setMcpDisabledServers(l)},[e.actions,e.mcpDisabledServers]),C=(0,r.useMemo)(()=>{var t;return new Set([...null!==(t=e.mcpDisabledServers)&&void 0!==t?t:[],...y])},[e.mcpDisabledServers,y]),j=(0,r.useCallback)(e=>e in x&&!(null==C?void 0:C.has(e)),[x,C]);return(0,r.useMemo)(()=>({cometMcpSources:x,toggleCometMcpSource:w,addCometMcpSource:_,removeCometMcpSource:M,hasCometMcpSource:j,cometMcpDisabledServers:C}),[x,w,_,M,j,C])}},17760:(e,t,a)=>{"use strict";a.d(t,{SL:()=>c,X8:()=>u,X_:()=>o,bI:()=>n,s6:()=>d});var l=a(77150),r=a(77917),s=a(30002);a(18360);var i=a(3041);let n=async e=>{let{headers:t={},params:a,reason:i}=e,n=await r.By.GET("/rest/collections/list_user_collections",i,{params:{query:{limit:a.limit,offset:a.offset,version:s.mj6}},timeoutMs:(0,r.e4)(),headers:t});if(!n.response.ok||!n.data)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to list user collections",cause:n.error});return n.data},o=async e=>{let{headers:t={},params:a,reason:s}=e;try{let{error:e,data:i}=await r.By.GET("/rest/collections/get_collection",s,{params:{query:a},headers:t,timeoutMs:(0,r.e4)()});if(e)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to get collection",cause:e});if(!(null==i?void 0:i.status)||(null==i?void 0:i.status)==="failed")throw new l.T("API_CLIENTS_ERROR",{message:"Failed to get collection",cause:i});return i}catch(e){i.vF.error(e);return}},d=async e=>{let{headers:t={},params:a,reason:s}=e;try{let{error:e}=await r.By.PUT("/rest/collections/{collection_uuid}/access",s,{params:{path:{collection_uuid:a.collection_uuid}},headers:t,body:{updated_access:a.updated_access},timeoutMs:(0,r.e4)()});if(e)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to update collection access",cause:e})}catch(e){i.vF.error(e)}},c=async e=>{let{params:t,reason:a}=e;try{let{error:e,data:s}=await r.By.POST("/rest/collections/upsert_thread_collection",a,{body:t});if(e)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to upsert thread collection",cause:e});if(!s)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to upsert thread collection",cause:s});return s}catch(e){return}},u=async e=>{let{collectionUUID:t,entryUUID:a,reason:s}=e;try{let{error:e}=await r.By.DELETE("/rest/collections/remove_collection_thread",s,{params:{query:{collection_uuid:t,entry_uuid:a}}});if(e)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to remove thread from collection",cause:e})}catch(e){return}}},18811:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(18507),o=a(12839),d=a(43627);let c=r.memo(e=>{let{blockCount:t,size:a=d.or.large,animateLines:s=!0,divider:c,noLines:u,noHeight:m,variant:p="subtler",className:h,...v}=e,g="h-1 bg-inverse/70  rounded-full",f=(0,r.useMemo)(()=>{let e=[];for(let r=0;r<(null!=t?t:1);r++)e.push((0,l.jsx)(o.Ay,{variant:p,className:i()("animate-pulse rounded-md",{"h-8":a===d.or.small,"h-10":a===d.or.regular,"h-[72px]":a===d.or.large,"h-32":a===d.or.xl,"h-6":a===d.or.tiny,"h-full":m}),children:(0,l.jsx)("div",{className:"gap-y-sm p-md flex h-full flex-col",children:!u&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.P.div,{initial:{width:s?0:"100%"},animate:{width:"100%"},transition:{duration:.8,delay:.2},className:g}),(0,l.jsx)(n.P.div,{initial:{width:s?0:"100%"},animate:{width:"100%"},transition:{duration:.8,delay:.2},className:g}),(0,l.jsx)(n.P.div,{initial:{width:s?0:"80%"},animate:{width:"80%"},transition:{duration:.8,delay:.2},className:g}),(0,l.jsx)(n.P.div,{initial:{width:s?0:"20%"},animate:{width:"20%"},transition:{duration:.8,delay:.2},className:g})]})})},r));return e},[s,t,a,u,m,p]);return(0,l.jsx)(o.Ay,{className:i()("h-full",{"divider gap-y-sm flex flex-col":c,"absolute top-0 w-full":m},h),...v,children:f})});c.displayName="TextBlockThrobber";let u=c},21615:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});let l=(0,a(27773).w)({path:"M7 11v8a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-7a1 1 0 0 1 1 -1h3a4 4 0 0 0 4 -4v-1a2 2 0 0 1 4 0v5h3a2 2 0 0 1 2 2l-1 5a2 3 0 0 1 -2 2h-7a3 3 0 0 1 -3 -3",name:"IconThumbUp",variant:"stroked"})},21753:(e,t,a)=>{"use strict";a.d(t,{m:()=>u,u:()=>c});var l=a(85860),r=a(15492),s=a(44152),i=a(42826),n=a(80314),o=a(11129),d=a(18360);let c=e=>{let{fileRepoInfo:t,connectionTypes:a,status:s,searchKeyword:c,parentUuids:u,rootFilesOnly:m,cursor:p,pollingEnabled:h=!1,pageSize:v,fileTypes:g,reason:f}=e,[y,x]=(0,l.useState)(!1),b=(0,l.useMemo)(()=>({file_repository_info:t,filters:{connection_types:null!=a?a:d.Ml,status:null!=s?s:d.Ml,search_keyword:c,parent_uuids:null!=u?u:d.Ml,root_files_only:null!=m&&m,file_types:null!=g?g:d.Ml,connection_ids:d.Ml,ids:d.Ml,remote_file_ids:d.Ml,uuids:d.Ml,upload_ids:d.Ml},pagination:{cursor:p,page_size:null!=v?v:100},order_by:"updated",order_dir:"desc"}),[t,a,s,c,u,m,p,v,g]),w=(0,r.useQuery)({queryKey:(0,o.UW)(b),queryFn:()=>(0,n.nN)({request:b,reason:f}),refetchInterval:()=>!!h&&!!y&&5e3,staleTime:0,gcTime:0,enabled:"COLLECTION"!==t.file_repository_type||"COLLECTION"===t.file_repository_type&&!!t.owner_id&&t.owner_id!==i.Ox});return(0,l.useEffect)(()=>{var e;x((null===(e=w.data)||void 0===e?void 0:e.files.some(e=>"SYNCING"===e.status||"QUEUED"===e.status))||!1)},[w.data]),w},u=e=>{let{fileRepoInfo:t,connectionTypes:a,status:l,searchKeyword:r,parentUuids:i,rootFilesOnly:c,pageSize:u,fileTypes:m,reason:p}=e,h={file_repository_info:t,filters:{connection_types:null!=a?a:d.Ml,status:null!=l?l:d.Ml,search_keyword:r,parent_uuids:null!=i?i:d.Ml,root_files_only:null!=c&&c,file_types:null!=m?m:d.Ml,connection_ids:d.Ml,ids:d.Ml,remote_file_ids:d.Ml,uuids:d.Ml,upload_ids:d.Ml},pagination:{page_size:null!=u?u:100},order_by:"updated",order_dir:"desc"};return(0,s.useInfiniteQuery)({enabled:"USER"===t.file_repository_type||"COLLECTION"===t.file_repository_type&&!!t.owner_id,initialPageParam:void 0,queryKey:(0,o.UW)(h,!0),queryFn:e=>{let{pageParam:t}=e;return(0,n.nN)({request:{...h,pagination:{cursor:t,page_size:null!=u?u:100}},reason:p})},getNextPageParam:e=>{var t;return null!==(t=e.next_cursor)&&void 0!==t?t:void 0}})}},23095:(e,t,a)=>{"use strict";a.d(t,{j:()=>D});var l=a(25576),r=a(85860),s=a(43084),i=a(64299),n=a.n(i),o=a(52243),d=a(18507),c=a(38806),u=a(53175),m=a(83081),p=a(68361),h=a(84011),v=a(80892),g=a(12839),f=a(60410),y=a(38683),x=a(26890),b=a(60010),w=a(90915),_=a(27773);let M=(0,_.w)({path:"M10.293 3.207c.63-.63 1.707-.184 1.707.707v16.172c0 .89-1.077 1.337-1.707.707L5.5 16H3a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h2.5l4.793-4.793Zm6.63 1.164a1 1 0 0 1 1.323-.209l.083.06.215.179a10.003 10.003 0 0 1 2.523 11.909 10.003 10.003 0 0 1-2.738 3.468 1 1 0 0 1-1.258-1.555A8.006 8.006 0 0 0 20.043 12a8 8 0 0 0-2.632-5.932l-.34-.29-.076-.068a1.001 1.001 0 0 1-.072-1.339ZM14.2 7.401a1 1 0 0 1 1.4-.2 6 6 0 0 1 0 9.599 1 1 0 1 1-1.2-1.6 4 4 0 0 0 0-6.4 1 1 0 0 1-.2-1.4Z",name:"IconProductVolume",variant:"filled"}),C=(0,_.w)({path:"M12 16.5v3.586c0 .89-1.077 1.337-1.707.707L5.5 16H3a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h.5l8.5 8.5ZM2.293 2.293a1 1 0 0 1 1.414 0l3.75 3.75 2.836-2.836c.63-.63 1.707-.184 1.707.707v6.672l3.444 3.444a3.76 3.76 0 0 0 .134-.24A4.001 4.001 0 0 0 14.4 8.8a1 1 0 0 1 1.2-1.6 6 6 0 0 1 1.766 7.484c-.138.277-.3.54-.478.79l1.454 1.454A7.955 7.955 0 0 0 20.043 12a8.002 8.002 0 0 0-2.632-5.932l-.34-.29-.076-.068a1.001 1.001 0 0 1 1.251-1.548l.083.06.215.179a10.004 10.004 0 0 1 2.523 11.909 9.972 9.972 0 0 1-1.303 2.04l1.943 1.943.068.076a1 1 0 0 1-1.406 1.407l-.076-.069-18-18a1 1 0 0 1 0-1.414Z",name:"IconProductVolumeMuted",variant:"filled"}),j=(0,_.w)({path:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0 M12 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0 M12 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",name:"IconDotsVertical",variant:"stroked"});var A=a(12718);let E=(0,_.w)({path:"M4 8v-2a2 2 0 0 1 2 -2h2 M4 16v2a2 2 0 0 0 2 2h2 M16 4h2a2 2 0 0 1 2 2v2 M16 20h2a2 2 0 0 0 2 -2v-2",name:"IconMaximize",variant:"stroked"}),S=(0,_.w)({path:"M9 4h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h2a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2z M17 4h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h2a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2z",name:"IconPlayerPauseFilled",variant:"filled"});var k=a(69721),N=a(40578),T=a(49427),I=a(67121);let R=r.memo(e=>{let{videoUrl:t,hideTimeline:a=!0,aspectRatio:s=16/9,className:i,onLoadedData:o,isGenerated:d=!1,entryUUID:c,autoPlay:_=!1,muted:R=!0}=e,P=(0,r.useRef)(null),[O,D]=(0,r.useState)(!1),[L,U]=(0,r.useState)(R),[F,z]=(0,r.useState)(0),[B,H]=(0,r.useState)(!1),[q,G]=(0,r.useState)(!1),[Q,V]=(0,r.useState)(!0),{trackEvent:K}=(0,v.yw)();(0,h.$)({assetType:I.PW.GENERATED_VIDEO,entryUUID:null!=c?c:"",answerMode:"search",reason:"video-player",skip:!d||!q}),(0,r.useEffect)(()=>{if(q&&P.current){let e=P.current;V(e.mozHasAudio||!!e.webkitAudioDecodedByteCount||!!(e.audioTracks&&e.audioTracks.length))}},[q,P]);let W=(0,r.useCallback)(e=>{e.stopPropagation(),P.current&&(P.current.paused?P.current.play():P.current.pause(),D(!O))},[O]),Y=(0,r.useCallback)(e=>{e.stopPropagation(),P.current&&(P.current.muted=!L,U(!L))},[L]),X=(0,r.useCallback)(e=>{if(e.stopPropagation(),P.current){let t=e.currentTarget.getBoundingClientRect(),a=(e.clientX-t.left)/t.width*P.current.duration;P.current.currentTime=a}},[]);(0,r.useEffect)(()=>{let e=setInterval(()=>{if(P.current)z(P.current.currentTime/P.current.duration)},16);return()=>clearInterval(e)},[]);let{$t:Z}=(0,m.A)(),[J,$]=(0,r.useState)(!1),ee=(0,r.useCallback)(()=>$(!0),[]),et=(0,r.useCallback)(()=>$(!1),[]),{trackEventOnce:ea}=(0,v.yw)(),{deprecatedOpenToast:el}=(0,b.G)(),{isMobileStyle:er}=(0,y.al)(),{downloadMediaAsset:es}=(0,p.s)({reason:"GeneratedVideoCard"}),ei=(0,r.useCallback)(()=>{t&&(ea("generated video reported",{video_url:t}),el(Z({defaultMessage:"Video reported",id:"Ir50ThCD/C"}),"success",3))},[Z,t,el,ea]),en=(0,r.useCallback)(async e=>{e.stopPropagation(),t&&(await es(t,"video.mp4",document.body),d&&K("generated asset downloaded",{assetType:I.PW.GENERATED_VIDEO,answerMode:"search",entryUUID:null!=c?c:"",reason:"video-player"}))},[t,es,d,c,K]),eo=(0,r.useMemo)(()=>[{type:"default",text:Z({defaultMessage:"Report",id:"x5Tz6MZH82"}),icon:N.k,onClick:ei}],[Z,ei]),ed=(0,r.useCallback)(e=>{e.stopPropagation(),P.current&&(P.current.requestFullscreen?P.current.requestFullscreen():P.current.webkitEnterFullscreen?P.current.webkitEnterFullscreen():P.current.mozRequestFullScreen?P.current.mozRequestFullScreen():P.current.msRequestFullscreen&&P.current.msRequestFullscreen())},[]),ec=(0,r.useMemo)(()=>({aspectRatio:s}),[s]);return(0,l.jsx)(u.l,{fullBleed:!0,className:n()("group relative w-full overflow-hidden",i),style:ec,children:(0,l.jsxs)("div",{className:"relative size-full overflow-hidden",onMouseEnter:()=>H(!0),onMouseLeave:()=>H(!1),children:[(0,l.jsx)("video",{ref:P,loop:!0,autoPlay:_,playsInline:!0,muted:L,className:n()("size-full object-cover",{"opacity-0":!q}),onPlay:()=>D(!0),onPause:()=>D(!1),onClick:W,onLoadedData:()=>{G(!0),null==o||o()},src:t+"#t=0.001"}),(0,l.jsx)("div",{className:n()("absolute inset-0 flex flex-col justify-end transition-opacity duration-200",B||J||!O?"opacity-100":"opacity-0",q?"":"pointer-events-none opacity-0"),onClick:W,children:(0,l.jsxs)("div",{className:n()("p-md flex w-full flex-col bg-gradient-to-t from-black/60 to-transparent pb-0",a?"pb-md":"pb-0"),children:[(0,l.jsxs)("div",{className:"gap-md flex",children:[(0,l.jsx)(g.Ay,{as:"button",onClick:W,children:(0,l.jsx)(f.A,{color:"white",children:(0,l.jsx)(T.A,{icon:O?S:k.z})})}),(0,l.jsx)(w.A,{showTooltip:d&&!Q,tooltipLayout:"right",tooltipText:Z({defaultMessage:"This video does not have audio.",id:"V7VF0Hgi7t"}),asChild:!0,children:(0,l.jsx)(g.Ay,{as:"button",onClick:Q?Y:e=>e.stopPropagation(),className:n()({"opacity-50":!Q}),children:(0,l.jsx)(f.A,{color:"white",children:(0,l.jsx)(T.A,{icon:L?C:M})})})}),(0,l.jsx)(g.Ay,{as:"button",className:"ml-auto",onClick:en,children:(0,l.jsx)(f.A,{color:"white",children:(0,l.jsx)(T.A,{icon:A.i})})}),(0,l.jsx)(g.Ay,{as:"button",onClick:ed,children:(0,l.jsx)(f.A,{color:"white",children:(0,l.jsx)(T.A,{icon:E})})}),(0,l.jsx)(x.n,{isMobileStyle:er,items:eo,onOpen:ee,onClose:et,wrapperClassName:"flex",children:(0,l.jsx)(g.Ay,{as:"button",className:"size-[20px]",children:(0,l.jsx)(f.A,{color:"white",children:(0,l.jsx)(T.A,{icon:j})})})})]}),!a&&(0,l.jsx)("div",{className:"py-md cursor-pointer",onClick:X,children:(0,l.jsx)("div",{className:"relative h-0.5 flex-1 shrink-0 cursor-pointer overflow-hidden rounded-full bg-white/30",children:(0,l.jsx)("div",{className:"absolute left-0 top-0 size-full bg-white",style:{transformOrigin:"left",transform:"scaleX(".concat(F,")")}})})})]})})]})})});R.displayName="VideoPlayer";let P=r.memo(e=>{let{loading:t,size:a=30}=e,[i,{width:u,height:m}]=(0,s.A)(),[p,h]=(0,r.useState)(0),[v,g]=(0,r.useState)(0),f=(0,o.A)(0,0,.58,1),y=(0,o.A)(.19,1,.22,1);(0,r.useEffect)(()=>{if(u&&m){let e=Math.ceil(u/a),t=Math.ceil(m/a);h(e),g(t)}},[u,m,a]);let x=u?((e,t)=>{let a=Math.floor(t/e);return a%2!=0&&(a-=1),t/(a=Math.max(2,a))})(a,u):a;return(0,l.jsx)("div",{ref:i,style:{gridTemplateColumns:"repeat(auto-fill, ".concat(x,"px)"),gridTemplateRows:"repeat(auto-fill, ".concat(x,"px)")},className:n()("pointer-events-none absolute inset-0 z-[5] grid size-full gap-0",{"bg-raised":0===p||0===v}),children:(0,l.jsx)(c.N,{children:[...Array(p*v)].map((e,a)=>t?(0,l.jsx)(d.P.div,{animate:{opacity:[.9,0],transition:{repeat:1/0,duration:.5,delay:function(e,t){let a=Math.ceil(0);return Math.floor(Math.random()*(Math.floor(10)-a)+a)}(0,0)/10,repeatType:"mirror",ease:f}},exit:{opacity:0,transition:{duration:1,ease:y}},className:"bg-base relative",children:(0,l.jsx)("div",{className:"bg-raised inset-0 size-full"})},a):null)})})});P.displayName="BlinkingGrid";var O=a(15925);let D=r.memo(e=>{var t;let{sourceImage:a,media:i,generating:m,square:p=!1,type:h="image",onMediaLoad:v,entryUUID:g}=e,f=(0,o.A)(.19,1,.22,1),[y,x]=(0,r.useState)(void 0),[b,w]=(0,r.useState)(!1),[_,M]=(0,r.useState)(!m),[C,j]=(0,r.useState)(!0),[A,{width:E}]=(0,s.A)();(0,r.useEffect)(()=>{let e="video"===h?"VIDEO_GEN_PLACEHOLDER":"IMAGE_GEN_PLACEHOLDER";i&&i.name!==e&&x(i)},[i,h]),(0,r.useEffect)(()=>{C&&j(!1)},[C]),(0,r.useEffect)(()=>{m&&(w(!1),M(!1))},[m]),(0,r.useEffect)(()=>{if(b&&!m){let e=setTimeout(()=>{M(!0)},1e3);return()=>clearTimeout(e)}},[b,m]);let S=((e,t)=>{let a=Math.floor(t/e);return a%2!=0&&(a-=1),t/(a=Math.max(2,a))})(30,E),k=(0,r.useCallback)(()=>{w(!0),null==v||v()},[v]),N=(0,r.useMemo)(()=>({url:null==y?void 0:y.url,name:null==y?void 0:y.name,showCitation:!1}),[null==y?void 0:y.url,null==y?void 0:y.name]);return(0,l.jsx)("div",{ref:A,className:"relative size-full shrink-0",children:0!==S?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P,{loading:!_,size:S}),(0,l.jsx)(d.P.div,{className:"relative size-full",style:{maskSize:"".concat(S,"px ").concat(S,"px"),maskPosition:"top left",maskRepeat:"repeat"},initial:{maskImage:_?"radial-gradient(black ".concat(S/5*4,"px, transparent 0px)"):"radial-gradient(black ".concat(S/5,"px, transparent 0px)")},animate:{maskImage:_?"radial-gradient(black ".concat(S/5*4,"px, transparent 0px)"):"radial-gradient(black ".concat(S/5,"px, transparent 0px)")},transition:{duration:1,ease:f},children:(0,l.jsx)(u.l,{className:n()("relative size-full overflow-hidden !rounded-md ".concat(_?"cursor-pointer":""),{"!rounded-none":p}),fullBleed:!0,children:(0,l.jsx)(d.P.div,{animate:{filter:!_&&a?"blur(20px) saturate(2)":"none"},transition:{duration:1,ease:f},className:"grid size-full",children:(0,l.jsx)("div",{className:"relative w-full bg-black/40 dark:bg-white/40",children:(0,l.jsxs)(c.N,{children:[((null==a?void 0:a.startsWith("http"))||(null==a?void 0:a.startsWith("blob")))&&!_&&(0,l.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1,ease:f},className:"absolute inset-0 size-full",children:(0,l.jsx)("img",{src:a,alt:"Source",className:"block size-full object-cover"})},"source"),(null==y?void 0:null===(t=y.image)||void 0===t?void 0:t.startsWith("http"))&&(0,l.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:+!!_},exit:{opacity:0},transition:{duration:1,ease:f},className:"absolute inset-0 size-full",children:"image"===h?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O.A,{src:y.image||y.thumbnail,alt:y.name||"Generated Image",origin:N,includeLightBoxModal:!!_,maskClassName:n()("!bg-transparent",{"!rounded-none":p}),imageClassName:"block w-full h-full max-h-[100%] object-contain !bg-transparent",containerClassName:"w-full h-full absolute inset-0 z-10 !bg-transparent",onLoad:k}),(0,l.jsx)("img",{src:y.image||y.thumbnail,alt:y.name||"Generated Image",className:"absolute inset-0 block size-full object-cover blur-[20px] saturate-150"})]}):(0,l.jsx)(R,{videoUrl:y.image,isGenerated:!0,aspectRatio:11/6,onLoadedData:k,className:"absolute inset-0 block size-full !rounded-none object-cover",entryUUID:g})},"generated")]})})})})})]}):null})});D.displayName="GeneratedMediaLoader"},23508:(e,t,a)=>{"use strict";a.d(t,{Q:()=>l});let l=(0,a(27773).w)({path:"M10 9a2 2 0 1 0 4 0a2 2 0 0 0 -4 0 M4 8v-2a2 2 0 0 1 2 -2h2 M4 16v2a2 2 0 0 0 2 2h2 M16 4h2a2 2 0 0 1 2 2v2 M16 20h2a2 2 0 0 0 2 -2v-2 M8 16a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2",name:"IconUserScan",variant:"stroked"})},24877:(e,t,a)=>{"use strict";a.d(t,{Aq:()=>i,Rg:()=>s,d4:()=>r});var l=a(57023);let r=(0,l.YK)({monthly:{defaultMessage:"Pay monthly",id:"dC8ig5S+30"},yearly:{defaultMessage:"Pay yearly",id:"szrzn7zQJJ"},unknown:{defaultMessage:"Unknown",id:"5jeq8PJZg7"}}),s=(0,l.YK)({monthly:{defaultMessage:"{price} per month",id:"MdFvGXMUO4"},yearly:{defaultMessage:"{price} per year",id:"1YmVZcwG/X"},unknown:{defaultMessage:"Unknown",id:"5jeq8PJZg7"}}),i="unset"},26970:(e,t,a)=>{"use strict";a.d(t,{G:()=>eu});var l=a(25576),r=a(85860),s=a(83081),i=a(64299),n=a.n(i),o=a(18507),d=a(14337),c=a(62440),u=a(38806);let m=e=>{var t;return null!==(t=null==e?void 0:e.includes("perplexity.ai/finance"))&&void 0!==t&&t},p=e=>"https://www.perplexity.ai/finance"===e;var h=a(60410),v=a(38683),g=a(90915),f=a(72811);let y=r.memo(e=>{let{query:t,completion:a,inputsAndCompletions:r,description:i,highlightPrefix:n,url:o,title:d,shouldShowTitle:c}=e,u=m(o),v=p(o),g=c&&d?d:t,f=u?g.toUpperCase():g,{$t:y}=(0,s.A)(),x=u?null==a?void 0:a.toUpperCase():a;return v?(0,l.jsx)(h.A,{variant:"small",inline:!0,children:y({defaultMessage:"{perplexity} Finance",id:"LnL5Kdg1cp"},{perplexity:"Perplexity"})},"perplexity-finance"):(0,l.jsxs)(l.Fragment,{children:[!i&&(null==r?void 0:r.length)&&n?r.map((e,t)=>{let[a,r]=e;return a?(0,l.jsx)(h.A,{color:"light",variant:"small",className:"inline",as:"div",children:a},"".concat(t,"-").concat(a)):(0,l.jsx)(h.A,{className:"inline whitespace-pre",variant:"small",as:"div",children:r},"".concat(t,"-").concat(r))}):i?(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)(h.A,{variant:"small",inline:!0,children:f}),(0,l.jsx)(h.A,{variant:"tinyRegular",className:"!text-quiet opacity-70",inline:!0,children:i})]}):(0,l.jsx)(h.A,{inline:!0,color:"light",variant:"small",children:f}),a&&n&&!(null==r?void 0:r.length)&&(0,l.jsx)(h.A,{className:"whitespace-pre",inline:!0,variant:"small",children:x}),a&&!n&&(0,l.jsx)(h.A,{color:"light",inline:!0,variant:"small",children:x})]})});y.displayName="DefaultQueryContentComponent";let x=r.memo(e=>{let{onClick:t,query:a,completion:s,inputsAndCompletions:i,url:o,suggestionIndex:d,keyboardFocusedIndex:c,setKeyboardFocusedIndex:m,leftIcon:p,rightIcon:x,className:b,description:w,title:_,shouldShowTitle:M,highlightPrefix:C=!0,category:j,QueryContentComponent:A=y,metadata:E,actionHandler:S}=e,{isMobileUserAgent:k}=(0,v.al)(),N=(0,r.useCallback)(()=>{null==m||m(-1)},[m]),T=(0,r.useCallback)(e=>M&&_&&a?(0,l.jsx)(g.A,{tooltipText:a,bodyClassName:"max-w-[300px]",showTooltip:!0,asChild:!0,tooltipLayout:"right",children:e}):e,[M,_,a]);return(0,l.jsx)(u.N,{children:T((0,l.jsx)("div",{"data-focused":void 0===c||-1===c?"none":c===d?"self":"other","data-testid":"auto-suggestion-".concat((null!=d?d:0)+1),className:n()("group flex cursor-pointer flex-row items-center rounded-lg p-[8px]",b),onPointerDown:()=>{S?S():t(s?a+s:a)},onPointerLeave:N,children:(0,l.jsxs)("div",{className:"flex w-full min-w-0 flex-row whitespace-pre leading-tight",children:[(0,l.jsx)(h.A,{className:"-mr-three",color:"light",inline:!0,variant:"small",children:p}),(0,l.jsx)(h.A,{variant:"small",className:k?"truncate":"line-clamp-2 text-wrap",children:o?(0,l.jsx)(f.N,{href:o,target:"_blank",rel:"noopener",children:(0,l.jsx)(A,{query:a,url:o,completion:s,inputsAndCompletions:i,description:w,category:j,highlightPrefix:C,metadata:E,title:_,shouldShowTitle:M})}):(0,l.jsx)(A,{query:a,url:o,completion:s,inputsAndCompletions:i,description:w,category:j,highlightPrefix:C,metadata:E,title:_,shouldShowTitle:M})}),x&&(0,l.jsx)(h.A,{variant:"smallBold",color:"super",inline:!0,className:n()("pr-xs ml-auto","group-hover:opacity-100 group-data-[focused=self]:opacity-100",{"opacity-0 group-data-[focused=other]:opacity-0":!o}),children:x})]})}))})});x.displayName="SuggestionCard";var b=a(12839);let w={ticker:{order:0,showHeader:!1,highlightPrefix:!1},suggestion:{order:1,showHeader:!1,highlightPrefix:!0},news:{displayName:"Latest News",order:2,showHeader:!0,highlightPrefix:!1},related_question:{displayName:"Related Questions",order:3,showHeader:!0,highlightPrefix:!1},shortcuts:{displayName:"Shortcuts",order:4,showHeader:!0,highlightPrefix:!0}},_=e=>{let t={};return e.forEach(e=>{let a=e.category||"suggestion";t[a]||(t[a]=[]),t[a].push(e)}),t},M=e=>Object.keys(e).sort((e,t)=>{var a,l,r,s;return(null!==(r=null===(a=w[e])||void 0===a?void 0:a.order)&&void 0!==r?r:Number.MAX_SAFE_INTEGER)-(null!==(s=null===(l=w[t])||void 0===l?void 0:l.order)&&void 0!==s?s:Number.MAX_SAFE_INTEGER)}),C=e=>{let{metadata:t}=e;return!!t&&"price"===t.type&&!!t.price_info&&"number"==typeof t.price_info.currentPrice&&!!t.price_info.change&&!!t.price_info.changePercentage},j=e=>[...e].sort((e,t)=>{let a=C(e),l=C(t);return a&&!l?-1:!a&&l?1:0}),A=r.memo(e=>{let{text:t,show:a,className:r}=e;return a?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.Ay,{className:n()("my-sm sm:mx-sm border-b first:hidden",r)}),t&&(0,l.jsx)(b.Ay,{variant:"transparent",className:"sm:mx-sm mt-xs mb-sm pr-sm",children:(0,l.jsx)(h.A,{className:"w-max",variant:"tinyMono",color:"light",children:t})})]}):null});A.displayName="GroupItemSeparator";let E=r.memo(e=>{let{category:t,suggestions:a,categoryConfig:s,value:i,focusedIndex:n,setFocusedIndex:o,handleSubmit:d,indexOffset:c,LeftIconComponent:u,RightIconComponent:m,QueryContentComponent:p,onFillButtonClick:h,titleClassName:v}=e,g=(0,r.useMemo)(()=>"ticker"===t?j(a):a,[t,a]);return a.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(A,{show:s.showHeader,text:s.displayName,className:v}),g.map((e,a)=>{var r;return(0,l.jsx)(S,{suggestion:e,index:a,category:t,categoryConfig:s,value:i,focusedIndex:n,setFocusedIndex:o,handleSubmit:d,indexOffset:c,LeftIconComponent:u,RightIconComponent:m,onFillButtonClick:h,QueryContentComponent:p,highlightPrefix:null===(r=s.highlightPrefix)||void 0===r||r},"".concat(t,"-").concat(e.input+e.completion+e.description||e.query_uuid))})]}):null});E.displayName="SuggestionGroup";let S=r.memo(e=>{let{suggestion:{input:t,completion:a,query_uuid:s,image:i,imageDark:o,url:d="",description:c,identifier:u="",category:m,title:p="",subscribed:h=!1,metadata:v,submission_query:g,inputs_and_completions:f,icon_name:y,shouldShowTitle:b,actionHandler:w,isPersonalized:_},index:M,LeftIconComponent:C,QueryContentComponent:j,RightIconComponent:A,highlightPrefix:E,focusedIndex:S,handleSubmit:k,indexOffset:N,onFillButtonClick:T,setFocusedIndex:I,value:R}=e,P=(0,r.useCallback)(e=>k({query:e,query_uuid:s,url:d,identifier:u,category:m,description:c,image:i,imageDark:o,title:p,subscribed:h,submission_query:g,isPersonalized:_},M+N),[m,c,k,u,i,o,M,N,s,g,h,p,d,_]),O=(0,r.useCallback)(()=>{T(t+a,d)},[a,t,T,d]),D=(0,r.useMemo)(()=>(0,l.jsx)(C,{image:i,imageDark:o,alt:t+R,url:d,category:m,iconName:y,value:R}),[C,m,y,i,o,t,d,R]),L=(0,r.useMemo)(()=>(0,l.jsx)(A,{onClick:O,url:d,isSelected:h,metadata:v,category:m}),[A,O,d,h,v,m]);return(0,l.jsx)(x,{onClick:P,query:t,completion:a,inputsAndCompletions:f,url:d,suggestionIndex:M+N,keyboardFocusedIndex:S,setKeyboardFocusedIndex:I,description:c,title:p,shouldShowTitle:b,highlightPrefix:E,className:n()("hover:bg-subtler","data-[focused=self]:bg-subtler","dark:data-[focused=self]:bg-subtler","hover:data-[focused=other]:bg-raised","dark:hover:data-[focused=other]:bg-subtler"),category:m,QueryContentComponent:j,metadata:v,leftIcon:D,rightIcon:L,actionHandler:w})});S.displayName="SuggestionCardFactory";var k=a(83991),N=a(49126),T=a(95920),I=a(27773);let R=(0,I.w)({path:"M7 9a4 4 0 1 0 8 0a4 4 0 0 0 -8 0 M5.75 15a8.015 8.015 0 1 0 9.25 -13 M11 17v4 M7 21h8",name:"IconGlobe",variant:"stroked"});var P=a(7957),O=a(67845);let D=(0,I.w)({path:"M3 17a3 3 0 1 0 6 0a3 3 0 0 0 -6 0 M13 17a3 3 0 1 0 6 0a3 3 0 0 0 -6 0 M9 17v-13h10v13 M9 8h10",name:"IconMusic",variant:"stroked"});var L=a(75796),U=a(41561),F=a(6366),z=a(78052),B=a(28700),H=a(37483);a(24915);let q=(e,t,a)=>{let l=a?e.replace(/\s+/g,"").toLocaleLowerCase():e,r=t.query,s=0,i=0;for(;s<l.length&&i<r.length;){var n;l[s]===(null===(n=r[i])||void 0===n?void 0:n.toLocaleLowerCase())&&s++,i++}return[s===l.length,i]},G=(e,t)=>{let a=e.replace(/\s+/g,""),l=[],r="",s="",i=0,n=0;for(;i<a.length&&n<t.length;){var o,d;(null===(o=a[i])||void 0===o?void 0:o.toLocaleLowerCase())===(null===(d=t[n])||void 0===d?void 0:d.toLocaleLowerCase())?(s&&(l.push(["",s]),s=""),r+=t[n],i++):(r&&(l.push([r,""]),r=""),s+=t[n]),n++}return r&&l.push([r,""]),s&&l.push(["",s]),n<t.length&&l.push(["",t.slice(n)]),l},Q={calendar:T._,"report-search":z.y,browser:N.G,mail:P.j,"shopping-bag":B.C,message:O.p,"user-heart":H.$,play:U.h,globe:R,music:D,book:k.L,plane:L.s,plus:F.u};var V=a(80892),K=a(79756),W=a(36206),Y=a(89479),X=a(98540),Z=a(95772);let J=(0,I.w)({path:"M19.6602 2C20.9486 2.00018 21.993 3.0446 21.9932 4.33301C21.9932 5.62156 20.9487 6.66682 19.6602 6.66699C19.6103 6.66699 19.5608 6.66128 19.5117 6.6582L16.9111 12.3467C16.803 12.5829 16.5903 12.7551 16.3369 12.8125C16.1151 12.8626 15.8841 12.8195 15.6963 12.6963L15.6182 12.6387L11.374 9.08691L5.05176 19.4873H10.333V13.667C10.333 13.2069 10.706 12.8342 11.166 12.834C11.6263 12.834 11.999 13.2068 11.999 13.667V19.4873H15.3203V15.333C15.3205 14.8729 15.6932 14.5 16.1533 14.5C16.6134 14.5001 16.9862 14.873 16.9863 15.333V19.4873H19.5C19.9595 19.4871 20.3328 19.1128 20.333 18.6533V9.49414C20.333 9.03406 20.706 8.66042 21.166 8.66016C21.6263 8.66016 22 9.0339 22 9.49414V18.6533C21.9998 20.0333 20.88 21.1531 19.5 21.1533H4.5C3.2062 21.1532 2.14091 20.1693 2.0127 18.9092L2 18.6533V5.33398C2 3.9538 3.11983 2.83407 4.5 2.83398H14.5L14.585 2.83789C15.0051 2.8806 15.333 3.23555 15.333 3.66699C15.3328 4.09829 15.005 4.4534 14.585 4.49609L14.5 4.5H4.5C4.04031 4.50008 3.66602 4.87427 3.66602 5.33398V18.5586L10.4541 7.39355L10.5059 7.31836C10.6338 7.15201 10.821 7.03859 11.0303 7.00391C11.2698 6.96435 11.515 7.03176 11.7012 7.1875L15.8496 10.6582L17.9951 5.96777C17.5817 5.54678 17.3262 4.96964 17.3262 4.33301C17.3263 3.04449 18.3716 2 19.6602 2Z",name:"IconPerplexityFinance",variant:"filled"});var $=a(39808),ee=a(33477),et=a(39618);let ea=(0,I.w)({path:"M17 5l-10 14",name:"IconSlash",variant:"stroked"});var el=a(74858);let er=(0,I.w)({path:"M20.94 13.045a9 9 0 1 0 -8.953 7.955 M3.6 9h16.8 M3.6 15h9.4 M11.5 3a17 17 0 0 0 0 18 M12.5 3a16.991 16.991 0 0 1 2.529 10.294 M16 22l5 -5 M21 21.5v-4.5h-4.5",name:"IconWorldShare",variant:"stroked"});var es=a(49427),ei=a(65917),en=a(24915);let eo=r.memo(e=>{var t;let{image:a,alt:s,url:i,iconName:n,value:o,category:u}=e,m=0===o.length,[h,v]=(0,r.useState)(!1),{sidecarSourceTab:{url:g}}=(0,d.jX)(),f=(0,c.y)(),y=(0,r.useMemo)(()=>en.env.NEXT_PUBLIC_IS_SIDECAR_BUILD&&g&&m?(0,W.WK)(g):a||(i?(0,X.Ld)(i):void 0),[a,i,g,m]),x=n?Q[n]:null,b=m&&null!==(t=K.YD[f])&&void 0!==t?t:et.C;return"shortcuts"!==u||n?p(i)?(0,l.jsx)("div",{className:"mr-2 flex size-5 shrink-0 items-center justify-center",children:(0,l.jsx)(es.e,{icon:J,size:"sm",className:"text-foreground"})}):y&&!h?(0,l.jsx)("div",{className:"relative mr-2 size-5 shrink-0 overflow-hidden rounded-sm",children:(0,l.jsx)("img",{src:y,alt:null!=s?s:"suggestion",className:"object-cover",sizes:"24px",onError:()=>v(!0)})}):(0,l.jsx)(es.e,{icon:h&&i?el.U:null!=x?x:b,size:"sm",className:"mt-two mr-2 w-5 shrink-0"}):(0,l.jsx)(es.e,{icon:ea,size:"sm",className:"mt-two mr-2 w-5 shrink-0"})});eo.displayName="LeftIcon";let ed=r.memo(e=>{let{onClick:t,url:a,category:r}=e;return"shortcuts"===r?null:m(a)?(0,l.jsx)("div",{className:"flex h-full items-center",children:(0,l.jsx)(es.e,{icon:ee.V,size:"sm",className:"text-quiet"})}):(0,l.jsx)("button",{className:"appearance-none",onPointerDown:e=>{e.stopPropagation(),e.preventDefault(),t(e)},type:"button",children:(0,l.jsx)(es.e,{icon:a?er:$.q,size:"sm",className:"-mb-xs"})})});ed.displayName="RightIcon";let ec=r.memo(()=>{let{$t:e}=(0,s.A)();return(0,l.jsxs)("div",{className:"flex w-full min-w-0 flex-row items-center whitespace-pre p-[8px] leading-tight",children:[(0,l.jsx)(h.A,{className:"-mr-three px-three shrink-0",color:"super",inline:!0,variant:"small",children:(0,l.jsx)(es.e,{size:"xs",icon:Z.N})}),(0,l.jsx)(h.A,{variant:"tinyMono",color:"super",className:"ml-2",children:e({defaultMessage:"Comet Assistant",id:"ML678gEBQ1"})})]})});ec.displayName="CometAssistantRow";let eu=r.memo(e=>{let{isOpen:t,suggestedQueries:a,focusedIndex:s,setFocusedIndex:i,handlePasteQuery:d,handleSubmit:c,dropdownClassName:u,dropdownType:m="query",components:p,value:h,children:v,popoverClassName:g,categoryTitleClassName:f,userInputQuery:y,portalTarget:x,placement:b="bottom",allowNonSequentialMatch:C=!1,isCometHome:j,scrollableShards:A=[],floatingStrategy:S,shouldEnableStacking:k=!1}=e,{trackEvent:N}=(0,V.yw)(),{RightIconComponent:T=ed,LeftIconComponent:I=eo,QueryContentComponent:R}=null!=p?p:{},P=(0,r.useMemo)(()=>a.map((e,t,a)=>{let{query:l,query_uuid:r,image:i,imageDark:n,url:o,title:d,description:c="",identifier:u="",category:p,subscribed:v=!1,metadata:g,submission_query:f,icon:x,is_comet_assistant:b,shouldShowTitle:w,actionHandler:_,isPersonalized:M}=e;if("select"===m)return{input:l,completion:"",query_uuid:r,title:d,image:i,imageDark:n,url:o,description:c,identifier:u,category:p,subscribed:v,submission_query:f,icon_name:x,is_comet_assistant:b,shouldShowTitle:w,actionHandler:_,isPersonalized:M};let j=y?-1===s?h:y:h;return j.length>0&&l.startsWith(j)?{input:j,completion:l.slice(j.length),query_uuid:r,title:d,image:i,imageDark:n,url:o,category:p,metadata:g,...("ticker"===p||"news"===p)&&{description:c},submission_query:f,icon_name:x,is_comet_assistant:b,shouldShowTitle:w,actionHandler:_,isPersonalized:M}:C&&!c&&j.length>0&&j.length<=l.length&&a[t]&&q(j,a[t],!0)[0]?{input:"",completion:l,inputs_and_completions:G(j,l),query_uuid:r,title:d,image:i,url:o,category:p,metadata:g,...("ticker"===p||"news"===p)&&{description:c},submission_query:f,icon_name:x,is_comet_assistant:b,shouldShowTitle:w,actionHandler:_,isPersonalized:M}:{input:l,completion:"",query_uuid:r,title:d,image:i,imageDark:n,url:o,category:p,metadata:g,...("ticker"===p||"news"===p)&&{description:c},submission_query:f,icon_name:x,is_comet_assistant:b,shouldShowTitle:w,actionHandler:_,isPersonalized:M}}),[a,h,m,y,s,C]),O=(0,r.useMemo)(()=>_(P),[P]),D=(0,r.useMemo)(()=>M(O),[O]),L=(0,r.useMemo)(()=>D.some(e=>{var t;return null===(t=O[e])||void 0===t?void 0:t.some(e=>e.is_comet_assistant)}),[D,O]),U=(0,r.useCallback)((e,t)=>{if(t){window.open(t,"_blank");return}N("auto suggestion filled",{}),d(e)},[d,N]),F=n()("!block w-full","bottom"===b?"mt-[-5px]":"mb-[-5px]",g),z="bottom"===b?"rounded-b-2xl":"rounded-t-2xl",B=(0,r.useRef)(null),[H,Q]=(0,r.useState)(null),K=!t||0===a.length;(0,ei.wY)({ref:B,onResize:e=>{var t;Q(null!==(t=null==e?void 0:e.height)&&void 0!==t?t:null)}});let W=(0,r.useMemo)(()=>({portalTarget:null!=x?x:void 0,removeScroll:!0,shards:A}),[x,A]),X=(0,r.useMemo)(()=>(0,l.jsx)("div",{className:n()("bottom"===b?"!border-t-subtlest shadow-super/10 rounded-b-2xl shadow-md dark:shadow-lg dark:shadow-black/10":"!border-b-subtler rounded-t-2xl","border-subtle border","bg-raised p-3",u),children:(0,l.jsx)(o.P.div,{animate:{height:K?0:null!=H?H:"auto"},initial:{height:0},transition:{height:{type:"spring",bounce:.1,duration:.05}},style:{overflow:"hidden"},children:(0,l.jsxs)("div",{ref:B,className:"flex flex-col items-stretch","data-testid":"autosuggestion-container",children:[j&&L?(0,l.jsx)(ec,{}):null,D.map((e,t)=>{let a=O[e],r=w[e]||{order:999,showHeader:!1},n=0;for(let e=0;e<t;e++){var o,d;n+=(null===(o=O[null!==(d=D[e])&&void 0!==d?d:""])||void 0===o?void 0:o.length)||0}return(null==a?void 0:a.length)?(0,l.jsx)(E,{category:e,suggestions:a||[],categoryConfig:r,value:h,focusedIndex:s,setFocusedIndex:i,handleSubmit:c,indexOffset:n,LeftIconComponent:I,RightIconComponent:T,QueryContentComponent:R,onFillButtonClick:U,titleClassName:f},e):null})]})})}),[I,R,T,f,H,u,s,O,c,L,j,U,b,K,i,D,h]),Z=(0,r.useMemo)(()=>S?{strategy:S}:void 0,[S]),J=(0,r.useMemo)(()=>k?{className:"flex z-[1]"}:void 0,[k]);return(0,l.jsx)(Y.A,{isOpen:t,matchTargetWidth:!0,disableAnimation:!0,placement:b,childrenClassName:"grow block",contentClassName:F,borderRadius:z,avoidCollisions:!1,disableShadow:!0,overlayProps:W,content:X,floatingElementProps:J,...Z&&{customFloatingUIOptions:Z},children:v})});eu.displayName="SuggestDropdown"},26976:(e,t,a)=>{"use strict";a.d(t,{CJ:()=>x,Cb:()=>u,Co:()=>v,Di:()=>n,Fi:()=>w,Iv:()=>h,J7:()=>m,No:()=>_,PE:()=>y,Qy:()=>p,bS:()=>g,dG:()=>c,e6:()=>d,er:()=>f,mH:()=>o,o4:()=>M});var l=a(77150),r=a(77917),s=a(18360),i=a(3041);let n=async e=>{let{name:t,referrer:a,referrerId:s,redirectPath:n,unauthedRedirectPath:o,reason:d}=e;try{var c;let{data:e,error:i}="factset"!==t?await r.By.GET("/rest/connectors/".concat(t,"/connect"),d,{timeoutMs:(0,r.e4)(),numRetries:1,reason:d,params:{query:{referrer:a,referrer_id:s,redirect_path:n,unauthed_redirect_path:o}}}):await r.By.GET("/rest/connectors/factset/connect",d,{timeoutMs:(0,r.e4)(),numRetries:1,reason:d});if(i)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to initiate OAuth flow",cause:i});return null!==(c=e.redirect_url)&&void 0!==c?c:null}catch(e){return i.vF.error("Error fetching factset OAuth redirect URL:",e),null}},o=async e=>{let{connectorName:t,reason:a}=e,s="disconnectConnector:".concat(t);try{let{data:e,error:s}=await r.By.GET("/rest/connectors/{connector_id}/disconnect",a,{timeoutMs:(0,r.e4)({productionMs:500}),numRetries:1,reason:a,params:{path:{connector_id:t}}});if(s)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to disconnect connector",cause:s});return e}catch(e){return i.vF.log("Error in ".concat(s,":"),e),null}},d=async e=>{let{connectionUUID:t,reason:a}=e,{data:l,error:s}=await r.By.POST("/rest/connections/{uuid}/update",a,{params:{path:{uuid:t}},body:{disconnect:!0}});if(s)throw Error("Failed to disconnect file connector",{cause:s});return l},c=async e=>{let{connectionUUID:t,reason:a}=e,{data:l,error:s}=await r.By.POST("/rest/connections/{uuid}/delete",a,{params:{path:{uuid:t}}});if(s)throw Error("Failed to disconnect file connector and delete files",{cause:s});return l},u=async e=>{let{connectorName:t,fileIds:a,fileRepoInfo:i,folder_ids:n=s.Ml,reason:o}=e,{error:d,data:c}="sharepoint"===t?await r.By.POST("/rest/connectors/".concat(t,"/files"),o,{body:{file_ids:a,file_repository_info:i,drive_ids:n}}):await r.By.POST("/rest/connectors/".concat(t,"/files"),o,{body:{file_ids:a,file_repository_info:i,folder_ids:n}});if(d)throw new l.T("API_CLIENTS_ERROR",{cause:d});return c},m=async e=>{let{reason:t}=e,{data:a,error:l}=await r.By.POST("/rest/connectors/box/picker",t);if(l)throw Error("Failed to refresh box picker credentials",{cause:l});return a},p=async e=>{let{connectionType:t,content:a,reason:l}=e,{data:s,error:i}=await r.By.POST("/rest/connectors/picker/log",l,{body:{connection_type:t,content:a}});if(i)throw Error("Failed log connector picker",{cause:i});return s},h=async e=>{let{request:t,reason:a}=e,{data:l,error:s}=await r.By.POST("/rest/file-repository/delete-files",a,{body:t});if(s)throw Error("Failed to delete files",{cause:s});return l};class v extends Error{constructor(){super("Downloads are disabled"),this.name="DownloadsDisabledError"}}class g extends Error{constructor(){super("PDF downloads are restricted"),this.name="PdfUntrustedOriginError"}}class f extends Error{constructor(){super("This file belongs to a different organization"),this.name="UserNotInFileOrgError"}}let y=async e=>{let{request:t,reason:a}=e,s=await r.By.POST("/rest/file-repository/download",a,{body:t,timeoutMs:2e3,numRetries:1});if(s.error){if(s.error.detail&&"object"==typeof s.error.detail&&"error_details"in s.error.detail){if("DOWNLOADS_DISABLED"===s.error.detail.error_details)throw new v;if("PDF_UNTRUSTED_ORIGIN"===s.error.detail.error_details)throw new g;if("USER_NOT_IN_FILE_ORG"===s.error.detail.error_details)throw new f}throw new l.T("API_CLIENTS_ERROR",{message:"Failed to download file",cause:s.error})}return s.data},x=async e=>{let{request:t,reason:a}=e,s=await r.By.POST("/rest/file-repository/download-attachment",a,{body:t,timeoutMs:2e3,numRetries:1});if(s.error){if(s.error.detail&&"object"==typeof s.error.detail&&"error_details"in s.error.detail){if("DOWNLOADS_DISABLED"===s.error.detail.error_details)throw new v;if("PDF_UNTRUSTED_ORIGIN"===s.error.detail.error_details)throw new g;if("USER_NOT_IN_FILE_ORG"===s.error.detail.error_details)throw new f}throw new l.T("API_CLIENTS_ERROR",{message:"Failed to download attachment",cause:s.error})}return s.data},b=e=>{let{accessLevel:t,enableWebByDefault:a,...l}=e;return{...l,access:t,enable_web_by_default:a}},w=async e=>{let{collectionUuid:t,changes:a,reason:l}=e,s=b(a),i=await r.By.POST("/rest/collections/edit_collection/{collection_uuid}",l,{params:{path:{collection_uuid:t}},body:s,timeoutMs:(0,r.e4)()});if(!i.response.ok||!i.data)throw Error("Failed to edit collection",{cause:i.error});let{access:n,...o}=i.data;return void 0!==n?{...o,accessLevel:n}:o},_=async e=>{let{params:t,reason:a}=e,l=b(t);t.template_id&&(l.template_id=t.template_id);let s=await r.By.POST("/rest/collections/create_collection",a,{body:l,timeoutMs:(0,r.e4)()});if(!s.response.ok||!s.data)throw Error("Failed to create collection",{cause:s.error});return s.data},M=async e=>{let{collectionUuid:t,reason:a}=e,{error:l}=await r.By.DELETE("/rest/collections/delete_collection/{collection_uuid}",a,{params:{path:{collection_uuid:t}},timeoutMs:(0,r.e4)(),numRetries:1});if(l)throw Error("Failed to delete collection",{cause:l})}},27093:(e,t,a)=>{"use strict";a.d(t,{i:()=>n});var l=a(25576);a(85860);var r=a(64299),s=a.n(r),i=a(60410);let n=e=>{let{label:t,value:a,valueColor:r="light",cta:n,shouldWrapInMobile:o=!0}=e;return(0,l.jsxs)("div",{className:s()("gap-md flex justify-between sm:flex-row sm:flex-nowrap sm:items-center",o&&"flex-col flex-wrap"),children:[(0,l.jsxs)("div",{children:[t&&(0,l.jsx)(i.A,{variant:"small",children:t}),a&&(0,l.jsx)(i.A,{variant:"tinyRegular",color:r,children:a})]}),(0,l.jsx)("div",{children:n})]})}},27628:(e,t,a)=>{"use strict";a.d(t,{k:()=>o});var l=a(85860),r=a(83081),s=a(53121),i=a(30002),n=a(21978);let o=()=>{let{$t:e}=(0,r.A)(),t=(0,n.rd)(),{createCollection:a,createCollectionForThread:o}=(0,s.W)({reason:"create-new-space"}),d=(0,l.useCallback)(()=>{a({title:e({defaultMessage:"New Space",id:"t5xj3BH/Ni"}),description:"",emoji:"",instructions:"",accessLevel:i.lF6,enableWebByDefault:!0,callback:e=>{t.push("/spaces/".concat(e.slug))}})},[a,e,t]),c=(0,l.useCallback)((a,l)=>{o({title:e({defaultMessage:"New Space",id:"t5xj3BH/Ni"}),description:"",emoji:"",instructions:"",accessLevel:i.lF6,enableWebByDefault:!0,entryUUID:a,frontendContextUUID:l,callback:e=>{t.push("/spaces/".concat(e.slug))}})},[o,e,t]);return(0,l.useMemo)(()=>({handleCreateNewSpace:d,handleCreateNewSpaceForThread:c}),[d,c])}},27836:(e,t,a)=>{"use strict";a.d(t,{g:()=>b});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(14489),o=a(83081),d=a(70714),c=a(30760),u=a(80892),m=a(60410),p=a(35052);let h=(0,a(27773).w)({path:"M12 2c-.218 0 -.432 .002 -.642 .005l-.616 .017l-.299 .013l-.579 .034l-.553 .046c-4.785 .464 -6.732 2.411 -7.196 7.196l-.046 .553l-.034 .579c-.005 .098 -.01 .198 -.013 .299l-.017 .616l-.004 .318l-.001 .324c0 .218 .002 .432 .005 .642l.017 .616l.013 .299l.034 .579l.046 .553c.464 4.785 2.411 6.732 7.196 7.196l.553 .046l.579 .034c.098 .005 .198 .01 .299 .013l.616 .017l.642 .005l.642 -.005l.616 -.017l.299 -.013l.579 -.034l.553 -.046c4.785 -.464 6.732 -2.411 7.196 -7.196l.046 -.553l.034 -.579c.005 -.098 .01 -.198 .013 -.299l.017 -.616l.005 -.642l-.005 -.642l-.017 -.616l-.013 -.299l-.034 -.579l-.046 -.553c-.464 -4.785 -2.411 -6.732 -7.196 -7.196l-.553 -.046l-.579 -.034a28.058 28.058 0 0 0 -.299 -.013l-.616 -.017l-.318 -.004l-.324 -.001zm2.293 7.293a1 1 0 0 1 1.497 1.32l-.083 .094l-4 4a1 1 0 0 1 -1.32 .083l-.094 -.083l-2 -2a1 1 0 0 1 1.32 -1.497l.094 .083l1.293 1.292l3.293 -3.292z",name:"IconSquareRoundedCheckFilled",variant:"filled"});var v=a(35454),g=a(49427),f=a(72811),y=a(62615);let x=e=>{var t;let{tier:a,currency:r,checked:s,price:n,label:x,description:b,paymentMethodType:w,yearlySavings:_,subscriptionTier:M}=e,{formatNumber:C}=(0,o.A)(),j=(0,y.ok)(),A=(0,y.a8)(),E=new URLSearchParams(null!==(t=null==j?void 0:j.toString())&&void 0!==t?t:void 0);E.set("plan",a);let S="".concat(A,"?").concat(E.toString()),{trackEvent:k}=(0,u.yw)(),{colorScheme:N}=(0,p.U)(),T="yearly"===a&&_&&!s;return(0,l.jsx)(f.N,{className:i()("block h-full rounded-xl border p-3",{"border-super dark:border-foreground":s,"border-subtler":!s}),href:S,onClick:()=>{"yearly"===a?k("pro annual toggled on",{subscriptionTier:M,paymentMethodType:w}):k("pro annual toggled off",{subscriptionTier:M,paymentMethodType:w})},children:(0,l.jsxs)("div",{className:"flex justify-stretch gap-2",children:[(0,l.jsxs)("section",{children:[(0,l.jsxs)("header",{className:"flex flex-wrap items-center justify-between gap-1",children:[(0,l.jsx)(m.A,{as:"h3",variant:"small",children:(0,l.jsx)(d.A,{...x})}),T&&(0,l.jsxs)(m.A,{variant:"tiny",color:"super",className:"flex items-center gap-1",children:[(0,l.jsx)(g.e,{icon:v.c,size:16}),(0,l.jsx)(d.A,{defaultMessage:"Save {price}",id:"9s8Jkp7fSt",values:{price:C(_/(0,c.hb)(r),{style:"currency",currency:r,minimumFractionDigits:0,maximumFractionDigits:0})}})]})]}),(0,l.jsx)(m.A,{className:"mt-1 flex items-end gap-2",variant:"small",color:"light",children:(0,l.jsx)(d.A,{...b,values:{price:C(n/(0,c.hb)(r),{style:"currency",currency:r})}})})]}),s&&(0,l.jsx)(m.A,{className:"ml-auto",color:"dark"===N?"default":"super",children:(0,l.jsx)(g.e,{icon:h})})]})})};function b(e){let{choices:t,tier:a,paymentMethodType:s,cohorts:o,subscriptionTier:d}=e,c=(0,r.useMemo)(()=>{let e=t.find(e=>"monthly"===e.tier),a=t.find(e=>"yearly"===e.tier);return(null==e?void 0:e.price)&&(null==a?void 0:a.price)?(null==o?void 0:o.some(e=>e.includes("HALF_OFF")))?a.price/2:12*e.price-a.price:0},[t,o]);return(0,l.jsx)("ul",{className:i()("grid gap-4",t.length?"grid-cols-2":"grid-cols-1"),children:t.length?t.filter(e=>"unknown"!==e.tier).map(e=>(0,l.jsx)("li",{children:(0,l.jsx)(x,{tier:e.tier,currency:e.currency,checked:a===e.tier,price:e.price,label:e.label,description:e.description,paymentMethodType:s,yearlySavings:c,subscriptionTier:d})},e.tier)):(0,l.jsx)("li",{children:(0,l.jsx)(n.W,{className:"h-[70px] w-full rounded-xl",children:(0,l.jsx)("div",{className:"bg-subtler size-full"})},"price")})})}},28202:(e,t,a)=>{"use strict";a.d(t,{C:()=>u});var l=a(85860),r=a(83081),s=a(24877),i=a(45100),n=a(80892),o=a(84607),d=a(62615),c=a(3041);function u(){var e;let[t,a]=(0,l.useState)(),[u,m]=(0,l.useState)(!1),[p,h]=(0,l.useState)(!1),v=(0,d.ok)(),g=null!==(e=null==v?void 0:v.get("promotion_code"))&&void 0!==e?e:"",[f,y]=(0,l.useState)(g),[,x]=(0,i.L)(),[b,w]=(0,l.useState)(""),{trackEvent:_}=(0,n.yw)(),{$t:M}=(0,r.A)(),C=(0,l.useCallback)(async(e,a)=>{w("");let l=null==t?void 0:t.applyPromotionCode,r=null==t?void 0:t.removePromotionCode;if(l&&r){if(m(!0),e)try{let t=await (null==l?void 0:l(e));if((null==t?void 0:t.type)==="success"){_("pro promocode applied",{paymentMethodType:a}),x(e);let t=new URLSearchParams(window.location.search);t.set("promotion_code",e),(0,o.hf)(Object.fromEntries(t)),y(e)}else{var s;_("pro promocode apply error",{paymentMethodType:a}),null==r||r(),y(""),x(null);let e=(null==t?void 0:null===(s=t.error)||void 0===s?void 0:s.message)==="This promotion code has expired."?M({defaultMessage:"Expired promo code",id:"lU6FCUyiVT"}):M({defaultMessage:"Invalid promo code",id:"vZWdYG0Jt6"});w(e)}}catch(e){null==r||r(),y(""),_("pro promocode apply error",{paymentMethodType:a}),c.vF.error("Error applying promo code",e),x(null),w(M({defaultMessage:"Invalid promo code",id:"vZWdYG0Jt6"}))}else try{let e=await (null==r?void 0:r());(null==e?void 0:e.type)==="success"?(_("pro promocode removed",{paymentMethodType:a}),y(""),x(null)):(_("pro promocode remove error",{paymentMethodType:a}),x(null),w(M({defaultMessage:"Error removing promo code",id:"C4mLCxSemT"})))}catch(e){c.vF.error("Error removing promo code",e),_("pro promocode remove error",{paymentMethodType:a}),w(M({defaultMessage:"Error removing promo code",id:"C4mLCxSemT"}))}m(!1)}},[null==t?void 0:t.applyPromotionCode,null==t?void 0:t.removePromotionCode,_,M,x]),j=(0,l.useCallback)(()=>{w("")},[]);return(0,l.useEffect)(()=>{y(e=>e||g)},[g]),(0,l.useEffect)(()=>{f&&!(null==t?void 0:t.promoCode)&&(null==t?void 0:t.applyPromotionCode)&&C(f,s.Aq)},[C,f,null==t?void 0:t.promoCode,null==t?void 0:t.applyPromotionCode]),(0,l.useMemo)(()=>({setCheckoutData:a,checkoutData:t?{...t,applyPromo:C,isApplyingPromo:u,promoError:b,clearPromoError:j}:void 0,isExpressCheckoutLoading:p,setIsExpressCheckoutLoading:h}),[C,t,j,u,p,b])}},28325:(e,t,a)=>{"use strict";a.d(t,{N:()=>K,X:()=>W});var l=a(25576),r=a(85860),s=a(83081),i=a(70714),n=a(64299),o=a.n(n),d=a(90873),c=a(47575),u=a(39266),m=a(57023),p=a(76523),h=a(15492),v=a(77917),g=a(3041);let f=e=>{let{reason:t}=e,{data:a,isLoading:l}=(0,h.useQuery)({queryKey:["student_partner_config",t],queryFn:async()=>{try{let{data:e,error:a}=await v.By.GET("/rest/academic/student-partner-config",t,{timeoutMs:(0,v.e4)()});if(a)throw Error("Failed to get student partner config");return{countryOffers:e.country_offers||{},countryNames:e.country_names||{},defaultMonths:e.default_months||1}}catch(e){return g.vF.error("Failed to get student partner config",e),{countryOffers:{BR:3,PH:3,MY:1,ID:1},countryNames:{BR:"Brazil",PH:"Philippines",MY:"Malaysia",ID:"Indonesia"},defaultMonths:1}}},staleTime:3e5});return(0,r.useMemo)(()=>{var e,t,r;return{countryOffers:null!==(e=null==a?void 0:a.countryOffers)&&void 0!==e?e:{},countryNames:null!==(t=null==a?void 0:a.countryNames)&&void 0!==t?t:{},defaultMonths:null!==(r=null==a?void 0:a.defaultMonths)&&void 0!==r?r:1,loading:l}},[a,l])};var y=a(9126),x=a(66087);let b={standard:{title:(0,l.jsx)(i.A,{defaultMessage:"Free",id:"tf1lIh/bri"}),monthlyPrice:(0,l.jsx)(m.Gr,{value:0,style:"currency",currency:"USD"}),yearlyPricePerMonth:null,monthlyBillingPeriod:(0,l.jsx)(i.A,{defaultMessage:"Forever",id:"BG9UOWuEog"}),buttonText:(0,l.jsx)(i.A,{defaultMessage:"Continue with free",id:"zX2SelZjuT"}),description:y.dm,features:y.GD},pro:{title:(0,l.jsx)(i.A,{defaultMessage:"Pro",id:"R/eOkjWqNU"}),monthlyBillingPeriod:(0,l.jsx)(i.A,{defaultMessage:"when billed annually",id:"CxEUNEw3IX"}),monthlyPrice:(0,l.jsx)(m.Gr,{value:20,style:"currency",currency:"USD"}),yearlyPricePerMonth:(0,l.jsx)(m.Gr,{value:16.67,style:"currency",currency:"USD"}),buttonText:(0,l.jsx)(i.A,{defaultMessage:"Continue with Pro",id:"5/o9BMhnta"}),description:y.bx,features:y.A_},max:{title:(0,l.jsx)(i.A,{defaultMessage:"Max",id:"kkjl2vQekD"}),monthlyBillingPeriod:null,monthlyPrice:(0,l.jsx)(m.Gr,{value:200,style:"currency",currency:"USD"}),yearlyPricePerMonth:null,buttonText:(0,l.jsx)(i.A,{defaultMessage:"Continue with Max",id:"1ORWA/vPd8"}),description:y.o1,features:y.xC},enterprise_pro:{title:(0,l.jsx)(i.A,{defaultMessage:"Enterprise Pro",id:"h/OVAC8xF3"}),yearlyBillingPeriod:(0,l.jsx)(i.A,{defaultMessage:"billed yearly",id:"BK8kQt5/nC"}),monthlyBillingPeriod:(0,l.jsx)(i.A,{defaultMessage:"when billed annually",id:"CxEUNEw3IX"}),monthlyPrice:(0,l.jsx)(m.Gr,{value:40,style:"currency",currency:"USD"}),yearlyPricePerMonth:(0,l.jsx)(m.Gr,{value:33.33,style:"currency",currency:"USD"}),buttonText:(0,l.jsx)(i.A,{defaultMessage:"Continue with Enterprise Pro",id:"ifdiwgNLuc"}),description:y.$s,features:y.mm},enterprise_max:{title:(0,l.jsx)(i.A,{defaultMessage:"Enterprise Max",id:"tfsuL8YexA"}),yearlyBillingPeriod:(0,l.jsx)(i.A,{defaultMessage:"billed yearly",id:"BK8kQt5/nC"}),monthlyBillingPeriod:(0,l.jsx)(i.A,{defaultMessage:"when billed annually",id:"CxEUNEw3IX"}),monthlyPrice:(0,l.jsx)(m.Gr,{value:325,style:"currency",currency:"USD"}),yearlyPricePerMonth:(0,l.jsx)(m.Gr,{value:270.83,style:"currency",currency:"USD"}),buttonText:(0,l.jsx)(i.A,{defaultMessage:"Continue with Enterprise Max",id:"UOcjuwA4xJ"}),description:y.$s,features:y.Jd},pro_student:{title:(0,l.jsx)(i.A,{defaultMessage:"Education Pro",id:"Up6fU3LgJN"}),yearlyPricePerMonth:null,monthlyBillingPeriod:null,monthlyPrice:(0,l.jsx)(m.Gr,{value:4.99,style:"currency",currency:"USD"}),description:y.VU,features:y.On},pro_unverified_student:{title:(0,l.jsx)(i.A,{defaultMessage:"Education Pro",id:"Up6fU3LgJN"}),yearlyPricePerMonth:null,monthlyBillingPeriod:(0,l.jsx)(i.A,{defaultMessage:"No credit card required, auto-downgrade to free",id:"0r9uk/D33v"}),monthlyPrice:(0,l.jsx)(i.A,{defaultMessage:"Free trial",id:"PI5zmsy/ax"}),buttonText:(0,l.jsx)(i.A,{defaultMessage:"Verify as student",id:"1tQDdEeW0V"}),subButtonText:(0,l.jsx)(i.A,{defaultMessage:"Verify as educator",id:"vOTkGR1Bdz"}),description:(0,l.jsx)(i.A,{defaultMessage:"Verify your student or educator status. Refer to earn more free Pro.",id:"4iPG2FhZW6"}),features:y.On}},w=e=>{let{tier:t,isEnterpriseAdmin:a,isStudent:r,billingPeriod:s,proDiscount:n}=e,o=(0,x.m)(),d=(0,y.nP)(),{countryOffers:c,defaultMonths:u}=f({reason:"tier-meta-data"}),{isFromStudentCometGrowth:m,isFromStudentReferral:h}=(0,p.j)();if("pro_unverified_student"===t){let e;let t=o&&c[o]||u;return e=m?(0,l.jsx)(i.A,{defaultMessage:"Comet access + free Pro",id:"HQIePLKH1b"}):h?(0,l.jsx)(i.A,{defaultMessage:"Redeem 1 month",id:"KnDJBwXMb1"}):t>1?(0,l.jsx)(i.A,{defaultMessage:"{months} months free trial",id:"lsnvrjEXuG",values:{months:t}}):(0,l.jsx)(i.A,{defaultMessage:"Redeem free Pro",id:"TS1EKqbD7V"}),{...b.pro_unverified_student,monthlyPrice:e,features:d}}if("pro"===t&&r)return{...b.pro_student,features:d.filter(e=>"unlock-free-pro"!==e.key)};if("pro"===t&&n){let e=n.discountPrice?b[t].monthlyPrice:"",a=n.discountPrice?b[t].yearlyPricePerMonth:"",r=n.discountPrice?(0,l.jsx)(l.Fragment,{children:n.discountPrice}):b[t].monthlyPrice,o=n.discountPrice?(0,l.jsx)(l.Fragment,{children:n.discountPrice}):b[t].yearlyPricePerMonth,d=n.showStudentDiscountContent?(0,l.jsx)(i.A,{defaultMessage:"Unlock the full capabilities of Perplexity at a discount when using a valid educational email.",id:"xqWcjbsdXj"}):b[t].description,c=b[t].monthlyPrice,u=(null==n?void 0:n.discountType)==="first_month_free"?"monthly"===s?(0,l.jsx)(i.A,{defaultMessage:"First month free, then $20/month",id:"YvOdHbwWXs"}):(0,l.jsx)(i.A,{defaultMessage:"First month free, then $16.67/month",id:"am6VV9Ad2K"}):void 0;return{...b[t],features:y.A_,monthlyPrice:r,yearlyPricePerMonth:o,description:d,previousStrikethroughMonthlyPrice:e,previousStrikethroughYearlyPrice:a,discountDescription:u,...n.discountPrice?{previousMonthlyPrice:c}:{}}}return"enterprise_pro"!==t&&"enterprise_max"!==t||a?"pro"===t?{...b[t],features:y.A_}:b[t]:{...b[t],buttonText:(0,l.jsx)(i.A,{defaultMessage:"Contact your admin",id:"BUJtQlaK1z"})}};var _=a(95641),M=a(98188),C=a(96391),j=a(38481),A=a(51244),E=a(26941),S=a(43627),k=a(21978);let N=e=>{let{subscriptionSource:t,previousSubscriptionSource:a}=e,l=(0,k.rd)(),{env:{isProduction:i,isBeta:n}}=(0,E.L)(),{openModal:o}=(0,A.u)(),{locale:d}=(0,s.A)();return{navigateToPortal:(0,r.useCallback)(async()=>{if("incentive"===t){o("incentiveProModal",{origin:S.Kw.PRICING_TABLE});return}if("ios"===t||"ios"===a){l.push("https://www.apple.com/app-store/");return}if("android"===t||"android"===a){l.push("https://play.google.com/store");return}let e=await (0,j.jh)({locale:d,reason:"tier-button"});if(e){l.push(e);return}l.push(i||n?"https://billing.stripe.com/p/login/6oEeXaewnb3z1facMM":"https://billing.stripe.com/p/login/test_7sIdSS7ioeNSdpe9AA")},[t,a,l,o,d,i,n])}};var T=a(80892),I=a(11129),R=a(71849),P=a(14036),O=a(60410),D=a(28554),L=a(26085),U=a(60010);let F=e=>{let{tier:t,onButtonClick:a,onSubTierButtonClick:n,disabled:o}=e,{isPro:d,isMax:u,isEnterprisePro:m,isEnterpriseMax:p,subscriptionSource:h,hasActiveSubscription:v}=(0,c.E)(),{formatDate:g,$t:f}=(0,s.A)(),{data:y,status:x,isLoading:b}=(0,j.mD)({reason:"paywall",enabled:u&&"pro"===t}),{isAdmin:w,isEnterprise:_}=(0,P.fE)({reason:"tier-button"}),M=(0,r.useMemo)(()=>"success"===x&&(null==y?void 0:y.current_subscription_tier)==="max"&&(null==y?void 0:y.next_subscription_tier)==="pro"&&(null==y?void 0:y.downgrade_scheduled),[y,x]),E=(0,r.useMemo)(()=>"success"===x&&(null==y?void 0:y.downgrade_scheduled_ts)?g((null==y?void 0:y.downgrade_scheduled_ts)*1e3,{month:"long",day:"numeric",year:"numeric"}):"",[y,x,g]),{openStackedModal:k}=(0,A.u)(),{previousSubscriptionSource:T}=(0,C.b)({reason:"tier-button"}),{navigateToPortal:I}=N({subscriptionSource:h,previousSubscriptionSource:T}),{cancelMaxDowngrade:R,isPending:U}=B(),F=d&&v,H=u&&v,q=m&&v;if("pro"===t&&F&&!M||"enterprise_pro"===t&&q||"enterprise_max"===t&&p&&v)return(0,l.jsx)(z,{});if("max"===t&&H)return M?(0,l.jsx)(D.A,{fullWidth:!0,variant:"primary",disabled:U||b||o,onClick:R,isLoading:U,text:f({defaultMessage:"Keep Max",id:"XpN74Q/7Zn"}),testId:"keep-max-button"}):(0,l.jsx)(z,{});if("standard"===t&&(F||H))return(0,l.jsx)(D.A,{fullWidth:!0,variant:"common",onClick:I,disabled:o,text:(0,l.jsx)(i.A,{defaultMessage:"Downgrade to free",id:"hHJO3dpg4H"})});if("pro"===t&&H)return(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)(D.A,{fullWidth:!0,variant:"common",disabled:M||b||o,onClick:()=>{!M&&k("downgradeModal",{origin:S.Kw.PRICING_TABLE})},text:b?"":M?(0,l.jsx)(i.A,{defaultMessage:"Downgrade scheduled",id:"NZIQayhrc6"}):(0,l.jsx)(i.A,{defaultMessage:"Downgrade to Pro",id:"kaso/aUweR"})}),M&&E&&(0,l.jsx)(O.A,{variant:"tinyRegular",color:"light",children:(0,l.jsx)(i.A,{defaultMessage:"You will be downgraded on {downgradeBillingStart}",id:"Hs+T4CTvOa",values:{downgradeBillingStart:E}})})]});if("standard"===t)return(0,l.jsx)(D.A,{fullWidth:!0,variant:"common",onClick:a,disabled:o,text:(0,l.jsx)(i.A,{defaultMessage:"Continue with free",id:"zX2SelZjuT"})});if("max"===t&&F)return(0,l.jsx)(D.A,{fullWidth:!0,variant:"inverted",disabled:o,onClick:()=>k("upgradeModal",{origin:S.Kw.PRICING_TABLE}),text:(0,l.jsx)(i.A,{defaultMessage:"Upgrade to Max",id:"z+PtTMgM3T"}),testId:"upgrade-to-max-button"});if("enterprise_pro"===t){let e=w||!_?(0,l.jsx)(i.A,{defaultMessage:"Continue with Enterprise Pro",id:"ifdiwgNLuc"}):(0,l.jsx)(i.A,{defaultMessage:"Request Enterprise Pro",id:"GwFywecEyY"});return(0,l.jsx)(D.A,{fullWidth:!0,variant:"inverted",disabled:o,onClick:a,text:e})}if("enterprise_max"===t&&q){let e=w?(0,l.jsx)(i.A,{defaultMessage:"Continue with Enterprise Max",id:"UOcjuwA4xJ"}):(0,l.jsx)(i.A,{defaultMessage:"Request Enterprise Max",id:"deqHi82ijZ"});return(0,l.jsx)(D.A,{fullWidth:!0,variant:"primary",disabled:o,onClick:a,text:e})}return"enterprise_max"===t?(0,l.jsx)(D.A,{fullWidth:!0,variant:"inverted",disabled:o,onClick:a,text:(0,l.jsx)(i.A,{defaultMessage:"Continue with Enterprise Max",id:"UOcjuwA4xJ"})}):"pro_unverified_student"===t?(0,l.jsxs)("div",{className:"gap-sm pb-md flex flex-col",children:[(0,l.jsx)(D.A,{fullWidth:!0,variant:"inverted",disabled:o,onClick:a,text:(0,l.jsx)(i.A,{defaultMessage:"Verify as student",id:"1tQDdEeW0V"})}),(0,l.jsx)(L.A,{noPadding:!0,variant:"primary",onClick:n,disabled:o,text:(0,l.jsx)(i.A,{defaultMessage:"Verify as educator",id:"vOTkGR1Bdz"})})]}):(0,l.jsx)(D.A,{fullWidth:!0,variant:"pro"===t?"primary":"inverted",onClick:a,disabled:o,text:(0,l.jsx)(i.A,{defaultMessage:"Get {tier}",id:"Rmlz2H/LWT",values:{tier:t.charAt(0).toUpperCase()+t.slice(1)}}),testId:"upgrade-to-".concat(t,"-button")})},z=()=>(0,l.jsx)(D.A,{fullWidth:!0,disabled:!0,variant:"common",text:(0,l.jsx)(i.A,{defaultMessage:"Your current plan",id:"m5/DxlihXS"}),testId:"your-current-plan-button"}),B=()=>{let{$t:e}=(0,s.A)(),t=(0,_.useQueryClient)(),{update:a}=(0,M.N)(),{trackEvent:l}=(0,T.yw)(),{openToast:r}=(0,U.G)(),{currentOpenModals:i,closeModal:n}=(0,A.u)(),o=(0,j.PF)({reason:"cancel-downgrade"},{onMutate:()=>{l("subscription cancel downgrade clicked")},onSuccess:async()=>{await (0,R.fi)({reason:"cancel-downgrade"}),await a(),l("subscription cancel downgrade success"),t.invalidateQueries({queryKey:(0,I.qs)()}),r({variant:"success",message:e({defaultMessage:"Max subscription resumed",id:"w9dWkTVNlZ"}),description:e({defaultMessage:"You'll continue to receive uninterrupted access to Max features.",id:"YbEsVsbfnA"}),timeout:3}),i.length>0&&n()}});return{cancelMaxDowngrade:()=>o.mutate(),...o}};var H=a(12839),q=a(11702),G=a(34953),Q=a(49427),V=a(72811);let K=e=>{let{tier:t,billingPeriod:a,origin:n,onStandardTierClick:m=d.A,onTierButtonClick:p=d.A,onSubTierButtonClick:h=d.A,isEnterpriseAdmin:v,isStudent:g,className:f,proDiscount:y,tierBadges:x,isSoftBankEnterprise:b}=e,{$t:_}=(0,s.A)(),{isMax:M,isEnterprisePro:C,isEnterpriseMax:j}=(0,c.E)(),A="enterprise_pro"===t||"enterprise_max"===t,E=C&&"enterprise_pro"===t||j&&"enterprise_max"===t,S=b&&A&&!E,{handleClickMonthly:k,handleClickEnterprise:N}=(0,u.k)({origin:n,reason:"tier-card"}),T=(0,r.useCallback)(()=>{if("standard"===t&&m){m();return}if("enterprise_pro"===t||"enterprise_max"===t){N(t),p();return}("max"===t||"pro"===t)&&k(t),p()},[t,m,p,N,k]),I=w({tier:t,isEnterpriseAdmin:!!v,isStudent:g,billingPeriod:a,proDiscount:y,onButtonClick:T}),{title:R,monthlyBillingPeriod:P,description:D,features:L,monthlyPrice:U,yearlyPricePerMonth:z}=I,{previousStrikethroughMonthlyPrice:B,discountDescription:K}=null!=I?I:{},Y="monthly"===a?U:z,X="max"===t||"pro"===t||"enterprise_pro"===t||"enterprise_max"===t||"pro_unverified_student"===t,Z=X?"default":"light",J=(null==x?void 0:x[t])||("pro"!==t||M?void 0:{text:_({defaultMessage:"Popular",id:"pxF+t0PUQJ"}),color:"super"}),$="pro"===t&&g;return(0,l.jsxs)(H.Ay,{className:o()("p-ml gap-sm flex flex-col pb-8",f),children:[(0,l.jsxs)("div",{className:"flex grow flex-col",children:[(0,l.jsxs)("div",{className:"mb-sm flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,l.jsx)(O.A,{variant:"baseSemi",color:Z,children:R}),J&&(0,l.jsx)(H.Ay,{variant:"superLight",className:o()("flex h-fit items-center rounded-md px-2 py-1",J.className),children:(0,l.jsx)(O.A,{variant:"tinyRegular",color:J.color||"super",children:J.text})})]}),(0,l.jsxs)("div",{className:"h-8",children:[K&&(0,l.jsx)(O.A,{variant:"tinyRegular",color:"light",children:K}),"monthly"===a&&B&&(0,l.jsx)(O.A,{variant:"tiny",color:"light",className:"line-through",children:B}),(0,l.jsxs)("div",{className:"flex items-end gap-1",children:[(0,l.jsx)(O.A,{variant:"baseSemi",color:Z,children:Y}),(0,l.jsxs)(O.A,{variant:"tinyRegular",className:"pb-xs",children:[X&&"enterprise_pro"!==t&&"enterprise_max"!==t&&"pro_unverified_student"!==t&&!$&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(W,{}),(0,l.jsx)(i.A,{defaultMessage:" / month",id:"poNf+KAUKK"})]}),$&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(W,{}),(0,l.jsx)(i.A,{defaultMessage:" / month or <link>refer to earn</link>",values:{link:e=>(0,l.jsx)(V.N,{className:"underline",href:"https://perplexity.ai/referrals",target:"_blank",children:e})},id:"hmYc/CXQmI"})]}),("enterprise_pro"===t||"enterprise_max"===t)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(W,{}),(0,l.jsx)(i.A,{defaultMessage:" / per seat each month",id:"krzByVjMC0"})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[z&&(0,l.jsx)(O.A,{variant:"tinyRegular",children:z}),(0,l.jsx)(O.A,{variant:"tinyRegular",color:"light",children:P})]})]})]}),(0,l.jsx)("div",{className:"mt-md mb-sm min-h-10",children:(0,l.jsx)(O.A,{variant:"tinyRegular",color:Z,children:D})}),(0,l.jsxs)("div",{className:"mb-lg mt-1 flex flex-col gap-2",children:[(0,l.jsx)(F,{tier:t,onButtonClick:T,onSubTierButtonClick:h,disabled:b}),S&&(0,l.jsx)(O.A,{variant:"tinyRegular",color:"light",className:"text-center",children:(0,l.jsx)(i.A,{defaultMessage:"Please reach out to your SoftBank representative to manage your subscription.",id:"LCYNwJ1TPK"})})]}),(0,l.jsxs)("ul",{className:"flex flex-col gap-3",children:[L.map(e=>(0,l.jsxs)("li",{className:"flex flex-row gap-2",children:[(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)(Q.e,{icon:q.i,size:16,color:"#8D9191"})}),(0,l.jsx)(O.A,{variant:"tinyRegular",color:"light",children:e})]},e.props.id)),"pro"===t&&(0,l.jsxs)("li",{className:"flex flex-row gap-3",children:[(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)(Q.e,{icon:G.Z,size:16,color:"#8D9191"})}),(0,l.jsx)(O.A,{variant:"tinyRegular",color:"light",children:(0,l.jsx)(i.A,{defaultMessage:"Exclusive access to Pro Perks and more",id:"a55IveCULf"})})]})]})]}),"pro"===t&&(0,l.jsx)("div",{className:"mt-auto pt-4",children:(0,l.jsxs)(O.A,{variant:"tinyRegular",color:"light",children:[(0,l.jsx)(i.A,{defaultMessage:"Existing subscriber? See ",id:"EFG99v1s2/"}),(0,l.jsx)(V.N,{href:"https://www.perplexity.ai/help-center/en/collections/8934800-subscription-billing",className:"underline",target:"_blank",children:(0,l.jsx)(i.A,{defaultMessage:"billing help",id:"2FmZi7KYDc"})})]})}),"max"===t&&(0,l.jsx)("div",{className:"mt-auto pt-4",children:(0,l.jsxs)(O.A,{variant:"tinyRegular",color:"light",children:[(0,l.jsx)(i.A,{defaultMessage:"For personal use only, and subject to our ",id:"WOtW93rmqA"}),(0,l.jsx)(V.N,{href:"https://www.perplexity.ai/hub/legal/terms-of-service",className:"underline",target:"_blank",children:(0,l.jsx)(i.A,{defaultMessage:"policies",id:"b1EHYiMz0c"})})]})})]})},W=r.memo(()=>"US"!==(0,x.m)()&&(0,l.jsx)(i.A,{defaultMessage:"USD",id:"hCQDknhvbI"}));W.displayName="USDSpan"},28566:(e,t,a)=>{"use strict";a.d(t,{S:()=>l});let l=(0,a(27773).w)({path:"M8.243 7.34l-6.38 .925l-.113 .023a1 1 0 0 0 -.44 1.684l4.622 4.499l-1.09 6.355l-.013 .11a1 1 0 0 0 1.464 .944l5.706 -3l5.693 3l.1 .046a1 1 0 0 0 1.352 -1.1l-1.091 -6.355l4.624 -4.5l.078 -.085a1 1 0 0 0 -.633 -1.62l-6.38 -.926l-2.852 -5.78a1 1 0 0 0 -1.794 0l-2.853 5.78z",name:"IconStarFilled",variant:"filled"})},28700:(e,t,a)=>{"use strict";a.d(t,{C:()=>l});let l=(0,a(27773).w)({path:"M6.331 8h11.339a2 2 0 0 1 1.977 2.304l-1.255 8.152a3 3 0 0 1 -2.966 2.544h-6.852a3 3 0 0 1 -2.965 -2.544l-1.255 -8.152a2 2 0 0 1 1.977 -2.304z M9 11v-5a3 3 0 0 1 6 0v5",name:"IconShoppingBag",variant:"stroked"})},31814:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var l=a(25576),r=a(85860),s=a(83081),i=a(70714),n=a(60410),o=a(35052),d=a(30002),c=a(72811);let u=()=>{let{colorScheme:e}=(0,o.U)(),{locale:t}=(0,s.A)(),a=(0,r.useMemo)(()=>{var e;return null!==(e=d._Cp[t])&&void 0!==e?e:d._Cp.default},[t]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.A,{className:"mb-4",variant:"small",color:"ultraLight",textCenter:!0,children:(0,l.jsx)(i.A,{defaultMessage:"By confirming your subscription, you allow Perplexity, Inc. to charge you for future payments in accordance with their terms. You can always cancel your subscription.",id:"XGZM6vn9o4"})}),(0,l.jsxs)("ul",{className:"mt-auto flex items-center justify-center gap-4 self-center",children:[(0,l.jsx)("li",{className:"border-subtler border-r pr-4",children:(0,l.jsx)("img",{src:"dark"===e?"https://cdn.brandfolder.io/KGT2DTA4/at/v5bcwzcgcmgbp3676v3rg79q/Powered_by_Stripe_-_white.svg":"https://cdn.brandfolder.io/KGT2DTA4/at/g65qkq94m43qc3c9fqnhh3m/Powered_by_Stripe_-_black.svg",width:120,height:27,style:{opacity:"dark"===e?.4:.55},alt:"Powered by Stripe"})}),(0,l.jsx)("li",{className:"border-subtler border-r pr-4",children:(0,l.jsx)(n.A,{variant:"small",color:"light",children:(0,l.jsx)(c.N,{href:a.privacyPolicy,target:"__blank",children:(0,l.jsx)(i.A,{defaultMessage:"Privacy",id:"3QztawJkyy",description:"link label"})})})}),(0,l.jsx)("li",{children:(0,l.jsx)(n.A,{variant:"small",color:"light",children:(0,l.jsx)(c.N,{href:a.termsOfService,target:"__blank",children:(0,l.jsx)(i.A,{defaultMessage:"Terms",id:"qZ8WUIKvw0",description:"link label"})})})})]})]})}},32014:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var l=a(25576),r=a(64299),s=a.n(r),i=a(12839);let n=e=>{let{extraCss:t="",variant:a="subtler"}=e;return(0,l.jsx)(i.Ay,{variant:a,className:s()("shimmer aspect-square w-[144px] rounded-lg",t)})}},32971:(e,t,a)=>{"use strict";a.d(t,{V:()=>i});var l=a(85860),r=a(80892),s=a(16079);let i=e=>{let{origin:t}=e,{trackEvent:a}=(0,r.yw)();return(0,l.useCallback)(()=>{(0,s.Vt)(),a("whatsapp button clicked",{origin:t}),window.open("https://api.whatsapp.com/send/?phone=18334363285&text&type=phone_number&app_absent=0","_blank")},[a,t])}},33496:(e,t,a)=>{"use strict";a.d(t,{o:()=>l,w:()=>n});var l,r=a(47575),s=a(98188),i=a(94105);function n(e){var t,a;let{feature:n}=e,{session:o}=(0,s.N)(),d=null!==(a=null==o?void 0:null===(t=o.user)||void 0===t?void 0:t.org_uuid)&&void 0!==a?a:"none",{hasAccessToProFeatures:c}=(0,r.E)(),{value:u}=(0,i.mu)({flag:"connectors-space-access-for-pro",defaultValue:!1});return"none"!==d||!!c&&n!==l.MY_FILES&&(n===l.SPACES?u:n!==l.SOURCES)}!function(e){e.MY_FILES="my-files",e.SOURCES="sources",e.MY_CONNECTORS="my-connectors",e.SPACES="spaces"}(l||(l={}))},34113:(e,t,a)=>{"use strict";a.d(t,{T:()=>o});var l=a(85860),r=a(15492),s=a(83081),i=a(38481),n=a(11129);let o=e=>{var t,a,o,d,c;let{reason:u}=e,{$t:m}=(0,s.A)(),{data:p,isLoading:h}=(0,r.useQuery)({queryKey:(0,n.Hn)(),queryFn:()=>(0,i.gy)({reason:u})}),v=!!(null==p?void 0:p.institution),g=null!==(d=null==p?void 0:null===(t=p.offer)||void 0===t?void 0:t.discount_str)&&void 0!==d?d:void 0;!g&&v&&(g=m({defaultMessage:"$4.99",id:"ngR/pJs1LV"}));let f=null!==(c=null==p?void 0:null===(a=p.offer)||void 0===a?void 0:a.discount_type)&&void 0!==c?c:void 0;return(0,l.useMemo)(()=>{var e;return{userPromotionsLoading:h,discountPrice:g,discountType:f,showStudentDiscountContent:v,campaignId:null==p?void 0:null===(e=p.campaign)||void 0===e?void 0:e.id,institution:null==p?void 0:p.institution}},[null==p?void 0:null===(o=p.campaign)||void 0===o?void 0:o.id,null==p?void 0:p.institution,g,f,h,v])}},34819:(e,t,a)=>{"use strict";a.d(t,{n:()=>n});var l=a(85860),r=a(49611);let s="__merge-ah-script__".concat(crypto.randomUUID()),i=(0,r.A)(function(){return new Promise((e,t)=>{if(document.getElementById(s))return e();let a=document.createElement("script");a.src="https://ah-cdn.merge.dev/initialize.js",a.id=s,a.onload=()=>e(),a.onerror=t,document.body.appendChild(a)})});function n(e){let t=(0,l.useCallback)(async()=>{let t=null==e?void 0:e.linkToken;if(!t)throw Error("Link token is required");await i(),await new Promise(a=>{window.AgentHandlerLink.initialize({...e,linkToken:t,onReady:()=>a()})})},[e]);return(0,l.useCallback)(async()=>{await t(),window.AgentHandlerLink&&window.AgentHandlerLink.openLink(e)},[e,t])}},34953:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});let l=(0,a(27773).w)({path:"M16 18a2 2 0 0 1 2 2a2 2 0 0 1 2 -2a2 2 0 0 1 -2 -2a2 2 0 0 1 -2 2zm0 -12a2 2 0 0 1 2 2a2 2 0 0 1 2 -2a2 2 0 0 1 -2 -2a2 2 0 0 1 -2 2zm-7 12a6 6 0 0 1 6 -6a6 6 0 0 1 -6 -6a6 6 0 0 1 -6 6a6 6 0 0 1 6 6z",name:"IconSparkles",variant:"stroked"})},35009:(e,t,a)=>{"use strict";a.d(t,{i:()=>d});var l=a(85860),r=a(83081),s=a(12927),i=a(26941);let n=["ar","bg","cs","da","de","el","en","en-AU","en-CA","en-NZ","en-GB","es","es-ES","es-419","et","fi","fil","fr","fr-CA","fr-FR","he","hu","hr","id","it","it-IT","ja","ko","lt","lv","ms","mt","nb","nl","no","pl","pt","pt-BR","ro","ru","sk","sl","sv","th","tr","vi","zh","zh-HK","zh-TW"];async function o(){return a.e(9521).then(a.bind(a,79521)).then(e=>{let{loadStripe:t}=e;return t})}let d=()=>{let{env:{isProduction:e,isStaging:t}}=(0,i.L)(),{locale:a}=(0,r.A)(),d=(0,l.useMemo)(()=>(0,s.YW)([a],n,"en"),[a]);return(0,l.useMemo)(()=>{let a=e||t?"pk_live_51N9YqBGZwjqPfxkZtUgmBVuQH2100lzQ2yLYZp7mlr80eUyO8n3fBwXMgeMIhARze7BNrAHjhOXRD1u5AawwCO8800sFI1FBVA":"pk_test_51N9YqBGZwjqPfxkZo0iwN0OgoN9pvr85PDuJjOJeoeKbo4wSXpwhYg7BSoKJVHV3HnqWUkfD0IJSOs9q3n5Hqlqx00PsidZhZT";return o().then(e=>e(a,{betas:["custom_checkout_beta_5"],locale:d}))},[e,t,d])}},35179:(e,t,a)=>{"use strict";var l,r;a.d(t,{GO:()=>c,QK:()=>d,WH:()=>i,ZW:()=>l,o2:()=>n,qX:()=>o,u8:()=>s}),function(e){e[e.NONE=0]="NONE",e[e.READER=1]="READER",e[e.WRITER=2]="WRITER",e[e.EDITOR=5]="EDITOR",e[e.ADMIN=3]="ADMIN",e[e.OWNER=4]="OWNER",e[e.OWNER_DEFAULT_BOOKMARKS=6]="OWNER_DEFAULT_BOOKMARKS",e[e.INVITED_READER=11]="INVITED_READER",e[e.INVITED_WRITER=12]="INVITED_WRITER",e[e.INVITED_EDITOR=15]="INVITED_EDITOR",e[e.INVITED_ADMIN=13]="INVITED_ADMIN"}(l||(l={}));function s(e){return e===l.OWNER||e===l.OWNER_DEFAULT_BOOKMARKS}function i(e){return e===l.OWNER_DEFAULT_BOOKMARKS}function n(e){return e>=l.WRITER&&e<l.INVITED_READER}function o(e){return e>=l.READER&&e<l.INVITED_READER}function d(e){return e==l.READER||e==l.INVITED_READER}function c(e){return[l.INVITED_READER,l.INVITED_WRITER,l.INVITED_EDITOR,l.INVITED_ADMIN].includes(e)}!function(e){e.PageAccessNotAllowed="pageAccessNotAllowed",e.ThreadAccessNotAllowed="threadAccessNotAllowed",e.InvalidThread="invalidThread",e.ThreadExpired="threadExpired",e.ThreadStreamError="threadStreamError",e.CollectionAccessNotAllowed="collectionAccessNotAllowed",e.SpaceAccessNotAllowed="spaceAccessNotAllowed",e.InvalidCollection="invalidCollection",e.SubscriptionAlreadyActive="subscriptionAlreadyActive",e.UnableToGrantAccess="unableToGrantAccess"}(r||(r={}))},35190:(e,t,a)=>{"use strict";a.d(t,{Q:()=>f});var l=a(85860),r=a(95641),s=a(83081),i=a(11129),n=a(77917),o=a(3041);async function d(e){let{request:t,reason:a}=e,{data:l,error:r}=await n.By.POST("/rest/shopping/generate-shopping-try-on",a,{body:t,timeoutMs:35e3,headers:{"content-type":"application/json"}});return r?{status:"error",image_url:""}:l}async function c(e){let{request:t,reason:a}=e,{data:l,error:r}=await n.By.POST("/rest/shopping/try-on-photo/generate-avatar",a,{body:t,timeoutMs:4e4,headers:{"content-type":"application/json"}});return r?{status:"error",image_url:""}:l}let u=async e=>{let{reason:t,try_on_photo_url:a}=e;try{let e=await n.By.PUT("/rest/shopping/try-on-photo/save",t,{body:{try_on_photo_url:a},timeoutMs:(0,n.e4)()});if(e.data)return e.data;return{status:"error",user_try_on_photo_url:""}}catch(e){return o.vF.error("Failed to save user try on photo",e),{status:"error",user_try_on_photo_url:""}}},m=async e=>{let{reason:t}=e;try{let e=await n.By.DELETE("/rest/shopping/try-on-photo/delete",t,{timeoutMs:(0,n.e4)()});if(e.data)return e.data;return{status:"error"}}catch(e){return o.vF.error("Failed to delete user try on photo",e),{status:"error"}}};var p=a(51244);let h=async e=>{let{file:t,fileSource:a,forceImage:l,reason:r}=e,s=await n.By.POST("/rest/uploads/create_upload_url",r,{body:{filename:t.name,content_type:t.type,source:null!=a?a:"default",file_size:t.size,force_image:null!=l&&l},timeoutMs:n.dS.MEDIUM,retries:2});return s.data?s.data:null};var v=a(60010),g=a(77936);let f=e=>{let{reason:t,productImageUrl:a}=e,{$t:n}=(0,s.A)(),{deprecatedOpenToast:f}=(0,v.G)(),{openModal:y,closeModal:x}=(0,p.u)(),b=(0,r.useQueryClient)(),[w,_]=(0,l.useState)({status:"idle",error:null,resultUrl:null,selfieUrl:null});(0,l.useEffect)(()=>{if(a){let e=b.getQueryData((0,i.pE)(a));e&&_(t=>({...t,resultUrl:e}))}},[a,b]);let M=(0,l.useRef)(!1),C=(0,l.useCallback)(()=>{_({status:"idle",error:null,resultUrl:null,selfieUrl:null})},[]),j=(0,l.useCallback)(e=>{_(t=>({...t,status:"error",error:e}))},[]),A=(0,l.useCallback)(async e=>{if(!e.type.startsWith("image/"))return j(n({defaultMessage:"Only image files are supported.",id:"f4sVsu2Ean"})),null;if(e.size>0xa00000)return j(n({defaultMessage:"Image size exceeds 10MB limit.",id:"/lVoGk8eeX"})),null;try{_(e=>({...e,status:"uploading"}));let r=await h({file:e,fileSource:"shopping_try_on",forceImage:!0,reason:t});if(!(null==r?void 0:r.fields)||!(null==r?void 0:r.s3_bucket_url)){if(null==r?void 0:r.rate_limited)throw Error("File upload failed due to rate limit.");throw Error("Failed to get upload URL")}let s=new FormData;Object.entries(r.fields).forEach(e=>{let[t,a]=e;s.append(t,a)}),s.append("file",e);let i=await fetch(r.s3_bucket_url,{method:"POST",body:s});if(!i.ok)throw Error("Failed to upload file");let n=null;try{var a,l;let e=await i.json();(null==e?void 0:e.secure_url)?n=e.secure_url:(null==e?void 0:null===(l=e.eager)||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:a.secure_url)&&(n=e.eager[0].secure_url),n&&(0,g.WR)(n)&&(n=(0,g.Rh)(n))}catch(e){r.s3_object_url&&(n=r.s3_object_url)}if(!n)throw Error("Failed to get image URL from upload response");return _(e=>({...e,status:"idle"})),n}catch(e){return j(e instanceof Error?e.message:n({defaultMessage:"Failed to upload image.",id:"+eCvtPyOJg"})),null}},[n,t,j]),E=(0,l.useCallback)(async e=>{let t=await A(e);return t&&_(e=>({...e,selfieUrl:t})),t},[A]),S=(0,l.useCallback)(()=>{y("shoppingTryOnOnboardingModal",{onSuccessfulOnboarding:e=>{b.setQueryData((0,i.rO)(),{try_on_photo_url:e}),b.setQueryData((0,i.CM)(),!1),f(n({defaultMessage:"Avatar updated successfully!",id:"tjpCN5PY48"}),"success",3)},onClose:()=>{x()}})},[y,x,b,f,n]),k=(0,l.useCallback)(async e=>{try{let{user_try_on_photo_url:a}=await u({reason:t,try_on_photo_url:e});return a}catch(e){return f(n({defaultMessage:"Failed to save avatar. Please try again.",id:"Z5lnZQ5t8Q"}),"error",5),o.vF.error("Failed to save avatar",e),""}},[t,n,f]),N=(0,l.useCallback)(async()=>{try{await m({reason:t})}catch(e){o.vF.error("Failed to delete avatar",e)}},[t]),T=(0,l.useCallback)(e=>{M.current=e},[]),I=(0,l.useCallback)(async e=>{let t=await k(e);b.setQueryData((0,i.rO)(),{try_on_photo_url:t}),f(n({defaultMessage:"Your avatar has been generated! You can now try on clothes.",id:"moiCrokdKs"}),"success",10,"",n({defaultMessage:"Check it out",id:"IjqWGw+QT1"}),()=>{y("avatarManagementModal",{source:"toast",onRetry:S})})},[k,n,f,b,y,S]),R=(0,l.useCallback)(async e=>{try{_(e=>({...e,status:"processing",resultUrl:null,error:null})),b.setQueryData((0,i.CM)(),!0);let a=await c({request:{user_image_url:e},reason:t});if("failed"===a.status)throw b.setQueryData((0,i.CM)(),!1),Error("Failed to generate avatar");_(e=>({...e,status:"success",resultUrl:a.image_url})),M.current&&await I(a.image_url),b.setQueryData((0,i.CM)(),!1)}catch(e){j(e instanceof Error?e.message:n({defaultMessage:"Failed to generate avatar.",id:"anPmJ/DLsx"}))}},[t,n,j,I,M,b]),P=(0,l.useCallback)(async(e,a)=>{try{_(e=>({...e,status:"processing",resultUrl:null,error:null})),b.setQueryData((0,i.CM)(),!0);let l=await c({request:{user_image_url:a,selfie_image_url:e},reason:t});if("failed"===l.status)throw b.setQueryData((0,i.CM)(),!1),Error("Failed to generate avatar");_(e=>({...e,status:"success",resultUrl:l.image_url})),M.current&&await I(l.image_url),b.setQueryData((0,i.CM)(),!1)}catch(e){j(e instanceof Error?e.message:n({defaultMessage:"Failed to generate avatar.",id:"anPmJ/DLsx"}))}},[t,n,j,I,M,b]),O=(0,l.useCallback)(async(e,a)=>{try{_(e=>({...e,status:"processing",resultUrl:null,error:null}));let l=await d({request:{image_url:e,product_image_url:a},reason:t});if("error"===l.status)throw Error("Failed to generate try-on");_(e=>({...e,status:"success",resultUrl:l.image_url})),a&&b.setQueryData((0,i.pE)(a),l.image_url)}catch(e){j(e instanceof Error?e.message:n({defaultMessage:"Failed to generate try-on.",id:"ptEP5MGDf6"}))}},[t,n,j,b]),D=(0,l.useCallback)(()=>{a&&b.removeQueries({queryKey:(0,i.pE)(a)}),_(e=>({...e,resultUrl:null}))},[a,b]);return(0,l.useMemo)(()=>({status:w.status,error:w.error,resultUrl:w.resultUrl,selfieUrl:w.selfieUrl,uploadPhoto:A,uploadSelfie:E,generateDefaultAvatar:R,generateCustomAvatar:P,tryOnProduct:O,saveAvatar:k,resetState:C,deleteAvatar:N,setShouldAutoSaveAvatar:T,clearCachedTryOn:D,handleRetry:S}),[w.status,w.error,w.resultUrl,w.selfieUrl,A,E,R,P,O,k,C,N,T,D,S])}},37342:(e,t,a)=>{"use strict";a.d(t,{A:()=>I});var l=a(25576),r=a(85860),s=a(95899);function i(e){let{children:t,session:a}=e;return(0,l.jsx)(s.SessionProvider,{session:a,refetchInterval:86400,children:t})}var n=a(10023),o=a(79756),d=a(16502);let c=(e,t)=>null!=t&&!!t.includes("WindowsApp")||"true"===e,u=e=>"light"===e||"dark"===e;var m=a(26941),p=a(54499),h=a(37705);let v=(0,r.memo)(e=>{let{children:t,userAgent:a,hostname:s}=e,i=(0,r.useMemo)(()=>({device:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e||"undefined"==typeof navigator||(e=navigator.userAgent),{isChrome:(0,p.H8)(e),isMobile:(0,p.Fr)(e),isAndroid:(0,p.m0)(e),isIOS:(0,p.un)(e),isMacOS:(0,p.U0)(e),isMobileSafari:(0,p.HQ)(e),isFirefox:(0,p.gm)(e),isWindowsApp:(0,p.r$)(e),isWindowsOS:(0,p.Yh)(e),isMetaBrowser:(0,p.A5)(e),isSamsungBrowser:(0,p.Pb)(e),userAgent:e}}(a),env:(0,h._$)(s)}),[a,s]);return(0,l.jsx)(m.V.Provider,{value:i,children:t})});v.displayName="WebPlatformProvider";var g=a(91866),f=a(41290),y=a(49611),x=a(74884),b=a(49515),w=a(67205),_=a(26302),M=a(3041);let C={},j=r.memo(e=>{let{locale:t,children:a,messages:s=C}=e,i=(0,r.useCallback)(e=>{"MISSING_TRANSLATION"!==e.code&&M.vF.error(e)},[]);return(0,l.jsx)(_.A,{locale:t,defaultLocale:w.X,messages:s,onError:i,children:a})});j.displayName="TranslationsProvider";let A=(0,y.A)(b.Zi),E=r.memo(e=>{let{locale:t,children:a}=e,{translations:s,matchedLocale:i}=(0,r.use)(A(t));return(0,l.jsx)(j,{locale:i,messages:s,children:a})});E.displayName="InnerClientTranslationsProvider";let S={},k=r.memo(e=>{let{children:t,shouldSetHtmlLang:a=!0}=e,s=(0,r.useMemo)(()=>(0,x.t)(),[]),i=(0,r.useMemo)(()=>(0,b.Ji)(s),[s]);return(a&&"undefined"!=typeof document&&(document.documentElement.lang!==s&&(document.documentElement.lang=s),document.documentElement.dir!==i&&(document.documentElement.dir=i)),s===w.X)?(0,l.jsx)(j,{locale:s,messages:S,children:t}):(0,l.jsx)(r.Suspense,{fallback:null,children:(0,l.jsx)(E,{locale:s,children:t})})});k.displayName="ClientTranslationsProvider";let N=(0,f.Q)(async()=>{let{DebugModeActivator:e}=await a.e(1422).then(a.bind(a,31422));return{default:e}},{restricted:!0}),T=r.memo(e=>{let{host:t,userAgent:a,children:s,session:m}=e,p=(0,r.useMemo)(()=>(function(e){var t,a;let{userAgent:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.colorScheme,s=u(r)?r:null,i=e[d.q5],n={};try{n=JSON.parse(null!==(t=e[d.XW])&&void 0!==t?t:"{}")}catch(e){}let m=Object.values(o.k0).includes(i);i&&m||(i=o.k0.SEARCH);let p=e[d.$c];return{colorScheme:s,isCollapsed:c(e.isCollapsed,l),isSidebarPinned:"true"===e.isSidebarPinned,sidebarHiddenHubs:JSON.parse(null!==(a=e.sidebarHiddenHubs)&&void 0!==a?a:"[]"),isIncognitoLocal:void 0===e[d.Ee]?void 0:"true"===e[d.Ee],isDiscoverInterestBoxDismissed:p?"true"===p:void 0,isEnterpriseAdDismissed:"true"==e[d.iP],isMaxAssistantMode:"true"==e[d.km],isSplashPageDismissed:"true"==e[d.J3],isSuggestionsDisabled:"true"==e[d.Nv],isHomepageWidgetsDisabled:"true"==e[d.wm],isSportsIosCtaDismissed:"true"==e[d.Yk],preferredSearchMode:i,preferredSearchModels:n,welcomeBackGateImpressions:Number(e[d.rw])||0,shareGateImpressions:Number(e[d.CY])||0,isSidebarConnectorsAdDismissed:"true"==e[d.Br],isStudentReferralBannerDismissed:"true"==e[d.xv],isStudentSpaceUpsellDismissed:"true"==e[d.Z3],studentSpaceUpsellImpressions:Number(e[d.d6])||0}})((0,g.OR)(),{userAgent:a}),[a]);return(0,l.jsx)(k,{children:(0,l.jsx)(i,{session:m,children:(0,l.jsx)(v,{hostname:t,userAgent:a,children:(0,l.jsxs)(n.t,{initialLocalUserSettings:p,children:[(0,l.jsx)(N,{}),s]})})})})});T.displayName="RootProviders";let I=T},37483:(e,t,a)=>{"use strict";a.d(t,{$:()=>l});let l=(0,a(27773).w)({path:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0 M6 21v-2a4 4 0 0 1 4 -4h.5 M18 22l3.35 -3.284a2.143 2.143 0 0 0 .005 -3.071a2.242 2.242 0 0 0 -3.129 -.006l-.224 .22l-.223 -.22a2.242 2.242 0 0 0 -3.128 -.006a2.143 2.143 0 0 0 -.006 3.071l3.355 3.296z",name:"IconUserHeart",variant:"stroked"})},37652:(e,t,a)=>{"use strict";a.d(t,{e:()=>U});var l=a(85860),r=a(47575),s=a(83105),i=a(14337),n=a(95641),o=a(4428),d=a(26976),c=a(11129),u=a(10173),m=a(27628),p=a(8114),h=a(61851),v=a(87710),g=a(41433),f=a(2870),y=a(34819),x=a(77594),b=a(46972);let w={GCAL_CONNECT:"gcal_connect",CONNECTOR_COMPLETE:"connector_complete"},_={UPSELL_CONNECTOR:"upsell-connector-channel"};var M=a(80892),C=a(63149),j=a(60760),A=a(50663),E=a(14475),S=a(51244),k=a(89334),N=a(7631),T=a(26941),I=a(43627),R=a(67121),P=a(21978),O=a(3041),D=a(24915);let L={logged_out_image_generation:I.Kw.IMAGE_GENERATION_IN_THREAD,logged_out_video_generation:I.Kw.VIDEO_GENERATION_IN_THREAD,subscription_upgrade_video_generation:I.Kw.VIDEO_GENERATION_IN_THREAD,missing_out_on_pro:I.Kw.MISSING_OUT_ON_PRO_IN_THREAD,auto_upgrade_to_pro:I.Kw.AUTO_UPGRADE_TO_PRO,pro_feature_limit_queries:I.Kw.PRO_FEATURE_LIMIT_BANNER,pro_feature_limit_files:I.Kw.PRO_FEATURE_LIMIT_BANNER,login_for_comet_agent_queries:I.Kw.LOGIN_FOR_COMET_AGENT_QUERIES_IN_THREAD,comet_agent_queries_rate_limited:I.Kw.COMET_AGENT_QUERIES_RATE_LIMITED_IN_THREAD,pro_upgrade:I.Kw.PRO_UPGRADE_IN_SIDE_HOMEPAGE,max_feature_limit_labs_queries:I.Kw.PRO_FEATURE_LIMIT_BANNER,enterprise_max_side:I.Kw.ENTERPRISE_MAX_UPSELL,logged_out_canvas_generation:I.Kw.CANVAS_GENERATION_IN_THREAD,max_feature_canvas_generation:I.Kw.CANVAS_GENERATION_IN_THREAD},U=(e,t,a)=>{var U,F;let z=(0,s.L)(),{openVisitorLoginUpsell:B}=(0,h.P)({enabled:!z}),{trackEvent:H}=(0,M.yw)(),{lastResult:q}=(0,b.E)(),{openModal:G}=(0,S.u)(),Q=(0,k.EJ)(),V="?handle_upsell=true",{submitQuery:K}=(0,x.N)(),W=(0,i.Zh)(),{handleVerificationSuccess:Y}=(0,f.T)({origin:I.Kw.STUDENT_VERIFICATION_UPSELL}),X=D.env.NEXT_PUBLIC_IS_SIDECAR_BUILD?"sidecar_thread":Q?"search_results_page":void 0,{subscriptionTier:Z}=(0,r.E)(),{device:{isWindowsOS:J,isMacOS:$}}=(0,T.L)(),ee=(0,P.rd)(),{handleConnect:et}=(0,u.G)({reason:"upsell"}),{mutateAsync:ea}=function(e){let{reason:t}=e,a=(0,n.useQueryClient)(),l=(0,c.U_)();return(0,o.useMutation)({mutationKey:["publishArticleMutation"],mutationFn:async e=>{let a,{connectorName:l,connectionUUID:r,deleteFiles:s}=e;return r&&!s?await (0,d.e6)({connectionUUID:r,reason:t}):r&&s?await (0,d.dG)({connectionUUID:r,reason:t}):await (0,d.mH)({connectorName:l,reason:t})},onSettled:async()=>{await a.refetchQueries({queryKey:l})},onMutate:async e=>{let{connectorName:t,connectionUUID:r}=e;a.setQueryData(l,e=>{if(!e)return e;let a=e.connectors.connectors.map(e=>e.name!==t||r&&e.connection_uuid!==r?e:{...e,connected:!1});return{...e,connectors:{connectors:a}}})}})}({reason:"upsell"}),el=(0,p.k)(),{handleCreateNewSpaceForThread:er}=(0,m.k)(),{connectors:es}=(0,E.u)({reason:"upsell"}),{handleDownloadClick:ei}=(0,v.y)({isWindows:J,isUnsupportedDevice:!$&&!J}),en=(0,g.v)(),eo=null==e?void 0:null===(U=e.cta_information)||void 0===U?void 0:U.merge_auth_token,ed=null==e?void 0:null===(F=e.cta_information)||void 0===F?void 0:F.merge_auth_callback_uuid,ec=(0,y.n)({linkToken:(e=>{if(e)try{return JSON.parse(e)}catch(t){return e}})(eo),onSuccess:()=>{ed&&(0,C.iU)({uuid:ed,success:!0,reason:"Account successfully connected"}),ee.push(window.location.pathname+V)}}),eu=(0,l.useCallback)(async()=>{try{await W.setCometAsDefaultBrowser("set_default_browser")}catch(e){}},[W]);(0,l.useEffect)(()=>{if(!D.env.NEXT_PUBLIC_IS_SIDECAR_BUILD)return;let e=new BroadcastChannel(_.UPSELL_CONNECTOR);return e.onmessage=e=>{e.data.type===w.CONNECTOR_COMPLETE&&(window.focus(),window.location.href=window.location.pathname+V)},()=>{e.close()}},[V]);let em=(0,l.useCallback)(()=>{if(e)switch(e.app_location){case R.AD.MODAL:H("upsell modal opened",{entryUUID:null==q?void 0:q.backend_uuid,upsellType:e.upsell_type,upsellName:e.name,cometSurface:X,subscriptionTier:Z});break;case R.AD.IN_THREAD:case R.AD.IN_THREAD_BOTTOM:case R.AD.IN_THREAD_INPUT:H("thread upsell banner clicked",{entryUUID:null==q?void 0:q.backend_uuid,upsellType:e.upsell_type,upsellName:e.name,cometSurface:X,subscriptionTier:Z});break;case R.AD.SIDEBAR:case R.AD.SIDE_CARD:H("side upsell clicked",{upsellType:e.upsell_type,upsellName:e.name,cometSurface:X})}},[q,H,e,X,Z]),ep=(0,l.useCallback)(()=>{var t,a;(null==q?void 0:q.query_str)&&K({rawQuery:q.query_str,existingEntryUUID:q.backend_uuid,redoSearch:!0,collection:null,newFrontendContextUUID:null,existingFrontendContextUUID:q.frontend_context_uuid,promptSource:"user",querySource:"rewrite-upsell",attachments:[],modelPreferenceOverride:null!==(a=null==e?void 0:null===(t=e.cta_information)||void 0===t?void 0:t.model_preference)&&void 0!==a?a:"pplx_pro"})},[q,K,e]),eh=(0,l.useCallback)(()=>{var t;if(!e)return;let{permalink_new_tab:a,permalink:l}=null!==(t=e.cta_information)&&void 0!==t?t:{};l&&(a?window.open(l,"_blank"):window.location.href=l)},[e]);return(0,l.useCallback)(()=>{var l,r,s,i,n,o,d,c,u,m,p;if(!e)return;let h=e.cta===R.E6.SHORTCUT_MODAL?null===(r=e.cta_information)||void 0===r?void 0:null===(l=r.recommended_shortcut)||void 0===l?void 0:l.name:void 0;(0,A.g)(e.name,h),em();let v=null!==(s=L[e.name])&&void 0!==s?s:I.Kw.UNSPECIFIED_GENERALIZED_UPSELL,g=(null==q?void 0:q.thread_url_slug)?"/search/".concat(q.thread_url_slug).concat(V):void 0;(window.location.pathname.startsWith("/b/mission-control")||window.location.pathname.startsWith("/b/assistants"))&&(g="/b/assistants".concat(V));let f=(null==q?void 0:q.thread_url_slug)?"/search/".concat(q.thread_url_slug):void 0;switch(e.cta){case R.E6.SIGN_UP_OR_LOGIN:if(D.env.NEXT_PUBLIC_IS_SIDECAR_BUILD)return;B({title:e.title,description:e.description,origin:v});break;case R.E6.PRO_UPGRADE:en({pitchMessage:(null===(i=e.cta_information)||void 0===i?void 0:i.upgrade_paywall_title)?{title:e.cta_information.upgrade_paywall_title}:void 0,origin:v,defaultSegment:e.upsell_type===R.Yx.UPGRADE_TO_ENTERPRISE?"business":void 0});break;case R.E6.THREAD_TO_SPACE:if(!(null==q?void 0:q.backend_uuid))return;el?er(null==q?void 0:q.backend_uuid,null==q?void 0:q.frontend_context_uuid):G("spaceCreateForThread",{entryUUID:null==q?void 0:q.backend_uuid,frontendContextUUID:null==q?void 0:q.frontend_context_uuid});break;case R.E6.CONNECTOR:if(D.env.NEXT_PUBLIC_IS_SIDECAR_BUILD||(null===(n=e.cta_information)||void 0===n?void 0:n.connector_type)!=="gcal")D.env.NEXT_PUBLIC_IS_SIDECAR_BUILD&&(null===(o=e.cta_information)||void 0===o?void 0:o.connector_type)==="gcal"?window.open("".concat(window.location.origin).concat("/account/connectors","?connector_type=").concat(w.GCAL_CONNECT),"_blank"):O.vF.error("Unhandled upsell connector type",{connectorType:null===(c=e.cta_information)||void 0===c?void 0:c.connector_type});else{let e="gcal";for(let t of(0,N.Ox)(null!==(d=null==es?void 0:es.connectors)&&void 0!==d?d:[],e))ea({connectorName:e,connectionUUID:t});et({connectorName:e,redirectPath:g,unauthedRedirectPath:f})}break;case R.E6.REWRITE_ANSWER:t&&(null==q?void 0:q.backend_uuid)?(0,j._U)({entryUUID:null==q?void 0:q.backend_uuid,reason:"rewrite-upsell"}).catch(()=>{O.vF.error("Error terminating entry")}).finally(ep):ep();break;case R.E6.PERMALINK:eh();break;case R.E6.SET_DEFAULT_BROWSER:eu();break;case R.E6.IMAGE_ANNOUNCEMENT_MODAL:{if(!e.image_asset||!e.image_asset_low_res||!e.button_text)return;let t=e.cta;e.upsell_type===R.Yx.DOWNLOAD_COMET&&(t=R.E6.COMET_DOWNLOAD),G("announcementImageModal",{imageUrlHd:e.image_asset,imageUrlLowRes:e.image_asset_low_res,title:null!==(u=e.title)&&void 0!==u?u:"",description:null!==(m=e.description)&&void 0!==m?m:"",upsellInformation:{...e,cta:t}});break}case R.E6.COMET_DOWNLOAD:ei({upsellName:e.name});break;case R.E6.MERGE_AUTH_CONNECTOR:eo&&ec();break;case R.E6.SHORTCUT_MODAL:{let t=null===(p=e.cta_information)||void 0===p?void 0:p.recommended_shortcut;G("taskShortcutModal",{source:"thread_upsell_create",onCreated:null==a?void 0:a.hideUpsell,shortcut:t?{title:t.name,prompt:t.prompt}:void 0});break}case R.E6.OPEN_SHEERID_MODAL:H("sheerid form redirect",{verificationLocationSource:I.Kw.STUDENT_VERIFICATION_UPSELL,verificationRoleType:"student"}),G("sheerIdModal",{onSuccess:Y,type:"student"})}},[e,em,null==q?void 0:q.thread_url_slug,null==q?void 0:q.backend_uuid,null==q?void 0:q.frontend_context_uuid,V,B,en,G,t,el,er,null==es?void 0:es.connectors,et,ea,ep,eh,eu,ei,Y,eo,ec,null==a?void 0:a.hideUpsell,H])}},37705:(e,t,a)=>{"use strict";a.d(t,{KV:()=>v,YG:()=>o,_$:()=>b});var l=a(24915);let r=e=>null==e?void 0:e.includes("perplexity.ai"),s=e=>null==e?void 0:e.includes("localhost"),i=e=>null==e?void 0:e.includes("pplx.dev"),n=e=>r(e)&&(null==e?void 0:e.includes("preview")),o=e=>r(e)&&(null==e?void 0:e.includes("staging")),d=e=>r(e)&&((null==e?void 0:e.includes("alpha"))||(null==e?void 0:e.includes("beta"))),c=e=>r(e)&&(null==e?void 0:e.includes("testing")),u=e=>r(e)&&(null==e?void 0:e.includes("experimental")),m=e=>r(e)&&(null==e?void 0:e.includes("askdev")),p=e=>r(e)&&(null==e?void 0:e.startsWith("dev")),h=e=>r(e)&&((null==e?void 0:e.includes("klarna"))||(null==e?void 0:e.includes("inhouse"))||(null==e?void 0:e.includes("wolfram"))||(null==e?void 0:e.includes("ftrouter"))||(null==e?void 0:e.includes("ft"))||(null==e?void 0:e.includes("brave"))||(null==e?void 0:e.includes("claude2"))||(null==e?void 0:e.includes("claude1-instant"))||(null==e?void 0:e.includes("claude2-instant"))||(null==e?void 0:e.includes("shopping"))||(null==e?void 0:e.includes("turbo16k"))||(null==e?void 0:e.includes("yelp"))||(null==e?void 0:e.includes("mobile-flag-dev"))),v=e=>r(e)&&!n(e)&&!c(e)&&!d(e)&&!m(e)&&!p(e)&&!h(e)&&!u(e),g=e=>r(e)&&(null==e?void 0:e.includes("sandbox")),f=e=>(null==e?void 0:e.includes("quokka-gamma.ts.net"))||(null==e?void 0:e.endsWith(".preview.i.perplexity.ai")),y=e=>{let t="unknown";try{var a,r;if(void 0!==l&&(null==l?void 0:null===(a=l.env)||void 0===a?void 0:a.DD_ENV))return null==l?void 0:null===(r=l.env)||void 0===r?void 0:r.DD_ENV;if(!e)return t;if(s(e))return"local";if("www.perplexity.ai"===e)return"prod";if(e.endsWith(".preview.i.perplexity.ai"))return e.replace(/\.preview\.i\.perplexity\.ai$/,"");if(e.endsWith(".perplexity.ai"))return e.replace(/\.perplexity\.ai$/,"");return t}catch(e){return t}},x=e=>e.isTesting||e.isLocalhost||e.isSandbox||e.isDevBox||e.isPplxDev||e.isDevDeployment,b=e=>{let t={isPublicDNS:r(e),isLocalhost:s(e),isPplxDev:i(e),isPreview:n(e),isStaging:o(e),isBeta:d(e),isTesting:c(e),isAskDev:m(e),isDevBox:p(e),isNamedDevDomain:h(e),isProduction:v(e),isSandbox:g(e),isDevDeployment:f(e),deployName:y(e),envHasDevLogins:!1};return t.envHasDevLogins=x(t),t}},37813:(e,t,a)=>{"use strict";a.d(t,{As:()=>l,LN:()=>s,Lt:()=>i});let l=e=>{var t;return null!==(t=e.is_scrubbed)&&void 0!==t&&t},r=e=>!!s(e)&&l(e),s=e=>e.is_memory||e.is_conversation_history,i=e=>{let t=e.is_client_context,a=r(e);return t||a}},39266:(e,t,a)=>{"use strict";a.d(t,{k:()=>E});var l=a(85860),r=a(57023),s=a(83081),i=a(47575),n=a(83105),o=a(98188),d=a(85722),c=a(61851),u=a(4327),m=a(35458),p=a(45100),h=a(80892),v=a(38481),g=a(51244),f=a(14036),y=a(66723),x=a(26941),b=a(99390),w=a(74884),_=a(21978),M=a(3041);let C=(0,r.YK)({pro:{defaultMessage:"Perplexity Enterprise Pro Request",id:"c8Vh79Ma17"},max:{defaultMessage:"Perplexity Enterprise Max Request",id:"5x+WE7gjCk"}}),j=(0,r.YK)({pro:{defaultMessage:"Dear Admin Team,%0D%0A%0D%0AI'd like to request an upgrade to Perplexity Enterprise Pro for our team. It would give us unlimited searches with the top AI models, better research tools, and custom workspaces while ensuring data security and administrative controls.%0D%0A%0D%0ABest regards,%0D%0A[Your Name]",id:"NQKslzlMIS"},max:{defaultMessage:"Hi there,%0D%0A[requestor email] is requesting an upgrade to Perplexity Enterprise Max, our most powerful tier yet.%0D%0A%0D%0AIt would give them access to:%0D%0A• Unlimited access to Research and Labs – get comprehensive research reports, build dashboards, analyze data, and create interactive web apps–all in one place%0D%0A• Access to advanced AI models - Get in-depth answers powered by o3-pro, GPT 5 Thinking, or Opus 4.1 Thinking%0D%0A• Greater file upload limits - from 5,000 to 10,000 in your files and 500 to 5,000 in Spaces%0D%0A• Enhanced video generation - from 3 to 15 videos a month with sound powered by Veo 3%0D%0A%0D%0A[Upgrade your team member to Enterprise Max]",id:"b1ZvgOasAJ"}}),A=(0,r.YK)({pro:{defaultMessage:"Dear Admin Team,%0D%0A%0D%0AI'd like to request a downgrade to Perplexity Enterprise Pro, as I no longer require the additional functionality offered by Enterprise Max.%0D%0A%0D%0ABest regards,%0D%0A[Your Name]",id:"BcKiJLVOOh"}}),E=e=>{var t;let{origin:a,reason:r,redirectPath:E}=e,{$t:S}=(0,s.A)(),k=(0,_.rd)(),{hasAccessToProFeatures:N,isEnterprisePro:T}=(0,i.E)(),{discountCode:I}=(0,u.S)(),[R]=(0,p.L)(),{referralCode:P}=(0,m.M)(),O=(0,n.L)(),{openVisitorLoginUpsell:D}=(0,c.P)({enabled:!O}),{trackEvent:L}=(0,h.yw)(),{organization:U,orgUser:F,isAdmin:z}=(0,f.fE)({reason:r}),{subscriptionTier:B}=(0,i.E)(),{navigateToPayment:H}=(0,d.U)(),{device:{isWindowsApp:q}}=(0,x.L)(),{openModal:G}=(0,g.u)(),{session:Q}=(0,o.N)(),V=(0,l.useCallback)(async()=>{if(O){var e;if(await H({origin:a,discountCode:null!==(e=null!=I?I:R)&&void 0!==e?e:void 0,tier:"yearly",redirectPath:E}))return;L("pro checkout started",{subscriptionTier:"pro",origin:a,discountCode:null!=I?I:"",referralCode:null!=P?P:"",tier:"yearly",flowType:"stripe_checkout"});let t=await (0,v.fw)({request:{tier:"yearly",referralCode:N?"":P,discountCode:N?"":I,origin:a,locale:(0,w.t)(),subscriptionTier:"pro"},reason:r});(null==t?void 0:t.url)?(0,b.x)(t.url,"Handle click pricing yearly checkout started"):k.refresh("Handle click annual")}else D({title:S({defaultMessage:"Sign in to unlock {pro}",id:"HsM7RilrD6"},{pro:"Pro"}),origin:a})},[O,H,a,I,L,P,N,k,D,S,R,r,E]),K=(0,l.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pro";if(O){var t;if(await H({origin:a,discountCode:null!==(t=null!=I?I:R)&&void 0!==t?t:void 0,tier:"monthly",referralCode:null!=P?P:void 0,subscriptionTier:e,redirectPath:E}))return;L("pro checkout started",{subscriptionTier:e,origin:a,discountCode:null!=I?I:"",referralCode:null!=P?P:"",tier:"monthly",flowType:"stripe_checkout"});let l=await (0,v.fw)({request:{tier:"monthly",referralCode:N?"":P,discountCode:N?"":I,origin:a,locale:(0,w.t)(),subscriptionTier:e},reason:r});(null==l?void 0:l.url)?(0,b.x)(l.url,"Handle click pricing monthly checkout started"):k.refresh("Handle click monthly")}else D({title:S({defaultMessage:"Sign in to unlock {tier}",id:"8E/VXpzNhf"},{tier:"max"===e?"Max":"Pro"}),origin:a})},[O,H,a,I,P,L,N,k,D,S,R,r,E]),W=(0,l.useCallback)(e=>{var t;let a=null==F?void 0:F.uuid,l=null==F?void 0:F.email,r=null==Q?void 0:null===(t=Q.user)||void 0===t?void 0:t.subscription_tier,s=(0,y.ce)(e);if(!a||!l||!r||!(0,y.SI)(r)){M.vF.error("Failed to open tier upgrade modal",{userId:a,from:r,tier:e});return}setTimeout(()=>{G("memberSetTierModal",{userId:a,email:l,from:r,to:s})},10)},[G,null==F?void 0:F.uuid,null==F?void 0:F.email,null==Q?void 0:null===(t=Q.user)||void 0===t?void 0:t.subscription_tier]),Y=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"enterprise_pro";if(F&&U){if(z){T?W(e):q?(0,b.x)("https://www.perplexity.ai/onboarding/onboarding-org-subscription?tier=".concat(e),"Handle click enterprise WindowsApp"):k.push("/onboarding/onboarding-org-subscription?tier=".concat(e));return}{let t=(0,y.ce)(e),l=function(e){var t;let{toTier:a,fromTier:l,organization:r,$t:s}=e,i=null==r?void 0:null===(t=r.admins)||void 0===t?void 0:t.map(e=>null==e?void 0:e.email).filter(e=>void 0!==e).join(";"),n=s(C[a]),o=function(e){let{toTier:t,fromTier:a,$t:l}=e;return l("pro"===t&&"max"===a?A.pro:j[t])}({toTier:a,fromTier:l,$t:s});return"mailto:".concat(i,"?subject=").concat(n,"&body=").concat(o)}({toTier:t,fromTier:B,organization:U,$t:S});L("enterprise email request generated",{toTier:t,fromTier:B,origin:a}),(0,b.x)(l,"Handle click enterprise")}}else L("enterprise pro onboarding started",{origin:a}),q?(0,b.x)("https://www.perplexity.ai/onboarding/org/create?tier=".concat(e),"Handle click enterprise WindowsApp"):k.push("/onboarding/org/create?tier=".concat(e))},[F,z,q,k,W,U,S,L,a,T,B]);return(0,l.useMemo)(()=>({handleClickMonthly:K,handleClickEnterprise:Y,handleClickAnnual:V}),[V,Y,K])}},40027:(e,t,a)=>{"use strict";a.d(t,{A:()=>_});var l=a(25576),r=a(85860),s=a(95254),i=a(64299),n=a.n(i),o=a(12839),d=a(60410),c=a(28554),u=a(26085),m=a(22895),p=a(20041),h=a(65651),v=a(51437),g=a(43627),f=a(18360),y=a(31049);let x=(0,a(27773).w)({path:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0 M12 3v18 M12 14l7 -7 M12 19l8.5 -8.5 M12 9l4.5 -4.5",name:"IconCircleHalf2",variant:"stroked"});var b=a(12422),w=a(49427);let _=r.memo(e=>{let{wrapperClassName:t,variant:a="default",size:i="default",errorText:_,className:M,value:C,maxLength:j,errorMessage:A,disabled:E=!1,hasShadow:S=!1,autoFocus:k=!1,placeholder:N="",rightItems:T=f.Ml,onChange:I,onClear:R,onClick:P,onBlur:O,onFocus:D,onKeyDown:L,onPaste:U,isLoading:F,inlineEditBlock:z,label:B,subtitle:H,isOptional:q,minRows:G,isMobileUserAgent:Q,allowEnterNewlines:V=!1,testId:K,textAreaClassname:W,ref:Y}=e,X=(0,v.Z)(E),Z=(0,r.useRef)(null),[J,$]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(!1),ea=(0,r.useRef)(J);ea.current=J,(0,r.useEffect)(()=>{if(!Q&&k){var e;null===(e=Z.current)||void 0===e||e.focus()}},[Q,Z,k]),(0,r.useEffect)(()=>{X===E||E||Q||!k||setTimeout(()=>{var e;null===(e=Z.current)||void 0===e||e.focus()},200)});let el=(0,r.useMemo)(()=>n()({"border-r mr-sm pr-xs border-subtler":0!=T.length}),[T.length]),er=n()("overflow-auto max-h-[50vh] outline-none w-full flex items-center","text-foreground font-sans resize-none","bg-transparent placeholder-quieter","caret-super selection:bg-super/50 dark:selection:bg-super/10 dark:selection:text-super",W),es=(0,r.useMemo)(()=>{let e=(()=>{switch(a){case"subtle":return"bg-subtle";case"default":return"bg-base dark:bg-subtler";default:(0,y.s)(a)}})(),t=n()("w-full focus:ring-subtler flex items-center",e,"border border-subtler  focus:ring-1 rounded-md","duration-200 transition-all",{"ring-subtler ring-1":J,"shadow-sm":S},M),l=n()({"py-sm text-sm px-md":"default"===i,"text-base p-md pb-xl":"large"===i}),r=n()({"pr-md":0===T.length});return n()(t,l,r)},[J,S,M,i,T.length,a]),ei=void 0!==A,en=!ei&&!!j&&!!C&&C.length>j,eo=(0,r.useMemo)(()=>(0,l.jsxs)("div",{className:"right-sm gap-sm mb-xs pb-xs absolute bottom-0 flex items-center rounded-full",children:[F?(0,l.jsx)(d.A,{color:"light",children:(0,l.jsx)(w.e,{icon:x,className:"aspect-square animate-spin"})}):null,ei&&(0,l.jsx)(o.Ay,{className:"mr-sm",children:(0,l.jsx)(d.A,{color:"red",variant:"tiny",children:A})}),en&&(0,l.jsx)(o.Ay,{className:"mr-sm",children:j&&C&&(0,l.jsx)(d.A,{color:"red",variant:"tiny",children:j-C.length})}),void(0,l.jsx)("div",{className:el,children:(0,l.jsx)(u.A,{icon:b.M,pill:!0,onClick:R,size:g.or.small})})!==R,T.map((e,t)=>"toggleButton"==e.type?(0,l.jsx)(h.d,{...e.buttonProps,disabled:!e.buttonProps.disableOverride&&(e.buttonProps.disabled||ei||en)},t):(0,l.jsx)(c.A,{...e.buttonProps,size:g.or.small,disabled:e.buttonProps.disabled||ei||en,pill:!0},t))]}),[A,F,j,R,T,C,el,ei,en]),ed=(0,r.useCallback)(()=>{if(Z.current){let e=Z.current.value.length;Z.current.focus(),Z.current.setSelectionRange(e,e)}},[]),ec=(0,r.useCallback)(e=>{if(!(null==Z?void 0:Z.current))return!0;let t=Z.current,{selectionStart:a,selectionEnd:l,value:r}=t;if(a!==l)return!1;let s=document.createElement("div"),i=window.getComputedStyle(t);s.style.position="absolute",s.style.visibility="hidden",s.style.whiteSpace=i.whiteSpace,s.style.wordWrap=i.wordWrap,s.style.font=i.font,s.style.padding=i.padding,s.style.border=i.border,s.style.width=t.offsetWidth+"px",s.style.lineHeight=i.lineHeight,document.body.appendChild(s);try{let t=parseInt(i.lineHeight)||24,l=r.substring(0,a);s.textContent=l;let n=s.offsetHeight;if("first"===e)return n<=t;return s.textContent=r,s.offsetHeight-n<t}finally{document.body.removeChild(s)}},[]),eu=(0,r.useCallback)(e=>{null==D||D(e.nativeEvent),$(!0)},[D]),em=(0,r.useCallback)(e=>{null==O||O(e.nativeEvent),$(!1)},[O]),ep=(0,r.useCallback)(e=>{null==P||P(e.nativeEvent)},[P]),eh=(0,r.useCallback)(e=>{null==I||I(e.target.value)},[I]),ev=(0,r.useCallback)(e=>{(0,p.h$)(e.nativeEvent,{isMobileUserAgent:Q,isComposing:ee,allowEnterNewlines:V,onKeyDown:L})},[L,ee,Q,V]),eg=(0,r.useCallback)(()=>(0,p.Ji)(et),[et]),ef=(0,r.useCallback)(()=>(0,p.iu)(et),[et]),ey=(0,r.useCallback)(e=>{null==U||U(e.nativeEvent)},[U]);return(0,r.useImperativeHandle)(Y,()=>{let e=Z.current;return e.focusAtEnd=ed,e.inLine=ec,e.isFocused=()=>ea.current,e.append=e=>{Z.current&&(Z.current.value+=e)},e.scrollToEnd=()=>{Z.current&&(Z.current.scrollTop=Z.current.scrollHeight)},e.trim=()=>{Z.current&&(Z.current.value=Z.current.value.trim())},e},[ed,ec]),(0,r.useEffect)(()=>{k&&!Q&&ed()},[k,ed,Q]),(0,l.jsxs)("div",{"data-test-id":K,children:[(0,l.jsx)(m.n,{label:B,subtitle:H,isOptional:q,errorText:_}),(0,l.jsx)("div",{className:n()("rounded-3xl",t),children:(0,l.jsxs)("div",{className:"relative flex items-center",children:[(0,l.jsx)("div",{className:es,children:(0,l.jsx)(s.A,{ref:Z,autoFocus:k,placeholder:N,disabled:E,minRows:G,value:C,onClick:ep,onChange:eh,name:B,onKeyDown:ev,onBlur:em,onCompositionStart:eg,onCompositionEnd:ef,onFocus:eu,onPaste:ey,className:er,autoComplete:"off","data-testid":K})}),(0,l.jsx)("div",{className:"absolute bottom-0 m-px flex justify-between rounded-b-md px-[6px]",style:{width:"calc(100% - 2px)"},children:eo})]})}),z&&(0,l.jsx)("div",{className:"mt-sm flex justify-end",children:z})]})})},40578:(e,t,a)=>{"use strict";a.d(t,{k:()=>l});let l=(0,a(27773).w)({path:"M7 13v-8a1 1 0 0 0 -1 -1h-2a1 1 0 0 0 -1 1v7a1 1 0 0 0 1 1h3a4 4 0 0 1 4 4v1a2 2 0 0 0 4 0v-5h3a2 2 0 0 0 2 -2l-1 -5a2 3 0 0 0 -2 -2h-7a3 3 0 0 0 -3 3",name:"IconThumbDown",variant:"stroked"})},40993:(e,t,a)=>{"use strict";a.d(t,{P:()=>d});var l=a(25576);a(85860);var r=a(64299),s=a.n(r),i=a(60410),n=a(70919),o=a(49427);let d=(e,t)=>{var a,r,d,c,u,m;let p=null!==(a=null==t?void 0:t.isOverlapping)&&void 0!==a&&a,h=null!==(r=null==t?void 0:t.stackDirection)&&void 0!==r?r:"left";if(!e.length)return(0,l.jsx)(o.e,{icon:n._,size:"sm"});let v=Math.max(1,null!==(d=null==t?void 0:t.maxVisuals)&&void 0!==d?d:3),g=e=>{if(p&&!e)switch(null==t?void 0:t.size){case"sm":return"-0.25rem";case"md":return"-0.375rem";case"lg":return"-0.5rem";case"xl":return"-0.625rem";default:return}},f=()=>{var a;let l=s()("relative flex items-center justify-center",{"rounded-full":(null==t?void 0:t.shape)==="circle"||!(null==t?void 0:t.shape),"rounded-none":(null==t?void 0:t.shape)==="square","size-4":(null==t?void 0:t.size)==="sm","size-5":(null==t?void 0:t.size)==="md","size-6":(null==t?void 0:t.size)==="lg","size-7":(null==t?void 0:t.size)==="xl"});return p&&e&&!(e.length<=1)?s()(l,null!==(a=null==t?void 0:t.overlappingClassName)&&void 0!==a?a:"bg-base ring-subtlest",{"ring-1":(null==t?void 0:t.size)==="sm"||(null==t?void 0:t.size)==="md","ring-2":(null==t?void 0:t.size)==="lg"||(null==t?void 0:t.size)==="xl"}):l},y=(null===(c=null==t?void 0:t.showRemainderCount)||void 0===c||c)&&e.length>v,x=1===v&&e.length>1&&y?0:y?v-1:Math.min(v,e.length),b=e.slice(0,x).map((t,a)=>(0,l.jsx)("div",{className:f(),style:{zIndex:"left"===h?e.length-a-1:e.length+a,marginLeft:g(0===a)},children:t},a));return(0,l.jsxs)("div",{className:s()("isolate",null!==(u=null==t?void 0:t.containerClass)&&void 0!==u?u:"my-xs flex items-center"),children:[(0,l.jsxs)("div",{className:null!==(m=null==t?void 0:t.innerClassName)&&void 0!==m?m:s()("flex items-center",{"gap-2":!p}),children:[b,y&&(0,l.jsx)("div",{className:s()(f(),{"mx-1":0===x}),style:{zIndex:"left"===h?-1:e.length+v,marginLeft:g(0===x)},children:(0,l.jsxs)(i.A,{variant:"tinyMono",color:"light",inline:!0,children:["+",e.length-x]})})]}),(null==t?void 0:t.rightText)&&(0,l.jsx)("div",{className:"ml-2",children:t.rightText})]})}},41290:(e,t,a)=>{"use strict";a.d(t,{Q:()=>p});var l=a(25576),r=a(85860),s=a(33061),i=a(50698),n=a(3041);let o={},d="lastCriticalImportFailure",c=()=>null,u=Promise.resolve(),m=new Map;function p(e){var t,a;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,d=null!==(t=i.loading)&&void 0!==t?t:c,p="undefined"!=typeof navigator&&navigator.userAgent.includes("Mobile")&&!navigator.userAgent.includes("iPad"),h="undefined"!=typeof navigator&&"serviceWorker"in navigator&&!!navigator.serviceWorker.controller,f="localhost"===window.location.hostname,y=null!==(a=i.prefetch)&&void 0!==a?a:!h&&!p&&!f,x=async()=>{let t=0;for(;t<=2;)try{let t=await e();m.set(e,t.default);break}catch(e){if(2===t){if(!navigator.onLine)break;let t=Error(e instanceof Error?e.message:"Dynamic import failed");t.name="ReactRenderingError",t.cause=e,i.restricted?n.vF.debug(t):n.vF.error(t),i.critical&&(g()||v()&&(n.vF.warn("Reloading window",{reason:"critical import failure",url:window.location.href}),window.location.reload()));break}await new Promise(e=>setTimeout(e,500*Math.pow(2,t))),t++}};return y&&!m.has(e)&&navigator.onLine&&(u=u.then(()=>x())),function(t){let[,a]=(0,r.useState)(!1),n=(0,r.useRef)(!1);(0,r.useEffect)(()=>{!n.current&&(m.has(e)&&(i.nextFrame?setTimeout(()=>(0,s.flushSync)(()=>a(e=>!e))):(0,s.flushSync)(()=>a(e=>!e))),x().then(()=>{i.nextFrame?setTimeout(()=>(0,s.flushSync)(()=>a(e=>!e))):(0,s.flushSync)(()=>a(e=>!e))}))},[]);let o=m.get(e);return(n.current=!!o,o)?(0,l.jsx)(o,{...t}):(0,l.jsx)(d,{})}}let h=()=>{let e=i.U.getItem(d);return e?new Date(Number.parseInt(e,10)):new Date},v=()=>i.U.setItem(d,Date.now().toString()),g=()=>{let e=h();return!isNaN(e.getTime())&&e.getTime()>Date.now()-15e3}},41561:(e,t,a)=>{"use strict";a.d(t,{h:()=>l});let l=(0,a(27773).w)({path:"M7 4v16l13 -8z",name:"IconPlayerPlay",variant:"stroked"})},41697:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});let l=(0,a(27773).w)({path:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0 M6 21v-2a4 4 0 0 1 4 -4h1.5 M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0 M20.2 20.2l1.8 1.8",name:"IconUserSearch",variant:"stroked"})},42826:(e,t,a)=>{"use strict";a.d(t,{Hh:()=>l,Ox:()=>s,d8:()=>r});let l=["list_user_collections",{}],r="list_collection_threads",s="__temp__"},44111:(e,t,a)=>{"use strict";a(95317),a(61505),a(81685),a(91487),a(61263),a(68109)},45100:(e,t,a)=>{"use strict";a.d(t,{L:()=>r});var l=a(65917);let r=()=>(0,l.Mj)("pplx.persistent_promo_code",null)},46304:(e,t,a)=>{"use strict";a.d(t,{U:()=>o});var l=a(85860),r=a(15492),s=a(87475),i=a(17760),n=a(30002);let o=e=>{let{collectionSlug:t,reason:a,enabled:o=!!t}=e,d=async()=>{if(!t)return null;let e=await (0,i.X_)({params:{collection_slug:t,version:n.mj6},reason:a});return null!=e?e:null},{data:c,isLoading:u}=(0,r.useQuery)({enabled:o,queryKey:["get_collection",{collection_slug:null==t?void 0:t.slice(-22)}],queryFn:d,placeholderData:s.rX});return(0,l.useMemo)(()=>({collection:null!=c?c:void 0,isLoading:u}),[c,u])}},46418:(e,t,a)=>{"use strict";a.d(t,{n:()=>o});var l=a(85860),r=a(80892),s=a(21978);let i="clicked enterprise ad",n="https://www.perplexity.ai/enterprise",o=()=>{let{trackEvent:e}=(0,r.yw)(),t=(0,s.rd)(),a=(0,l.useCallback)(async a=>{null==a||a.preventDefault(),e(i,{source:"settingsHeader"}),t.push(n)},[e,t]),o=(0,l.useCallback)(async a=>{a.preventDefault(),e(i,{source:"pricingTable"}),t.push(n)},[e,t]),d=(0,l.useCallback)(async a=>{a.preventDefault(),e(i,{source:"paywall"}),t.push(n)},[e,t]),c=(0,l.useCallback)(t=>{let{orgName:a,success:l}=t;e("org created",{orgName:a,success:l})},[e]),u=(0,l.useCallback)(t=>{let{invitedEmail:a,source:l,orgUUID:r,inviteType:s}=t;e("org user invited",{invitedEmail:a,source:l,orgUUID:r,inviteType:s})},[e]),m=(0,l.useCallback)(t=>{let{invitedEmails:a,inviteCount:l,successCount:r,failureCount:s,source:i,orgUUID:n,inviteType:o}=t;e("org users bulk invited",{invitedEmails:a,inviteCount:l,successCount:r,failureCount:s,source:i,orgUUID:n,inviteType:o})},[e]),p=(0,l.useCallback)(t=>{let{orgUUID:a}=t;e("org invite step completed",{orgUUID:a})},[e]),h=(0,l.useCallback)(t=>{let{orgUUID:a,source:l,intent:r,success:s}=t;return e("org payment portal entered",{orgUUID:a,source:l,intent:r,success:s})},[e]),v=(0,l.useCallback)(t=>{let{orgUUID:a,success:l}=t;e("sso enabled",{orgUUID:a,success:l})},[e]);return(0,l.useMemo)(()=>({handleSettingsHeaderAdClick:a,handlePricingTableAdClick:o,handlePaywallAdClick:d,trackOrgCreated:c,trackOrgUserInvited:u,trackOrgUsersBulkInvited:m,trackOrgInviteStepCompleted:p,trackOrgPaymentPortalEntered:h,trackSSOEnabled:v}),[d,o,a,c,p,h,u,m,v])}},46640:(e,t,a)=>{"use strict";a.d(t,{c:()=>l});let l=(0,a(27773).w)({path:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0 M5.65 5.65l12.7 12.7 M5.65 18.35l12.7 -12.7 M12 3a9 9 0 0 0 9 9 M3 12a9 9 0 0 1 9 9",name:"IconBallBasketball",variant:"stroked"})},46708:(e,t,a)=>{"use strict";a.d(t,{Ap:()=>y,Iv:()=>f,Xf:()=>g});var l=a(85860),r=a(83081),s=a(46972),i=a(14036),n=a(26941),o=a(43627),d=a(3694),c=a(94749),u=a(30950),m=a(3541),p=a(87569);let h=(0,a(27773).w)({path:"M13 4v4c-6.575 1.028 -9.02 6.788 -10 12c-.037 .206 5.384 -5.962 10 -6v4l8 -7l-8 -7z",name:"IconShare3",variant:"stroked"});var v=a(81467);let g=e=>{var t,a,g,f,y,x;let{currentAccessLevel:b,onClick:w,isCollection:_,isPage:M,spaceIsOrgPinned:C=!1,addOrgPinnedSpace:j,deleteOrgPinnedSpace:A,reason:E,hideLabels:S=!1,isCollectionOwner:k=!1}=e,{$t:N}=(0,r.A)(),T=(0,r.A)(),{device:{isIOS:I,isAndroid:R}}=(0,n.L)(),{isEnterprise:P,organization:O}=(0,i.fE)({reason:E}),{firstResult:{collection_info:D,sources:{sources:L}={}}={}}=(0,s.E)(),U=_?null===(f=null==O?void 0:null===(t=O.settings)||void 0===t?void 0:t.public_collection_sharing_allowed)||void 0===f||f:M?null===(y=null==O?void 0:null===(a=O.settings)||void 0===a?void 0:a.public_page_sharing_allowed)||void 0===y||y:null===(x=null==O?void 0:null===(g=O.settings)||void 0===g?void 0:g.public_thread_sharing_allowed)||void 0===x||x,F=null==L?void 0:L.includes(d.kL.factset),z=(0,l.useMemo)(()=>_&&k?[{label:T.formatMessage({defaultMessage:"Share via link",id:"oJFaPCNcIw"}),text:T.formatMessage({defaultMessage:"Link share",id:"5CBpesC8V9"}),onClick:()=>null==A?void 0:A(),active:!C},{label:T.formatMessage({defaultMessage:"Pinned for everyone in org",id:"BCLJqQMHbj"}),text:T.formatMessage({defaultMessage:"Pinned",id:"fWZYP5U4xZ"}),onClick:()=>null==j?void 0:j(),active:C}]:void 0,[j,A,T,_,k,C]),B=(0,l.useMemo)(()=>[{label:S?void 0:"",text:N({defaultMessage:"Owner Only",id:"RUPRkBML7X"}),icon:m.X,show:!1,accessLevel:o.hx.OWNER_ONLY},{label:S?void 0:N({defaultMessage:"Only the author can view",id:"ZKx/MMPXAk"}),text:_?N({defaultMessage:"Only invited members",id:"mm5vL8ueCo"}):N({defaultMessage:"Private",id:"viXE3205/2"}),icon:m.X,show:!M,onClick:()=>w(o.hx.PRIVATE_READ),active:b===o.hx.PRIVATE_READ,accessLevel:o.hx.PRIVATE_READ,testId:"access-level-private"},{label:S?void 0:N({defaultMessage:"Anyone in your Space can view",id:"8i8H9TisQU"}),text:N({defaultMessage:"Space",id:"0ah2udCSKF"}),icon:c.M,onClick:()=>w(o.hx.COLLECTION_READ),active:b===o.hx.COLLECTION_READ,show:!_&&!M&&!!(null==D?void 0:D.uuid),accessLevel:o.hx.COLLECTION_READ,testId:"access-level-space"},{label:S?void 0:N({defaultMessage:"Anyone in your organization can view",id:"T2yBpbP3mu"}),text:N({defaultMessage:"Anyone in my org with the link",id:"ah50gEdYbM"}),icon:u.A,onClick:()=>w(o.hx.ORG_READ),active:b===o.hx.ORG_READ,show:P&&(!M||U),accessLevel:o.hx.ORG_READ,testId:"access-level-org",subMenu:z},{label:S?void 0:N({defaultMessage:"Anyone with the link",id:"KL1VgUyLuG"}),text:N({defaultMessage:"Anyone with the link",id:"KL1VgUyLuG"}),icon:I?v.n:R?p.V:h,onClick:()=>w(o.hx.PUBLIC_READ),active:b===o.hx.PUBLIC_READ,show:U&&!F,accessLevel:o.hx.PUBLIC_READ,testId:"access-level-public"}],[N,null==D?void 0:D.uuid,b,F,S,R,_,P,I,M,w,U,z]),H=B.find(e=>e.accessLevel===b)||null;return(0,l.useMemo)(()=>({accessLevelMenuItems:B,selectedAccessMenuItem:H}),[B,H])},f=e=>!!e&&[o.hx.PUBLIC_READ,o.hx.PUBLIC_PUBLISHED,o.hx.ORG_READ,o.hx.COLLECTION_READ].includes(e),y=e=>{switch(e){case o.hx.PUBLIC_READ:case o.hx.PUBLIC_PUBLISHED:return"public";case o.hx.ORG_READ:return"organization";case o.hx.COLLECTION_READ:return"collection";case o.hx.PRIVATE_READ:case o.hx.OWNER_ONLY:default:return"private"}}},46884:(e,t,a)=>{"use strict";a.d(t,{j:()=>p});var l=a(25576),r=a(85860),s=a(70714),i=a(64299),n=a.n(i),o=a(60410),d=a(1407),c=a(75546),u=a(41697),m=a(49427);let p=r.memo(e=>{let{variant:t="medium",searchType:a}=e,r="memory"===a,i=n()("flex items-center justify-between w-full","small"===t?"mb-0":"mb-2");return(0,l.jsxs)("div",{className:i,children:[(0,l.jsxs)(o.A,{className:"flex items-center gap-2",variant:"tiny",color:"light",children:[(0,l.jsx)(m.e,{icon:r?d.b:c.q,size:"sm"}),r?(0,l.jsx)(s.A,{defaultMessage:"Memory",id:"dVx3yznM2C"}):(0,l.jsx)(s.A,{defaultMessage:"Library",id:"StcK672jB9"})]}),(0,l.jsx)(o.A,{variant:"tiny",color:"ultraLight",children:(0,l.jsx)(m.e,{icon:u.p,size:"sm"})})]})});p.displayName="MemorySearchCitationCardTitle"},46972:(e,t,a)=>{"use strict";a.d(t,{Dm:()=>u,E:()=>g,Oc:()=>y,Wz:()=>c,aw:()=>d,sN:()=>f}),a(25576);var l=a(85860),r=a(15492),s=a(5826),i=a(18360);a(7685);var n=a(53220),o=a(96983);let d=e=>{var t,a,l,r,n,o,d;return e?{author_id:(0,s.r1)(e),author_image:(0,s.T7)(e),author_username:(0,s.gh)(e),bookmarkState:(0,s.KW)(e),collection:(0,s.VH)(e),contextUUID:(0,s.Tr)(e),expiry_time:null!==(t=(0,s.pG)(e))&&void 0!==t?t:void 0,first_query:(0,s.F2)(e),focus:(0,s.X3)(e),frontendContextUUID:(0,s.Pf)(e),mode:null!==(a=(0,s._Y)(e))&&void 0!==a?a:void 0,parent_info:null!==(l=(0,s.V$)(e))&&void 0!==l?l:void 0,personalized:null!==(r=(0,s.Dz)(e))&&void 0!==r?r:void 0,privacy_state:null!==(n=(0,s.Cx)(e))&&void 0!==n?n:void 0,rwToken:(0,s.dg)({backend_uuid:e.backend_uuid,read_write_token:e.read_write_token,context_uuid:e.context_uuid}),sources:null!==(o=(0,s.nk)(e))&&void 0!==o?o:void 0,text_completed:!1,thread_access:null!==(d=(0,s.ZA)(e))&&void 0!==d?d:void 0,thread_url_slug:(0,s.N6)(e),title:(0,s.L0)(e),updated_datetime:(0,s.nY)(e)}:i.t0},c=e=>{var t,a,l,r;return{forkCount:null!==(t=null==e?void 0:e.fork_count)&&void 0!==t?t:0,likeCount:null!==(a=null==e?void 0:e.like_count)&&void 0!==a?a:0,viewCount:null!==(l=null==e?void 0:e.view_count)&&void 0!==l?l:0,userLikes:null!==(r=null==e?void 0:e.user_likes)&&void 0!==r&&r}},u={fork_count:0,like_count:0,view_count:0,user_likes:!1},{Context:m,useStore:p,useSelector:h,useTrackedState:v}=(0,o.PH)("ResultsContext"),g=v,f=e=>(0,r.useQuery)({queryKey:["navigationResults",e],queryFn:()=>Promise.resolve({}),enabled:!1}),y=()=>{let e=p(),t=(0,n.Us)();return(0,l.useCallback)(a=>{t(e.getState().currentThreadId,a)},[t,e])}},47167:(e,t,a)=>{"use strict";a.d(t,{RN:()=>u,gP:()=>d,il:()=>c,pI:()=>m,q0:()=>l,u9:()=>o,uJ:()=>n});var l,r=a(77150),s=a(77917),i=a(3041);!function(e){e.SPRING_2025="SPRING_2025",e.GIVE_1_MONTH_FREE="GIVE_1MO_GET_1MO"}(l||(l={}));let n={EMAIL_ALREADY_REGISTERED:"Promo not valid for existing users",INVALID_REFERRAL_CODE:"Invalid referral code",UNKNOWN:"An unknown error occurred",EMAIL_RATE_LIMIT_EXCEEDED:"Too many emails sent to this address"},o=async e=>{let{email:t,reason:a}=e;try{let{data:e,error:l}=await s.By.GET("/rest/referrals/validate-email",a,{params:{query:{email:t}},timeoutMs:(0,s.e4)()});if(l)throw new r.T("API_CLIENTS_ERROR",{message:"Failed to validate referral email",cause:l});return{valid:e.is_valid,error:!1}}catch(e){return i.vF.error(e),{valid:!1,error:!0}}},d=async e=>{let{referralCode:t,reason:a}=e;try{let{data:e,error:l}=await s.By.GET("/rest/referrals/get-user-from-referral-code",a,{params:{query:{referral_code:t}}});if(l)throw Error("Failed to get user from referral code");return e}catch(e){return i.vF.error("Failed to get user from referral code",e),{email:null,is_student:null,is_active:!1}}},c=async e=>{let{toEmail:t,referralType:a,reason:l}=e;try{let{error:e}=await s.By.POST("/rest/referrals/send-referral-email",l,{body:{to_email:t,referral_type:a},timeoutMs:8e4});if(e){var r,o;return{success:!1,error:(null===(o=e.detail)||void 0===o?void 0:null===(r=o[0])||void 0===r?void 0:r.msg)||e.detail}}return{success:!0,error:null}}catch(e){return i.vF.error("Failed to send referral email",e),{success:!1,error:n.UNKNOWN}}},u=async e=>{let{headers:t,email:a,reason:l}=e,{data:r,error:i}=await s.By.GET("/rest/referrals/",l,{headers:t,params:{query:{email:a}}});if(i)throw Error("Failed to get user referral status");return r},m=async e=>{let{verificationId:t,reason:a}=e;try{if(!t)throw Error("Verification ID is required");let{data:e,error:l}=await s.By.GET("/rest/referrals/student-reward-details",a,{params:{query:{verification_id:t}},timeoutMs:(0,s.e4)()});if(l)throw Error("Failed to get student reward details");return e}catch(e){return i.vF.error("Failed to get student reward details",e),{months_awarded:1,reward_type:"default",organization:null,country_label:null}}}},49126:(e,t,a)=>{"use strict";a.d(t,{G:()=>l});let l=(0,a(27773).w)({path:"M4 8h16 M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z M8 4v4",name:"IconBrowser",variant:"stroked"})},49303:(e,t,a)=>{"use strict";let l;a.d(t,{default:()=>eI});var r=a(25576),s=a(85860),i=a(95641),n=a(83105),o=a(98188),d=a(63447),c=a(91866),u=a(41290),m=a(62615);let p=(0,u.Q)(async()=>{let{Analytics:e}=await a.e(5712).then(a.bind(a,15712));return{default:e}},{prefetch:!1}),h=()=>{let e=(0,m.ok)(),t=(0,n.L)(),{session:a}=(0,o.N)(),l=(0,s.useRef)(!1);return(0,s.useEffect)(()=>{let r=e.get("dub_id");if(r&&((0,c.TV)("dub_id",r,{expires:90}),t&&!l.current)){var s,i;l.current=!0,(0,d.P3)({eventName:"activated",isDeferred:!0,clickId:r,nextauthUserId:null!==(i=null==a?void 0:null===(s=a.user)||void 0===s?void 0:s.id)&&void 0!==i?i:null,reason:"logged in lead"})}},[e,t,a]),(0,r.jsx)(p,{domainsConfig:{refer:"pplx.ai"},cookieOptions:{expiresInDays:90}})};var v=a(34469),g=a(77917),f=a(36206),y=a(92988),x=a(26941),b=a(30002),w=a(16079),_=a(3041);async function M(e){let t=new TextEncoder().encode(e);return await crypto.subtle.digest("SHA-256",t)}async function C(e){return Array.from(new Uint8Array(await M(e))).map(e=>e.toString(16).padStart(2,"0")).join("")}let j=async e=>{let{reason:t}=e;try{let{data:e,error:a}=await g.By.POST("/rest/attribution/comet/session",t,{timeoutMs:(0,g.e4)(),numRetries:1});if(a)throw a;return{success:e.success}}catch(e){return _.vF.error("Failed to start Comet session",e),{success:!1}}},A=async e=>{let{eventName:t,reason:a}=e;try{var l;let{data:e,error:r}=await g.By.POST("/rest/attribution/comet/event/{event_name}",a,{timeoutMs:(0,g.e4)(),params:{path:{event_name:t}}});if(r)throw r;return{success:null!==(l=null==e?void 0:e.success)&&void 0!==l&&l}}catch(e){return _.vF.error("Failed to send Comet event",e),{success:!1}}},E=(0,y.j)("SingularAttributionContext",{sendQueryEventSingular:()=>Promise.resolve(),maybeSendNthQueryEventSingular:()=>Promise.resolve(),sendSubscribedEventSingular:()=>Promise.resolve(),sendSubscribedPayingEventSingular:()=>Promise.resolve(),sendAppDownloadClickedEventSingular:()=>Promise.resolve(),sendResurrectedActivationEventSingular:()=>Promise.resolve(),sendCometDownloadPageLoadEventSingular:()=>Promise.resolve(),sendCometDownloadPageSignInEventSingular:()=>Promise.resolve(),sendCometDownloadedEventSingular:()=>Promise.resolve(),sendCometDownloadButtonClickedEventSingular:()=>Promise.resolve(),sendCometWaitlistButtonClickedEventSingular:()=>Promise.resolve(),sendCometDownloadLinkEmailEventSingular:()=>Promise.resolve(),sendSubscribedMaxEventSingular:()=>Promise.resolve()}),S={1:"activated",3:"true activated",5:"quality activated",10:"super activated"},k={1:"first comet query",3:"third comet query"},N=async(e,t)=>{if(!e)return null;let a=new Date;a.setMilliseconds(0);let l="".concat(e,"-").concat(a.toISOString(),"-").concat(t);return await C(l)},T=async e=>{let{productId:t,visitorId:l,userId:r}=e,{SingularConfig:s,singularSdk:i}=await a.e(1520).then(a.t.bind(a,51520,19)),n=new s("perplexity_ai_039eb8fb","1e0179ca95965b57a3e91c1cf3049b64",t);r&&n.withCustomUserId(r),i.init(n);let o="initialized singular",d=await N(l,o);return i.event(o,{visitorId:l,eventId:d}),i},I=e=>{var t,a,l;let{children:i}=e,{session:n}=(0,o.N)(),d=(0,c.Ri)(v.nK),{env:{isProduction:u,isStaging:p},device:{isMobile:h}}=(0,x.L)(),g=(0,s.useRef)([]),y=(0,s.useRef)([]),_=(0,m.ok)(),[M,C]=(0,s.useState)(void 0);(0,s.useEffect)(()=>{var e;let t=null==n?void 0:null===(e=n.user)||void 0===e?void 0:e.id,a=u||p?"ai.perplexity":"ai.testing.perplexity";d&&T({userId:t,productId:a,visitorId:d}).then(e=>{if(e)C({sdk:e}),t&&(0,f.bf)()&&((0,w.ot)()>1||j({reason:"comet attribution"}))})},[u,p,null==n?void 0:null===(t=n.user)||void 0===t?void 0:t.id,d]);let I=(0,s.useCallback)(async(e,t)=>{if(!M){g.current.push({name:e,extraArguments:t});return}if(!d)return;let a=await N(d,e),l={...t,visitorId:d,eventId:a,isMobile:h};y.current.includes(e)||(M.sdk.event(e,l),y.current.push(e))},[M,d,h]),R=(0,s.useCallback)(async e=>{let{isCometBrowser:t}=e,a=(0,w.ri)(),l=(0,w.ot)(),r=(0,w.Fw)();a&&S[a]&&await I(S[a]),l&&k[l]&&await I(k[l]),t&&1===r&&A({eventName:"activated",reason:"comet attribution"})},[I]),P=(0,s.useCallback)(async e=>{var t;await I("user sign in",{isNewUser:e}),(null==n?void 0:null===(t=n.user)||void 0===t?void 0:t.id)&&M&&M.sdk.login(n.user.id)},[null==n?void 0:null===(a=n.user)||void 0===a?void 0:a.id,M,I]);return(0,s.useEffect)(()=>{M&&g.current.length>0&&(g.current.filter((e,t,a)=>t===a.findIndex(t=>t.name===e.name)).forEach(e=>{let{name:t,extraArguments:a}=e;I(t,a)}),g.current=[])},[M,I]),(0,s.useEffect)(()=>{if((null==_?void 0:_.get(b.cp2))&&(null==_?void 0:_.get(b.JKn))){let t=(null==_?void 0:_.get(b.JKn))==="true";if(P(t),t){var e;I("new user sign in"),(null==n?void 0:null===(e=n.user)||void 0===e?void 0:e.id)&&(null==M||M.sdk.setMatchID(n.user.id))}else I("existing user sign in");(0,f.bf)()&&I("comet user sign in")}},[_,P,I,null==n?void 0:null===(l=n.user)||void 0===l?void 0:l.id,null==M?void 0:M.sdk]),(0,r.jsx)(E.Provider,{value:(0,s.useMemo)(()=>({sendQueryEventSingular:()=>I("query submitted"),maybeSendNthQueryEventSingular:R,sendSubscribedEventSingular:()=>I("user subscribed"),sendSubscribedPayingEventSingular:()=>I("user subscribed paying"),sendAppDownloadClickedEventSingular:e=>I("app download button clicked",{origin:e}),sendResurrectedActivationEventSingular:()=>I("resurrected activated"),sendCometDownloadPageLoadEventSingular:e=>I("".concat(e," page loaded")),sendCometDownloadPageSignInEventSingular:e=>I("".concat(e," page signed in")),sendCometDownloadedEventSingular:()=>I("download-comet comet downloaded"),sendCometDownloadButtonClickedEventSingular:e=>I("".concat(e," download button clicked")),sendCometWaitlistButtonClickedEventSingular:e=>I("".concat(e," waitlist button clicked")),sendCometDownloadLinkEmailEventSingular:e=>I("".concat(e," send download link")),sendSubscribedMaxEventSingular:()=>I("user subscribed max")}),[I,R]),children:i})};var R=a(54499),P=a(63300),O=a(52155);let D=s.memo(function(){var e,t;let{session:a}=(0,o.N)(),l=(0,s.useMemo)(()=>{if(a)return{id:a.user.id,name:a.user.name,email:a.user.email,isPro:!!a.user.subscription_status&&"none"!==a.user.subscription_status}},[a]);if(!l)return null;let i=(0,R.r$)(null!==(t=null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent)&&void 0!==t?t:"");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.E,{session:l,isWindowsApp:i}),(0,r.jsx)(O.t,{session:l,isWindowsApp:i})]})});D.displayName="Instrumentation";var L=a(66087),U=a(94105);let F=e=>{let{children:t,hostname:a}=e,{session:l}=(0,o.N)(),s=(0,L.m)();return(0,r.jsx)(U.oW,{hostname:a,session:null!=l?l:void 0,cfCountry:s,children:t})};var z=a(43627);class B{static cancelOneTap(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!window)return!0;let t=window.location.pathname;return!![{match:"/",condition:()=>e},{match:"/welcome",condition:()=>e},{match:"/search/new"},{match:"/join/",startsWith:!0},{match:"/onboarding",startsWith:!0},{match:"/search/render",startsWith:!0},{match:"/auth/windows-app",startsWith:!0},{match:"/auth/sso",startsWith:!0},{match:"/auth/error",startsWith:!0}].some(e=>{let{match:a,startsWith:l,condition:r}=e;return(l?t.startsWith(a):t===a)&&(!r||r())})}static getLoginSource(){if(!window)return z.Kw.GOOGLE_ONETAP_UNKNOWN;let e=window.location.pathname;return e?"/"===e?z.Kw.GOOGLE_ONETAP_HOME:e.startsWith("/search/")?z.Kw.GOOGLE_ONETAP_THREAD:e.startsWith("/page/")?z.Kw.GOOGLE_ONETAP_PAGE:e.startsWith("/discover")?z.Kw.GOOGLE_ONETAP_DISCOVER:z.Kw.GOOGLE_ONETAP_UNKNOWN:z.Kw.GOOGLE_ONETAP_UNKNOWN}}var H=a(24065),q=a(89334),G=a(59889),Q=a(38683),V=a(68294);let K=(0,y.j)("GoogleOneTapContext",{promptSkipped:!1});function W(e){let{children:t}=e,a=(0,s.useRef)(0),l=(0,s.useRef)(!1),[i,n]=(0,s.useState)(!1),{status:d}=(0,o.N)(),{isMobileUserAgent:c}=(0,Q.al)(),u=(0,H.x)().erp,m=(0,s.useCallback)(async e=>{if(!e||B.cancelOneTap())return;let t=B.getLoginSource(),a=new URL(window.location.href),l=new URLSearchParams({[b.cp2]:t});a.search=l.toString();let r={credential:e.credential,callbackUrl:a.toString()};await (0,G.J)("googleonetap",r)},[]);return(0,s.useEffect)(()=>{if("authenticated"===d||"loading"===d||c||["new_tab","sidecar"].includes(null!=u?u:""))return;async function e(){var t,r;if(!l.current&&(a.current+=1,!(a.current>4))){if(await (0,V.A)(),!(null===(r=window.google)||void 0===r?void 0:null===(t=r.accounts)||void 0===t?void 0:t.id)){setTimeout(e,500);return}l.current=!0,!B.cancelOneTap()&&(window.google.accounts.id.initialize({client_id:"60244564555-30175ip7vg79fobh0rk1sur3pdutj9l1.apps.googleusercontent.com",callback:m,auto_select:!0,use_fedcm_for_prompt:!0}),(0,q.EJ)()?n(!0):window.google.accounts.id.prompt(e=>{n(e.isSkippedMoment())}))}}let t=setTimeout(e,500);return()=>{clearTimeout(t)}},[m,c,d,u]),(0,r.jsx)(K.Provider,{value:{promptSkipped:i},children:t})}a(95899);var Y=a(80892);a(16672),a(47719);let{Context:X,useTrackedState:Z}=(0,a(96983).PH)("LocalUserSettingsContext");var J=a(16683),$=a(79095),ee=a(52758),et=a(51244),ea=a(21978);let el=e=>{let{children:t}=e,[a,l]=(0,s.useState)([]),i=(0,s.useMemo)(()=>{var e,t;return null!==(t=null===(e=a.at(-1))||void 0===e?void 0:e.modalName)&&void 0!==t?t:null},[a]),{trackEvent:n}=(0,Y.yw)(),{setModalOpen:o}=(0,ee.o)();(0,s.useEffect)(()=>{o(null!=i)},[i,o]);let{device:{isMacOS:d,isWindowsApp:c}}=(0,x.L)(),{shouldShowLossAversionModal:u,handleOpenLossAversion:m}=(0,$.c)(),p=(0,ea.rd)(),h=(0,s.useCallback)((e,t)=>{l(()=>[{modalName:e,arg:t}])},[]),v=(0,s.useCallback)((e,t)=>{l(a=>[...a,{modalName:e,arg:t}])},[]),g=(0,s.useCallback)((e,t)=>{l(a=>{let l=a.findLastIndex(t=>t.modalName==e);if(-1==l)return a;{let r=a.slice();return r[l]={modalName:e,arg:t},r}})},[]),f=(0,s.useCallback)(()=>{l(e=>e.slice(0,e.length-1))},[]),y=(0,s.useMemo)(()=>({currentOpenModals:a,currentOpenedModal:i,openModal:h,openStackedModal:v,updateModal:g,closeModal:f}),[a,h,v,g,f,i]),b=(0,s.useCallback)(e=>{if(d?e.metaKey&&"k"===e.key:e.ctrlKey&&"i"===e.key)e.preventDefault(),u?m({args:{origin:z.Kw.NEW_THREAD_SHORTCUT,callback:()=>{n("quick ask keyboard shortcut",{}),p.push("/",void 0,"Quick ask keyboard shortcut (loss aversion)")}},openModalOverride:h}):(n("quick ask keyboard shortcut",{}),p.push("/",void 0,"Quick ask keyboard shortcut"));else if(d?e.metaKey&&"/"===e.key:e.ctrlKey&&"/"===e.key)e.preventDefault(),h(c?"keyboardShortcutEditorModal":"keyboardShortcutHelperModal",null);else if(c&&e.ctrlKey&&"d"===e.key){e.preventDefault();let t=new CustomEvent("toggleDictation");document.dispatchEvent(t)}},[d,c,u,m,h,n,p]);return(0,s.useEffect)(()=>(document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}),[b]),(0,r.jsxs)(et.I.Provider,{value:y,children:[t,(0,r.jsx)(J.b,{})]})};var er=a(70754),es=a(87475),ei=a(52613),en=a(53540),eo=a(32565),ed=a(84447);class ec{static retryDelay(e,t){return Math.min(e>1?2**e*1e3:1e3,3e4)}static retryQuery(e,t){return!1}static retryMutation(e,t){return!1}}(0,ed._)(ec,"GC_TIME",3e5),(0,ed._)(ec,"STALE_TIME",1/0);var eu=a(72484),em=a(3889);function ep(){return new ei.E({queryCache:new en.$({onError:e=>{let t=e instanceof em.W?e:new em.W("FETCHER_UNKNOWN_ERROR",{details:{cause:(0,eu.P5)(e)},cause:(0,eu.u7)(e)?e:void 0});_.vF.error(t)}}),mutationCache:new eo.q({onError:e=>{_.vF.error("Mutation error",e)}}),defaultOptions:{queries:{staleTime:ec.STALE_TIME,gcTime:ec.GC_TIME,refetchOnReconnect:!0,refetchOnMount:!0,refetchOnWindowFocus:!0,retry:ec.retryQuery,retryDelay:ec.retryDelay,throwOnError:!1,networkMode:"online"},mutations:{gcTime:ec.GC_TIME,retry:ec.retryMutation,retryDelay:ec.retryDelay,throwOnError:!1,networkMode:"online"}}})}var eh=a(76224);let ev=(0,y.j)("AetherContext",{isMobileStyle:!1,isMobileUserAgent:!1}),eg=(0,s.memo)(e=>{let{children:t,isMobileStyle:a=!1,isMobileUserAgent:l=!1}=e;return(0,r.jsx)(ev.Provider,{value:{isMobileStyle:a,isMobileUserAgent:l},children:(0,r.jsx)(eh.Kq,{children:t})})});eg.displayName="AetherProvider";var ef=a(90773),ey=a(60010);let ex=s.memo(()=>{let{message:e,variant:t,description:a,ctaText:l,ctaOnClick:i,isVisible:n,timeout:o,handleClick:d,closeToast:c,position:u,iconOverride:m,keyProp:p}=(0,ey.G)(),h=(0,s.useCallback)(()=>{"refresh"===t&&void 0===d?window.location.reload():d&&d()},[t,d]);return(0,r.jsx)(ef.A,{keyProp:p,isVisible:n,variant:t,message:e,description:a,ctaText:l,ctaOnClick:i,timeout:o,handleClick:h,onTimeout:c,position:u,iconOverride:m},p)});ex.displayName="Toasts";var eb=a(61058);let ew=s.memo(e=>{let{children:t,colorScheme:a}=e,{isMobileStyle:l,isMobileUserAgent:s}=(0,Q.al)();return(0,r.jsx)(eg,{isMobileStyle:l,isMobileUserAgent:s,children:(0,r.jsx)(eb.S,{userPreferredColorScheme:a,children:(0,r.jsxs)(ey.Q,{children:[t,(0,r.jsx)(ex,{})]})})})});ew.displayName="GlobalUXProvider",a(44111);var e_=a(83081),eM=a(64473),eC=a(51058),ej=a(63825),eA=a(47603);let eE=(0,y.j)("UploadProgressContext",null),eS=s.memo(e=>{let{children:t}=e,[a,l]=(0,s.useState)([]),[i,n]=(0,s.useState)(!1),o=(0,s.useCallback)(e=>{let{fileRepoInfo:t,collectionSlug:a,isFileManagerUiRedesignEnabled:r}=e;r&&l(e=>[...e,{id:e.length+1,fileRepoInfo:t,collectionSlug:a}])},[]),d=(0,s.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e))},[]),c=(0,s.useMemo)(()=>({startMonitoring:o,setModalOpen:n}),[o,n]),u=a.at(-1),m=!i&&u,p=(0,s.useCallback)(()=>{(null==u?void 0:u.id)&&d(u.id)},[null==u?void 0:u.id,d]);return(0,r.jsxs)(eE.Provider,{value:c,children:[t,m&&u&&(0,r.jsx)(ek,{fileRepoInfo:u.fileRepoInfo,collectionSlug:u.collectionSlug,onClose:p})]})});eS.displayName="UploadProgressProvider";let ek=e=>{let{fileRepoInfo:t,collectionSlug:a,onClose:l}=e,{$t:n}=(0,e_.A)(),o=(0,ea.rd)(),d=(0,i.useQueryClient)(),[c,u]=(0,s.useState)(!1),[m,p]=(0,s.useState)(0),[h,v]=(0,s.useState)(0),{total:g,errors:f,pending:y}=(0,eM.j)({enablePolling:!c,activePollingIntervalMs:5e3,passivePollingIntervalMs:5e3,fileRepoInfo:t,reason:"upload-progress-toast"});(0,s.useEffect)(()=>{g>m&&p(g),f>h&&v(f),0===g&&m>0&&(u(!0),d.invalidateQueries({queryKey:["connector-files"]}),d.invalidateQueries({queryKey:["connector-files-infinite"]}))},[g,f,y,m,h,d]);let x=n({defaultMessage:"See files",id:"p+DFrrlLh2"}),b=(0,s.useCallback)(()=>{switch(t.file_repository_type){case"USER":o.push("/account/files");break;case"ORG":o.push("/account/org/files");break;case"COLLECTION":if(!a){eA.vF.error("Collection slug is not set",{fileRepoInfo:t});return}o.push("/spaces/".concat(a,"?showUploadModal"));break;default:eA.vF.warn("Unsupported file repository type",{fileRepoInfo:t})}},[t,o,a]);if(!m)return null;if(c){let e=n({defaultMessage:"{totalFiles, number} files synced",id:"9MS85urDwN"},{totalFiles:m}),t=n({defaultMessage:"Ready to search",id:"n813XUWD4Q"});return(0,r.jsx)(ef.A,{message:e,description:t,variant:"success",iconOverride:eC.i,ctaText:x,ctaOnClick:b,isVisible:!0,handleClose:l})}let w=Math.round((m-y)/m*100),_=n({defaultMessage:"Syncing {totalFiles, number} files",id:"ho+SHGkjiL"},{totalFiles:m}),M=isNaN(w)?"":n({defaultMessage:"{percentage, number}% complete with {errors, number} errors",id:"EbZcfC1rW4"},{percentage:w,errors:f});return(0,r.jsx)(ef.A,{message:_,description:M,variant:"success",iconOverride:ej.H,ctaText:x,ctaOnClick:b,closeOnCtaClick:!1,isVisible:!0,handleClose:l})};var eN=a(37342);function eT(e){let{children:t}=e;(0,er.z)();let{colorScheme:a}=Z();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D,{}),(0,r.jsx)(ew,{colorScheme:null!=a?a:void 0,children:(0,r.jsxs)(F,{hostname:window.location.hostname,children:[(0,r.jsx)(I,{children:(0,r.jsx)(eS,{children:(0,r.jsx)(el,{children:(0,r.jsx)(W,{children:t})})})}),(0,r.jsx)(h,{})]})})]})}function eI(e){let{children:t}=e,a=es.S$?ep():(l||(l=ep()),l),[n,o]=(0,s.useState)(),[d,c]=(0,s.useState)();return((0,s.useEffect)(()=>{o(window.location.hostname),c(navigator.userAgent)},[]),n&&d)?(0,r.jsx)(i.QueryClientProvider,{client:a,children:(0,r.jsx)(eN.A,{host:window.location.hostname,userAgent:navigator.userAgent,children:(0,r.jsx)(eT,{children:t})})}):(0,r.jsx)(i.QueryClientProvider,{client:a,children:t})}},50276:(e,t,a)=>{"use strict";a.d(t,{R6:()=>i,s4:()=>s});var l=a(77150),r=a(77917);let s=async e=>{let{request:t,reason:a}=e,{error:s,data:i}=await r.By.POST("/rest/deeper-research/download-asset",a,{body:t,timeoutMs:2e3,numRetries:1});if(s)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to download file",cause:s});return i.file_url},i=async e=>{let{request:t,reason:a}=e,{error:s,data:i}=await r.By.POST("/rest/deeper-research/export-all-assets",a,{body:t,timeoutMs:6e4,numRetries:1,parseAs:"blob"});if(s)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to export all assets",cause:s});return i}},50458:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});let l=(0,a(27773).w)({path:"M15 7l-6.5 6.5a1.5 1.5 0 0 0 3 3l6.5 -6.5a3 3 0 0 0 -6 -6l-6.5 6.5a4.5 4.5 0 0 0 9 9l6.5 -6.5",name:"IconPaperclip",variant:"stroked"})},50663:(e,t,a)=>{"use strict";a.d(t,{g:()=>s});var l=a(77917),r=a(3041);let s=async(e,t)=>{try{let{error:a}=await l.By.POST("/rest/homepage-widgets/upsell/interacted","homepage upsell interaction tracking",{body:{upsell_name:e,upsell_instance_identifier:t||null},timeoutMs:(0,l.e4)(),numRetries:1});a&&r.vF.error("Failed to mark upsell as interacted",{upsellName:e,upsellInstanceIdentifier:t,error:a})}catch(a){r.vF.error("Error marking upsell as interacted",{upsellName:e,upsellInstanceIdentifier:t,error:a})}}},50665:(e,t,a)=>{"use strict";a.d(t,{N:()=>l});let l=(0,a(27773).w)({path:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11",name:"IconBolt",variant:"stroked"})},51058:(e,t,a)=>{"use strict";a.d(t,{i:()=>l});let l=(0,a(27773).w)({path:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0 M9 12l2 2l4 -4",name:"IconCircleCheck",variant:"stroked"})},52758:(e,t,a)=>{"use strict";a.d(t,{o:()=>v});var l=a(25576),r=a(85860),s=a(95641),i=a(83081),n=a(64473),o=a(92988),d=a(90773),c=a(51058),u=a(63825),m=a(21978),p=a(47603);let h=(0,o.j)("UploadProgressContext",null),v=()=>{let e=(0,r.useContext)(h);if(!e)throw Error("useUploadProgress must be used within an UploadProgressProvider");return e};r.memo(e=>{let{children:t}=e,[a,s]=(0,r.useState)([]),[i,n]=(0,r.useState)(!1),o=(0,r.useCallback)(e=>{let{fileRepoInfo:t,collectionSlug:a,isFileManagerUiRedesignEnabled:l}=e;l&&s(e=>[...e,{id:e.length+1,fileRepoInfo:t,collectionSlug:a}])},[]),d=(0,r.useCallback)(e=>{s(t=>t.filter(t=>t.id!==e))},[]),c=(0,r.useMemo)(()=>({startMonitoring:o,setModalOpen:n}),[o,n]),u=a.at(-1),m=!i&&u,p=(0,r.useCallback)(()=>{(null==u?void 0:u.id)&&d(u.id)},[null==u?void 0:u.id,d]);return(0,l.jsxs)(h.Provider,{value:c,children:[t,m&&u&&(0,l.jsx)(g,{fileRepoInfo:u.fileRepoInfo,collectionSlug:u.collectionSlug,onClose:p})]})}).displayName="UploadProgressProvider";let g=e=>{let{fileRepoInfo:t,collectionSlug:a,onClose:o}=e,{$t:h}=(0,i.A)(),v=(0,m.rd)(),g=(0,s.useQueryClient)(),[f,y]=(0,r.useState)(!1),[x,b]=(0,r.useState)(0),[w,_]=(0,r.useState)(0),{total:M,errors:C,pending:j}=(0,n.j)({enablePolling:!f,activePollingIntervalMs:5e3,passivePollingIntervalMs:5e3,fileRepoInfo:t,reason:"upload-progress-toast"});(0,r.useEffect)(()=>{M>x&&b(M),C>w&&_(C),0===M&&x>0&&(y(!0),g.invalidateQueries({queryKey:["connector-files"]}),g.invalidateQueries({queryKey:["connector-files-infinite"]}))},[M,C,j,x,w,g]);let A=h({defaultMessage:"See files",id:"p+DFrrlLh2"}),E=(0,r.useCallback)(()=>{switch(t.file_repository_type){case"USER":v.push("/account/files");break;case"ORG":v.push("/account/org/files");break;case"COLLECTION":if(!a){p.vF.error("Collection slug is not set",{fileRepoInfo:t});return}v.push("/spaces/".concat(a,"?showUploadModal"));break;default:p.vF.warn("Unsupported file repository type",{fileRepoInfo:t})}},[t,v,a]);if(!x)return null;if(f){let e=h({defaultMessage:"{totalFiles, number} files synced",id:"9MS85urDwN"},{totalFiles:x}),t=h({defaultMessage:"Ready to search",id:"n813XUWD4Q"});return(0,l.jsx)(d.A,{message:e,description:t,variant:"success",iconOverride:c.i,ctaText:A,ctaOnClick:E,isVisible:!0,handleClose:o})}let S=Math.round((x-j)/x*100),k=h({defaultMessage:"Syncing {totalFiles, number} files",id:"ho+SHGkjiL"},{totalFiles:x}),N=isNaN(S)?"":h({defaultMessage:"{percentage, number}% complete with {errors, number} errors",id:"EbZcfC1rW4"},{percentage:S,errors:C});return(0,l.jsx)(d.A,{message:k,description:N,variant:"success",iconOverride:u.H,ctaText:A,ctaOnClick:E,closeOnCtaClick:!1,isVisible:!0,handleClose:o})}},52865:(e,t,a)=>{"use strict";a.d(t,{NO:()=>s}),a(25576);var l=a(85860);let r=(0,a(92988).j)("ScrollContainerRefContext",null),s=()=>{let e=(0,l.useContext)(r);if(!e)throw Error("useScrollContainerRef must be used within a ScrollContainerRefProvider");return e}},53121:(e,t,a)=>{"use strict";a.d(t,{W:()=>V});var l=a(85860),r=a(95641),s=a(4428),i=a(77150),n=a(77917),o=a(25576),d=a(15492),c=a(87475),u=a(64829);let m=e=>null==e?void 0:e.toLowerCase(),p=e=>"pending"===m(e.status),h=e=>e.find(e=>p(e)&&e.backend_uuid),v=e=>!!(e&&(0,u.bv)(e)&&"blocks"in e[0]);var g=a(46972);let f=async e=>{let{slugOrUUID:t,headers:a,reason:l}=e,{data:r,error:s}=await n.By.GET("/rest/article/{article_uuid_or_slug}",l,{params:{path:{article_uuid_or_slug:t}},headers:a,timeoutMs:(0,n.e4)({productionMs:3e3}),numRetries:1});if(s)throw new i.T("API_CLIENTS_ERROR",{cause:s});if("success"!==r.status)throw new i.T("API_CLIENTS_ERROR",{cause:r});return r.entries};var y=a(11129),x=a(14036),b=a(92988),w=a(43627),_=a(18360),M=a(7685),C=a(67121),j=a(62615);let A=e=>{var t,a,l;return(null===(t=e[0])||void 0===t?void 0:t.article_info)?{title:e[0].article_info.title||"",summary:e[0].article_info.summary||"",suggested_sections:e[0].article_info.suggested_sections||[],audience:e[0].article_info.audience||"anyone",read_time:e[0].article_info.read_time,emphasize_sources:null!==(a=e[0].article_info.emphasize_sources)&&void 0!==a&&a,num_sections:e.length,should_index:null!==(l=e[0].should_index)&&void 0!==l&&l}:null},E={isBlocksApi:!1,article:[],heroSection:void 0,isLoading:!1,isPublished:!1,isOrgInternal:!1,inFlight:!1,inFlightLatest:!1,currentlyStreamingSection:void 0,socialStats:{forkCount:0,likeCount:0,viewCount:0,userLikes:!1},threadMetadata:{rwToken:void 0,contextUUID:void 0,frontendContextUUID:void 0,title:void 0,first_query:void 0,focus:void 0,author_id:void 0,author_username:void 0,author_image:void 0,parent_info:void 0,mode:void 0,personalized:!1,collection:void 0,thread_access:0,thread_url_slug:void 0,updated_datetime:void 0,expiry_time:void 0,privacy_state:C.k9.NONE},articleMetadata:{title:"",summary:"",suggested_sections:[],audience:"anyone",read_time:0,emphasize_sources:!1,num_sections:0,should_index:!1},articleMedia:[],articleWebResults:[],relatedPages:[],articleLocalState:{isEditModeEnabled:!1,setEditModeEnabled:()=>void 0,isCreating:!1,setIsCreating:()=>void 0,isTitleVisible:!0,setTitleVisible:()=>void 0,clickedImage:null,setClickedImage:()=>void 0,clickedImageIndex:0,isRewritingSection:!1,setRewritingSection:()=>void 0},refetch:()=>void 0},S=(0,b.j)("ArticleResultsContext",E);l.memo(e=>{var t,a;let{relatedPages:s=_.Ml,children:i,slug:n}=e,m="article-results-provider",[b,C]=(0,l.useState)(!1),[E,k]=(0,l.useState)(!1),[N,T]=(0,l.useState)(null),[I,R]=(0,l.useState)(!0),[P,O]=(0,l.useState)(!1),{isEnterprise:D}=(0,x.fE)({reason:m}),L=(0,r.useQueryClient)(),U=(0,j.ok)(),F=null==U?void 0:U.get("newFrontendContextUUID"),[z,B]=(0,l.useState)(L.getQueryData((0,y.Zt)(n||"")));(0,l.useEffect)(()=>{if(F){B(F);return}B(L.getQueryData((0,y.Zt)(n||"")))},[F,L,n]);let{data:H,isLoading:q}=(0,d.useQuery)({enabled:!!n&&"new"!==n,queryKey:(0,y.fH)(z||""),queryFn:()=>f({slugOrUUID:n,reason:m}),refetchOnMount:!0,placeholderData:c.rX}),G=v(H),Q=(0,l.useMemo)(()=>{if(!H||G)return;let e=H[H.length-1];return{inFlight:H.some(p),inFlightLatest:e&&p(e)}},[H,G]),V=null!==(t=null==Q?void 0:Q.inFlight)&&void 0!==t&&t,K=null!==(a=null==Q?void 0:Q.inFlightLatest)&&void 0!==a&&a,W=(0,l.useMemo)(()=>{if(H&&!G)return h(H)},[H,G]),Y=(0,l.useMemo)(()=>{if(!H||0===H.length)return null;let e=H[0];if(p(e))return null;let t=e.social_info;return t?(0,g.Wz)(t):(0,g.Wz)(g.Dm)},[H]),X=(0,l.useMemo)(()=>H&&0!==H.length?(0,g.aw)(H[0]):(0,g.aw)(),[H]),Z=(0,l.useMemo)(()=>H?A(H):null,[H]),J=(0,l.useMemo)(()=>{let e=[];return null==H||H.forEach(t=>{var a,l,r;if("media-only"===t.article_info.layout){let l=null!==(a=t.article_info.user_selected_media_items)&&void 0!==a?a:[],r=null==l?void 0:l.filter(e=>"image"===e.medium);e.push(...r)}else{let a=null!==(l=null==t?void 0:t.media_items)&&void 0!==l?l:[],s=null!==(r=null==t?void 0:t.featured_images)&&void 0!==r?r:[];"text"!==t.article_info.layout&&((0,u.bv)(s)&&"image"===s[0].medium?e.push(s[0]):(0,u.bv)(a)&&"image"===a[0].medium&&e.push(a[0]))}}),e},[H]),$=(0,l.useMemo)(()=>{if(!N)return 0;let e=J.findIndex(e=>(null==e?void 0:e.image)===(null==N?void 0:N.image));return e>-1?e:0},[N,J]),ee=(0,l.useMemo)(()=>{let e=new Map;return H&&0!==H.length?(null==H||H.forEach(t=>{let a=M.iQ.parseAskTextField(t);(null==a?void 0:a.web_results)&&a.web_results.forEach(t=>{e.has(t.url)?e.get(t.url).count+=1:e.set(t.url,{...t,count:1})})}),Array.from(e.values()).sort((e,t)=>t.count-e.count).map(e=>({...e,count:void 0}))):[]},[H]),et=null!=X?X:(0,g.aw)(),ea=D&&!!et.collection&&et.thread_access===w.hx.COLLECTION_READ,el=!!D&&et.thread_access===w.hx.ORG_READ,er=ea||el||et.thread_access===w.hx.PUBLIC_READ;return(0,o.jsx)(S.Provider,{value:{isBlocksApi:G,article:null!=H?H:[],isLoading:q,heroSection:null==H?void 0:H[0],lastSection:null==H?void 0:H[H.length-1],socialStats:Y,isPublished:er,isOrgInternal:el,inFlight:V,inFlightLatest:K,currentlyStreamingSection:W,threadMetadata:et,articleMetadata:null!=Z?Z:A([]),articleLocalState:{isEditModeEnabled:b,setEditModeEnabled:C,isTitleVisible:I,setTitleVisible:R,isCreating:E,setIsCreating:k,clickedImage:N,setClickedImage:T,clickedImageIndex:$,isRewritingSection:P,setRewritingSection:O},articleMedia:J,articleWebResults:ee,relatedPages:s},children:i})}).displayName="ArticleResultsProvider";let k=()=>{let e=(0,l.useContext)(S);if(!e)throw Error("useArticleResults must be used within ArticleResultsContext");return e};var N=a(42826);a(98188),a(96867);var T=a(17760);let I="recentCollections";function R(){return["spaces","list","all"]}a(88209);var P=a(74924);let O={searchTerm:"",updateUserInput:e=>void 0},D=(0,b.j)("UserInputStateContext",O),L=()=>{let e=(0,l.useContext)(D);return e||O},U="list_ask_threads";var F=a(26976),z=a(35179);let B=(e,t)=>{var a;let l=e.getQueryData(["results"]);return null==l?void 0:null===(a=l.find(e=>e.frontend_context_uuid===t))||void 0===a?void 0:a.collection_info},H=(e,t)=>{var a;let l=e.getQueryData((0,y.fH)(t));return null==l?void 0:null===(a=l.find(e=>e.frontend_context_uuid===t))||void 0===a?void 0:a.collection_info},q=(e,t,a)=>{e.setQueryData((0,y.fH)(t),e=>e?e.map(a):e)},G=[w.hx.OWNER_ONLY,w.hx.PRIVATE_READ,w.hx.COLLECTION_READ],Q=(e,t,a,l,r)=>{let{entryUUID:s,frontendContextUUID:i,newCollectionUUID:n,newCollectionTitle:o,newCollectionEmoji:d,newCollectionSlug:c,newCollectionAccess:u,newCollectionUserPermission:m}=t,p={collection_info:{uuid:n,title:o,emoji:d,slug:c,access:u,user_permission:m},bookmark_state:"BOOKMARKED"};i&&(r(e=>e?e.map(e=>e.frontend_context_uuid===i?{...e,...p}:e):[]),e.setQueryData([l,{frontend_context_uuid:i}],e=>e?e.map(e=>e.frontend_context_uuid===i?{...e,...p}:e):[])),e.setQueryData(a,e=>{let t=(e=e||{pages:[],pageParams:[]}).pages.map(e=>e.map(e=>e.uuid===s?{...e,collection:{...e.collection,...p.collection_info}}:e));return{...e,pages:t}})},V=e=>{let{reason:t}=e,{searchTerm:a}=L(),o=(0,r.useQueryClient)(),{isEnterprise:d}=(0,x.fE)({reason:t}),{threadMetadata:c}=k(),u=(0,P.k)(),m=(0,j.a8)(),p="results",h=[U,{search_term:null!=a?a:""}],v=y.Og,f=B,b=(0,g.Oc)(),_=(0,l.useCallback)((e,t,a)=>{b(e=>e?e.map(a):e)},[b]);((null==m?void 0:m.startsWith("/page"))||(null==m?void 0:m.startsWith("/discover")))&&(p="articleResults",h=[U,{search_term:null!=a?a:""}],v=y.OM,f=H,_=q);let C=(0,l.useCallback)(e=>{let t=!u&&!(null==c?void 0:c.rwToken);d&&!t&&b(t=>{if(t)return t.map(t=>{let a=!1,l=w.hx.PRIVATE_READ;if("add"===e){var r;a=G.includes(null!==(r=t.thread_access)&&void 0!==r?r:null),l=M.iQ.isArticleMode(t)?w.hx.PRIVATE_READ:w.hx.COLLECTION_READ}else a=t.thread_access!==w.hx.COLLECTION_READ,l=w.hx.PRIVATE_READ;return{...t,thread_access:a?t.thread_access:l}})})},[u,null==c?void 0:c.rwToken,d,b]),{mutate:A}=(0,s.useMutation)({mutationFn:async e=>{let{title:a,description:l,emoji:r,instructions:s,accessLevel:i,existingCollection:n,enableWebByDefault:o,closeModal:d}=e;return d(),(0,F.Fi)({collectionUuid:n.uuid,changes:{title:a,description:l,emoji:r,instructions:s,accessLevel:i,enableWebByDefault:o},reason:t})},onMutate:async e=>{let t=["get_collection",{collection_slug:e.existingCollection.slug.slice(-22)}];await o.cancelQueries({queryKey:t});let a=o.getQueryData(t);return o.setQueryData(t,t=>({...t,title:e.title,description:e.description,emoji:e.emoji,instructions:e.instructions,access:e.accessLevel,enable_web_by_default:e.enableWebByDefault})),{previousCollection:a}},onSettled:(e,t,a,l)=>{let r=["get_collection",{collection_slug:a.existingCollection.slug.slice(-22)}];t?o.setQueryData(r,null==l?void 0:l.previousCollection):(o.setQueryData(r,t=>({...t,...e})),o.setQueryData(N.Hh,t=>(null==t?void 0:t.pages)?{...t,pages:t.pages.map(t=>t.map(t=>t.uuid===a.existingCollection.uuid?{...t,...e}:t))}:t),o.invalidateQueries({queryKey:R()}),o.invalidateQueries({queryKey:(0,y.lU)()}))}}),{mutate:E}=(0,s.useMutation)({mutationFn:async e=>{let{accessLevel:a,collectionUuid:l}=e;await (0,T.s6)({params:{collection_uuid:l,updated_access:a},reason:t})},onMutate:async e=>{let t=["get_collection",{collection_slug:e.collectionSlug.slice(-22)}];await o.cancelQueries({queryKey:t});let a=o.getQueryData(t);return o.setQueryData(t,t=>({...t,access:e.accessLevel})),{previousCollection:a}},onSettled:async(e,t,a,l)=>{if(t)o.setQueryData(N.Hh,null==l?void 0:l.previousCollection);else{let e=a.collectionSlug.slice(-22);await o.invalidateQueries({queryKey:["org_pinned_spaces_query_key"]}),await o.invalidateQueries({queryKey:["get_collection",{collection_slug:e}]}),o.invalidateQueries({queryKey:R()})}}}),{mutate:S}=(0,s.useMutation)({mutationFn:async e=>{let{entryUUID:a,title:l,description:r,emoji:s,instructions:i,accessLevel:n,callback:o,frontendContextUUID:d}=e,c=await (0,F.No)({params:{title:l,description:r,emoji:s,instructions:i,accessLevel:n},reason:t});return await (0,T.SL)({params:{new_collection_uuid:c.uuid,entry_uuid:a,return_collection:!1,return_thread:!1},reason:t}),o(c),C("add"),{title:l,description:r,emoji:s,instructions:i,accessLevel:n,newCollection:c}},onMutate:async e=>{let{entryUUID:t,frontendContextUUID:a,...l}=e;await o.cancelQueries({queryKey:h}),await o.cancelQueries({queryKey:N.Hh});let r=o.getQueryData(h),s=o.getQueryData(N.Hh);o.setQueryData(N.Hh,e=>{var t;let a=null!==(t=(e=e||{pages:[],pageParams:[]}).pages&&e.pages[0])&&void 0!==t?t:[],r={...(null==a?void 0:a.length)>0?a[0]:[],...l,uuid:N.Ox,thread_count:1};return{...e,pages:[[r,...a]]}}),o.setQueryData(h,e=>{let a=(e=e||{pages:[],pageParams:[]}).pages.map(e=>e.map(e=>e.uuid===t?{...e,collection:{...e.collection,description:l.description,uuid:N.Ox,title:l.title,emoji:l.emoji}}:e));return{...e,pages:a}}),o.setQueryData(v(t),e=>{var t;let a=null!==(t=null==e?void 0:e.collection_info)&&void 0!==t?t:{};return{...e,collection_info:{...a,uuid:N.Ox,description:l.description,title:l.title,emoji:l.emoji}}});let i=null;if(a){var n;i=null!==(n=f(o,a))&&void 0!==n?n:null,_(o,a,e=>e.frontend_context_uuid===a?{...e,collection_info:{...e.collection_info,uuid:N.Ox,title:l.title,emoji:l.emoji},bookmark_state:"BOOKMARKED"}:e)}return{previousThreads:r,previousCollections:s,previousCollectionInfo:i}},onSettled:(e,t,a,l)=>{t?(o.setQueryData(h,l.previousThreads),o.setQueryData(N.Hh,l.previousCollections),a.frontendContextUUID&&_(o,a.frontendContextUUID,e=>{if(e.frontend_context_uuid===a.frontendContextUUID){var t;return{...e,collection_info:null!==(t=null==l?void 0:l.previousCollectionInfo)&&void 0!==t?t:null,bookmark_state:(null==l?void 0:l.previousCollectionInfo)?"BOOKMARKED":"NOT_BOOKMARKED"}}return e})):(o.invalidateQueries({queryKey:h}),o.invalidateQueries({queryKey:N.Hh}),o.invalidateQueries({queryKey:[I]}),o.invalidateQueries({queryKey:(0,y.lU)()}),o.invalidateQueries({queryKey:R()}),a.frontendContextUUID&&_(o,a.frontendContextUUID,t=>{if(t.frontend_context_uuid===a.frontendContextUUID){var l,r,s,i;return{...t,collection_info:{...t.collection_info,uuid:null==e?void 0:null===(l=e.newCollection)||void 0===l?void 0:l.uuid,title:null==e?void 0:null===(r=e.newCollection)||void 0===r?void 0:r.title,emoji:null==e?void 0:null===(s=e.newCollection)||void 0===s?void 0:s.emoji,slug:null==e?void 0:null===(i=e.newCollection)||void 0===i?void 0:i.slug},bookmark_state:"BOOKMARKED"}}return t}))}}),{mutate:O}=(0,s.useMutation)({mutationFn:async e=>{let{title:a,description:l,emoji:r,instructions:s,accessLevel:i,template_id:n,callback:o}=e,d=await (0,F.No)({params:{title:a,description:l,emoji:r,instructions:s,accessLevel:i,template_id:n},reason:t});return o(d),{collection:d}},onMutate:async e=>{let{...t}=e;o.setQueryData(N.Hh,e=>{let a=(e=e||{pages:[],pageParams:[]}).pages[0]||[],l={...a.length>0?a[0]:{},...t,uuid:N.Ox,thread_count:0};return{...e,pages:[[l,...a]]}})},onSuccess:async()=>{o.refetchQueries({queryKey:N.Hh}),o.invalidateQueries({queryKey:[I]}),o.invalidateQueries({queryKey:(0,y.lU)()}),o.invalidateQueries({queryKey:R()})}}),{mutate:D}=(0,s.useMutation)({mutationFn:async e=>{let{entryUUID:a}=e,l=await (0,T.SL)({params:{entry_uuid:a,upsert_type:"bookmark",return_collection:!0,return_thread:!1},reason:t});return C("add"),l},onMutate:async e=>{var t;let a;let{entryUUID:l,topic:r}=e,s=o.getQueryData((0,y.vW)(r));for(let e of null!==(t=null==s?void 0:s.pages)&&void 0!==t?t:[])for(let t of e.threads)if(t.uuid===l){a=t.collection;break}return o.setQueryData((0,y.vW)(r),e=>{if(e)return{pageParams:e.pageParams,pages:e.pages.map(e=>({...e,threads:e.threads.map(e=>({...e,collection:e.uuid===l?{uuid:N.Ox,title:"Bookmarks",emoji:"1f516",slug:N.Ox}:e.collection}))}))}}),{previousCollection:a}},onSettled:(e,t,a,l)=>{let{entryUUID:r,topic:s}=a;if(t||!e)(null==l?void 0:l.previousCollection)&&o.setQueryData((0,y.vW)(s),e=>{if(e)return{pageParams:e.pageParams,pages:e.pages.map(e=>({...e,threads:e.threads.map(e=>({...e,collection:e.uuid===r?l.previousCollection:e.collection}))}))}});else{let{updated_collection:t}=e,{uuid:a,title:l,emoji:i,slug:n}=t;o.setQueryData((0,y.vW)(s),e=>{if(e)return{pageParams:e.pageParams,pages:e.pages.map(e=>({...e,threads:e.threads.map(e=>({...e,collection:e.uuid===r?{uuid:a,title:l,emoji:i,slug:n}:e.collection}))}))}})}}}),{mutate:V}=(0,s.useMutation)({mutationFn:async e=>{let{entryUUID:a,topic:l,oldCollectionUUID:r}=e;return await (0,T.X8)({collectionUUID:r,entryUUID:a,reason:t}),{topic:l}},onMutate:async e=>{var t;let a;let{entryUUID:l,topic:r}=e,s=o.getQueryData((0,y.vW)(r));for(let e of null!==(t=null==s?void 0:s.pages)&&void 0!==t?t:[])for(let t of e.threads)if(t.uuid===l){a=t.collection;break}return o.setQueryData((0,y.vW)(r),e=>{if(e)return{pageParams:e.pageParams,pages:e.pages.map(e=>({...e,threads:e.threads.map(e=>({...e,collection:e.uuid===l?void 0:e.collection}))}))}}),{previousCollection:a}},onSettled:(e,t,a,l)=>{let{entryUUID:r,topic:s}=a;t&&(null==l?void 0:l.previousCollection)&&o.setQueryData((0,y.vW)(s),e=>{if(e)return{pageParams:e.pageParams,pages:e.pages.map(e=>({...e,threads:e.threads.map(e=>({...e,collection:e.uuid===r?l.previousCollection:e.collection}))}))}})}}),{mutate:K}=(0,s.useMutation)({mutationFn:async e=>{let{entryUUID:a,frontendContextUUID:l}=e,r=await (0,T.SL)({params:{entry_uuid:a,upsert_type:"bookmark",return_collection:!0,return_thread:!1},reason:t});return C("add"),{response:r,entryUUID:a,frontendContextUUID:l}},onMutate:async e=>{let{frontendContextUUID:t}=e;await o.cancelQueries({queryKey:h}),await o.cancelQueries({queryKey:N.Hh}),b(e=>e?e.map(e=>e.frontend_context_uuid===t?{...e,bookmark_state:"BOOKMARKED",collection_info:{uuid:null,title:"Bookmarks",emoji:"1f516",slug:null,access:null,user_permission:z.ZW.OWNER_DEFAULT_BOOKMARKS}}:e):e)},onSettled:async(e,t)=>{var a;if(!e||!(null===(a=e.response)||void 0===a?void 0:a.updated_collection))return;let l=e.response.updated_collection,r=e.entryUUID,s=e.frontendContextUUID,{uuid:i,title:n,emoji:d=null,slug:c,access:u,user_permission:m}=l;await o.cancelQueries({queryKey:h}),await o.cancelQueries({queryKey:N.Hh}),Q(o,{entryUUID:r,frontendContextUUID:s,newCollectionUUID:i,newCollectionTitle:n,newCollectionEmoji:d,newCollectionSlug:c,newCollectionAccess:u,newCollectionUserPermission:m},h,p,b),o.invalidateQueries({queryKey:N.Hh}),o.invalidateQueries({queryKey:h}),o.invalidateQueries({queryKey:["results"]}),o.invalidateQueries({queryKey:[p,{frontend_context_uuid:s}]})}}),{mutate:W}=(0,s.useMutation)({mutationFn:async e=>{let{entryUUID:a,currentCollectionUUID:l,newCollectionTitle:r,newCollectionUUID:s,newCollectionSlug:i,newCollectionAccess:n,closeModal:o,callback:d}=e;if(s!==N.Ox)return o(),await (0,T.SL)({params:{new_collection_uuid:s,entry_uuid:a,return_collection:!1,return_thread:!1},reason:t}),null==d||d(),C("add"),{entryUUID:a,currentCollectionUUID:l,newCollectionTitle:r,newCollectionUUID:s,newCollectionSlug:i,newCollectionAccess:n,closeModal:o}},onMutate:async e=>{let{entryUUID:t,frontendContextUUID:a,currentCollectionUUID:l,newCollectionUUID:r,newCollectionTitle:s,newCollectionEmoji:i,newCollectionSlug:n,newCollectionAccess:d,newCollectionUserPermission:c}=e;await o.cancelQueries({queryKey:h}),await o.cancelQueries({queryKey:N.Hh});let u=o.getQueryData(h),m=o.getQueryData(N.Hh);return Q(o,{entryUUID:t,frontendContextUUID:a,newCollectionUUID:r,newCollectionTitle:s,newCollectionEmoji:i,newCollectionSlug:n,newCollectionAccess:d,newCollectionUserPermission:c},h,p,b),o.setQueryData(N.Hh,e=>{let t=(e=e||{pages:[],pageParams:[]}).pages.map(e=>e.map(e=>e.uuid===l?{...e,thread_count:e.thread_count-1}:e.uuid===r?{...e,thread_count:e.thread_count+1}:e));return{...e,pages:t}}),{previousThread:u,previousCollections:m}},onSettled:(e,t,a,l)=>{if(t)o.setQueryData(h,l.previousThread),o.setQueryData(N.Hh,l.previousCollections);else{let e=a.existingCollectionSlug,t={collection_slug:null==e?void 0:e.slice(-22)},l={collection_slug:a.newCollectionSlug.slice(-22)},r=[N.d8,t],s=[N.d8,l];o.invalidateQueries({queryKey:["get_collection",l]}),o.invalidateQueries({queryKey:r}),o.refetchQueries({queryKey:s}),o.refetchQueries({queryKey:v(a.entryUUID)}),o.invalidateQueries({queryKey:N.Hh}),o.invalidateQueries({queryKey:h}),o.invalidateQueries({queryKey:["results"]}),o.invalidateQueries({queryKey:[p,{frontend_context_uuid:a.frontendContextUUID}]}),o.invalidateQueries({queryKey:[I]})}}}),{mutate:Y}=(0,s.useMutation)({mutationFn:async e=>{let{entryUUID:a,oldCollectionUUID:l,callback:r}=e;if(l)return await (0,T.X8)({collectionUUID:l,entryUUID:a,reason:t}),null==r||r(),C("remove"),{entryUUID:a,oldCollectionUUID:l}},onMutate:async e=>{let{entryUUID:t,oldCollectionUUID:a,frontendContextUUID:l,collectionSlug:r}=e;await o.cancelQueries({queryKey:h}),await o.cancelQueries({queryKey:N.Hh});let s=o.getQueryData(h),i=o.getQueryData(N.Hh);return l&&(b(e=>e?e.map(e=>e.frontend_context_uuid===l?{...e,collection_info:void 0,bookmark_state:"NOT_BOOKMARKED"}:e):[]),o.setQueryData([p,{frontend_context_uuid:l}],e=>e?e.map(e=>e.frontend_context_uuid===l?{...e,collection_info:null,bookmark_state:"NOT_BOOKMARKED"}:e):[])),o.setQueryData(h,e=>{let l=(e=e||{pages:[],pageParams:[]}).pages.map(e=>e.map(e=>{var l;return t===e.uuid&&(null===(l=e.collection)||void 0===l?void 0:l.uuid)===a?{...e,collection:null}:e}));return{...e,pages:l}}),o.setQueryData(N.Hh,e=>{let l=(e=e||{pages:[],pageParams:[]}).pages.map(e=>e.map(e=>e.uuid===a?{...e,thread_count:e.thread_count-1}:e));return o.setQueryData(v(t),e=>e&&Array.isArray(e.pages)?{...e,pages:e.pages.map(e=>e.map(e=>e.uuid===t?{...e,collection_info:null}:e))}:{...e,collection_info:null}),{...e,pages:l}}),r&&o.setQueryData([N.d8,{collection_slug:r.slice(-22)}],function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pages:[],pageParams:[]};return{...e,pages:e.pages.map(e=>e.filter(e=>e.uuid!==t))}}),{previousThreads:s,previousCollections:i}},onSettled:(e,t,a,l)=>{if(t)o.setQueryData(h,l.previousThreads),o.setQueryData(N.Hh,l.previousCollections);else if(o.invalidateQueries({queryKey:v(a.entryUUID)}),o.invalidateQueries({queryKey:h}),o.invalidateQueries({queryKey:N.Hh}),o.invalidateQueries({queryKey:["results"]}),o.invalidateQueries({queryKey:[I]}),o.invalidateQueries({queryKey:[p,{frontend_context_uuid:a.frontendContextUUID}]}),a.collectionSlug){let e={collection_slug:a.collectionSlug.slice(-22)},t=[N.d8,e];o.invalidateQueries({queryKey:t}),o.invalidateQueries({queryKey:["get_collection",e]})}}}),{mutate:X}=(0,s.useMutation)({mutationFn:async e=>{await (0,F.o4)({collectionUuid:e,reason:t})},onSuccess:(e,t)=>{o.invalidateQueries({queryKey:N.Hh}),o.invalidateQueries({queryKey:[I]}),o.invalidateQueries({queryKey:(0,y.lU)()}),o.invalidateQueries({queryKey:R()}),o.setQueryData(N.Hh,e=>e&&e.pages?{...e,pages:e.pages.map(e=>e.filter(e=>e.uuid!==t))}:e)}}),{mutate:Z}=(0,s.useMutation)({mutationFn:async e=>{let{collectionUuid:t,link:a,reason:l}=e,{data:r,error:s}=await n.By.POST("/rest/collections/focused_web_config/links",l,{timeoutMs:(0,n.e4)(),body:{collection_uuid:t,link:a},numRetries:1});if(s)throw new i.T("API_CLIENTS_ERROR",{cause:s,details:{reason:l}});return r},onSettled:(e,t,a,l)=>{o.invalidateQueries({queryKey:["get_collection",{collection_slug:a.collectionSlug.slice(-22)}]})}}),{mutate:J}=(0,s.useMutation)({mutationFn:async e=>{let{collectionUuid:t,link:a,reason:l}=e;await n.By.DELETE("/rest/collections/focused_web_config/links",l,{body:{collection_uuid:t,link:a},timeoutMs:(0,n.e4)(),numRetries:1})},onSettled:(e,t,a,l)=>{o.invalidateQueries({queryKey:["get_collection",{collection_slug:a.collectionSlug.slice(-22)}]})}});return(0,l.useMemo)(()=>({updateCollectionInfo:A,updateCollectionAccessLevel:E,createCollectionForThread:S,createCollection:O,bookmarkFromFeed:D,removeBookmarkFromFeed:V,firstTimeBookmark:K,swapThreadCollection:W,removeThreadFromCollection:Y,deleteCollection:X,addLink:Z,removeLink:J}),[Z,D,S,O,X,K,V,J,Y,W,E,A])}},53175:(e,t,a)=>{"use strict";a.d(t,{l:()=>o});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(12839);let o=r.memo(e=>{var t;let{children:a,header:r,fullBleed:s,roundedClass:o,shadow:d,fullBleedBorderClassname:c,...u}=e;return(0,l.jsxs)(l.Fragment,{children:[r,(0,l.jsxs)(n.Ay,{...u,variant:null!==(t=u.variant)&&void 0!==t?t:"raised",className:i()("relative",{border:!s&&!u.variant,[o||"rounded-xl"]:!u.variant,"shadow-[0_1px_2px_0_rgba(0,0,0,0.03)]":d},u.className),children:[s&&(0,l.jsx)("div",{className:i()("rounded-inherit pointer-events-none absolute inset-0 z-[1] border border-[black]/5 dark:border-[white]/5",c)}),a]})]})});o.displayName="CanonicalCard"},53220:(e,t,a)=>{"use strict";a.d(t,{Us:()=>S});var l=a(25576),r=a(85860),s=a(77917),i=a(67121),n=a(2241),o=a(46129);let d=(0,a(42972).G)();var c=a(94921),u=a(96983),m=a(57874),p=a(343),h=a(3889),v=a(55179),g=a(3041),f=a(66516);let y=Object.freeze([]);function x(e,t){return t?e.streams[t]:void 0}function b(e,t,a){var l;let r=e.middlewares.reduce((e,t)=>t(e),a);if(!r)return{newState:e};let s=x(e,t);if(!s||!e.activeStreams.includes(t))return{newState:e};let o=r.context_uuid,d=r.backend_uuid,c=r.uuid,u=!(s.entryId&&s.isReconnect&&e.erroredStreams[s.entryId])&&(!s.threadId||!s.entryId);if("DEFAULT_SEARCH_PLACEHOLDER"===d||d===n.P)return{newState:{streams:{...e.streams,[t]:{...s,placeholderChunk:r}}}};if(r.status===i.nW.PENDING&&(null===(l=r.blocks)||void 0===l?void 0:l.length)===0||r.status===i.nW.RESUMING)return{newState:{...w(e,r,{isFirstMessage:u,placeholderChunk:s.placeholderChunk,streamId:s.id.description}),streams:{...e.streams,[t]:{...s,threadId:r.context_uuid,entryId:d,extraEntryId:c,placeholderChunk:r}}},ingested:r};if(!o||!d)return{newState:e};let m=s;return u&&(m={...s,threadId:o,entryId:d,extraEntryId:c}),{newState:{...w(e,r,{isFirstMessage:u,placeholderChunk:s.placeholderChunk,streamId:s.id.description}),streams:{...e.streams,[t]:m}},ingested:r}}function w(e,t,a){let{isFirstMessage:l,placeholderChunk:r,streamId:s}=a,n=t.context_uuid,d=t.backend_uuid,c=Array.from(e.threads),u={...e.entries};if(c.length>=100){let e=c.shift();if(e)for(let t of e.entryIds)delete u[t]}let m=c.findIndex(e=>e.id===n),p=c[m];if(p?p.entryIds.includes(d)||(c[m]={...p,entryIds:[...p.entryIds,d]}):c.push({id:n,entryIds:[d]}),t.status===i.nW.COMPLETED)u[d]=t;else if(t.blocks){var h,v,g,f,x,b;let e=u[d];e&&e.uuid!==t.uuid?e=r:e||(e=r);let a=null!==(v=null!==(h=null==e?void 0:e.frontend_context_uuid)&&void 0!==h?h:t.frontend_context_uuid)&&void 0!==v?v:s,i=null!==(f=null!==(g=null==e?void 0:e.frontend_uuid)&&void 0!==g?g:t.frontend_uuid)&&void 0!==f?f:s,n=null!==(x=null==e?void 0:e.query_str)&&void 0!==x?x:t.query_str,c=(null==e?void 0:e.connector_auth_info)!=null&&!("connector_auth_info"in t)&&!l,m={...null!=e?e:{},...t,frontend_context_uuid:a,frontend_uuid:i,query_str:n,...c&&{connector_auth_info:void 0},blocks:function(e,t){let a=new Map(e.map(e=>[e.intended_usage,e]));for(let e of t)if(e.diff_block){var l,r;let t=e.diff_block.field,s=null!==(r=null===(l=a.get(e.intended_usage))||void 0===l?void 0:l[t])&&void 0!==r?r:{},i=(0,o.X6)(s,e.diff_block.patches,!1,!1).newDocument;a.set(e.intended_usage,{intended_usage:e.intended_usage,[t]:i})}else a.set(e.intended_usage,e);return Array.from(a.values())}(l?y:null!==(b=null==e?void 0:e.blocks)&&void 0!==b?b:y,t.blocks)};u[d]=m}return{threads:c,entries:u}}let _=Object.freeze([e=>e?(0,c.A)(e,e=>null!=e):e]),M=(e,t)=>({threads:[],entries:{},activeStreams:[],erroredStreams:{},middlewares:_,streamTimers:{},streams:{},actions:{abortStream:t=>{e(e=>{let a=e.activeStreams,l=x(e,t);if(l){try{var r;null===(r=l.abortController)||void 0===r||r.abort("Forced abort")}catch(e){g.vF.error("Failed to abort stream",e)}finally{a=a.filter(e=>e!==t)}return{activeStreams:a,streams:{...e.streams,[t]:{...l,promise:null,abortController:null}}}}return e},void 0,"abortStream")},getEntryById:e=>t().entries[e],createStream:e=>t().actions.createBackwardsCompatibleStream(e,{reason:"create-stream",timer:(0,f.Ip)(void 0,{nowFromTimeOrigin:performance.now()})}).id,retryStream:a=>{var l;let r=t().entries[a];if(!r)return;let s=t().erroredStreams[a];if(!s)return;let i=null===(l=s.placeholderChunk)||void 0===l?void 0:l.query_str;if(i){if(e(e=>{let{entries:t,threads:l}=e,{[a]:r,...s}=t,i=Array.from(l),n=l.findIndex(e=>e.entryIds.includes(a));return -1===n?e:(i.splice(n,1,{id:i[n].id,entryIds:i[n].entryIds}),{threads:i,entries:s})}),!function(e){return!!e&&!e.resume_entry_uuid}(s.params))throw Error("Stream params are not SubmitParams so cannot retry");return t().actions.createBackwardsCompatibleStream({query_str:i,params:{...s.params,existing_entry_uuid:a,query_source:"retry",frontend_context_uuid:r.frontend_context_uuid}},{placeholderChunk:s.placeholderChunk,timer:(0,f.Ip)(void 0,{nowFromTimeOrigin:performance.now()}),reason:"retry-stream"})}},reconnectStream:a=>{let l=function(e,t){let a=Object.values(e.streams),l=a.length;for(let r=l-1;r>=0;r--){let l=a[r];if(l.entryId===t&&e.activeStreams.includes(l.id.description))return l}}(t(),a);if(l&&l.promise&&l.abortController&&!l.abortController.signal.aborted)return l.id;let r=t().entries[a],s=null==r?void 0:r.cursor,n=t().actions.createBackwardsCompatibleStream({query_str:"",params:{resume_entry_uuid:a,cursor:s}},{isReconnect:!0,timer:(0,f.Ip)(void 0,{nowFromTimeOrigin:performance.now()}),reason:"reconnect-stream"});return e(e=>b(e,n.id.description,{...r,status:i.nW.PENDING}).newState,void 0,"ingestPlaceholderChunk"),n.id},createBackwardsCompatibleStream:(a,l)=>{var r,n,o,c,u,m,p,f,w,_;let{isReconnect:M,placeholderChunk:C,onFinalResponse:j,onFirstMessageReceived:A,timer:E,reason:S}=l,k=Array.from(t().activeStreams),N={...t().streams};if(k.length>=50)try{let e=k.shift();e&&(null===(f=N[e])||void 0===f||null===(p=f.abortController)||void 0===p||p.abort(),N[e]={...N[e],promise:null,abortController:null})}catch(e){g.vF.error("Failed to abort stream",e)}let T=null!==(w=null===(r=a.params)||void 0===r?void 0:r.frontend_uuid)&&void 0!==w?w:crypto.randomUUID(),I=new AbortController,R={id:{description:T},promise:Promise.resolve(),abortController:I,isReconnect:M,entryId:null===(n=a.params)||void 0===n?void 0:n.resume_entry_uuid,params:a.params,timer:E},P={message:async a=>{let l=x(t(),T),r=!1;if((null==l?void 0:l.threadId)||(r=!0,null==A||A(a)),e(e=>{let{newState:t,ingested:r}=b(e,T,a);if((null==r?void 0:r.status)===i.nW.COMPLETED&&(null==j||j(r)),(null==r?void 0:r.status)===i.nW.FAILED&&l&&l.entryId){let{promise:a,abortController:r,...s}=l;return{...t,erroredStreams:{...e.erroredStreams,[l.entryId]:s}}}return t},void 0,"ingest"),l){var s;d.emit("progress",{stream:l,message:null!==(s=t().entries[a.backend_uuid])&&void 0!==s?s:a,isFirstMessage:r})}}},O=(null===(o=a.params)||void 0===o?void 0:o.query_source)==="default_search",D={[v.kC]:T};return g.vF.info("Starting stream",{request_id:T}),R.promise=(M?s.By.SSE("/rest/sse/perplexity_ask/reconnect/{resume_entry_uuid}",S,{path:{resume_entry_uuid:null!==(_=null===(c=a.params)||void 0===c?void 0:c.resume_entry_uuid)&&void 0!==_?_:""},params:{cursor:null===(u=a.params)||void 0===u?void 0:u.cursor},signal:I.signal,handlers:P,headers:D}):s.By.SSE("/rest/sse/perplexity_ask",S,{params:{...a,params:{...a.params,version:"2.18"}},signal:I.signal,handlers:P,metrics:{omnisearch:O},timer:E,headers:D})).then(()=>(function(e,t){var a;let l=x(e,t);if(!l)return;let r=e.threads.find(e=>e.id===l.threadId);d.emit("completed",{stream:l,thread:(null!==(a=null==r?void 0:r.entryIds.map(t=>e.entries[t]))&&void 0!==a?a:y).filter(e=>null!=e),message:l.entryId?e.entries[l.entryId]:void 0})})(t(),T),a=>{let l=x(t(),T);l&&(e(e=>(function(e,t,a){g.vF.error("Error in reading stream",a);let l=x(e,t);if(!l)return e;let r=null==l?void 0:l.entryId;if(!r)return e;let s={...e.entries[r],status:i.nW.FAILED},{promise:n,abortController:o,...d}=l;return{erroredStreams:{...e.erroredStreams,[r]:{...d,code:a instanceof h.W?a.code:void 0}},entries:{...e.entries,[r]:s}}})(e,T,a),void 0,"handleStreamError"),d.emit("error",{stream:l,error:a}))}).finally(()=>{e(e=>{let{activeStreams:t,streams:a}=e;return{streams:{...a,[T]:{...a[T],promise:null,abortController:null}},activeStreams:t.filter(e=>e!==T)}},void 0,"cleanupBackwardsCompatibleStream")}),k.push(T),e({activeStreams:k,streams:{...N,[T]:R}},void 0,"createBackwardsCompatibleStream"),d.emit("created",{stream:R,query:a.query_str,params:a.params}),null===(m=R.abortController)||void 0===m||m.signal.addEventListener("abort",()=>{d.emit("aborted",{stream:R})}),C&&e(e=>b(e,T,C).newState,void 0,"ingestPlaceholderChunk"),R},setMiddlewares:t=>{e(()=>({middlewares:[..._,...t]}))}}}),C=(0,u.Rv)("StreamStateContext",()=>(0,m.v)()((0,p.lt)((0,p.eh)(M),{name:"StreamStore"})));C.useSelector;let j=C.useStore,A=()=>{let e=j(),t=(0,r.useMemo)(()=>(function(e,t){let a={minuteCount:0,hourCount:0,minuteWindow:Math.floor(Date.now()/6e4),hourWindow:Math.floor(Date.now()/36e5)};return async function(){for(var l=arguments.length,r=Array(l),s=0;s<l;s++)r[s]=arguments[s];let i=Date.now(),n=Math.floor(i/6e4),o=Math.floor(i/36e5);return(n!==a.minuteWindow&&(a.minuteCount=0,a.minuteWindow=n),o!==a.hourWindow&&(a.hourCount=0,a.hourWindow=o),a.minuteCount>=t.perMinute||a.hourCount>=t.perHour)?{allowed:!1}:(a.minuteCount++,a.hourCount++,{allowed:!0,result:await e(...r)})}})(e.getState().actions.reconnectStream,{perMinute:20,perHour:120}),[e]);return(0,r.useEffect)(()=>{function a(){let a=e.getState(),l=new Set(a.activeStreams),r=new Set(Object.values(a.streams).filter(e=>l.has(e.id.description)).map(e=>e.entryId));Object.values(a.entries).forEach(e=>{(null==e?void 0:e.reconnectable)&&l.size<50&&!r.has(null==e?void 0:e.backend_uuid)&&t(e.backend_uuid)})}a();let l=setInterval(a,1e3);function r(){clearInterval(l),a(),l=setInterval(a,1e3)}function s(){clearInterval(l)}return window.addEventListener("online",r,!0),window.addEventListener("offline",s,!0),()=>{clearInterval(l),window.removeEventListener("online",r,!0),window.removeEventListener("offline",s,!0)}},[t,e]),null};r.memo(e=>{let{children:t}=e;return(0,l.jsxs)(C.Provider,{children:[(0,l.jsx)(A,{}),t]})}).displayName="StreamStateProvider";let E=()=>j(),S=()=>{let e=E();return(0,r.useCallback)(function(t,a){let{terminateStream:l=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t&&e.setState(e=>{if(!t)return e;(function(e,t){let a=Object.values(e.streams),l=a.length;for(let r=l-1;r>=0;r--){let l=a[r];if(l.threadId===t&&e.activeStreams.includes(l.id.description))return l}})(e,t)&&l&&g.vF.error("Attempting to mutate entries while stream is active");let r=e.threads.findIndex(e=>e.id===t);if(-1===r)return e;let s=e.threads[r];if(!s)return e;let i=s.entryIds.map(t=>e.entries[t]).filter(e=>null!=e),n=null==a?void 0:a(i);if(!n)return e;let o=Array.from(e.threads);return o.splice(r,1,{...s,entryIds:n.map(e=>e.backend_uuid)}),{...e,entries:{...e.entries,...n.reduce((e,t)=>(e[t.backend_uuid]=t,e),{})},threads:o}},void 0,"mutateEntries")},[e])};r.memo(e=>{let{middlewares:t}=e,a=E();return(0,r.useLayoutEffect)(()=>{a.getState().actions.setMiddlewares(t)},[t,a]),null}).displayName="MiddlewareRegistry"},53511:(e,t,a)=>{"use strict";a.d(t,{N:()=>q,Q:()=>H});var l=a(25576),r=a(85860),s=a(83081),i=a(70714),n=a(57023),o=a(64299),d=a.n(o),c=a(89412),u=a(12839),m=a(60410),p=a(28554),h=a(26085),v=a(40027),g=a(38683),f=a(60010),y=a(49960),x=a(7450),b=a(27773);let w=(0,b.w)({path:"M12 5l0 14 M18 11l-6 -6 M6 11l6 -6",name:"IconArrowUp",variant:"stroked"});var _=a(12422);let M={outOfDate:(0,n.zR)({defaultMessage:"Out of date",id:"osuyeDna3D"}),inaccurate:(0,n.zR)({defaultMessage:"Inaccurate",id:"nzRZzFiqUd"}),irrelevant:(0,n.zR)({defaultMessage:"Irrelevant",id:"yi63oZJMHr"}),upToDate:(0,n.zR)({defaultMessage:"Up to date",id:"aOfyGCCmT0"}),accurate:(0,n.zR)({defaultMessage:"Accurate",id:"wrxp13nnhA"}),relevant:(0,n.zR)({defaultMessage:"Relevant",id:"XpZsjM22T8"}),successToast:(0,n.zR)({defaultMessage:"Thank you for your detailed feedback!",id:"ZrHT928df5"}),positivePrompt:(0,n.zR)({defaultMessage:"What did you like about this memory? (optional)",id:"xNH2PHiuYB"}),negativePrompt:(0,n.zR)({defaultMessage:"What didn't you like about this memory? (optional)",id:"gEOv/lEKfP"}),placeholder:(0,n.zR)({defaultMessage:"Add specific details",id:"HY/Q6ifj24"})},C={out_of_date:M.outOfDate,inaccurate:M.inaccurate,irrelevant:M.irrelevant},j={up_to_date:M.upToDate,accurate:M.accurate,relevant:M.relevant},A=r.memo(e=>{let{type:t,message:a,onFeedbackClick:i}=e,n=(0,s.A)().formatMessage,o=(0,r.useCallback)(()=>{i(t)},[t,i]);return(0,l.jsx)(p.A,{size:"small",variant:"common",text:n(a),onClick:o,extraCSS:"w-full justify-start text-left"})});A.displayName="FeedbackOption";let E=r.memo(e=>{let{isPositive:t,onFeedbackClick:a,onFreeformVisible:s}=e,i=t?j:C,n=(0,r.useMemo)(()=>Object.entries(i).map(e=>{let[t,r]=e;return(0,l.jsx)(A,{type:t,message:r,onFeedbackClick:a},t)}),[i,a]);return(0,l.jsxs)("div",{className:"gap-sm flex flex-col",children:[n,(0,l.jsx)(p.A,{size:"small",variant:"common",text:"Other...",onClick:s,extraCSS:"w-full justify-start text-left"})]})});E.displayName="FeedbackOptions";let S=r.memo(e=>{let{onSubmit:t,feedbackState:a,setFeedbackState:i,onDismiss:n,isPositive:o}=e,{deprecatedOpenToast:p}=(0,f.G)(),b=(0,s.A)().formatMessage,{isMobileStyle:C,isMobileUserAgent:j}=(0,g.al)(),[A,S]=(0,r.useState)(!1),k=(0,r.useCallback)(()=>{p(b(M.successToast),"success",2)},[p,b]),N=(0,r.useCallback)(e=>{k(),t(e)},[k,t]),T=(0,r.useCallback)(()=>{a&&N(a)},[a,N]),I=(0,r.useCallback)(e=>{let t={type:e};i(t),N(t)},[i,N]),R=(0,r.useCallback)(()=>{S(!1)},[S]),P=(0,r.useCallback)(()=>{S(!0)},[S]),O=(0,r.useCallback)(e=>{i({type:"comment",comment:e})},[i]),D=(0,r.useCallback)(e=>{y.g.isEnterKeyWithoutShift(e)&&T()},[T]),L=(0,r.useMemo)(()=>[{type:"button",buttonProps:{variant:"primary",size:"small",icon:w,onClick:T,disabled:!(null==a?void 0:a.comment),extraCSS:"aspect-square min-h-md h-md w-md",pill:!0}}],[T,null==a?void 0:a.comment]);return(0,l.jsx)("div",{className:"mt-lg animate-in fade-in w-full duration-500",children:(0,l.jsxs)(u.Ay,{className:"gap-sm p-md pt-sm relative flex w-full flex-col rounded-md border",children:[(0,l.jsx)("div",{className:d()("absolute bottom-full flex size-0 items-end",o?"left-2":"left-10"),children:(0,l.jsx)(u.Ay,{variant:"background",className:"size-3 shrink-0 origin-bottom-left rotate-45 border border-b-0 border-r-0"})}),(0,l.jsxs)("div",{className:d()("ease-outExpo flex items-center pr-8 duration-150",{"pl-4":A}),children:[(0,l.jsx)(h.A,{size:"tiny",onClick:R,pill:!0,icon:x.G,extraCSS:d()("!absolute duration-150",{"opacity-0 pointer-events-none":!A,"top-xs left-xs":A})}),(0,l.jsx)(m.A,{variant:"small",color:"light",children:o?b(M.positivePrompt):b(M.negativePrompt)})]}),(0,l.jsx)(c.bL,{mode:"popLayout",transition:{duration:.2,ease:c.lu},children:(0,l.jsx)(c.q7,{initial:{opacity:0,x:A?10:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:A?-10:10},transition:{duration:.2,ease:c.lu},children:A?(0,l.jsx)("div",{className:"gap-x-sm flex items-end",children:(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)(v.A,{className:"pr-md w-full",placeholder:b(M.placeholder),value:(null==a?void 0:a.comment)||"",minRows:3,isOptional:!0,onChange:O,onKeyDown:D,autoFocus:!0,isMobileStyle:C,isMobileUserAgent:j,rightItems:L})})}):(0,l.jsx)(E,{isPositive:o,onFeedbackClick:I,onFreeformVisible:P})},A?"visible":"hidden")}),(0,l.jsx)(h.A,{size:"tiny",onClick:n,pill:!0,icon:_.M,extraCSS:"!absolute top-xs right-xs"})]})})});S.displayName="MemoryFeedbackInput";var k=a(80892),N=a(71825),T=a(51244),I=a(17147),R=a(1407),P=a(75546),O=a(40578);let D=(0,b.w)({path:"M13 21.008a3 3 0 0 0 2.995 -2.823l.005 -.177v-4h2a3 3 0 0 0 2.98 -2.65l.015 -.173l.005 -.177l-.02 -.196l-1.006 -5.032c-.381 -1.625 -1.502 -2.796 -2.81 -2.78l-.164 .008h-8a1 1 0 0 0 -.993 .884l-.007 .116l.001 9.536a1 1 0 0 0 .5 .866a2.998 2.998 0 0 1 1.492 2.396l.007 .202v1a3 3 0 0 0 3 3z M5 14.008a1 1 0 0 0 .993 -.883l.007 -.117v-9a1 1 0 0 0 -.883 -.993l-.117 -.007h-1a2 2 0 0 0 -1.995 1.852l-.005 .15v7a2 2 0 0 0 1.85 1.994l.15 .005h1z",name:"IconThumbDownFilled",variant:"filled"});var L=a(21615);let U=(0,b.w)({path:"M13 3a3 3 0 0 1 2.995 2.824l.005 .176v4h2a3 3 0 0 1 2.98 2.65l.015 .174l.005 .176l-.02 .196l-1.006 5.032c-.381 1.626 -1.502 2.796 -2.81 2.78l-.164 -.008h-8a1 1 0 0 1 -.993 -.883l-.007 -.117l.001 -9.536a1 1 0 0 1 .5 -.865a2.998 2.998 0 0 0 1.492 -2.397l.007 -.202v-1a3 3 0 0 1 3 -3z M5 10a1 1 0 0 1 .993 .883l.007 .117v9a1 1 0 0 1 -.883 .993l-.117 .007h-1a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-7a2 2 0 0 1 1.85 -1.995l.15 -.005h1z",name:"IconThumbUpFilled",variant:"filled"});var F=a(49427),z=a(72811);let B=e=>{if(!e)return;let t=e.split("/").filter(Boolean);return t.length>0?t[t.length-1]:void 0},H=e=>{var t,a;let l=e.is_memory?"memory":"conversation_history",r=e.is_memory?e.url:void 0,s=e.is_conversation_history?B(e.url):void 0;return{snippet:e.snippet,url:null!==(t=e.url)&&void 0!==t?t:"",title:e.name,type:l,memoryKey:r,entryUuid:s,timestamp:null!==(a=e.timestamp)&&void 0!==a?a:""}},q=r.memo(e=>{let{isOpen:t,onClose:a,snippet:n,type:o,url:d,memoryKey:c,entryUuid:p,title:v,timestamp:f}=e,{formatDate:y}=(0,s.A)(),x=(0,g.tT)(),b="conversation_history"===o,{trackEvent:w}=(0,k.yw)(),{openStackedModal:_}=(0,T.u)(),M=(0,r.useCallback)(()=>{w("navigated to manage memory",{memory_key:c}),_("memoryListModal",{isMemoryEnabled:!0})},[c,w,_]),C=(0,r.useMemo)(()=>(0,l.jsx)(m.A,{variant:"small",children:(0,l.jsx)(i.A,{defaultMessage:"Manage",id:"0AzlrbMWV9"})}),[]),j=(0,r.useMemo)(()=>(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(F.e,{icon:b?P.q:R.b}),(0,l.jsx)(m.A,{variant:"baseSemi",children:b?(0,l.jsx)(i.A,{defaultMessage:"Library",id:"StcK672jB9"}):(0,l.jsx)(i.A,{defaultMessage:"Memory",id:"dVx3yznM2C"})})]}),[b]);return(0,l.jsxs)(I.A,{variant:x?"bottom-sheet":"side-sheet",isOpen:t,onClose:a,modalClassname:"md:!max-w-[400px] md:!min-w-[400px]",modalContentClassname:"justify-between",titleContent:j,children:[(0,l.jsxs)(u.Ay,{className:"flex size-full flex-col items-start",children:[v&&f&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.A,{variant:"baseSemi",children:v}),(0,l.jsx)(m.A,{variant:"tinyRegular",color:"light",className:"pb-sm",children:y(f,{dateStyle:"long"})})]}),(0,l.jsxs)("div",{className:"inline",children:[(0,l.jsx)(m.A,{variant:"small",className:"inline",children:n}),(0,l.jsx)(m.A,{variant:"smallBold",className:"ml-1 inline",color:"super",children:b&&(0,l.jsx)(z.N,{href:d,target:"_blank",rel:"noopener",className:"whitespace-nowrap",children:(0,l.jsx)(i.A,{defaultMessage:"See more",id:"yoLwRWw99S"})})})]}),b&&(0,l.jsx)(G,{entryUuid:null!=p?p:"",memoryKey:null!=c?c:"",type:o})]}),"memory"===o&&(0,l.jsxs)(u.Ay,{className:"flex w-full items-center justify-center gap-1",children:[(0,l.jsx)(m.A,{variant:"small",className:"inline",color:"light",children:(0,l.jsx)(i.A,{defaultMessage:"See all your memories.",id:"h0JAuR900y"})}),(0,l.jsx)(h.A,{onClick:M,size:"small",variant:"common",noPadding:!0,text:C})]})]})});q.displayName="MemorySearchHistoryModal";let G=r.memo(e=>{let{entryUuid:t,memoryKey:a,type:n}=e,o="feedback-container",{$t:d}=(0,s.A)(),c=(0,r.useMemo)(()=>{let e=B(window.location.pathname);if(e)return e.split("-").pop()},[]),{mutate:u}=(0,N.P4)({entryUuid:null!=t?t:"",reason:o}),{trackEvent:p}=(0,k.yw)(),{data:v}=(0,N.nU)({entryUuid:null!=t?t:"",enabled:!!t&&"conversation_history"===n,reason:o}),[g,f]=(0,r.useState)(!1),[y,x]=(0,r.useState)(!1),[b,w]=(0,r.useState)(null),_=(0,r.useMemo)(()=>"conversation_history"===n?v:void 0,[n,v]),M=(0,r.useCallback)((e,a)=>{"conversation_history"===n&&t&&u({shouldForget:e,feedback:a,feedbackEntryUuid:c})},[n,t,u,c]),C=(0,r.useCallback)(e=>{p("memory search history feedback",{type:n,isHelpful:!e,..."conversation_history"===n&&{entry_uuid:t},..."memory"===n&&{memory_key:a}}),M(e),x(!e),f(!0)},[n,t,a,p,M]),j=(0,r.useCallback)(()=>{if(!1===_){M(null),f(!1);return}C(!1)},[_,M,C]),A=(0,r.useCallback)(()=>{if(!0===_){M(null),f(!1);return}C(!0)},[_,M,C]),E=(0,r.useCallback)(e=>{M(!y,"comment"===e.type?e.comment:e.type),p("memory search history feedback",{type:n,isHelpful:y,..."conversation_history"===n&&{entry_uuid:t},..."memory"===n&&{memory_key:a}}),f(!1),w(null)},[n,t,a,p,y,M]),T=(0,r.useCallback)(()=>{f(!1),w(null)},[]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(h.A,{size:"small",icon:V(null!=_?_:null),onClick:j,toolTip:d({defaultMessage:"Helpful",id:"5vwKkgYwrE"}),pill:!0}),(0,l.jsx)(h.A,{size:"small",icon:Q(null!=_?_:null),onClick:A,toolTip:d({defaultMessage:"Not helpful",id:"04tuTF23S7"}),pill:!0})]}),!0===_&&(0,l.jsx)(m.A,{variant:"tinyRegular",color:"light",children:(0,l.jsx)(i.A,{defaultMessage:"This {type} will not be referenced in future searches.",id:"167AKZjMm1",values:{type:"memory"===n?"memory":"entry"}})}),g&&(0,l.jsx)(S,{onSubmit:E,feedbackState:b,setFeedbackState:w,onDismiss:T,isPositive:y})]})});G.displayName="FeedbackContainer";let Q=e=>null===e?O.k:!0===e?D:O.k,V=e=>null===e?L.p:!1===e?U:L.p},54192:(e,t,a)=>{"use strict";a.d(t,{w:()=>m});var l=a(85860),r=a(74251);let s=()=>{let{isGovernmentRequestOrigin:e}=(0,r.h)();return void 0===e};var i=a(89334),n=a(16672);let o=()=>"firefox"===(0,n.by)()||"firefox"===new URL(window.location.href).searchParams.get("pc"),d="partnerships",c=()=>(0,n.wK)()===d||new URL(window.location.href).searchParams.get("utm_source")===d;var u=a(26941);let m=(0,l.memo)(e=>{let{isSamsungBrowser:t,isWindowsApp:a,isComet:n,isFirefoxDefaultSearch:d,isPartnershipCampaign:m,isGovernment:p,children:h}=e,v=(0,i.EJ)(),g=o(),f=c(),{isGovernmentRequestOrigin:y}=(0,r.h)(),{device:{isWindowsApp:x,isSamsungBrowser:b}}=(0,u.L)(),w=s();return(0,l.useMemo)(()=>!!n&&!!v||!!a&&!!x||!!t&&!!b||!!d&&!!g||!!m&&!!f||!!p&&(!!w||!!y)||!1,[v,x,b,n,t,a,d,g,m,f,p,y,w])?null:h});m.displayName="OmitUpsellIf"},57162:(e,t,a)=>{"use strict";a.d(t,{k:()=>l});let l=(0,a(27773).w)({path:"M9 3a1 1 0 0 1 .608 .206l.1 .087l2.706 2.707h6.586a3 3 0 0 1 2.995 2.824l.005 .176v8a3 3 0 0 1 -2.824 2.995l-.176 .005h-14a3 3 0 0 1 -2.995 -2.824l-.005 -.176v-11a3 3 0 0 1 2.824 -2.995l.176 -.005h4z",name:"IconFolderFilled",variant:"filled"})},57346:(e,t,a)=>{"use strict";a.d(t,{dr:()=>S,z9:()=>T});var l=a(25576),r=a(85860),s=a(83081),i=a(64299),n=a.n(i),o=a(6271),d=a(32014),c=a(18126),u=a(80892),m=a(20764),p=a(12839),h=a(60410),v=a(28554),g=a(86661),f=a(35052),y=a(38683),x=a(26941),b=a(69744),w=a(99390),_=a(41290),M=a(2928),C=a(36234),j=a(28566),A=a(49427);let E=(0,_.Q)(()=>a.e(2917).then(a.bind(a,42917)),{loading:()=>(0,l.jsx)(d.A,{})}),S=e=>{let{partnerCode:t,partnerConfig:a,title:i}=e,{$t:n}=(0,s.A)(),{trackEvent:d}=(0,u.yw)(),[,,g]=(0,c.jW)(),[,,_]=(0,c.q)(),{colorScheme:j,isColorSchemeReady:A}=(0,f.U)({addSecondPass:!0}),S=a.includeLogoPostSuccess,{handleAppDownloadClicked:T}=(0,o.D)(t);(0,r.useEffect)(()=>{g(),_()},[]);let{isMobileStyle:I}=(0,y.al)(),{device:{isAndroid:R}}=(0,x.L)(),{device:{isIOS:P}}=(0,x.L)(),O="";P?O=n({defaultMessage:"Get the iPhone App",id:"ttTk7IUNum"}):R?(P=!1,O=n({defaultMessage:"Get the Android App",id:"crUUBQHuzK"})):(P=!0,O=n({defaultMessage:"Get the iPhone App",id:"ttTk7IUNum"}));let D=n(I?P?{defaultMessage:"Install the iPhone App now",id:"/rikjY3+pd"}:{defaultMessage:"Install the Android App now",id:"Q/j4jx/lAa"}:{defaultMessage:"Get the app now",id:"0mvMmKRm8c"}),L=I?void 0:n({defaultMessage:"Visit the App Store, Google Play, or scan with your phone to download instantly",id:"SDmwL2YRZ4"}),U=P?M.P:C.A,F=A?(0,l.jsx)("img",{src:"https://r2cdn.perplexity.ai/partner-logos/".concat(t,"/logo-").concat("dark"===j?"dark":"light",".svg"),alt:"",className:"h-[44px]"}):null;return(0,l.jsx)(p.Ay,{variant:"background",children:(0,l.jsx)("div",{className:"md:-mt-md",children:(0,l.jsx)(m.A,{title:null!=i?i:D,logo:S?F:(0,l.jsx)(b.g,{variant:"text",isPro:!0}),subtitle:L,showStepIndicator:!1,continueButtonProps:I?void 0:{onClick:()=>{(0,w.x)("/","Partner success get app")},size:I?"small":void 0,variant:"common"},headerClassName:"!flex gap-md justify-between",children:(0,l.jsxs)("div",{className:"gap-md flex flex-col md:flex-row",children:[(0,l.jsxs)(p.Ay,{variant:"background",className:"gap-sm pt-md md:gap-lg md:p-lg flex w-full flex-col items-center justify-center border-t md:rounded-lg md:border md:shadow-sm",children:[(0,l.jsx)(N,{showRatingBox:I}),(0,l.jsx)("div",{className:"flex-1"}),(0,l.jsxs)("div",{className:"gap-md flex w-full items-center justify-center",children:[(0,l.jsxs)("div",{className:"gap-sm flex w-full flex-col items-center",children:[(0,l.jsx)(v.A,{fullWidth:I,size:"regular",pill:!0,variant:"primary",icon:U,text:I?O:n({defaultMessage:"Get the iPhone App",id:"ttTk7IUNum"}),extraCSS:"w-full",onClick:()=>{d("app download button clicked",{origin:"partner"}),T()}}),I&&(0,l.jsx)(v.A,{fullWidth:I,size:"regular",pill:!0,variant:"border",text:n({defaultMessage:"Continue in browser",id:"KZJqry9pah"}),extraCSS:"w-full",onClick:()=>{(0,w.x)("/","Partner success get app mobile")}}),!I&&(0,l.jsx)(k,{})]}),!I&&(0,l.jsxs)("div",{className:"gap-sm flex flex-col items-center",children:[(0,l.jsx)(v.A,{fullWidth:I,size:"regular",pill:!0,variant:"primary",icon:C.A,text:n({defaultMessage:"Get the Android App",id:"crUUBQHuzK"}),onClick:()=>{d("app download button clicked",{origin:"partner"}),T()},extraCSS:"w-full"}),(0,l.jsx)(k,{reviewCount:167,rating:4.7})]})]})]}),!I&&(0,l.jsxs)(p.Ay,{variant:"background",className:"gap-md p-lg flex w-full flex-col items-center justify-center rounded-lg rounded-b-md border shadow-sm",children:[(0,l.jsx)(E,{}),(0,l.jsx)("div",{className:"flex w-full items-center justify-center",children:(0,l.jsx)(h.A,{variant:"baseSemi",className:"text-center",children:n({defaultMessage:"Scan with your phone for a quick download",id:"Zq1CH1J8R7"})})})]})]})})})})},k=e=>{let{rating:t=4.9,reviewCount:a=52}=e,{$t:r}=(0,s.A)();return(0,l.jsxs)("div",{className:"mt-xs md:gap-sm flex flex-col items-start gap-0 md:flex-row md:items-center",children:[(0,l.jsxs)("div",{className:"text-attention gap-x-two flex items-center",children:[(0,l.jsx)(A.e,{icon:j.S,size:"xs"}),(0,l.jsx)(A.e,{icon:j.S,size:"xs"}),(0,l.jsx)(A.e,{icon:j.S,size:"xs"}),(0,l.jsx)(A.e,{icon:j.S,size:"xs"}),(0,l.jsx)(A.e,{icon:j.S,size:"xs"})]}),(0,l.jsxs)(g.b,{className:"gap-xs text-quiet md:translate-y-px",children:[(0,l.jsx)(g.q,{id:"rating",children:(0,l.jsx)(h.A,{variant:"tiny",color:"light",className:"pt-two block",children:t})}),(0,l.jsx)(g.q,{id:"count",children:(0,l.jsx)(h.A,{variant:"tiny",color:"light",className:"pt-two block",children:r({defaultMessage:"{amount} reviews",id:"OvgPOfiWBN"},{amount:"".concat(a,"K")})})})]})]})},N=e=>{let{showRatingBox:t=!0,platform:a,className:r}=e,{$t:i}=(0,s.A)(),{device:{isIOS:o,isAndroid:d}}=(0,x.L)(),c=null!=a?a:o||!d?"ios":"android";return(0,l.jsxs)("div",{className:n()("gap-md flex w-full items-center justify-start",r),children:[(0,l.jsx)(T,{displayAs:c}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.A,{variant:"baseSemi",children:"Perplexity"}),(0,l.jsx)(h.A,{variant:"small",color:"light",children:i({defaultMessage:"Search and discovery with AI",id:"n3oaAt293P"})}),t&&(0,l.jsx)(k,{rating:"ios"===c?4.9:4.8,reviewCount:"ios"===c?80:252})]})]})},T=e=>{let{displayAs:t,className:a,allowBgImage:s=!0}=e,i=["/static/images/app-icons/nasa.png","/static/images/app-icons/jungle.png","/static/images/app-icons/flower.png","/static/images/app-icons/sf.png","/static/images/app-icons/books.png","/static/images/app-icons/cat.png"],o=(0,r.useMemo)(()=>i[Math.floor(Math.random()*i.length)],[]);return(0,l.jsxs)("div",{className:n()("bg-dark relative inline-flex aspect-square size-20 items-center justify-center overflow-hidden shadow-lg",{"p-md rounded-[20px]":"ios"===t,"p-md rounded-full":"android"===t},a),children:[s&&(0,l.jsx)("img",{className:n()("absolute inset-0 opacity-50 duration-150"),src:o,suppressHydrationWarning:!0,alt:""}),(0,l.jsx)("div",{className:"relative flex items-center justify-center",children:(0,l.jsx)(b.g,{variant:"mark",size:"md",color:"white"})}),(0,l.jsx)("div",{className:"rounded-inherit absolute inset-0 border border-black/20 dark:border-white/10"})]})}},57833:(e,t,a)=>{"use strict";a.d(t,{wj:()=>c,XT:()=>m,VZ:()=>v,HS:()=>p,to:()=>u,rv:()=>o,V_:()=>d,z0:()=>h});var l=a(70852);(0,a(57023).YK)({STOCK_PRICE_TARGET:{defaultMessage:"Price Target",id:"GkDb3edsv4"},STOCK_PRICE_MOVEMENT:{defaultMessage:"Price Movement",id:"nccbHgYn+f"}});var r=a(77266),s=a(79756),i=a(83674),n=a(31049);function o(e){let{intl:t,triggerType:a}=e;switch(a){case l.Y.SCHEDULED:return t.formatMessage({defaultMessage:"Scheduled task",id:"dG8VrMkuAT"});case l.Y.PRICE_ALERT:return t.formatMessage({defaultMessage:"Price alert",id:"XMapyUiPpV"});case l.Y.SHORTCUT:return t.formatMessage({defaultMessage:"Shortcut",id:"tceWOrncgz"});default:(0,n.s)(a)}}function d(e){let{intl:t,triggerType:a,actionPerformed:r}=e,s=function(e){let{intl:t,actionPerformed:a}=e;switch(a){case"created":return t.formatMessage({defaultMessage:"created",id:"lr7wlbGcN2"});case"updated":return t.formatMessage({defaultMessage:"updated",id:"fM7xZh2bri"});case"paused":return t.formatMessage({defaultMessage:"paused",id:"onIpArq3j6"});case"resumed":return t.formatMessage({defaultMessage:"resumed",id:"NUz1enNtoA"});case"deleted":return t.formatMessage({defaultMessage:"deleted",id:"GBLHN+CxXe"});case"copied":return t.formatMessage({defaultMessage:"copied",id:"JZWZSAD5l1"});case"skipped":return t.formatMessage({defaultMessage:"skipped",id:"yrhXAwV22L"});default:(0,n.s)(a)}}({intl:t,actionPerformed:r});switch(a){case l.Y.SCHEDULED:return t.formatMessage({defaultMessage:"Task has been {actionDisplayName}",id:"dztI4FIBBf"},{actionDisplayName:s});case l.Y.PRICE_ALERT:return t.formatMessage({defaultMessage:"Price alert has been {actionDisplayName}",id:"ApBHuTxt1D"},{actionDisplayName:s});case l.Y.SHORTCUT:return t.formatMessage({defaultMessage:"Shortcut has been {actionDisplayName}",id:"oprPa0O7KY"},{actionDisplayName:s});default:(0,n.s)(a)}}function c(e){var t;return{trigger:{type:l.Y.SCHEDULED,schedule:e.schedule},query:{prompt:e.prompt,searchModel:e.searchModel,sources:null!==(t=e.sources)&&void 0!==t?t:v()},status:"ACTIVE",notificationSettings:i.w}}function u(e){var t,a,s,o,d,c,u,m,p,h;let{selectedTask:v}=e;if(!v||null===v.type)return null;switch(v.type){case"SCHEDULE":return{id:v.id,trigger:{type:l.Y.SCHEDULED,schedule:(0,r.ru)(v.scheduleInfo),expiryDate:v.expiryDate},query:{prompt:v.prompt,searchModel:v.searchModel,sources:v.sources},status:v.status,notificationSettings:null!==(t=v.notificationSettings)&&void 0!==t?t:i.w};case"ALERT":switch(null===(a=v.subscription)||void 0===a?void 0:a.event_type){case"STOCK_PRICE_TARGET":return{id:v.id,trigger:{type:l.Y.PRICE_ALERT,alertType:l.J.TARGET_PRICE,price:(null!==(s=v.subscription.value_lower_bound)&&void 0!==s?s:-1e9)<0?null!==(o=v.subscription.value_upper_bound)&&void 0!==o?o:1e9:null!==(d=v.subscription.value_lower_bound)&&void 0!==d?d:-1e9,currency:"usd",symbol:null!==(c=v.subscription.event_entity)&&void 0!==c?c:""},query:{prompt:v.prompt,searchModel:v.searchModel,sources:v.sources},status:v.status};case"STOCK_PRICE_MOVEMENT":return{id:v.id,trigger:{type:l.Y.PRICE_ALERT,alertType:l.J.MOVEMENT_AMOUNT,percentageDecimalLowerBound:(null!==(u=v.subscription.value_lower_bound)&&void 0!==u?u:0)/100,percentageDecimalUpperBound:(null!==(m=v.subscription.value_upper_bound)&&void 0!==m?m:0)/100,symbol:null!==(p=v.subscription.event_entity)&&void 0!==p?p:""},query:{prompt:v.prompt,searchModel:v.searchModel,sources:v.sources},status:v.status};default:throw Error("Unhandled subscription.event_type: "+(null===(h=v.subscription)||void 0===h?void 0:h.event_type))}case"SHORTCUT":return{id:v.id,trigger:{type:l.Y.SHORTCUT,shortcut:v.title},query:{prompt:v.prompt,searchModel:v.searchModel,sources:v.sources},status:v.status};default:(0,n.s)(v.type)}}function m(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return{trigger:{type:l.Y.SCHEDULED,schedule:(0,r.IN)()},query:{searchModel:e?s.Im.PRO:s.Im.DEFAULT,prompt:"",sources:v()},status:"ACTIVE",notificationSettings:i.w}}function p(){let{symbol:e=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{symbol:""};return{trigger:{type:l.Y.PRICE_ALERT,alertType:l.J.TARGET_PRICE,price:0,currency:"usd",symbol:e},query:{prompt:"",searchModel:s.Im.PRO,sources:v()},status:"ACTIVE"}}function h(e){if(e.trigger.type!==l.Y.SCHEDULED)return e;let t=(0,r.Bz)(e.query.searchModel,e.trigger.schedule),a=(0,r.Pe)({expiryDate:e.trigger.expiryDate,schedule:e.trigger.schedule,defaultExpiryDate:t});return e.id?{...e,trigger:{...e.trigger,expiryDate:a}}:{...e,trigger:{...e.trigger,schedule:{...e.trigger.schedule},expiryDate:a,defaultExpiryDate:t}}}function v(){return["web"]}},59584:(e,t,a)=>{"use strict";a.d(t,{G:()=>l});let l=(0,a(27773).w)({path:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0 M12 8v4 M12 16h.01",name:"IconAlertCircle",variant:"stroked"})},60380:(e,t,a)=>{"use strict";a.d(t,{S:()=>l});let l=(0,a(27773).w)({path:"M12.01 2.011a3.2 3.2 0 0 1 2.113 .797l.154 .145l.698 .698a1.2 1.2 0 0 0 .71 .341l.135 .008h1a3.2 3.2 0 0 1 3.195 3.018l.005 .182v1c0 .27 .092 .533 .258 .743l.09 .1l.697 .698a3.2 3.2 0 0 1 .147 4.382l-.145 .154l-.698 .698a1.2 1.2 0 0 0 -.341 .71l-.008 .135v1a3.2 3.2 0 0 1 -3.018 3.195l-.182 .005h-1a1.2 1.2 0 0 0 -.743 .258l-.1 .09l-.698 .697a3.2 3.2 0 0 1 -4.382 .147l-.154 -.145l-.698 -.698a1.2 1.2 0 0 0 -.71 -.341l-.135 -.008h-1a3.2 3.2 0 0 1 -3.195 -3.018l-.005 -.182v-1a1.2 1.2 0 0 0 -.258 -.743l-.09 -.1l-.697 -.698a3.2 3.2 0 0 1 -.147 -4.382l.145 -.154l.698 -.698a1.2 1.2 0 0 0 .341 -.71l.008 -.135v-1l.005 -.182a3.2 3.2 0 0 1 3.013 -3.013l.182 -.005h1a1.2 1.2 0 0 0 .743 -.258l.1 -.09l.698 -.697a3.2 3.2 0 0 1 2.269 -.944z",name:"IconRosetteFilled",variant:"filled"})},60760:(e,t,a)=>{"use strict";a.d(t,{_U:()=>n,ec:()=>i});var l=a(77150),r=a(77917);a(30002),a(67121);var s=a(3041);let i=async e=>{let{slugOrUUID:t,reason:a}=e,{error:s}=await r.By.POST("/rest/thread/request-access/{entry_uuid_or_slug}",a,{params:{path:{entry_uuid_or_slug:t}}});if(s)throw new l.T("API_CLIENTS_ERROR",{cause:s})},n=async e=>{let{entryUUID:t,reason:a}=e;try{let{error:e}=await r.By.POST("/rest/sse/perplexity_terminate",a,{headers:{"content-type":"application/json"},body:{entry_uuid:t},timeoutMs:(0,r.e4)({productionMs:5e3}),numRetries:1});if(e)return!1;return!0}catch(e){return s.vF.error("Failed to terminate entry",e),!1}}},61505:()=>{},62440:(e,t,a)=>{"use strict";a.d(t,{y:()=>n});var l=a(85860),r=a(97113),s=a(79756),i=a(24915);function n(){let{configuredModel:e,configuredSearchMode:t}=(0,r.y)();return(0,l.useMemo)(()=>t||(i.env.NEXT_PUBLIC_IS_SIDECAR_BUILD&&e===s.Im.DEFAULT?s.k0.SEARCH:s.o8[e]),[t,e])}},62492:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});let l=(0,a(27773).w)({path:"M4 7l16 0 M10 11l0 6 M14 11l0 6 M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12 M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",name:"IconTrash",variant:"stroked"})},62928:(e,t,a)=>{"use strict";a.d(t,{M:()=>v});var l=a(25576),r=a(70714),s=a(64299),i=a.n(s),n=a(35052);let o=()=>{let{colorScheme:e}=(0,n.U)(),t="dark"===e?"#E8E8E6":"#13343B";return(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"131",height:"20",viewBox:"0 0 131 20",fill:"none",children:[(0,l.jsx)("path",{d:"M31.4135 4.45415H32.3637V6.41655H31.1337C30.17 6.41655 29.4514 6.64885 28.9749 7.11501C28.5012 7.5796 28.2632 8.34407 28.2632 9.40653V15.8413H26.3219V4.49878H28.2632V6.30874C28.2632 6.41089 28.3144 6.46119 28.4141 6.46119C28.471 6.46119 28.5137 6.44704 28.5442 6.41781C28.5747 6.38826 28.6008 6.33105 28.6313 6.24272C29.005 5.05139 29.9345 4.45509 31.4147 4.45509H31.4135V4.45383V4.45415ZM44.328 6.88554C44.8376 7.79398 45.0937 8.88881 45.0937 10.1682C45.0937 11.4475 44.8388 12.5423 44.328 13.4508C43.8169 14.3592 43.1549 15.0394 42.342 15.4902C41.5292 15.941 40.6553 16.1663 39.7208 16.1663C37.8791 16.1663 36.5843 15.4245 35.8365 13.9405C35.7796 13.8242 35.7064 13.7654 35.6206 13.7654C35.5348 13.7654 35.4904 13.8088 35.4904 13.8971V19.9836H33.5488V4.49753H35.4904V6.43919C35.4904 6.52594 35.5332 6.57089 35.6206 6.57089C35.708 6.57089 35.7784 6.51337 35.8365 6.39581C36.5843 4.91214 37.8791 4.16999 39.7208 4.16999C40.6553 4.16999 41.5292 4.39537 42.342 4.84613C43.1549 5.29689 43.8156 5.97711 44.328 6.88554ZM43.1536 10.1682C43.1536 8.83003 42.7978 7.78706 42.0858 7.03831C41.3742 6.28925 40.4368 5.9155 39.2694 5.9155C38.1019 5.9155 37.1646 6.2905 36.4526 7.03831C35.7397 7.78706 35.4794 8.83129 35.4794 10.1682C35.4794 11.505 35.741 12.5493 36.4526 13.298C37.1646 14.0483 38.1032 14.4208 39.2694 14.4208C40.4356 14.4208 41.3742 14.0458 42.0858 13.298C42.7978 12.5505 43.1536 11.505 43.1536 10.1682ZM11.631 6.9022C12.1405 7.81064 12.3967 8.90547 12.3967 10.1848C12.3967 11.4642 12.1418 12.559 11.631 13.4674C11.1199 14.3759 10.4582 15.0564 9.64534 15.5069C8.83246 15.9576 7.9586 16.183 7.02408 16.183C5.18238 16.183 3.88763 15.4412 3.13982 13.9572C3.08324 13.8409 3.00968 13.7821 2.92387 13.7821C2.83806 13.7821 2.79373 13.8255 2.79373 13.9135V20H0.853333V4.51419H2.79468V6.45553C2.79468 6.54229 2.83743 6.58724 2.92481 6.58724C3.0122 6.58724 3.08261 6.52971 3.14076 6.41215C3.88857 4.92848 5.18332 4.18633 7.02502 4.18633C7.95986 4.18633 8.8334 4.41171 9.64628 4.86247C10.4592 5.31323 11.1196 5.99346 11.6319 6.90189H11.6304L11.631 6.9022ZM10.4551 10.1848C10.4551 8.84669 10.0992 7.80372 9.38758 7.05497C8.67561 6.30748 7.737 5.93216 6.57081 5.93216C5.40462 5.93216 4.46601 6.30716 3.75435 7.05497C3.04269 7.80529 2.78085 8.84826 2.78085 10.1848C2.78085 11.5214 3.04269 12.5659 3.75435 13.315C4.46601 14.0653 5.40367 14.4375 6.57081 14.4375C7.73794 14.4375 8.67561 14.0625 9.38758 13.315C10.0992 12.5675 10.4551 11.5217 10.4551 10.1848ZM22.8906 12.2384H24.94C24.6672 13.3008 24.1092 14.2203 23.2687 14.9973C22.4266 15.7756 21.222 16.1635 19.6532 16.1635C18.4735 16.1635 17.4349 15.9199 16.5362 15.4327C15.6375 14.9455 14.9438 14.2527 14.4534 13.3499C13.9634 12.4484 13.7195 11.3875 13.7195 10.1653C13.7195 8.94319 13.9577 7.88231 14.4311 6.98079C14.9048 6.07927 15.5709 5.3849 16.4265 4.89799C17.2825 4.41077 18.2849 4.16716 19.4357 4.16716C20.5865 4.16716 21.5405 4.40794 22.3379 4.88668C23.137 5.36667 23.7323 6.00383 24.1284 6.7947C24.5245 7.5884 24.7209 8.45628 24.7209 9.40118V10.7101H15.767C15.8375 11.8439 16.2172 12.747 16.8996 13.4146C17.5823 14.0839 18.5002 14.4183 19.6513 14.4183C20.5858 14.4183 21.3031 14.2266 21.7992 13.8402C22.2949 13.4539 22.6576 12.9205 22.889 12.2362L22.8902 12.239L22.8906 12.2384ZM15.7271 9.07616H22.5027C22.5027 8.08788 22.2506 7.31241 21.7467 6.75258C21.2428 6.194 20.4519 5.91267 19.3731 5.91267C18.3663 5.91267 17.5424 6.18552 16.9027 6.73152C16.2631 7.27595 15.8711 8.05865 15.7271 9.07616ZM46.6598 15.8388H48.6027V0.134216H46.6598V15.8401V15.8388ZM73.9643 3.25872H76.2329V0.803439H73.9643V3.25872ZM82.3405 14.1492C81.9878 14.1857 81.7743 14.2039 81.7042 14.2039C81.6043 14.2039 81.5222 14.1747 81.466 14.1156C81.4088 14.0581 81.3789 13.9786 81.3789 13.8748C81.3789 13.8035 81.3975 13.5878 81.4342 13.2311C81.4685 12.8755 81.488 12.3255 81.488 11.5849V6.15785H84.2573L83.7116 4.49627H81.4889V1.44154H79.5482V4.4947H77.4359V6.15628H79.5482V12.1277C79.5482 13.3791 79.8515 14.3102 80.4544 14.9203C81.0583 15.5308 81.9793 15.8372 83.2178 15.8372H84.7282V14.093H83.9722C83.2385 14.093 82.695 14.1112 82.3423 14.1477L82.3405 14.1492ZM94.0765 4.4947L90.8612 14.0134C90.8187 14.131 90.7502 14.2838 90.5308 14.2838C90.3114 14.2838 90.2413 14.1313 90.1976 14.0134L86.9823 4.49627H85.0023L88.7259 15.8391H90.043C90.1285 15.8391 90.1942 15.8476 90.2385 15.8614C90.2812 15.8756 90.3171 15.9117 90.3463 15.9705C90.4026 16.0573 90.3957 16.189 90.324 16.3625L89.7202 18.02C89.6331 18.2384 89.4681 18.3475 89.2248 18.3475C89.1377 18.3475 88.9368 18.3293 88.6206 18.2928C88.3037 18.2564 87.8954 18.2384 87.3915 18.2384H85.8155V19.9824H87.8869C89.0956 19.9824 89.8226 19.7752 90.4488 19.3609C91.0749 18.9466 91.5593 18.2158 91.9051 17.1691L95.9267 4.93194V4.49501L94.0791 4.49658L94.0765 4.49501V4.4947ZM67.3928 8.72756L64.35 4.49595H62.2138V4.93131L65.8595 9.83905L61.4141 15.4019V15.8372H63.594L67.1332 11.2781L70.4346 15.8372H72.5284V15.4019L68.6646 10.1666L72.8528 4.95363V4.49595H70.6729L67.3937 8.72756H67.3928ZM74.1708 15.8388H76.1134V4.49753H74.1708V15.8401V15.8388ZM61.3877 12.2384C61.1136 13.3008 60.5575 14.2203 59.717 14.9973C58.8746 15.7756 57.67 16.1635 56.1009 16.1635C54.9215 16.1635 53.8826 15.9199 52.9839 15.4327C52.0836 14.9455 51.3918 14.2527 50.9014 13.3499C50.4126 12.4484 50.1687 11.3875 50.1687 10.1653C50.1687 8.94319 50.407 7.88231 50.8807 6.98079C51.356 6.07927 52.0205 5.3849 52.8764 4.89799C53.7314 4.41077 54.7341 4.16716 55.8865 4.16716C57.0389 4.16716 57.9913 4.40794 58.79 4.88668C59.5878 5.36667 60.1851 6.00383 60.5805 6.7947C60.9769 7.5884 61.1733 8.45628 61.1733 9.40118V10.7101H52.2185C52.2905 11.8439 52.668 12.747 53.3514 13.4146C54.0338 14.0839 54.952 14.4183 56.1028 14.4183C57.0373 14.4183 57.7549 14.2266 58.2503 13.8402C58.7457 13.4539 59.1088 12.9205 59.3385 12.2362H61.3893L61.3877 12.239V12.2384ZM52.2238 9.07616H58.9994C58.9994 8.08788 58.7473 7.31241 58.245 6.75258C57.7401 6.194 56.9502 5.91267 55.8711 5.91267C54.864 5.91267 54.0407 6.18552 53.4007 6.73152C52.761 7.27595 52.3681 8.05865 52.2254 9.07616H52.2238Z",fill:t}),(0,l.jsx)("path",{d:"M109.711 6.18397C108.45 3.79906 104.857 3.23459 103.095 5.16726C103.042 5.22393 102.946 5.18615 102.946 5.108V4.35019H101.032V17.7181H102.946V12.6105C102.946 12.5324 103.041 12.4946 103.095 12.5513C103.761 13.2524 104.703 13.7187 105.902 13.7187C108.576 13.7361 110.416 11.5646 110.355 8.85889C110.355 7.81181 110.139 6.91178 109.711 6.1836V6.18397ZM108.442 8.85926C108.442 9.83708 108.181 10.7201 107.666 11.2638C106.733 12.3357 104.565 12.325 103.622 11.2638C102.616 10.2293 102.606 7.49884 103.622 6.47176C104.565 5.38838 106.731 5.37727 107.665 6.47028C108.182 7.00363 108.442 7.87996 108.442 8.85926H108.442Z",fill:t}),(0,l.jsx)("path",{d:"M121.863 17.7181H105.423V15.9321H121.863C123.1 15.9321 124.247 15.6562 125.272 15.1113C126.361 14.5387 127.257 13.6613 127.865 12.572L127.868 12.5668C128.472 11.5031 128.779 10.2556 128.779 8.85887C128.779 7.46215 128.473 6.2158 127.869 5.15243L127.866 5.14761C127.257 4.05757 126.361 3.17976 125.276 2.60899C124.247 2.0623 123.1 1.786 121.862 1.786H101.058V0H121.862C123.395 0 124.825 0.34668 126.111 1.03004C127.498 1.7597 128.645 2.8816 129.423 4.27276C130.18 5.608 130.564 7.15066 130.564 8.85887C130.564 10.5671 130.18 12.1112 129.422 13.4465C128.645 14.8365 127.498 15.958 126.107 16.6899C124.824 17.3714 123.395 17.7177 121.862 17.7177L121.863 17.7181Z",fill:t}),(0,l.jsx)("path",{d:"M125.575 6.23651C123.985 3.24676 119.005 3.25047 117.403 6.23762C116.999 6.96469 116.794 7.84658 116.794 8.85921C116.738 11.7156 118.683 13.7383 121.497 13.719C124.308 13.7387 126.248 11.6956 126.201 8.85921C126.201 7.84695 125.99 6.96469 125.574 6.23688L125.575 6.23651ZM124.287 8.85921C124.287 9.83703 124.026 10.72 123.512 11.2637C122.578 12.3356 120.41 12.3249 119.467 11.2637C118.461 10.2293 118.451 7.49878 119.467 6.47171C120.41 5.38833 122.576 5.37722 123.51 6.47022C124.027 7.00358 124.287 7.87991 124.287 8.85921H124.287Z",fill:t}),(0,l.jsx)("path",{d:"M115.62 4.21942C114.999 4.21942 114.5 4.32498 114.137 4.53351C113.922 4.65018 113.725 4.855 113.54 5.15353C113.494 5.22761 113.38 5.19539 113.38 5.10835V4.35054H111.466V13.4657H113.38V8.26773C113.38 7.50585 113.544 6.95805 113.867 6.63915C114.466 6.01875 115.662 6.17617 116.543 6.15765V4.22016H115.62V4.21942Z",fill:t})]})},d=()=>{let{colorScheme:e}=(0,n.U)(),t="dark"===e?"#E8E8E6":"#13343B";return(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"141",height:"20",viewBox:"0 0 141 20",fill:"none",children:[(0,l.jsx)("path",{d:"M31.3164 4.34912H32.2726V6.32478H31.0348C30.065 6.32478 29.342 6.55865 28.8624 7.02796C28.3858 7.49569 28.1463 8.26532 28.1463 9.33496V15.8132H26.1928V4.39406H28.1463V6.21624C28.1463 6.31909 28.1979 6.36972 28.2981 6.36972C28.3554 6.36972 28.3984 6.35548 28.4291 6.32605C28.4598 6.2963 28.486 6.23871 28.5167 6.14978C28.8928 4.95039 29.8281 4.35007 31.3176 4.35007H31.3164V4.3488V4.34912ZM44.3119 6.79694C44.8247 7.71151 45.0825 8.81375 45.0825 10.1017C45.0825 11.3897 44.8259 12.492 44.3119 13.4065C43.7976 14.3211 43.1315 15.0059 42.3135 15.4597C41.4955 15.9135 40.6162 16.1404 39.6758 16.1404C37.8225 16.1404 36.5196 15.3936 35.7671 13.8996C35.7099 13.7825 35.6362 13.7233 35.5498 13.7233C35.4635 13.7233 35.4189 13.767 35.4189 13.8559V19.9835H33.465V4.39279H35.4189V6.34757C35.4189 6.43491 35.4619 6.48017 35.5498 6.48017C35.6378 6.48017 35.7086 6.42225 35.7671 6.3039C36.5196 4.8102 37.8225 4.06304 39.6758 4.06304C40.6162 4.06304 41.4955 4.28994 42.3135 4.74375C43.1315 5.19755 43.7963 5.88237 44.3119 6.79694ZM43.1302 10.1017C43.1302 8.75457 42.7721 7.70455 42.0557 6.95074C41.3396 6.19662 40.3963 5.82034 39.2216 5.82034C38.0468 5.82034 37.1036 6.19788 36.3871 6.95074C35.6697 7.70455 35.4078 8.75583 35.4078 10.1017C35.4078 11.4476 35.671 12.4989 36.3871 13.2527C37.1036 14.0081 38.0481 14.3831 39.2216 14.3831C40.3951 14.3831 41.3396 14.0056 42.0557 13.2527C42.7721 12.5002 43.1302 11.4476 43.1302 10.1017ZM11.4097 6.81371C11.9225 7.72829 12.1803 8.83052 12.1803 10.1185C12.1803 11.4065 11.9238 12.5087 11.4097 13.4233C10.8954 14.3379 10.2296 15.023 9.41162 15.4765C8.59365 15.9303 7.71431 16.1572 6.77392 16.1572C4.92066 16.1572 3.61779 15.4104 2.86529 13.9164C2.80835 13.7993 2.73433 13.7401 2.64798 13.7401C2.56163 13.7401 2.51703 13.7838 2.51703 13.8724V20H0.564453V4.40956H2.51798V6.36402C2.51798 6.45137 2.561 6.49662 2.64893 6.49662C2.73687 6.49662 2.80772 6.43871 2.86624 6.32035C3.61874 4.82666 4.92161 4.07949 6.77487 4.07949C7.71557 4.07949 8.5946 4.3064 9.41257 4.7602C10.2305 5.21401 10.8951 5.89883 11.4107 6.8134H11.4091L11.4097 6.81371ZM10.2264 10.1185C10.2264 8.77134 9.86837 7.72132 9.15225 6.96751C8.43581 6.21497 7.49131 5.83712 6.3178 5.83712C5.1443 5.83712 4.1998 6.21465 3.48367 6.96751C2.76755 7.72291 2.50406 8.77292 2.50406 10.1185C2.50406 11.4641 2.76755 12.5157 3.48367 13.2698C4.1998 14.0252 5.14335 14.3999 6.3178 14.3999C7.49226 14.3999 8.43581 14.0224 9.15225 13.2698C9.86837 12.5173 10.2264 11.4644 10.2264 10.1185ZM22.7399 12.186H24.8023C24.5277 13.2556 23.9663 14.1812 23.1205 14.9635C22.2731 15.7471 21.061 16.1376 19.4823 16.1376C18.2952 16.1376 17.2501 15.8923 16.3458 15.4018C15.4414 14.9113 14.7433 14.2138 14.2499 13.305C13.7568 12.3973 13.5113 11.3293 13.5113 10.0989C13.5113 8.86849 13.7511 7.80044 14.2274 6.89283C14.7041 5.98522 15.3744 5.28616 16.2354 4.79596C17.0967 4.30545 18.1054 4.06019 19.2634 4.06019C20.4214 4.06019 21.3814 4.3026 22.1839 4.78457C22.9879 5.2678 23.587 5.90927 23.9856 6.70549C24.3841 7.50455 24.5818 8.3783 24.5818 9.32958V10.6473H15.5717C15.6426 11.7888 16.0247 12.698 16.7114 13.3701C17.3984 14.0439 18.3221 14.3806 19.4804 14.3806C20.4208 14.3806 21.1426 14.1876 21.6417 13.7986C22.1405 13.4097 22.5056 12.8727 22.7384 12.1837L22.7396 12.1866L22.7399 12.186ZM15.5316 9.00236H22.3496C22.3496 8.00741 22.0959 7.2267 21.5889 6.66308C21.0819 6.10073 20.286 5.8175 19.2004 5.8175C18.1873 5.8175 17.3583 6.09219 16.7146 6.64188C16.0709 7.18999 15.6764 7.97797 15.5316 9.00236ZM46.6583 15.8107H48.6134V0H46.6583V15.812V15.8107ZM74.1342 3.14562H76.417V0.673745H74.1342V3.14562ZM82.5629 14.1097C82.208 14.1464 81.9932 14.1648 81.9227 14.1648C81.8221 14.1648 81.7395 14.1354 81.6829 14.0759C81.6254 14.0179 81.5953 13.9379 81.5953 13.8334C81.5953 13.7616 81.614 13.5445 81.651 13.1853C81.6855 12.8274 81.7051 12.2736 81.7051 11.528V6.06434H84.4918L83.9426 4.39153H81.706V1.31616H79.7531V4.38994H77.6275V6.06275H79.7531V12.0746C79.7531 13.3344 80.0584 14.2717 80.665 14.886C81.2727 15.5006 82.1995 15.8091 83.4457 15.8091H84.9656V14.0531H84.2049C83.4666 14.0531 82.9197 14.0714 82.5648 14.1081L82.5629 14.1097ZM94.3726 4.38994L91.1371 13.973C91.0944 14.0914 91.0254 14.2452 90.8046 14.2452C90.5839 14.2452 90.5133 14.0917 90.4694 13.973L87.2338 4.39153H85.2414L88.9884 15.811H90.3137C90.3998 15.811 90.4659 15.8196 90.5105 15.8335C90.5535 15.8477 90.5896 15.8841 90.619 15.9433C90.6756 16.0306 90.6686 16.1632 90.5965 16.3379L89.9889 18.0066C89.9013 18.2266 89.7352 18.3364 89.4904 18.3364C89.4028 18.3364 89.2006 18.318 88.8824 18.2813C88.5636 18.2446 88.1527 18.2266 87.6457 18.2266H86.0597V19.9823H88.1442C89.3604 19.9823 90.092 19.7737 90.7221 19.3566C91.3522 18.9395 91.8396 18.2038 92.1875 17.15L96.2344 4.83014V4.39026L94.3752 4.39184L94.3726 4.39026V4.38994ZM67.5214 8.6514L64.4596 4.39121H62.3099V4.82951L65.9785 9.77041L61.5052 15.3708V15.8091H63.6988L67.2602 11.2192L70.5824 15.8091H72.6893V15.3708L68.8012 10.1002L73.0157 4.85198V4.39121H70.8221L67.5224 8.6514H67.5214ZM74.342 15.8107H76.2968V4.39279H74.342V15.812V15.8107ZM61.4787 12.186C61.2028 13.2556 60.6433 14.1812 59.7975 14.9635C58.9498 15.7471 57.7377 16.1376 56.1587 16.1376C54.9719 16.1376 53.9265 15.8923 53.0221 15.4018C52.1162 14.9113 51.42 14.2138 50.9266 13.305C50.4347 12.3973 50.1893 11.3293 50.1893 10.0989C50.1893 8.86849 50.429 7.80044 50.9057 6.89283C51.384 5.98522 52.0526 5.28616 52.914 4.79596C53.7743 4.30545 54.7833 4.06019 55.9429 4.06019C57.1025 4.06019 58.0609 4.3026 58.8647 4.78457C59.6675 5.2678 60.2685 5.90927 60.6664 6.70549C61.0652 7.50455 61.2629 8.3783 61.2629 9.32958V10.6473H52.2519C52.3244 11.7888 52.7042 12.698 53.3919 13.3701C54.0786 14.0439 55.0025 14.3806 56.1606 14.3806C57.1009 14.3806 57.8231 14.1876 58.3216 13.7986C58.8201 13.4097 59.1854 12.8727 59.4166 12.1837H61.4802L61.4787 12.1866V12.186ZM52.2573 9.00236H59.0753C59.0753 8.00741 58.8217 7.2267 58.3162 6.66308C57.8082 6.10073 57.0133 5.8175 55.9274 5.8175C54.914 5.8175 54.0856 6.09219 53.4416 6.64188C52.7979 7.18999 52.4025 7.97797 52.2589 9.00236H52.2573Z",fill:t}),(0,l.jsx)("path",{d:"M103.544 8.01511C103.544 6.46478 104.351 5.5753 105.758 5.5753C106.32 5.5753 106.753 5.72538 107.043 6.02188C107.325 6.30993 107.468 6.72934 107.468 7.26802V13.4103H109.364V8.01511C109.364 6.46478 110.171 5.5753 111.578 5.5753C112.697 5.5753 113.289 6.16058 113.289 7.26802V13.4103H115.185V7.16381C115.185 5.20763 113.943 3.99231 111.943 3.99231C110.574 3.99231 109.592 4.48622 108.948 5.50082C108.933 5.52467 108.898 5.52393 108.885 5.49825C108.561 4.85316 107.811 3.99231 106.122 3.99231C105.341 3.99231 104.72 4.14276 104.222 4.45209C103.967 4.61098 103.771 4.79848 103.62 4.97939C103.576 5.03186 103.491 5.00067 103.491 4.93205V4.20073H101.647V13.4103H103.543V8.01511H103.544Z",fill:t}),(0,l.jsx)("path",{d:"M119.613 8.09297C117.478 8.29809 116.303 9.28847 116.303 10.8814C116.303 11.7055 116.641 12.3994 117.28 12.8882C117.891 13.3546 118.734 13.6012 119.718 13.6012C121.245 13.6012 122.137 13.0291 122.654 12.4266C122.699 12.3745 122.784 12.4053 122.784 12.4739V13.41H124.627V7.45889C124.627 6.3709 124.245 5.47519 123.521 4.86863C122.837 4.2951 121.864 3.992 120.708 3.992C119.552 3.992 118.63 4.27051 117.895 4.79708C117.17 5.31667 116.699 6.05056 116.548 6.92242C116.522 7.07287 116.509 7.39871 116.509 7.39871H118.331L118.351 7.23836C118.451 6.44759 118.966 5.50528 120.673 5.50528C122.05 5.50528 122.749 6.15073 122.749 7.42403V7.79574L119.613 8.0926V8.09297ZM122.749 9.33544C122.749 10.2183 122.468 10.9379 121.938 11.4164C121.452 11.8556 120.774 12.0879 119.978 12.0879C118.88 12.0879 118.199 11.5991 118.199 10.812C118.199 10.5423 118.199 9.72073 119.857 9.57028L122.749 9.29398V9.33544H122.749Z",fill:t}),(0,l.jsx)("path",{d:"M139.012 4.21545C138.234 2.82473 137.138 1.75106 135.756 1.02377C134.477 0.34456 133.071 0 131.578 0H101.666V1.78848H131.578C132.792 1.78848 133.918 2.05929 134.925 2.59429C136.001 3.16049 136.855 3.99822 137.463 5.08547L137.465 5.09024C138.065 6.14668 138.37 7.39172 138.37 8.78977C138.37 10.1878 138.066 11.4329 137.465 12.4904L137.462 12.4952C137.084 13.1718 136.61 13.752 136.045 14.2308L131.487 8.68739L134.933 4.47378V3.96409H133.028L130.261 7.45556H130.188L127.422 3.96409H125.516V4.47378L128.963 8.68776L125.516 12.9017V13.4114H127.422L130.188 9.91996H130.261L133.667 14.2117L134.459 15.2098L135.593 16.6391C135.646 16.6123 135.699 16.5859 135.751 16.5583C136.256 16.293 136.722 15.9808 137.149 15.6252C137.893 15.0043 138.517 14.2492 139.011 13.3659C139.765 12.0391 140.147 10.4997 140.147 8.79051C140.147 7.08128 139.765 5.54232 139.012 4.21618V4.21545Z",fill:t}),(0,l.jsx)("path",{d:"M131.578 15.7915H101.666V17.5679H131.578C132.198 17.5679 132.801 17.5099 133.383 17.3954L132.097 15.7742C131.926 15.7856 131.753 15.7915 131.578 15.7915Z",fill:t})]})};var c=a(9126),u=a(60410),m=a(11702),p=a(34953),h=a(49427);function v(e){let{renderInMobile:t,withLogo:a=!0,subscriptionTier:s}=e,n=t?"small":"base";return(0,l.jsxs)("section",{className:i()("flex-col md:flex",{hidden:!t,"gap-6":!t}),children:[!t&&a&&("pro"===s?(0,l.jsx)(o,{}):(0,l.jsx)(d,{})),(0,l.jsxs)("ul",{children:[("pro"===s?c.A_:c.xC).map((e,t)=>(0,l.jsxs)("li",{className:"mb-sm gap-x-sm flex",children:[(0,l.jsx)(u.A,{color:"light",variant:n,children:(0,l.jsx)(h.e,{icon:m.i})}),(0,l.jsx)(u.A,{color:"light",variant:n,children:e})]},t)),(0,l.jsxs)("li",{className:"mb-sm gap-x-sm flex",children:[(0,l.jsx)(u.A,{color:"light",variant:n,children:(0,l.jsx)(h.e,{icon:p.Z})}),(0,l.jsx)(u.A,{color:"light",variant:n,children:(0,l.jsx)(r.A,{defaultMessage:"And much more",id:"B55ddyNR6T"})})]})]})]})}},63137:(e,t,a)=>{"use strict";a.d(t,{B_:()=>s,c5:()=>r,g8:()=>l});let l=10,r=20,s=456},63447:(e,t,a)=>{"use strict";a.d(t,{P3:()=>s});var l=a(77917),r=a(3041);let s=async e=>{let{eventName:t,isDeferred:a,clickId:s,nextauthUserId:i,reason:n}=e;try{var o;let{data:e,error:r}=await l.By.POST("/rest/attribution/dub/lead",n,{timeoutMs:(0,l.e4)(),body:{event_name:t,is_deferred:a,click_id:s,nextauth_user_id:i}});if(r)throw r;return{success:null!==(o=null==e?void 0:e.success)&&void 0!==o&&o}}catch(e){return r.vF.error("Failed to save post install redirect",e),{success:!1}}}},63689:(e,t,a)=>{"use strict";a.d(t,{v:()=>l});let l=(0,a(27773).w)({path:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0 M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",name:"IconUser",variant:"stroked"})},63825:(e,t,a)=>{"use strict";a.d(t,{H:()=>l});let l=(0,a(27773).w)({path:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4 M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",name:"IconRefresh",variant:"stroked"})},64265:(e,t,a)=>{"use strict";a.d(t,{B:()=>r});var l=a(85860);let r=(e,t,a)=>{(0,l.useEffect)(()=>{let l=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&t()})},a),r=e.current;return r&&l.observe(r),()=>{r&&l.unobserve(r)}},[e,t,a])}},64473:(e,t,a)=>{"use strict";a.d(t,{j:()=>n});var l=a(15492),r=a(81940),s=a(80314),i=a(11129);let n=e=>{var t,a,n,o,d,c,u,m;let{reason:p,fileRepoInfo:h,enablePolling:v=!1,activePollingIntervalMs:g=5e3,passivePollingIntervalMs:f=6e4}=e,y=(0,i.HS)(h),{data:x}=(0,l.useQuery)({queryKey:y,queryFn:()=>(0,s.sn)({request:{file_repository_info:h},reason:p}),refetchInterval:e=>{var t,a;if(!v)return!1;let{pending_files:l=0}=null!==(a=null===(t=e.state.data)||void 0===t?void 0:t.summary)&&void 0!==a?a:{};return l>0?g:f},staleTime:(0,r.A)(30)});return{total:null!==(d=null==x?void 0:null===(t=x.summary)||void 0===t?void 0:t.total_files)&&void 0!==d?d:0,pending:null!==(c=null==x?void 0:null===(a=x.summary)||void 0===a?void 0:a.pending_files)&&void 0!==c?c:0,errors:null!==(u=null==x?void 0:null===(n=x.summary)||void 0===n?void 0:n.error_files)&&void 0!==u?u:0,uploads:null!==(m=null==x?void 0:null===(o=x.summary)||void 0===o?void 0:o.total_uploads)&&void 0!==m?m:0}}},64829:(e,t,a)=>{"use strict";function l(e){return!!e&&1===e.length}function r(e){return!!e&&e.length>0}a.d(t,{TY:()=>l,bv:()=>r})},65076:(e,t,a)=>{"use strict";a.d(t,{m:()=>l});let l=(0,a(27773).w)({path:"M17.8 20l-12 -1.5c-1 -.1 -1.8 -.9 -1.8 -1.9v-9.2c0 -1 .8 -1.8 1.8 -1.9l12 -1.5c1.2 -.1 2.2 .8 2.2 1.9v12.1c0 1.2 -1.1 2.1 -2.2 1.9z M12 5l0 14 M4 12l16 0",name:"IconBrandWindows",variant:"stroked"})},65308:(e,t,a)=>{"use strict";a.d(t,{e:()=>n});var l=a(4428),r=a(83081),s=a(26976),i=a(60010);let n=e=>{let{reason:t,onSuccess:a}=e,{$t:n}=(0,r.A)(),{deprecatedOpenToast:o}=(0,i.G)();return(0,l.useMutation)({mutationFn:async e=>{let{file_url:a}=e;return(await (0,s.PE)({request:{file_url:a,view_mode:!1},reason:t})).file_url},onSuccess:(e,t)=>{let{tab_id:l}=t;a?a(e,l):window.open(e,"_blank"),o(n({defaultMessage:"Downloading file...",id:"/vA9NyIeJh"}),"success",3)},onError:e=>{e instanceof s.Co?o(n({defaultMessage:"Downloads are disabled for files in this organization.",id:"NfM+Ayxvc6"}),"error",8):e instanceof s.bS?o(n({defaultMessage:"PDF downloads are restricted",id:"aJYvzl3Lq5"}),"error",8):e instanceof s.er?o(n({defaultMessage:"This file belongs to a different organization",id:"lo7Bg402Jd"}),"error",8):o(n({defaultMessage:"Failed to download file",id:"RIWlU8NdpC"}),"error",3)}})}},65811:(e,t,a)=>{"use strict";a.d(t,{C:()=>u,i:()=>c});var l=a(85860),r=a(15492),s=a(14337),i=a(77936);let n=()=>{var e;return(null===(e=window.location)||void 0===e?void 0:e.origin)?window.location.origin:"https://www.perplexity.ai"},o=e=>{let t=n(),a=(0,i.Dl)("".concat(t).concat(e));return(null==a?void 0:a.href)||"".concat(t).concat(e)},d=()=>[{id:"imessage",icon_url:o("/static/mcpb/imessage.png"),download_url:o("/static/mcpb/imessage_v0.0.10.mcpb"),manifest:{$schema:"https://static.modelcontextprotocol.io/schemas/2025-08-26/mcpb.manifest.schema.json",dxt_version:"0.1",name:"imessage",display_name:"Messages",version:"0.0.10",description:"Send and read messages using Apple's Messages app",long_description:"This tool lets Perplexity work with your Mac's Messages app. You can send messages, read messages, and ask Perplexity to help you understand what's important.\n\nIt uses Mac system features to connect to Messages. Your Mac will ask for permission before it can access Messages or Contacts. This is not made by Apple.",license:"MIT",author:{name:"Perplexity Inc",email:"support@perplexity.ai",url:"https://www.perplexity.ai/"},homepage:"https://www.perplexity.ai/",icon:"icon.png",tools:[{name:"list_contacts",description:'List contacts. When query is provided, search for contacts by name. Use it first to get a handle id, phone numbers, or emails. This tool is more preferred to be used first than "list_chats" tool. If this tool returns empty results, try to use "list_chats" tool to find a contact.'},{name:"list_chats",description:"List chats from Messages. When query is provided, search for chats by phone number (preferrable) or chat name (if phone number is not available)."},{name:"create_chat",description:"Create a new chat with a specific contact"},{name:"read_chat",description:"Read Messages from a specific chat"},{name:"send_imessage",description:"Send a Message to specific chat"}],server:{type:"node",entry_point:"server/index.js",mcp_config:{command:"node",args:["${__dirname}/server/index.js"],env:{HOME:"${HOME}"}}},compatibility:{comet:">=139.0.0",platforms:["darwin"],runtimes:{node:">=22.0.0"},permissions:{full_disk_access:!0,contacts:{for_tools:["list_contacts"]}}}}}],c=()=>{let e=(0,s.jX)(),t=(0,l.useMemo)(()=>{if(!e.platformInfo)return;let{isMac:t,isWindows:a,isLinux:l}=e.platformInfo;return t?"darwin":a?"win32":l?"linux":void 0},[e.platformInfo]);return(0,r.useQuery)({queryKey:["comet/available_dxts",t],queryFn:async()=>d().filter(e=>{var a;return null===(a=e.manifest.compatibility)||void 0===a||!a.platforms||t&&e.manifest.compatibility.platforms.includes(t)})})},u=(e,t)=>{var a;return t.dxt_name?null==e?void 0:null===(a=e.find(e=>e.id===t.dxt_name))||void 0===a?void 0:a.icon_url:void 0}},66087:(e,t,a)=>{"use strict";a.d(t,{m:()=>n});var l=a(85860),r=a(15492),s=a(3041);async function i(){try{let e=await fetch("/cdn-cgi/trace");return(await e.text()).split("\n").reduce((e,t)=>{let[a,l]=t.split("=");return e[a]=null!=l?l:"",e},{loc:"US"})}catch(e){return s.vF.error("Error getting Cloudflare trace",e),{loc:"US"}}}function n(){let{data:e}=(0,r.useQuery)({queryKey:["cloudflare-trace"],queryFn:i});return(0,l.useMemo)(()=>{var t;return null!==(t=null==e?void 0:e.loc)&&void 0!==t?t:"US"},[e])}},66157:(e,t,a)=>{"use strict";a.d(t,{o:()=>r});var l=a(7616);class r{static isRecentlyTrending(e){var t,a;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:432e5;return(null===(t=e.meta_data)||void 0===t?void 0:t.client)==="trending"&&new Date().getTime()-new l.v(null===(a=e.meta_data)||void 0===a?void 0:a.published_date).getTime()<r}static normalizeUrl(e){return e.replace(/\/$/,"")}static dedupWebResults(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return[];if(a)return e.filter(e=>e.is_attachment);if(!t)return e;let l=new Set(t.map(e=>this.normalizeUrl(e.url)));return e.filter(e=>!l.has(this.normalizeUrl(e.url)))}}},66723:(e,t,a)=>{"use strict";a.d(t,{H8:()=>o,OX:()=>c,SI:()=>n,ce:()=>m,jl:()=>r,zJ:()=>s});var l=a(57023);let r=(0,l.YK)({pro:{defaultMessage:"Enterprise Pro",id:"h/OVAC8xF3"},max:{defaultMessage:"Enterprise Max",id:"tfsuL8YexA"}}),s=[(0,l.zR)({defaultMessage:"Unlimited access to Labs, Research, and Comet Max Assistant",id:"cxCDLl3cHO"}),(0,l.zR)({defaultMessage:"Org-wide access to premium security features like data retention settings and usage analytics",id:"YgWIReWPJc"}),(0,l.zR)({defaultMessage:"10x more file storage",id:"LgZECYLgEY"}),(0,l.zR)({defaultMessage:"Access to our full model suite including o3-pro and Opus 4.1 Thinking",id:"0qp226NKVJ"}),(0,l.zR)({defaultMessage:"Enhanced video generation",id:"y2H8HPGbes"}),(0,l.zR)({defaultMessage:"Early access to new product features",id:"nFcQ0Wipw7"})],i={pro:"pro",max:"max"},n=e=>Object.keys(i).includes(e),o=(e,t)=>{let a=Object.keys(i);return a.indexOf(e)<a.indexOf(t)},d=["enterprise_pro","enterprise_max"],c=e=>d.includes(e),u={enterprise_pro:"pro",enterprise_max:"max"},m=e=>u[e]},67845:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});let l=(0,a(27773).w)({path:"M8 9h8 M8 13h6 M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z",name:"IconMessage",variant:"stroked"})},68088:(e,t,a)=>{"use strict";a.d(t,{o:()=>R});var l=a(84447),r=a(42972),s=a(97609),i=a(36206),n=a(3041),o=a(66516);function d(e){let t,a,{onMessage:l,extensionId:r,name:s}=e,d=()=>{t&&clearTimeout(t),t=setTimeout(p,1e3)},u=()=>{n.vF.warn("Disconnected. Attempting to reconnect...",{extensionId:r}),d()},m=()=>{if(a){a.onMessage.removeListener(l),a.onDisconnect.removeListener(u),clearTimeout(t);try{a.disconnect()}catch(e){}a=void 0}};function p(){if(m(),"undefined"==typeof chrome||!chrome.runtime){(0,i.bf)()&&(d(),n.vF.error("Comet browser is missing chrome.runtime"));return}try{(a=chrome.runtime.connect(r,{name:s})).onMessage.addListener(l),a.onDisconnect.addListener(u)}catch(e){d(),n.vF.error("Failed to connect to extension",{err:e,extensionId:r})}}return(0,i.bf)()&&(p(),(0,o.Rh)("web.frontend.comet_extension_connected",{extensionId:r,startTime:performance.timeOrigin,duration:performance.now()})),{sendMessage:e=>(!a&&(0,i.bf)()&&n.vF.warn("Attempting to send message while main port is not connected",{extensionId:r}),c(r,e)),sendMessageToPort:e=>{if(!(0,i.bf)())return()=>{};a||n.vF.warn("Attempting to send message to port while main port is not connected",{extensionId:r});let t=chrome.runtime.connect(r,{name:"".concat(s,"_").concat(crypto.randomUUID())});return t.postMessage(e),()=>{try{t.disconnect()}catch(e){}}}}}async function c(e,t){return new Promise((a,l)=>{if(!(0,i.bf)()){l(new s.B("INVALID_BROWSER_ERROR"));return}if("undefined"==typeof chrome||!chrome.runtime){l(new s.B("MISSING_RUNTIME_ERROR",{details:{extensionId:e,messageType:"object"==typeof t&&null!==t&&"type"in t?t.type:void 0,message:t}}));return}chrome.runtime.sendMessage(e,t,r=>{if(chrome.runtime.lastError){l(new s.B("RUNTIME_LAST_ERROR",{message:chrome.runtime.lastError.message,cause:chrome.runtime.lastError,details:{extensionId:e,messageType:"object"==typeof t&&null!==t&&"type"in t?t.type:void 0,message:t}}));return}a(r)})})}function u(e){let{base64Image:t}=e;return new Promise((e,a)=>{let l=new Image;l.onerror=()=>a(Error("Failed to load screenshot image")),l.onload=()=>{let t=l.width,a=l.height,r=t*a,s=r>115e4?Math.sqrt(115e4/r):t>1568?1568/t:a>1568?1568/a:1,i=Math.round(t*s),n=Math.round(a*s),o=document.createElement("canvas");o.width=i,o.height=n;let d=o.getContext("2d");null==d||d.drawImage(l,0,0,o.width,o.height),e({base64Image:o.toDataURL("image/png").split(",")[1]})},l.src="data:image/png;base64,".concat(t),setTimeout(()=>a(Error("Screenshot timed out")),5e3)})}function m(e){let{selector:t,value:a,submit:l}=e,r=null,s=window;if(s.__elementMap&&s.__elementMap[t]&&((r=s.__elementMap[t].deref()||null)&&document.contains(r)||(delete s.__elementMap[t],r=null)),!r)return{success:!1,reason:'No element found with reference: "'.concat(t,'". The element may have been removed from the page.')};if(r.scrollIntoView({behavior:"auto",block:"center",inline:"center"}),r instanceof HTMLElement&&r.focus(),"SELECT"===r.tagName){let e=r,t=Array.from(e.options),l=t.find(e=>e.value===a||e.text===a||e.label===a||e.value.toLowerCase()===a.toLowerCase()||e.text.toLowerCase()===a.toLowerCase());if(!l)return{success:!1,reason:'No option found matching "'.concat(a,'". Available options: ').concat(t.map(e=>e.text||e.value).join(", "))};e.value=l.value,l.selected=!0}else if("INPUT"===r.tagName){let e=r,t=(e.type||"text").toLowerCase();if("checkbox"===t){let t="true"===a||"1"===a||"yes"===a||"on"===a||"checked"===a;e.checked=t}else if("radio"===t)e.checked=!0;else if("range"===t||"number"===t){let l=parseFloat(a);if(isNaN(l))return{success:!1,reason:'Invalid number value: "'.concat(a,'"')};if("range"===t){let t=parseFloat(e.min)||0,a=parseFloat(e.max)||100;if(l<t||l>a)return{success:!1,reason:"Value ".concat(l," is out of range [").concat(t,", ").concat(a,"]")}}e.value=a}else if("date"===t||"time"===t||"datetime-local"===t||"month"===t||"week"===t){if(e.value=a,!e.value)return{success:!1,reason:"Invalid ".concat(t,' format: "').concat(a,'"')}}else if("color"===t){if(!/^#[0-9A-Fa-f]{6}$/.test(a))return{success:!1,reason:'Invalid color format: "'.concat(a,'". Expected format: #RRGGBB')};e.value=a}else{if("file"===t)return{success:!1,reason:"File inputs cannot be set programmatically for security reasons"};e.value=a}}else if("TEXTAREA"===r.tagName)r.value=a;else{if(!(r instanceof HTMLElement)||!r.isContentEditable)return{success:!1,reason:"not editable"};r.innerText=a}if(r.dispatchEvent(new Event("input",{bubbles:!0})),r.dispatchEvent(new Event("change",{bubbles:!0})),l){var i,n,o;let e=null;"closest"in r&&(e=r.closest("form")),!e&&(r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement)&&(e=r.form),null!==(o=null==e?void 0:null===(i=e.requestSubmit)||void 0===i?void 0:i.call(e))&&void 0!==o||null==e||null===(n=e.submit)||void 0===n||n.call(e)}return{success:!0}}function p(e){let{x:t,y:a}=e,l=document.createElement("div");l.style.cssText="\n        position: fixed;\n        left: ".concat(t-20,"px;\n        top: ").concat(a-20,"px;\n        width: 20px;\n        height: 20px;\n        border-radius: 50%;\n        background-color: rgba(66, 133, 244, 0.6);\n        z-index: 2147483647;\n        pointer-events: none;\n        transform: scale(0);\n        transition: transform 0.3s ease-out, opacity 0.3s ease-out;\n        opacity: 1;\n      "),document.body.appendChild(l),setTimeout(()=>l.style.transform="scale(1)",10),setTimeout(()=>{l.style.opacity="0",setTimeout(()=>l.remove(),300)},400)}function h(e){let{x:t,y:a,direction:l,amount:r}=e,s=40*(r||3),i=null!=l?l:"DOWN",n="UP"===i||"LEFT"===i?-1:1,o="LEFT"===i||"RIGHT"===i?"x":"y",d="x"===o?s*n:0,c="y"===o?s*n:0,u=document.elementFromPoint(t,a),m=u||document.body,p=new WheelEvent("wheel",{bubbles:!0,cancelable:!0,view:window,clientX:t,clientY:a,deltaX:d,deltaY:c,deltaMode:WheelEvent.DOM_DELTA_PIXEL});if(m.dispatchEvent(p)&&!p.defaultPrevented){let e=window;if(u){let t=u;for(;t;){let a=window.getComputedStyle(t);if("y"===o&&("auto"===a.overflowY||"scroll"===a.overflowY)||"x"===o&&("auto"===a.overflowX||"scroll"===a.overflowX)){let a=t;if("y"===o&&a.scrollHeight>a.clientHeight||"x"===o&&a.scrollWidth>a.clientWidth){e=t;break}}t=t.parentElement}}e===window?window.scrollBy({left:d,top:c,behavior:"auto"}):e.scrollBy({left:d,top:c,behavior:"auto"})}return{success:!0,message:"Scrolled ".concat(i.toLowerCase()," by ").concat(null!=r?r:3," ticks at (").concat(t,", ").concat(a,")")}}function v(e){let{url:t}=e;window.location.href=t}function g(e){let{x:t,y:a,button:l,clickCount:r}=e,s=document.elementFromPoint(t,a);if(!s)return{success:!1,reason:"not found"};if(s instanceof HTMLElement&&null!==s.offsetParent){s.scrollIntoView({behavior:"auto",block:"center",inline:"center"});let e="right"===l?2:+("middle"===l),i=null!=r?r:1,n={bubbles:!0,cancelable:!0,view:window,clientX:t,clientY:a,button:e,buttons:0===e?1:2===e?2:4,detail:i};return s.dispatchEvent(new MouseEvent("mousemove",n)),s.dispatchEvent(new MouseEvent("mousedown",n)),s.dispatchEvent(new MouseEvent("mouseup",n)),s.dispatchEvent(new MouseEvent("click",{...n,detail:i})),i>=2&&s.dispatchEvent(new MouseEvent("dblclick",{...n,detail:i})),2===e&&s.dispatchEvent(new MouseEvent("contextmenu",n)),{success:!0,outerHTML:s.outerHTML,text:s.innerText,tag:s.tagName}}return{success:!1,reason:s?"invisible":"not found"}}function f(e){let{value:t,submit:a}=e,l=document.activeElement;if(!l)return{success:!1,reason:"not found"};l.scrollIntoView({behavior:"auto",block:"center",inline:"center"}),l instanceof HTMLElement&&l.focus();let r=l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement,s=l instanceof HTMLElement&&l.isContentEditable;if(!r&&!s)return{success:!1,reason:"not editable"};let i="";r?i=l.value:s&&(i=l.innerText);let n=new InputEvent("beforeinput",{data:t,inputType:i?"insertReplacementText":"insertText",bubbles:!0,cancelable:!0});if(l.dispatchEvent(n),n.defaultPrevented)return{success:!1,reason:"beforeinput event was prevented"};if(r?l.value=t:s&&(l.innerText=t),l.dispatchEvent(new InputEvent("input",{data:t,inputType:i?"insertReplacementText":"insertText",bubbles:!0,cancelable:!1})),l.dispatchEvent(new Event("change",{bubbles:!0})),a){var o,d,c;let e=null;"closest"in l&&(e=l.closest("form")),r&&(e=l.form),null!==(c=null==e?void 0:null===(o=e.requestSubmit)||void 0===o?void 0:o.call(e))&&void 0!==c||null==e||null===(d=e.submit)||void 0===d||d.call(e)}return{success:!0}}function y(e){let{startX:t,startY:a,endX:l,endY:r}=e,s=document.elementFromPoint(t,a);if(!s)return{success:!1,reason:"start element not found"};let i=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window,clientX:t,clientY:a});s.dispatchEvent(i);let n=new MouseEvent("mousemove",{bubbles:!0,cancelable:!0,view:window,clientX:l,clientY:r});document.dispatchEvent(n);let o=document.elementFromPoint(l,r),d=new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,view:window,clientX:l,clientY:r});return(o||document).dispatchEvent(d),{success:!0}}function x(e){let{key:t}=e,a=document.activeElement||document.body;try{let e,s,i;let n=t.split("+"),o=n[n.length-1],d=n.slice(0,-1),c={ctrlKey:d.includes("Control")||d.includes("ControlOrMeta"),altKey:d.includes("Alt"),shiftKey:d.includes("Shift"),metaKey:d.includes("Meta")||d.includes("ControlOrMeta")},u={Enter:{key:"Enter",code:"Enter",keyCode:13},Backspace:{key:"Backspace",code:"Backspace",keyCode:8},Delete:{key:"Delete",code:"Delete",keyCode:46},Tab:{key:"Tab",code:"Tab",keyCode:9},Escape:{key:"Escape",code:"Escape",keyCode:27},Space:{key:" ",code:"Space",keyCode:32},ArrowUp:{key:"ArrowUp",code:"ArrowUp",keyCode:38},ArrowDown:{key:"ArrowDown",code:"ArrowDown",keyCode:40},ArrowLeft:{key:"ArrowLeft",code:"ArrowLeft",keyCode:37},ArrowRight:{key:"ArrowRight",code:"ArrowRight",keyCode:39},Home:{key:"Home",code:"Home",keyCode:36},End:{key:"End",code:"End",keyCode:35},PageUp:{key:"PageUp",code:"PageUp",keyCode:33},PageDown:{key:"PageDown",code:"PageDown",keyCode:34},Insert:{key:"Insert",code:"Insert",keyCode:45},Semicolon:{key:";",code:"Semicolon",keyCode:186},Equal:{key:"=",code:"Equal",keyCode:187},Comma:{key:",",code:"Comma",keyCode:188},Minus:{key:"-",code:"Minus",keyCode:189},Period:{key:".",code:"Period",keyCode:190},Slash:{key:"/",code:"Slash",keyCode:191},Backquote:{key:"`",code:"Backquote",keyCode:192},BracketLeft:{key:"[",code:"BracketLeft",keyCode:219},Backslash:{key:"\\",code:"Backslash",keyCode:220},BracketRight:{key:"]",code:"BracketRight",keyCode:221},Quote:{key:"'",code:"Quote",keyCode:222}};if(!o)return{success:!1,reason:"No key specified"};if(o.startsWith("Key")){let t=o.slice(3);e=c.shiftKey?t.toUpperCase():t.toLowerCase(),s=o,i=t.toUpperCase().charCodeAt(0)}else if(o.startsWith("Digit")){let t=o.slice(5);e=t,s=o,i=48+parseInt(t,10)}else u[o]?(e=u[o].key,s=u[o].code,i=u[o].keyCode):(e=o,s=o);let m=new KeyboardEvent("keydown",{key:e,code:s,keyCode:i,which:i,bubbles:!0,cancelable:!0,...c}),p=new KeyboardEvent("keyup",{key:e,code:s,keyCode:i,which:i,bubbles:!0,cancelable:!0,...c});if(a.dispatchEvent(m),1===e.length&&!c.ctrlKey&&!c.metaKey){let t=new InputEvent("beforeinput",{data:e,inputType:"insertText",bubbles:!0,cancelable:!0});if(a.dispatchEvent(t),!t.defaultPrevented){if(a instanceof HTMLInputElement||a instanceof HTMLTextAreaElement){var l,r;let t=null!==(l=a.selectionStart)&&void 0!==l?l:a.value.length,s=null!==(r=a.selectionEnd)&&void 0!==r?r:a.value.length;a.value=a.value.substring(0,t)+e+a.value.substring(s),a.selectionStart=a.selectionEnd=t+1}let t=new InputEvent("input",{data:e,inputType:"insertText",bubbles:!0,cancelable:!1});a.dispatchEvent(t)}}return a.dispatchEvent(p),{success:!0}}catch(e){return{success:!1,reason:e instanceof Error?e.message:"Unknown error"}}}function b(){let e=window;function t(e){let t=e.getAttribute("role");if(t)return t;let a=e.tagName.toLowerCase(),l=e.getAttribute("type");return({a:"link",button:"button",input:"submit"===l||"button"===l?"button":"checkbox"===l?"checkbox":"radio"===l?"radio":"file"===l?"button":"textbox",select:"combobox",textarea:"textbox",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",img:"image",nav:"navigation",main:"main",header:"banner",footer:"contentinfo",section:"region",article:"article",aside:"complementary",form:"form",table:"table",ul:"list",ol:"list",li:"listitem",label:"label"})[a]||"generic"}function a(e){let t=e.tagName.toLowerCase();if("select"===t){let t=e.querySelector("option[selected]")||e.options[e.selectedIndex];if(t&&t.textContent)return t.textContent.trim()}let a=e.getAttribute("aria-label");if(a&&a.trim())return a.trim();let l=e.getAttribute("placeholder");if(l&&l.trim())return l.trim();let r=e.getAttribute("title");if(r&&r.trim())return r.trim();let s=e.getAttribute("alt");if(s&&s.trim())return s.trim();if(e.id)try{let t=CSS.escape(e.id),a=document.querySelector('label[for="'.concat(t,'"]'));if(a&&a.textContent&&a.textContent.trim())return a.textContent.trim()}catch(e){}if("input"===t){let t=e.getAttribute("type")||"",a=e.getAttribute("value");if("submit"===t&&a&&a.trim())return a.trim();if(e&&e.value.length<50&&e.value.trim())return e.value.trim()}if(["button","a","summary"].includes(t)){let t="";for(let a=0;a<e.childNodes.length;a++){let l=e.childNodes[a];l.nodeType===Node.TEXT_NODE&&(t+=l.textContent)}if(t.trim())return t.trim()}if(t.match(/^h[1-6]$/)){let t=e.textContent;if(t&&t.trim())return t.trim().substring(0,100)}if("img"===t){let t=e.getAttribute("src");if(t){var i;return"Image: "+(null===(i=t.split("/").pop())||void 0===i?void 0:i.split("?")[0])}}let n="";for(let t=0;t<e.childNodes.length;t++){let a=e.childNodes[t];a.nodeType===Node.TEXT_NODE&&(n+=a.textContent)}if(n&&n.trim()&&n.trim().length>=3){let e=n.trim();return e.length>50?e.substring(0,50)+"...":e}return""}function l(e){return!!["a","button","input","select","textarea","details","summary"].includes(e.tagName.toLowerCase())||null!==e.getAttribute("onclick")||null!==e.getAttribute("tabindex")||"button"===e.getAttribute("role")||"link"===e.getAttribute("role")||"true"===e.getAttribute("contenteditable")}e.__elementMap||(e.__elementMap=e.__elementMap||{},e.__refCounter=e.__refCounter||0,e.__generateAccessibilityTree=function(r){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;try{let o=[];for(let d in document.body&&function e(r,s,i,n){if(s>15||!r||!r.tagName)return;let o=function(e,r){let s=e.tagName.toLowerCase();if(["script","style","meta","link","title","noscript"].includes(s)||"true"===e.getAttribute("aria-hidden")||!function(e){let t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity&&e.offsetWidth>0&&e.offsetHeight>0}(e))return!1;if("all"!==r.filter){let t=e.getBoundingClientRect(),a=document.documentElement.clientWidth||window.innerWidth,l=document.documentElement.clientHeight||window.innerHeight;if(!(t.top<l&&t.bottom>0&&t.left<a&&t.right>0))return!1}if("interactive"===r.filter)return l(e);if(l(e)||function(e){let t=e.tagName.toLowerCase();return!!["h1","h2","h3","h4","h5","h6","nav","main","header","footer","section","article","aside"].includes(t)||null!==e.getAttribute("role")}(e)||a(e).length>0)return!0;if("generic"===t(e)&&("div"===s||"span"===s)){let t=e.id||"",l=e.className||"",r=a(e);if(r&&r.length>=3||["search","dropdown","menu","modal","dialog","popup","toolbar","sidebar","content","text"].some(e=>t.includes(e)||l.includes(e)))return!0}return function(e){let t=e.getAttribute("role"),a=e.tagName.toLowerCase(),l=e.className||"",r=e.id||"";return!!(["search","form","group","toolbar","navigation"].includes(null!=t?t:"")||["form","fieldset","nav"].includes(a))||["search","form","menu","nav"].some(e=>r.includes(e)||l.includes(e))}(e)}(r,i)||0===s;if(o){let e=t(r),l=a(r),o=null,c=window;for(let e in c.__elementMap){var d;if((null===(d=c.__elementMap[e])||void 0===d?void 0:d.deref())===r){o=e;break}}o||(o="ref_"+ ++c.__refCounter,c.__elementMap[o]=new WeakRef(r));let u=r.getBoundingClientRect(),m=Math.round((u.left+u.width/2)*i.scaleX),p=Math.round((u.top+u.height/2)*i.scaleY),h="  ".repeat(s)+"- "+e;if(l){let e=l.replace(/\s+/g," ").substring(0,100);h+=' "'+(e=e.replace(/"/g,'\\"'))+'"'}h+=" [ref="+o+"] (x="+m+",y="+p+")",r.id&&(h+=' id="'+r.id+'"'),r.getAttribute("href")&&(h+=' href="'+r.getAttribute("href")+'"'),r.getAttribute("type")&&(h+=' type="'+r.getAttribute("type")+'"'),r.getAttribute("placeholder")&&(h+=' placeholder="'+r.getAttribute("placeholder")+'"'),n.push(h)}if(r.children&&s<15)for(let t=0;t<r.children.length;t++)e(r.children[t],o?s+1:s,i,n)}(document.body,0,{filter:r,scaleX:s,scaleY:i},o),e.__elementMap){var n;(null===(n=e.__elementMap[d])||void 0===n?void 0:n.deref())||delete e.__elementMap[d]}return{pageContent:o.filter(e=>!/^\s*- generic \[ref=ref_\d+\]/.test(e)).join("\n"),viewport:{width:document.documentElement.clientWidth||window.innerWidth,height:document.documentElement.clientHeight||window.innerHeight}}}catch(e){return{error:e instanceof Error?e.message:"unhandled error",pageContent:"",viewport:{width:0,height:0}}}})}function w(e){return window.__generateAccessibilityTree(e.filter,e.scaleX,e.scaleY)}class _{async Computer(e){let t=e.tab_id;try{var a,l,r,s,i,n,o,d,c,m,v,b;let w,_;switch(e.action){case"LEFT_CLICK":case"RIGHT_CLICK":case"DOUBLE_CLICK":case"TRIPLE_CLICK":{let s={x:null!==(a=e.coordinate[0])&&void 0!==a?a:0,y:null!==(l=e.coordinate[1])&&void 0!==l?l:0},i=await this.executeJs(t,g,{x:s.x,y:s.y,button:"RIGHT_CLICK"===e.action?"right":"left",clickCount:null!==(r=({DOUBLE_CLICK:2,TRIPLE_CLICK:3})[e.action])&&void 0!==r?r:1});if(await this.executeJs(t,p,s),!i.success)throw Error("Failed to click: ".concat(i.reason));w="".concat(e.action," at (").concat(s.x,", ").concat(s.y,")");break}case"TYPE":{if(!e.text)throw Error("Text is required for type action");let a=await this.executeJs(t,f,{value:e.text,submit:!1});if(!a.success)throw Error("Failed to type: ".concat(a.reason));w="Typed: ".concat(e.text);break}case"SCROLL":{let a=null!==(s=e.coordinate[0])&&void 0!==s?s:0,l=null!==(i=e.coordinate[1])&&void 0!==i?i:0,r=await this.executeJs(t,h,{x:a,y:l,direction:e.scroll_direction,amount:e.scroll_amount});if(!r.success)throw Error("Failed to scroll: ".concat(r.message));w=null!==(d=r.message)&&void 0!==d?d:"Scrolled ".concat(null!==(n=e.scroll_direction)&&void 0!==n?n:"down"," by ").concat(null!==(o=e.scroll_amount)&&void 0!==o?o:3," ticks at (").concat(a,", ").concat(l,")"),(_=await this.deps.mobileBridge.tabs_get_screenshot({id:t}).then(e=>e.base64_image).catch(()=>void 0))&&(_=(await this.executeJs(t,u,{base64Image:_})).base64Image);break}case"WAIT":{let t=e.duration||1;await new Promise(e=>setTimeout(e,1e3*t)),w="Waited ".concat(t," seconds");break}case"SCREENSHOT":{let e=await this.deps.mobileBridge.tabs_get_screenshot({id:t});_&&(_=(await this.executeJs(t,u,{base64Image:e.base64_image})).base64Image),w="Screenshot captured";break}case"KEY":{if(!e.text)throw Error("Text is required for key action");let a=await this.executeJs(t,x,{key:e.text});if(!a.success)throw Error("Failed to press key: ".concat(a.reason));w="Pressed key: ".concat(e.text);break}case"LEFT_CLICK_DRAG":{let a=null!==(c=e.start_coordinate[0])&&void 0!==c?c:0,l=null!==(m=e.start_coordinate[1])&&void 0!==m?m:0,r=null!==(v=e.coordinate[0])&&void 0!==v?v:0,s=null!==(b=e.coordinate[1])&&void 0!==b?b:0,i=await this.executeJs(t,y,{startX:a,startY:l,endX:r,endY:s});if(!i.success)throw Error("Failed to drag: ".concat(i.reason));w="Dragged from (".concat(a,", ").concat(l,") to (").concat(r,", ").concat(s,")");break}default:throw Error("Unknown action: ".concat(e.action))}await new Promise(e=>setTimeout(e,50));let M=await this.getTabContext(t);return{message:w,base64_image:_,tab_context:M}}catch(e){return this.deps.logger.error("[browser_computer_use] Computer action error:",e),{tab_context:await this.getTabContext(t),error:e instanceof Error?e.message:String(e)}}}async FormInput(e){let t=e.tab_id;try{let a=await this.executeJs(t,m,{selector:e.ref,value:e.value,submit:!1});if(!a.success)throw Error("Failed to set value: ".concat(a.reason));return{message:"Set value: ".concat(e.value),tab_context:await this.getTabContext(t)}}catch(e){return this.deps.logger.error("[browser_computer_use] FormInput error:",e),{tab_context:await this.getTabContext(t),error:e instanceof Error?e.message:String(e)}}}async GetPageText(e){let t=e.tab_id;try{var a,l;let r=await this.deps.mobileBridge.tabs_get_content({id:e.tab_id});return{markdown:null!==(l=null===(a=r.tab_content.markdown)||void 0===a?void 0:a.trim())&&void 0!==l?l:"",tab_context:await this.getTabContext(t)}}catch(e){return this.deps.logger.error("[browser_computer_use] GetPageText error:",e),{tab_context:await this.getTabContext(t),error:e instanceof Error?e.message:String(e)}}}async Navigate(e){let t=e.tab_id;try{if("forward"===e.url)return await this.executeJs(t,()=>{window.history.forward()}),{message:"Navigated forward",tab_context:await this.getTabContext(t)};if("back"===e.url)return await this.executeJs(t,()=>{window.history.back()}),{message:"Navigated back",tab_context:await this.getTabContext(t)};let a=e.url.includes("://")?e.url:"https://".concat(e.url);return await this.executeJs(t,v,{url:a}),{message:"Navigated to ".concat(a),tab_context:await this.getTabContext(t)}}catch(e){return this.deps.logger.error("[browser_computer_use] Navigate error:",e),{tab_context:await this.getTabContext(t),error:e instanceof Error?e.message:String(e)}}}async ReadPage(e){let t=e.tab_id;try{let a="interactive"===e.filter?"interactive":"all";return await this.executeJs(t,b),{result:(await this.executeJs(t,w,{filter:a,scaleX:1,scaleY:1})).pageContent,tab_context:await this.getTabContext(t)}}catch(e){return this.deps.logger.error("[browser_computer_use] ReadPage error:",e),{tab_context:await this.getTabContext(t),error:e instanceof Error?e.message:String(e)}}}async TabsCreate(e){try{let e=await this.deps.tabsManager.addTabToTask();return{message:"Created new tab ".concat(e.id),tab_id:e.id,tab_context:await this.getTabContext(e.id)}}catch(e){return this.deps.logger.error("[browser_computer_use] TabsCreate error:",e),{tab_context:await this.getTabContext(),error:e instanceof Error?e.message:String(e)}}}async TabsContext(e){return{tab_context:await this.getTabContext()}}async getTabContext(e){try{var t,a,l,r;let s=await this.deps.tabsManager.getTaskTabs(),i=s.map(e=>{var t;return{tab_id:e.id,title:null!==(t=e.title)&&void 0!==t?t:"",url:e.url}});return{current_tab_id:null!==(l=null!=e?e:null===(t=i[0])||void 0===t?void 0:t.tab_id)&&void 0!==l?l:-1,executed_on_tab_id:null!==(r=null!=e?e:null===(a=i[0])||void 0===a?void 0:a.tab_id)&&void 0!==r?r:-1,available_tabs:i,tab_count:s.length}}catch(t){return this.deps.logger.error("[browser_computer_use] Failed to get tab context:",t),{current_tab_id:null!=e?e:-1,executed_on_tab_id:null!=e?e:-1,available_tabs:[],tab_count:0}}}async executeJs(e,t){for(var a=arguments.length,l=Array(a>2?a-2:0),r=2;r<a;r++)l[r-2]=arguments[r];return(await this.deps.mobileBridge.agent_execute_js({id:e,js:"(".concat(t.toString(),")(").concat(l.map(e=>JSON.stringify(e)).join(","),")")})).result}constructor(e){(0,l._)(this,"deps",void 0),this.deps=e}}class M{async getTaskTabs(){return(await Promise.all([...this.tabRegistry.keys()].map(async e=>{let t=await this.deps.mobileBridge.tabs_get({id:e});return t.tab||this.tabRegistry.delete(e),t.tab}))).filter(e=>void 0!==e)}async addTabToTask(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"about:blank",t=(await this.deps.mobileBridge.tabs_create({hidden:!1,agent:!0,url:e})).tab;return this.tabRegistry.add(t.id),t}async init(e){let t=e.tab_id;if(t){let{tab:e}=await this.deps.mobileBridge.tabs_get({id:t});e&&this.tabRegistry.add(e.id)}e.start_url&&await this.addTabToTask(e.start_url)}async destroy(){[...this.tabRegistry.keys()].map(async e=>{this.tabRegistry.delete(e),await this.deps.mobileBridge.tabs_close({id:e})})}constructor(e){(0,l._)(this,"deps",void 0),(0,l._)(this,"tabRegistry",new Set),this.deps=e}}let C=async(e,t)=>{let a={};try{a=JSON.parse(e.extra_headers)}catch(e){}let l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];function l(e){for(var a=arguments.length,l=Array(a>1?a-1:0),r=1;r<a;r++)l[r-1]=arguments[r];n.vF[e](...l,...t)}return{error:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return l("error",...t)},warn:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return l("warn",...t)},info:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return l("info",...t)},debug:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return l("debug",...t)},log:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return l("log",...t)}}}({...a,taskId:e.uuid,uuid:e.uuid}),r=new M({mobileBridge:t,logger:l}),s=new _({mobileBridge:t,tabsManager:r,logger:l});return new j({payload:e,tabsManager:r,browserComputerUseToolsService:s,logger:l}).start()};class j{async start(){this.deps.logger.log("[agent] Starting agent task:",this.deps.payload);let e=performance.now(),t=()=>{},a=()=>{},l=new Promise((e,l)=>{t=e,a=l}),r=this.deps.payload.base_url+"/agent";this.socket=new WebSocket(r),this.socket.onopen=t,this.socket.onerror=a,this.socket.onmessage=this.handleRpcMessage.bind(this),await l,await this.deps.tabsManager.init(this.deps.payload);let{tab_context:s}=await this.deps.browserComputerUseToolsService.TabsContext({});return this.socket.send(JSON.stringify({start_agent:{task:this.deps.payload.task,task_uuid:this.deps.payload.uuid,extension_version:"0.0.1",url:this.deps.payload.start_url,tabs_context:s,extra_headers:this.deps.payload.extra_headers,client_start_time_ms:Math.round(performance.now()-e)}})),async()=>{await this.cleanup("EXTERNAL_CLEANUP")}}async handleRpcMessage(e){let t=JSON.parse(e.data),a=t.request_id,l=e=>{var t;(null===(t=this.socket)||void 0===t?void 0:t.readyState)===WebSocket.OPEN?this.socket.send(JSON.stringify({rpc_response:e})):this.deps.logger.warn("[agent] Socket is not open, cannot send response:",e)};try{if(!t.method)throw Error("No method specified in RPC request");if("ReportTaskComplete"===t.method){this.cleanup("AGENT_TASK_COMPLETED");return}let e=t.request?JSON.parse(t.request):void 0,r=performance.now();if(this.deps.logger.log("[agent] Request",{method:t.method,request:e}),t.method in this.deps.browserComputerUseToolsService){let s=t.method,i=await this.deps.browserComputerUseToolsService[s](e);this.deps.logger.log("[agent] Response",{method:t.method,response:i,duration:Math.round(performance.now()-r)}),l({request_id:a,response:JSON.stringify(i)});return}throw this.deps.logger.error("[agent] Unknown method:",t.method),Error("Unknown method: ".concat(t.method))}catch(e){l({request_id:a,response:JSON.stringify({status:"error",error:"".concat(e)})}),this.deps.logger.error("[agent] Error handling RPC message:",e,t)}}async cleanup(e){var t;this.isCleanupInProgress||(this.isCleanupInProgress=!0,null===(t=this.socket)||void 0===t||t.close(),this.deps.tabsManager.destroy(),this.deps.logger.info("[task/cleanup] Cleanup",{reason:e}))}constructor(e){(0,l._)(this,"deps",void 0),(0,l._)(this,"socket",void 0),(0,l._)(this,"isCleanupInProgress",!1),this.deps=e}}class A{get isAvailable(){return null!=window.cometBridge}startListenMessages(){window.cometBridge&&(window.cometBridge.onmessage=e=>{let t=e.data;if(t)try{let e=JSON.parse(t),a=this.requests.get(e.request_id);a?(this.requests.delete(e.request_id),a(e)):(console.warn("No callback found for requestId",e.request_id,e),n.vF.warn("No callback found for requestId",e.request_id,e))}catch(e){console.warn("Failed to parse bridge response",t,e),n.vF.warn("Failed to parse bridge response",t,e)}})}constructor(){(0,l._)(this,"requests",new Map),(0,l._)(this,"bridge",void 0),this.bridge=new Proxy({},{get:(e,t)=>e=>{let a=crypto.randomUUID(),l={request_id:a,[t]:null!=e?e:{}};return new Promise((e,t)=>{var r;this.requests.set(a,a=>{"error"in a?t(Error(String(a.error))):e(a)}),null===(r=window.cometBridge)||void 0===r||r.postMessage(JSON.stringify(l))})}}),this.startListenMessages()}}class E{get isAvailable(){var e,t;return(null===(t=window.webkit)||void 0===t?void 0:null===(e=t.messageHandlers)||void 0===e?void 0:e.cometBridge)!=null}constructor(){(0,l._)(this,"bridge",void 0),this.bridge=new Proxy({},{get:(e,t)=>async e=>{var a,l,r;let s=crypto.randomUUID(),i=await (null===(r=window.webkit)||void 0===r?void 0:null===(l=r.messageHandlers)||void 0===l?void 0:null===(a=l.cometBridge)||void 0===a?void 0:a.postMessage(JSON.stringify({request_id:s,[t]:null!=e?e:{}})));if(!i)throw Error("No response from cometBridge");return JSON.parse(i)}})}}let S="mcp_tools_settings_v1";var k=a(50698),N=a(57874),T=a(81080);let I=Object.freeze([]);class R{getStore(){return this.store}getMobileProxy(){return this.mobileProxy}setClassifierApiTimeoutMs(e){this.classifierApiTimeoutMs=e}async openNewTab(e){let t=new URL(e);t.searchParams.delete("erp"),t.pathname=t.pathname.replace("/sidecar",""),await this.openTab({url:t.toString(),request_id:"openNewTab",key:"openNewTab"})}_getNavigationResults(e){var t;return null!==(t=this.store.getState().navigationResults[e])&&void 0!==t?t:I}async closeSideCar(){return this.send({type:"HIDE_SIDECAR"})}async openTab(e){var t,a,l;if("web"!==this.platform){let a=(await (null===(t=this.mobileProxy)||void 0===t?void 0:t.bridge.tabs_create({url:e.url,hidden:!1}))).tab;return{is_success:!0,_metadata:{time:1},result:{tab_id:a.id,url:a.url,title:a.title,last_accessed:a.last_accessed}}}return{is_success:!0,result:(await this.tools.OpenTab({key:null!==(a=e.key)&&void 0!==a?a:"unknown",request_id:null!==(l=e.request_id)&&void 0!==l?l:"unknown",url:e.url,tab_id:e.tabId})).tab}}async fetchMobileSearchResults(e,t){let[a,l]=await Promise.all([this.mobileProxy.bridge.fetch_navigation_search_results({query:e,stream_id:t}),(0,i.cl)(e,this.classifierApiTimeoutMs).catch(a=>(n.vF.error("Classifier API call failed, using defaults",{error:a,query:e,streamId:t}),i.d6))]);return{...a.nav_search_response,classifierResult:l}}async fetchNavigationResults(e,t){if("web"!==this.platform)return{...await this.fetchMobileSearchResults(e,t),_metadata:void 0};{let a=await this.send({type:"NAV_SEARCH",payload:{query:e,streamId:t}});if(!a.is_success)throw Error("Failed to inject search results");return a}}async injectSearchResults(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{var l,r,d;let s=(0,o.Ip)(),c={streamId:t,...a};(0,o.Lr)("web.frontend.comet_navigation_run_inject",c);let u=await this.fetchNavigationResults(e,t);if(this.store.getState().actions.addNavigationResults(t,u),"web"!==this.platform&&(null===(l=u.results)||void 0===l?void 0:l.length)){let e=this.store.getState();(0,i.Wr)({clientPayloadCacheKey:"nav-".concat(t),cometBrowser:this,reason:"mobile_search_injection",navigationResults:u.results,maxChars:5e4,includeSidecar:!1,attachedTabs:[],cometState:e}).catch(e=>{n.vF.error("Failed to save mobile navigation results",{streamId:t,error:e})})}let m={type:null!==(d=u.type)&&void 0!==d?d:"unknown",...c};s.addTiming("web.frontend.comet_navigation_search_results",m);let p=s.getAbsoluteStartTime(),h={...m,startTime:p};u.searchTime&&(0,o.Rh)("web.frontend.comet_navigation_search_time",{duration:u.searchTime,...h}),u.classifyTime&&(0,o.Rh)("web.frontend.comet_navigation_classify_time",{duration:u.classifyTime,...h}),u.networkingTime&&(0,o.Rh)("web.frontend.comet_navigation_networking_time",{duration:u.networkingTime,...h}),"web"===this.platform&&(null===(r=u._metadata)||void 0===r?void 0:r.time)&&(0,o.Rh)("web.frontend.comet_navigation_extension_processing",{duration:u._metadata.time,...h})}catch(e){n.vF.error(new s.B("NAV_RESULTS_INJECTION_FAILED",{details:{streamId:t},cause:e}))}}async getIsCometDefaultBrowser(e){try{let t=await this.send({type:"GET_IS_DEFAULT_BROWSER",key:e});if(t.is_success)return t.isDefault;return null}catch(e){return null}}async setCometAsDefaultBrowser(e){return this.send({type:"SET_AS_DEFAULT_BROWSER",key:e})}async getDidSkipCookieImportOnboarding(e){let t="NOT_IMPORTED"===(await this.send({type:"GET_ONBOARDING_IMPORT_STATUS",key:e})).importStatus;return n.vF.info("[getDidSkipCookieImportOnboarding]",t),t}notifyUserStateChanged(e){this.send({type:"USER_STATE_CHANGED",payload:e}).catch(()=>{})}subscribeCometNavigate(e){let t=t=>{let a=new URL(t.detail.url);if(delete window.pplxNavIntentEvent,this.store.getState().actions.clearUserSelection(),(0,o.Lr)("comet_navigate"),"/search"===a.pathname&&a.searchParams.has("q")&&(a.pathname="/search/new"),"/search/new"===a.pathname){var l;let e=crypto.randomUUID(),r=t.detail.text||"",s=null!==(l=a.searchParams.get("q"))&&void 0!==l?l:"";a.searchParams.set("streamId",e),this.injectSearchResults(s,e,{omnisearch:!0}),this.store.getState().actions.setLastOmniboxInput(e,r)}e({url:a})};return window.pplxNavIntentEvent&&t(window.pplxNavIntentEvent),document.addEventListener("comet-navigate",t),()=>{document.removeEventListener("comet-navigate",t)}}subscribeToCometQuery(e){let t=t=>{let a=t.detail.query;delete window.pplxCometQuery,e(a,{source:t.detail.source})};return window.pplxCometQuery&&t(window.pplxCometQuery),document.addEventListener("comet-query",t),()=>{document.removeEventListener("comet-query",t)}}getLastOmniboxInput(e){return this.store.getState().omniboxInput[e]}async searchTabs(e){if("web"!==this.platform){let{tabs:e}=await this.mobileProxy.bridge.tabs_query();return{is_success:!0,tabs:e.map(e=>{var t,a;return{tabId:e.id,title:null!==(t=e.title)&&void 0!==t?t:"",url:e.url,isCurrent:!1,lastAccess:null!==(a=e.last_accessed)&&void 0!==a?a:0,snippet:""}}),_metadata:{time:1}}}return{is_success:!0,tabs:(await this.tools.SearchBrowser({queries:[],sources:["OPEN_TABS"],key:e,history_max_results:0,open_tabs_max_results:500,closed_tabs_max_results:0,request_id:e})).open_tabs_results.map(e=>({...e,tabId:e.tab_id,lastAccess:e.last_accessed}))}}async ungroupTabs(e,t,a){return{is_success:!0,tabIds:(await this.tools.UngroupTabs({group_ids:e.groupIds,tab_ids:e.tabIds,key:t,request_id:a})).ungrouped_tabs.map(e=>({id:e.tab_id,error:e.error})),groupIds:e.groupIds.map(e=>({id:e}))}}showNotification(){this.send({type:"SHOW_NOTIFICATION"}).catch(()=>{})}sendThreadStatusToMobile(e){let{status:t,streamId:a,text:l}=e;this.mobileProxy.bridge.thread_status({type:t,text:l,stream_id:a}).catch(e=>{n.vF.error("Failed to send thread status to mobile bridge",e)})}sendVoiceStatusToMobile(e){let{status:t,text:a}=e;this.mobileProxy.bridge.voice_status({type:t,text:a}).catch(e=>{n.vF.error("Failed to send voice status to mobile bridge",e)})}subscribeToMobileCommands(e){let t=t=>{e?e(t.detail):"stop"===t.detail.cmd&&"thread"===t.detail.subject?this.emitter.emit("BROWSER_TASK_STOP"):n.vF.warn("[comet-mobile] Unknown mobile command",t.detail.cmd)};return document.addEventListener("comet-mobile-cmd",t),()=>{document.removeEventListener("comet-mobile-cmd",t)}}setTabProgress(e){this.send({type:"SET_TAB_PROGRESS",payload:e}).catch(()=>{})}async searchTabGroups(e,t,a){return{is_success:!0,results:(await this.tools.SearchTabGroups({queries:e.queries,request_id:a,key:t})).tab_groups.map(e=>({...e,color:e.color,tabs:e.tabs.map(e=>{var t;return{...e,tabId:e.tab_id,isCurrent:null!==(t=e.is_current_tab)&&void 0!==t&&t}})}))}}showFeedbackForm(){this.send({type:"SHOW_FEEDBACK_FORM"}).catch(()=>{})}subscribeScreenshotCaptured(e){return this.emitter.on("SCREENSHOT_CAPTURED",e)}async fetchOpenedTabs(){let e=await this.searchTabs("fetch_opened_tabs");return e.is_success?e.tabs.filter(e=>(e.url.startsWith("https://")||e.url.startsWith("file://"))&&!e.isCurrent).sort((e,t)=>t.lastAccess-e.lastAccess):[]}async getPersonalSuggestions(e,t){return this.send({type:"GET_PERSONAL_SUGGESTIONS",payload:e,key:t})}async getTopMostVisitedUrls(e,t){return this.send({type:"GET_TOP_MOST_VISITED_URLS",payload:e,key:t})}getQuickActions(e){return this.send({type:"GET_QUICK_ACTIONS",key:e})}async getInitialHistorySummary(e,t,a){return this.SearchBrowser({queries:[],sources:["HISTORY"],key:"initial-history-summary",request_id:e,start_time:864e5*t,history_max_results:a,open_tabs_max_results:a,closed_tabs_max_results:a})}async getHistorySummary(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:14,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20;return this.SearchBrowser({queries:t,sources:["HISTORY"],key:e,request_id:"",start_time:864e5*a,history_max_results:l,open_tabs_max_results:l,closed_tabs_max_results:l})}async GetContent(e){return"web"!==this.platform?{contents:(await Promise.allSettled(e.pages.map(async e=>e.id?(await this.mobileProxy.bridge.tabs_get_content({id:e.id})).tab_content:(await this.mobileProxy.bridge.tabs_get_url_content({url:e.url})).tab_content))).map(e=>"fulfilled"===e.status?e.value:void 0).filter(e=>void 0!==e).map(e=>{var t,a,l;return{html:"",id:e.id,url:e.url,title:null!==(t=e.title)&&void 0!==t?t:"",og_meta:null!==(a=e.og_meta)&&void 0!==a?a:{},markdown:null!==(l=e.markdown)&&void 0!==l?l:""}})}:this.tools.GetContent(e)}async GetVisibleTabScreenshot(e){return this.tools.GetVisibleTabScreenshot(e)}async SearchBrowser(e){if("web"!==this.platform){let t=e.sources.includes("HISTORY")?Promise.allSettled((e.queries.length?e.queries:[""]).map(async t=>await this.mobileProxy.bridge.history_search({text:t,max_results:e.history_max_results,start_time:e.start_time,end_time:e.end_time}))):[],[{tabs:a},l]=await Promise.all([e.sources.includes("OPEN_TABS")?this.mobileProxy.bridge.tabs_query():{tabs:[]},t]);return{closed_tabs_results:[],history_results:l.map(e=>"fulfilled"===e.status?e.value.history_items:[]).flat().map(e=>{var t,a,l;return{title:null!==(t=e.title)&&void 0!==t?t:"",url:e.url,last_accessed:null!==(a=e.last_visit_time)&&void 0!==a?a:Date.now(),visit_count:null!==(l=e.visit_count)&&void 0!==l?l:1}}),open_tabs_results:a.map(e=>{var t,a;return{tab_id:e.id,title:null!==(t=e.title)&&void 0!==t?t:"",url:e.url,last_accessed:null!==(a=e.last_accessed)&&void 0!==a?a:0}})}}return this.tools.SearchBrowser(e)}async GetSidecarContext(e){if("web"!==this.platform){let e=(await this.mobileProxy.bridge.tabs_query()).tabs.sort((e,t)=>{var a,l;return(null!==(a=t.last_accessed)&&void 0!==a?a:-1)-(null!==(l=e.last_accessed)&&void 0!==l?l:-1)})[0];if(!e)return{content:void 0,contents:void 0};let t=(await this.mobileProxy.bridge.tabs_get_content({id:null==e?void 0:e.id})).tab_content,a={id:t.id,html:"",markdown:t.markdown,og_meta:t.og_meta,title:t.title,url:t.url};return{content:a,contents:[a]}}return this.tools.GetSidecarContext(e)}async closeTabs(e,t,a){var l,r;if("web"!==this.platform){let{tabs:t}=await this.mobileProxy.bridge.tabs_query(),a=null!==(l=e.tabIds)&&void 0!==l?l:[],r=t.filter(e=>a.includes(e.id));return r.forEach(e=>{this.mobileProxy.bridge.tabs_close({id:e.id})}),{is_success:!0,result:r.map(e=>{var t;return{id:e.id,url:e.url,title:null!==(t=e.title)&&void 0!==t?t:""}})}}return{is_success:!0,result:(await this.tools.CloseTabs({tab_ids:null!==(r=e.tabIds)&&void 0!==r?r:[],key:t,request_id:a})).tabs.map(e=>({id:e.tab_id,...e}))}}async groupTabs(e,t,a){var l;let r=await this.tools.GroupTabs({...e,tab_ids:e.tabIds,group_id:e.groupId,key:t,request_id:a});if(!r.tab_group)throw Error("[GroupTabs] Tab group not found");return{is_success:!0,tabGroup:{id:r.tab_group.id,title:r.tab_group.title,collapsed:null!==(l=r.tab_group.collapsed)&&void 0!==l&&l,color:r.tab_group.color}}}async maybeSendSearchResult(e,t,a){var l,r;if(!this.isTestDebugMode||!e)return;let s=[...null!==(l=e.web_results)&&void 0!==l?l:[],...null!==(r=e.extra_web_results)&&void 0!==r?r:[]].map(e=>({name:e.name,snippet:e.snippet,url:e.url,isClientContext:!!e.is_client_context}));return this.send({type:"PERPLEXITY_SEARCH_RESULT",payload:{answer:e.answer,webResults:s,isPending:a,steps:t.map(e=>e.step_type)}})}submitTask(e,t){return new Promise((a,l)=>{var r;let s=e.entryId,o=e.uuid;this.store.getState().actions.setPendingTask(o,{entryId:e.entryId,uuid:e.uuid,resolve:a,reject:l,onProgress:t});let d=null!==(r=this.taskTeardowns.get(s))&&void 0!==r?r:[];if(this.taskTeardowns.set(s,d),"web"!==this.platform){let t=C(e,this.mobileProxy.bridge);d.push(()=>t.then(t=>{t(),this.store.getState().actions.setTaskState(e.uuid,void 0)})),a({message:"Mobile task started",success:!0});return}this.agentExtension.sendMessage(e).then(()=>{d.push(t=>{this.agentExtension.sendMessage({type:"CLEANUP_AGENT_TASKS",payload:{entryId:e.entryId,reason:t}})})}).catch(t=>{let a={};try{a=JSON.parse(e.extra_headers)}catch(e){}n.vF.error("[comet] Unhandled error while submitting task",t),(0,i.xT)({clientPayloadCacheKey:o,errorType:t,errorMsg:"Agent task start failure."},a,"CometAdapter").catch(e=>{n.vF.error("Error sending tool failure",e)})})})}async moveThreadToSidecar(e){let{activeTaskUuid:t,entryId:a,isMissionControl:l,reason:r,waitForNavigation:i,animate:o,takeFocus:d}=e;try{return(await this.agentExtension.sendMessage({type:"MOVE_THREAD_TO_SIDECAR",payload:{active_task_uuid:t,is_mission_control:l,entry_id:a,wait_for_navigation:i,animate:o,takeFocus:d}})).success}catch(e){return n.vF.error(new s.B("MOVE_THREAD_TO_SIDECAR_FAILED",{cause:e,message:"Failed to move thread to sidecar for ".concat(r)})),!1}}getTaskTabs(){this.agentExtension.sendMessage({type:"GET_TASK_TABS"})}async sendMissionControlStatus(e){await this.agentExtension.sendMessage({type:"MISSION_CONTROL_STATUS",payload:e})}async makeTaskVisible(e){let t=await this.agentExtension.sendMessage({type:"MAKE_TASK_VISIBLE",payload:{task_uuid:e}});if(t.tab_ids){let e=new URL(window.location.href).pathname;t.tab_ids.forEach(t=>{this.store.getState().actions.setSidecarUrlById((0,i.VJ)(t,void 0),e)})}}cleanupTasks(e,t){if(!e)return;let a=this.taskTeardowns.get(e);a&&(a.forEach(e=>e(t)),this.taskTeardowns.delete(e))}captureSourceTabScreenshotV2(e){let{sourceTabUrl:t=""}=e;this.agentExtension.sendMessage({type:"CAPTURE_SCREENSHOT_V2",payload:{tabId:void 0,sourceTabUrl:t}})}deactivateScreenshotTool(){this.agentExtension.sendMessage({type:"DEACTIVATE_SCREENSHOT_TOOL",payload:{tabId:void 0}})}subscribeToSidecarBrowserTaskStop(e){return this.emitter.on("BROWSER_TASK_STOP",e)}subscribeForceSubmitQuery(e){return this.emitter.on("FORCE_SUBMIT_QUERY",e)}subscribeQuickActionButtonFired(e){return this.emitter.on("QUICK_ACTION_BUTTON_FIRED",e)}getMcpTools(e){return this.sendToAgent({type:"GET_MCP_TOOLS",payload:{serverName:e}})}callMcpTool(e,t){return this.sendToAgent({type:"CALL_MCP_TOOL",payload:e,context:t})}getMcpStdioServers(){let e=this.sendToAgent({type:"GET_STDIO_MCP_SERVERS",payload:void 0});return e.then(e=>{this.getStore().getState().actions.setMcpStdioServers(e)}).catch(()=>{}),e}addMcpStdioServer(e){return this.sendToAgent({type:"ADD_STDIO_MCP_SERVER",payload:e})}async updateMcpStdioServer(e,t){try{return await this.sendToAgent({type:"UPDATE_STDIO_MCP_SERVER",payload:{existingServerName:e,updates:t}})}catch(a){if(!(a instanceof Error)||!a.message.startsWith("Error in invocation of perplexity.mcp.updateStdioServer")&&!a.message.startsWith("chrome.perplexity.mcp.updateStdioServer is not a function"))throw a;return t.name&&t.name!==e?this.pendingServerRename={oldName:e,newName:t.name}:this.pendingServerRename=void 0,await this.removeMcpStdioServer(e,!0),this.addMcpStdioServer(t)}}async removeMcpStdioServer(e,t){await this.sendToAgent({type:"REMOVE_STDIO_MCP_SERVER",payload:{name:e}}),this.clearStateAfterRemovingMcpServer(e,t)}installDxt(e){return this.sendToAgent({type:"INSTALL_DXT",payload:{url:e}})}async uninstallDxt(e){await this.sendToAgent({type:"UNINSTALL_DXT",payload:{name:e}}),this.clearStateAfterRemovingMcpServer(e)}getInstalledDxts(){let e=this.sendToAgent({type:"GET_INSTALLED_DXT"});return e.then(e=>{this.getStore().getState().actions.setInstalledDxts(e)}).catch(()=>{}),e}async refreshDxtAndMcpState(){await Promise.all([this.getMcpStdioServers(),this.getInstalledDxts()])}async hasPermission(e){try{return await this.sendToAgent({type:"HAS_PERMISSION",payload:{permission:e}})}catch(e){return null}}async requestPermission(e){try{return await this.sendToAgent({type:"REQUEST_PERMISSION",payload:{permission:e}})}catch(e){return null}}handleMcpStdioServerChanged(e,t,a){var l;let r=this.getStore().getState(),s=null!==(l=r.mcpStdioServers)&&void 0!==l?l:[],i=s.findIndex(t=>t.name===e);if(-1===i)return;let n=[...s];n[i]=a,r.actions.setMcpStdioServers(n)}async send(e){return this.mainExtension.sendMessage(e).then(e=>(e.is_success=!e.errorType,e))}async sendToAgent(e){return this.agentExtension.sendMessage(e).then(e=>{if(!e.success)throw Error(e.error);return e.response})}clearStateAfterRemovingMcpServer(e,t){var a,l;let r=this.getStore().getState(),s=null!==(a=r.mcpDisabledServers)&&void 0!==a?a:new Set;if(s.has(e)){let t=new Set(s);t.delete(e),r.actions.setMcpDisabledServers(t)}if(t&&!this.pendingServerRename)return;if(this.pendingServerRename&&this.pendingServerRename.oldName===e){r.actions.renameMcpServerInToolsSettings(this.pendingServerRename.oldName,this.pendingServerRename.newName),this.pendingServerRename=void 0;return}let i=null!==(l=r.mcpToolsSettings)&&void 0!==l?l:{};if(i[e]){let t={...i};delete t[e],r.actions.setMcpToolsSettings(t)}}constructor(){(0,l._)(this,"tools",void 0),(0,l._)(this,"mobileProxy",new E),(0,l._)(this,"isTestDebugMode",!1),(0,l._)(this,"platform","web"),(0,l._)(this,"store",(0,N.v)((e,t)=>({platformInfo:void 0,sidecarSourceTab:{url:"/",title:"",tabId:-1,secondaryTab:null},screenshotToolEnabled:!0,sidecarUrlById:new Map,tasksState:{},navigationResults:{},classifierResults:{},omniboxInput:{},navigationMeta:{},taskScreenshots:{},userSelection:void 0,mcpStdioServers:void 0,mcpTools:void 0,mcpDisabledServers:void 0,installedDxts:void 0,taskTabs:void 0,mcpToolsSettings:void 0,pendingTasks:new Map,actions:{setPlatformInfo:t=>{e({platformInfo:t})},setSidecarUrlById:(a,l,r)=>{let s=t().sidecarUrlById;s.set(a,{url:l,updatedAt:null!=r?r:Date.now()}),e({sidecarUrlById:s})},deleteSidecarUrlById:a=>{let l=t().sidecarUrlById;l.delete(a),e({sidecarUrlById:l})},setSourceTab:t=>{let a=!0;try{let e=new URL(t.url);a="chrome:"!==e.protocol&&"comet:"!==e.protocol||"newtab"===e.hostname}catch(e){}e({sidecarSourceTab:t,screenshotToolEnabled:a})},setLastOmniboxInput:(t,a)=>{e(e=>({omniboxInput:{...e.omniboxInput,[t]:a}}))},addNavigationResults:(t,a)=>{let{results:l,classifierResult:r,...s}=a;(null==l?void 0:l.length)&&e(e=>{let a={navigationResults:{...e.navigationResults,[t]:l}};return r&&(a.classifierResults={...e.classifierResults,[t]:r}),s&&!e.navigationMeta[t]&&(a.navigationMeta={...e.navigationMeta,[t]:s}),a})},setTaskScreenshot:(t,a)=>{e(e=>({taskScreenshots:{...e.taskScreenshots,[t]:a}}))},setTaskState:(t,a)=>{e(e=>{let l={...e.tasksState};return void 0===a?delete l[t]:l[t]={is_paused:a},{tasksState:l}})},setUserSelection:t=>{e({userSelection:t})},clearUserSelection:()=>{e({userSelection:void 0})},setMcpStdioServers:t=>{e({mcpStdioServers:t})},setMcpTools:(t,a)=>{e(e=>({mcpTools:{...e.mcpTools,[t]:a}}))},removeMcpTools:t=>{e(e=>{let a={...e.mcpTools};return delete a[t],{mcpTools:a}})},setMcpDisabledServers:t=>{e({mcpDisabledServers:t}),k.U.setItem("mcp_disabled_servers_v1",JSON.stringify(Array.from(t)))},setMcpToolsSettings:t=>{e({mcpToolsSettings:t}),k.U.setItem(S,JSON.stringify(t))},setMcpToolEnabled:(t,a,l)=>{e(e=>{var r;let s=e.mcpToolsSettings||{},i={...s[t]||{}},n=null!==(r=i[a])&&void 0!==r?r:{enabled:!0},o={...i,[a]:{...n,enabled:l}},d={...s,[t]:o};return k.U.setItem(S,JSON.stringify(d)),{mcpToolsSettings:d}})},renameMcpServerInToolsSettings:(t,a)=>{e(e=>{let l=e.mcpToolsSettings||{};if(!l[t]||t===a)return e;let r={...l},s=l[t];return r[a]={...s},delete r[t],k.U.setItem(S,JSON.stringify(r)),{mcpToolsSettings:r}})},setInstalledDxts:t=>{e({installedDxts:t})},setTaskTabs:t=>{e({taskTabs:t})},setPendingTask:(t,a)=>{e(e=>{let l=new Map(e.pendingTasks);return l.set(t,a),{pendingTasks:l}})},deletePendingTask:t=>{e(e=>{let a=new Map(e.pendingTasks);return a.delete(t),{pendingTasks:a}})},getPendingTask:e=>t().pendingTasks.get(e)}}))),(0,l._)(this,"mainExtension",void 0),(0,l._)(this,"agentExtension",void 0),(0,l._)(this,"taskTeardowns",new Map),(0,l._)(this,"emitter",(0,r.G)()),(0,l._)(this,"pendingServerRename",void 0),(0,l._)(this,"classifierApiTimeoutMs",i.aZ),(0,l._)(this,"handleAgentExtensionMessage",e=>{try{(0,T.YW)(e).with({type:"SCREENSHOT_CAPTURED"},async e=>{let{payload:{screenshot:t}}=e,a=await fetch(t),l=await a.blob(),r=new File([l],"screenshot.png",{type:l.type});n.vF.info("Screenshot captured"),this.emitter.emit("SCREENSHOT_CAPTURED",r)}).with({type:"BROWSER_TASK_PROGRESS_SCREENSHOT"},async e=>{let{payload:{screenshot:t,taskUuid:a}}=e;this.store.getState().actions.setTaskScreenshot(a,"data:image/png;base64,".concat(t))}).with({type:"BROWSER_TASK_PROGRESS"},e=>{let{payload:{taskUuid:t,progress:a}}=e,l=this.store.getState().actions.getPendingTask(t);(null==l?void 0:l.onProgress)&&l.onProgress(a),this.emitter.emit("BROWSER_TASK_PROGRESS",t,a)}).with({type:"BROWSER_TASK_COMPLETE"},e=>{let{payload:{taskUuid:t,result:a}}=e,l=this.store.getState().actions.getPendingTask(t);l&&(this.store.getState().actions.deletePendingTask(t),l.resolve(a)),this.emitter.emit("BROWSER_TASK_COMPLETE",t,a)}).with({type:"BROWSER_TASK_STOP"},e=>{let{payload:t}=e;n.vF.info("Browser task stopped"),this.emitter.emit("BROWSER_TASK_STOP",t.entryId)}).with({type:"BROWSER_TASK_PAUSE_RESUME_FRONTEND"},e=>{let{payload:t}=e;n.vF.info("Browser task paused/resumed"),this.store.getState().actions.setTaskState(t.task_uuid,t.is_paused)}).with({type:"AGENT_TASK_FAILURE"},e=>{let{payload:{taskUuid:t,extraHeaders:a,error:l}}=e,r=this.store.getState().actions.getPendingTask(t);r&&(this.store.getState().actions.deletePendingTask(t),r.reject(Error(l))),(0,i.xT)({clientPayloadCacheKey:t,errorType:l,errorMsg:"Agent task failure."},a,"CometAdapter").catch(e=>{n.vF.error("Error sending tool failure",e)})}).with({type:"USER_SELECTION_CAPTURED"},e=>{let{payload:{selection:t}}=e;this.store.getState().actions.setUserSelection(t)}).with({type:"MOVE_THREAD_TO_SIDECAR"},e=>{let t,a,{payload:{url:l,task_tab_ids:r,entry_id:s}}=e;s?(a=new URL(window.location.href)).pathname="/sidecar/search/"+s:(a=new URL(l)).pathname="/sidecar"+a.pathname,t=a.toString(),r.forEach(e=>{this.store.getState().actions.setSidecarUrlById((0,i.VJ)(e,void 0),a.pathname)}),document.dispatchEvent(new CustomEvent("comet-navigate",{detail:{url:t,text:""}}))}).with({type:"GET_TASK_TABS"},e=>{let{payload:{tabs:t}}=e;this.store.getState().actions.setTaskTabs(t)}).with({type:"MCP_STDIO_SERVER_CHANGED"},e=>{let{payload:{serverName:t,changes:a,server:l}}=e;this.handleMcpStdioServerChanged(t,a,l)}).otherwise(e=>{n.vF.log("Unknown message type",e)})}catch(e){n.vF.error("Error parsing entropy message",e)}}),(0,l._)(this,"handleMessage",e=>{try{(0,T.YW)(e).with({type:"UPDATE_SOURCE_TAB"},e=>{this.store.getState().actions.setSourceTab(e.payload),e.payload.url!==this.store.getState().sidecarSourceTab.url&&this.store.getState().actions.clearUserSelection()}).with({type:"FORCE_SUBMIT_QUERY"},e=>{this.isTestDebugMode&&this.emitter.emit("FORCE_SUBMIT_QUERY",e.payload)}).with({type:"QUICK_ACTION_BUTTON_FIRED"},()=>{this.emitter.emit("QUICK_ACTION_BUTTON_FIRED")}).with({type:"INIT"},e=>{var t,a,l,r;this.isTestDebugMode=!!e.payload.isTestDebugMode,this.store.getState().actions.setPlatformInfo(e.payload.platform),this.store.getState().actions.setSourceTab({tabId:null!==(t=e.payload.sourceTabId)&&void 0!==t?t:-1,url:null!==(a=e.payload.sourceTabUrl)&&void 0!==a?a:"",title:null!==(l=e.payload.sourceTabTitle)&&void 0!==l?l:"",secondaryTab:null!==(r=e.payload.sourceSecondaryTab)&&void 0!==r?r:null})}).otherwise(e=>{n.vF.log("Unknown message type",e)})}catch(e){n.vF.error("Error parsing entropy message",e)}});let e=(0,i.t5)();(null==e?void 0:e.android_version)&&(this.platform="android"),(null==e?void 0:e.ios_version)&&(this.platform="ios"),this.mainExtension=d({onMessage:this.handleMessage,extensionId:"mcjlamohcooanphmebaiigheeeoplihb",name:"entropy_client_context"}),this.agentExtension=d({onMessage:this.handleAgentExtensionMessage,extensionId:"npclhjbddhklpbnacpjloidibaggcgon",name:"entropy-agent-extension-main"}),this.tools=P(this.agentExtension),"web"===this.platform?this.mainExtension.sendMessage({type:"INIT"}).then(e=>{e&&(this.isTestDebugMode=!!e.isTestDebugMode)},e=>{if((0,i.bf)())throw e}):this.mobileProxy="android"===this.platform?new A:new E,(0,i.oy)()}}let P=e=>new Proxy({},{get:(t,a)=>t=>e.sendMessage({type:"CALL_TOOL",method:a,request:t}).then(e=>{let{success:t,response:a}=e;if(!t)throw a;return a}).catch(e=>{if(n.vF.error("Error calling tool",e),"errorType"in e)throw e;throw{errorType:"unhandled",errorMsg:"Proxy error."}})})},68203:(e,t,a)=>{"use strict";a.d(t,{N:()=>j});var l=a(25576),r=a(85860),s=a(83436),i=a(70714),n=a(83081),o=a(95899),d=a(95809),c=a(35009),u=a(35458),m=a(14489),p=a(24877),h=a(45100),v=a(80892),g=a(38481),f=a(71849),y=a(60410),x=a(38683),b=a(99390),w=a(21978),_=a(3041),M=a(66516);let C=e=>{var t,a;let{paymentMethodType:n,onPaymentMethodTypeChange:d,onDataLoaded:c,setIsExpressCheckoutLoading:u,subscriptionTier:m}=e,p=(0,w.rd)(),{isMobileStyle:g}=(0,x.al)(),[,b]=(0,h.L)(),{updateEmail:C,lineItems:j,taxAmounts:A,discountAmounts:E,total:S,currency:k,applyPromotionCode:N,removePromotionCode:T,confirm:I,recurring:R}=(0,s.useCheckout)(),{trackEventOnce:P,trackEvent:O}=(0,v.yw)(),{data:D}=(0,o.useSession)({required:!0,onUnauthenticated:()=>{p.push("/",void 0,"Checkout form unauthenticated")}});(0,r.useEffect)(()=>{var e,t;(null==D?void 0:null===(e=D.user)||void 0===e?void 0:e.email)&&C(null==D?void 0:null===(t=D.user)||void 0===t?void 0:t.email)},[null==D?void 0:null===(t=D.user)||void 0===t?void 0:t.email,C]);let L=null==j?void 0:null===(a=j[0])||void 0===a?void 0:a.unitAmount,U=S.subtotal,F=S.total,z=null==A?void 0:A[0];(0,r.useEffect)(()=>{k&&void 0!==L&&c({unitPrice:L,currency:k,subtotal:U,total:F,stripeTaxAmount:z,discountAmounts:E||void 0,applyPromotionCode:N,removePromotionCode:T,confirm:I,recurring:R||void 0})},[N,I,k,E,c,T,U,z,F,L,R]);let B=(0,r.useCallback)(async e=>{var t,a;if(!I)return;let l=(0,M.Ip)();u(!0),O("pro checkout attempt",{subscriptionTier:m,paymentMethodType:"apple_pay"});try{let a=await I({expressCheckoutConfirmEvent:e});if("error"===a.type){u(!1),O("pro checkout error",{subscriptionTier:m,error:null!==(t=a.error.code)&&void 0!==t?t:"unknown",paymentMethodType:"apple_pay"}),_.vF.warn("Error confirming payment",a.error),l.addTiming("web.payment_page.payment_error");return}O("pro checkout success",{subscriptionTier:m,paymentMethodType:"apple_pay"}),b(null),l.addTiming("web.payment_page.payment_success");try{await (0,f.fi)({reason:"inner-checkout-form"}),u(!1)}catch(e){_.vF.warn("Error refreshing subscription status",e)}l.addTiming("web.payment_page.subscription_refreshed")}catch(e){O("pro checkout error",{subscriptionTier:m,error:null!==(a=e.code)&&void 0!==a?a:"unknown",paymentMethodType:"apple_pay"}),l.addTiming("web.payment_page.payment_error"),u(!1)}},[I,O,u,b,m]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("section",{className:"mb-4",children:[g&&(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)(s.ExpressCheckoutElement,{onConfirm:B,options:{paymentMethods:{applePay:"always",googlePay:"always",link:"never"}}})}),(0,l.jsx)(s.PaymentElement,{options:{layout:"accordion",fields:{billingDetails:"never"},paymentMethodOrder:["card","link"],terms:{card:"never"}},onFocus:()=>{P("pro paymentinfo started",{subscriptionTier:m})},onChange:e=>{if(e.empty)return;let t=e.value.type;O("pro paymentinfo updated",{subscriptionTier:m,paymentMethodType:t}),d(t)}})]}),(0,l.jsxs)("section",{children:[(0,l.jsx)("header",{className:"mb-4",children:(0,l.jsx)(y.A,{as:"h3",variant:"base",color:"light",children:(0,l.jsx)(i.A,{defaultMessage:"Billing Information",id:"xhOkBTQQrX",description:"section header"})})}),(0,l.jsx)(s.AddressElement,{options:{mode:"billing"},onFocus:()=>{P("pro customerinfo started",{subscriptionTier:m,paymentMethodType:n})}})]})]})},j=e=>{let{origin:t,tier:a,onPaymentMethodTypeChange:i,onDataLoaded:o,setIsExpressCheckoutLoading:h,subscriptionTier:f,successRedirectUrl:y}=e,{locale:x}=(0,n.A)(),{referralCode:w,referralEvaluated:_}=(0,u.M)(),{trackEvent:M}=(0,v.yw)(),j=(0,d.F)(),A=(0,d.A)(),[E,S]=(0,r.useState)(),[k,N]=(0,r.useState)(p.Aq),T=(0,r.useCallback)(e=>{e!==k&&(i(e),N(e))},[i,k]),I=(0,c.i)();return((0,r.useEffect)(()=>{a&&_&&(S(void 0),o(void 0),(0,g.fw)({request:{referralCode:w,discountCode:null,origin:t,tier:a,locale:x,embedded:!0,subscriptionTier:f,success_redirect_url:y},reason:"checkout-form"}).then(e=>{(null==e?void 0:e.url)&&"string"==typeof e.url&&e.url.length>0?(0,b.x)(e.url,"Checkout form"):(null==e?void 0:e.clientSecret)?(S(e.clientSecret),M("pro checkout rendered",{subscriptionTier:f})):M("pro checkout session error",{subscriptionTier:f})}))},[w,t,a,M,x,o,f,y,_]),E)?(0,l.jsx)(s.CheckoutProvider,{stripe:I,options:{clientSecret:E,elementsOptions:{appearance:j,fonts:A}},children:(0,l.jsx)(C,{paymentMethodType:k,onPaymentMethodTypeChange:T,onDataLoaded:o,setIsExpressCheckoutLoading:h,subscriptionTier:f})},E):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.W,{className:"mb-4",children:(0,l.jsx)("div",{className:"bg-subtler h-[300px] w-full"})}),(0,l.jsx)(m.W,{children:(0,l.jsx)("div",{className:"bg-subtler h-[350px] w-full"})})]})}},68294:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,y:()=>n});var l=a(49611);let r="google-drive-picker-gapi-script",s="google-identity-services-script",i=(0,l.A)(async function(){if(!document.getElementById(s))return new Promise((e,t)=>{let a=document.createElement("script");a.src="https://accounts.google.com/gsi/client",a.id=s,a.onload=()=>e(),a.onerror=t,document.body.appendChild(a)})}),n=(0,l.A)(async function(){if(!document.getElementById(r))return new Promise((e,t)=>{let a=document.createElement("script");a.src="https://apis.google.com/js/api.js",a.id=r,a.onload=()=>{window.gapi.load("picker",{callback:e,onerror:t})},a.onerror=t,document.body.appendChild(a)})})},68361:(e,t,a)=>{"use strict";a.d(t,{s:()=>o});var l=a(85860),r=a(83081),s=a(50276),i=a(60010),n=a(3041);let o=e=>{let{reason:t}=e,{$t:a}=(0,r.A)(),{deprecatedOpenToast:o}=(0,i.G)(),d=(0,l.useCallback)(async e=>{try{let l=await (0,s.s4)({request:e,reason:t}),r=document.createElement("a");r.href=l,r.download=e.filename,document.body.appendChild(r),r.click(),document.body.removeChild(r),o(a({defaultMessage:"Downloading file...",id:"/vA9NyIeJh"}),"success",3)}catch(t){n.vF.error("Failed to download S3 asset",{error:t,request:e,errorMessage:t instanceof Error?t.message:"Unknown error"}),o(a({defaultMessage:"Failed to download file",id:"RIWlU8NdpC"}),"error",3)}},[t,a,o]),c=(0,l.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"media",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.body;try{let r=await fetch(e,{mode:"cors",cache:"no-cache"});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));let s=await r.blob(),i=URL.createObjectURL(s),n=document.createElement("a");n.href=i,n.download=t,l.appendChild(n),n.click(),l.removeChild(n),URL.revokeObjectURL(i);let d=t.toLowerCase().includes(".mp4")||t.toLowerCase().includes(".mov")||t.toLowerCase().includes(".avi")||s.type.startsWith("video/")?a({defaultMessage:"Video downloaded",id:"WHvofOjBQO"}):a({defaultMessage:"Image downloaded",id:"nS5vxnEXaW"});o(d,"success",3)}catch(r){let l=t.toLowerCase().includes(".mp4")||t.toLowerCase().includes(".mov")||t.toLowerCase().includes(".avi");n.vF.error("Failed to download media asset",{error:r,mediaUrl:e,errorMessage:r instanceof Error?r.message:"Unknown error",errorType:r instanceof TypeError&&r.message.includes("Failed to fetch")?"CORS":"Unknown"}),o(l?a({defaultMessage:"Failed to download video",id:"g8uGrbPLMV"}):a({defaultMessage:"Failed to download image",id:"YPAbL/7UuZ"}),"error",3)}},[a,o]),u=(0,l.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image.jpg",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.body;return c(e,t,a)},[c]);return(0,l.useMemo)(()=>({downloadS3Asset:d,downloadImageAsset:u,downloadMediaAsset:c}),[u,d,c])}},69721:(e,t,a)=>{"use strict";a.d(t,{z:()=>l});let l=(0,a(27773).w)({path:"M6 4v16a1 1 0 0 0 1.524 .852l13 -8a1 1 0 0 0 0 -1.704l-13 -8a1 1 0 0 0 -1.524 .852z",name:"IconPlayerPlayFilled",variant:"filled"})},70610:(e,t,a)=>{"use strict";a(83105),a(71849)},70754:(e,t,a)=>{"use strict";a.d(t,{G:()=>h,z:()=>v});var l=a(85860),r=a(98188);let s=["49a618ae-2fee-4bac-9150-81c466a49187"];var i=a(24065),n=a(36206),o=a(41673),d=a(3041),c=a(27143),u=a(66516);let m=!1,p=performance.now();function h(e){var t,a,l;let{bootstrapConfig:r,user:i,routes:h,base:v=""}=e,g="undefined"==typeof document;if(m||g)return;let f="pub4ecf63e3fd1ad28de1a9027c01181601",y=r.version,x=null!==(a=r.env)&&void 0!==a?a:"local",b=(0,n.t5)(),w=null==i?void 0:null===(t=i.email)||void 0===t?void 0:t.endsWith("@perplexity.ai"),_="local"===x,M="testing"===x||_||b||w?100:2,C=_||w?100:2;if(!s.includes(null!==(l=null==i?void 0:i.org_uuid)&&void 0!==l?l:"")){(0,c.n)({ddApplicationId:"4705c1a2-db1e-42f0-8a66-cd6208ae9e65",ddClientToken:f,version:y,env:x,debug:_,sessionSampleRate:100,sessionReplaySampleRate:C,beforeSend:e=>{if(h&&e.view.url&&e.context)try{let t=new URL(e.view.url).pathname,a=(0,o.iZ)(t,v),l=(0,o.Di)(h,a);if(l){if(l.route.startsWith("^")){let t=(0,o.Di)(function(e){var t,a,l,r,s;let i=e;i=(i=i.replace(/^\^/,"").replace(/\$$/,"")).replace(/\\\//g,"/");let n=[],o=i.match(/^\/\(([^)]+\|[^)]+)\)/);if(o){let e=null===(t=o[1])||void 0===t?void 0:t.split("|").map(e=>"/".concat(e));n.push({type:"alternation",value:"",optional:!1,alternatives:e}),i=i.substring(o[0].length)}else{let e=i.match(/^([^(]+)/);if(e&&e[1]){let t=e[1];n.push({type:"literal",value:t,optional:!1}),i=i.substring(t.length)}}let d=i,c=0,u=0;for(;d.length>0&&u++<100;){let e=d.match(/^\(\?:\/\(\?<(\w+)>([^)]+)\)\)\?/);if(e){let[t,a,l]=e,r=l===a;n.push({type:r?"literal":"param",value:r?"/".concat(a):"/:".concat(a),optional:!0,paramName:r?void 0:a}),d=d.substring(t.length);continue}let t=d.match(/^\(\?:\/\(\?<(\w+)>([^)]+)\)\)/);if(t){let[e,a,l]=t,r=l===a;n.push({type:r?"literal":"param",value:r?"/".concat(a):"/:".concat(a),optional:!1,paramName:r?void 0:a}),d=d.substring(e.length);continue}let a=d.match(/^\/?\(([^)]+)\)\?/),l=d.match(/^\(\?:\/\(([^)]+)\)\)\?/),r=a||l;if(r){let[e]=r;c++,n.push({type:"param",value:"/:param".concat(c),optional:!0,paramName:"param".concat(c)}),d=d.substring(e.length);continue}let s=d.match(/^\/?\?+/);if(s&&s[0].length>0){d=d.substring(s[0].length);continue}break}let m=[],p=n.find(e=>"alternation"===e.type),h=n.filter(e=>"alternation"!==e.type);for(let e of p?p.alternatives.map(e=>"/".concat(e)):[""]){let t=h.filter(e=>e.optional),i=h.filter(e=>!e.optional),n=t.some(e=>{var t;return null===(t=e.paramName)||void 0===t?void 0:t.startsWith("param")});if(t.every(e=>{var t;return null===(t=e.paramName)||void 0===t?void 0:t.startsWith("param")})&&n){let r=t.length;for(let s=0;s<=r;s++){let r=e;for(let e of i)r+=e.value;for(let e=0;e<s;e++)r+=null!==(l=null===(a=t[e])||void 0===a?void 0:a.value)&&void 0!==l?l:"";r=(r=(r=r.replace(/\/+/g,"/")).replace(/\/\?/g,""))||"/",m.push(r)}}else{let a=t.length,l=Math.pow(2,a);for(let n=0;n<l;n++){let l=e;for(let e of i)l+=e.value;for(let e=0;e<a;e++)n&1<<e&&(l+=null!==(s=null===(r=t[e])||void 0===r?void 0:r.value)&&void 0!==s?s:"");l=(l=(l=l.replace(/\/+/g,"/")).replace(/\/\?/g,""))||"/",m.push(l)}}}return[...new Set(m)].sort((e,t)=>{let a=e.split("/").filter(Boolean),l=t.split("/").filter(Boolean);if(a.length!==l.length)return l.length-a.length;for(let e=0;e<a.length;e++){var r,s;let t=null===(r=a[e])||void 0===r?void 0:r.startsWith(":"),i=null===(s=l[e])||void 0===s?void 0:s.startsWith(":");if(t&&!i)return 1;if(!t&&i)return -1;if(a[e]!==l[e])return a[e].localeCompare(l[e])}return 0})}(l.route),a);t&&(e.context.normalizedName=(0,o.Hi)(t.route,v))}else e.context.normalizedName=(0,o.Hi)(l.route,v)}}catch(e){}return!0}}),(0,d.n_)({ddClientToken:f,version:y,env:x,debug:_,sessionSampleRate:M});let e="undefined"!=typeof navigator&&"serviceWorker"in navigator&&!!navigator.serviceWorker.controller;if((0,d.zm)({useServiceWorker:e}),(0,u.zm)({useServiceWorker:e}),b){let e={cometAgentExtensionVersion:null==b?void 0:b.agent_extension_version,cometDeviceId:b.device_id,cometMainExtensionVersion:b.extension_version,cometVersion:null==b?void 0:b.browser_version,erp:r.erp};(0,d.zm)(e),(0,u.zm)(e)}(0,u.Rh)("web.frontend.module_exec_start",{startTime:performance.timeOrigin,duration:p})}m=!0}function v(){let{session:e,status:t}=(0,r.N)();(0,l.useLayoutEffect)(()=>{"loading"!==t&&h({bootstrapConfig:(0,i.x)(),user:null==e?void 0:e.user})},[null==e?void 0:e.user,t])}},70852:(e,t,a)=>{"use strict";var l,r;a.d(t,{J:()=>r,Y:()=>l}),function(e){e.SCHEDULED="scheduled",e.PRICE_ALERT="priceAlert",e.SHORTCUT="shortcut"}(l||(l={})),function(e){e.TARGET_PRICE="targetPrice",e.MOVEMENT_AMOUNT="movementAmount"}(r||(r={}))},70919:(e,t,a)=>{"use strict";a.d(t,{_:()=>l});let l=(0,a(27773).w)({path:"M12.2401 8.96004C10.6561 8.96004 9.36011 7.66404 9.36011 6.08004C9.36011 4.49604 10.6561 3.20004 12.2401 3.20004C13.8241 3.20004 15.1201 4.49604 15.1201 6.08004C15.1201 7.66404 13.8241 8.96004 12.2401 8.96004ZM12.2401 5.12004C11.7121 5.12004 11.2801 5.55204 11.2801 6.08004C11.2801 6.60804 11.7121 7.04004 12.2401 7.04004C12.7681 7.04004 13.2001 6.60804 13.2001 6.08004C13.2001 5.55204 12.7681 5.12004 12.2401 5.12004Z M18 14.7201C16.416 14.7201 15.12 13.4241 15.12 11.8401C15.12 10.2561 16.416 8.96011 18 8.96011C19.584 8.96011 20.88 10.2561 20.88 11.8401C20.88 13.4241 19.584 14.7201 18 14.7201ZM18 10.8801C17.472 10.8801 17.04 11.3121 17.04 11.8401C17.04 12.3681 17.472 12.8001 18 12.8001C18.528 12.8001 18.96 12.3681 18.96 11.8401C18.96 11.3121 18.528 10.8801 18 10.8801Z M6.48004 14.7201C4.89604 14.7201 3.60004 13.4241 3.60004 11.8401C3.60004 10.2561 4.89604 8.96011 6.48004 8.96011C8.06404 8.96011 9.36004 10.2561 9.36004 11.8401C9.36004 13.4241 8.06404 14.7201 6.48004 14.7201ZM6.48004 10.8801C5.95204 10.8801 5.52004 11.3121 5.52004 11.8401C5.52004 12.3681 5.95204 12.8001 6.48004 12.8001C7.00804 12.8001 7.44004 12.3681 7.44004 11.8401C7.44004 11.3121 7.00804 10.8801 6.48004 10.8801Z M12.2401 20.48C10.6561 20.48 9.36011 19.184 9.36011 17.6C9.36011 16.016 10.6561 14.72 12.2401 14.72C13.8241 14.72 15.1201 16.016 15.1201 17.6C15.1201 19.184 13.8241 20.48 12.2401 20.48ZM12.2401 16.64C11.7121 16.64 11.2801 17.072 11.2801 17.6C11.2801 18.128 11.7121 18.56 12.2401 18.56C12.7681 18.56 13.2001 18.128 13.2001 17.6C13.2001 17.072 12.7681 16.64 12.2401 16.64Z",name:"IconPerplexitySourcesActive",variant:"filled"})},71825:(e,t,a)=>{"use strict";a.d(t,{JX:()=>m,Ko:()=>h,P4:()=>y,nU:()=>b,qP:()=>_,rV:()=>g});var l=a(44152),r=a(95641),s=a(4428),i=a(15492),n=a(77917),o=a(11129),d=a(3041);let c=async e=>{let{queryParams:t,headers:a={},reason:l}=e;try{let e=await n.By.GET("/rest/memories/list",l,{params:{query:{limit:t.limit,offset:t.offset,query:t.query},timeoutMs:n.dS.MEDIUM},headers:a});if(e.data)return{memories:e.data.memories,totalCount:e.data.total_memory_count};return{memories:[],totalCount:0}}catch(e){return d.vF.log("Error in ".concat("getMemories",":"),e),{memories:[],totalCount:0}}},u=(e,t)=>{let a=t.reduce((e,t)=>e+t.memories.length,0);if(a<e.totalCount)return a},m=e=>{let{initialPageParam:t=0,searchQuery:a,reason:r}=e;return(0,l.useInfiniteQuery)({queryKey:(0,o.dx)(a),queryFn:async e=>{let{pageParam:t}=e;return c({queryParams:{limit:20,offset:null!=t?t:0,query:a},reason:r})},getNextPageParam:u,initialPageParam:t,refetchOnMount:"always",placeholderData:e=>e})},p=async e=>{let{memoryKey:t,reason:a}=e;try{return(await n.By.DELETE("/rest/memories/delete",a,{params:{query:{memory_key:t}}})).data}catch(e){d.vF.log("Error in deleteMemory:",e);return}},h=e=>{let{reason:t}=e,a=(0,r.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>p({memoryKey:e,reason:t}),onMutate:async e=>{await a.cancelQueries({queryKey:["memories"]});let t=a.getQueryData(["memories"]);try{a.setQueryData(["memories"],t=>{if(!t)return t;let a=t.pages.map(t=>({totalCount:t.totalCount-1,memories:t.memories.filter(t=>t.memory_key!==e)}));return{...t,pages:a}})}catch(e){d.vF.log("Error in onMutate deleteMemories (".concat((0,o.dx)(),"):"),e)}return{previousData:t}},onError:(e,t,l)=>{(null==l?void 0:l.previousData)&&a.setQueryData(["memories"],l.previousData)},onSettled:()=>{a.invalidateQueries({queryKey:["memories"]})}})},v=async e=>{let{reason:t}=e;try{return(await n.By.DELETE("/rest/memories/delete-all",t)).data}catch(e){d.vF.log("Error in deleteAllMemories:",e);return}},g=()=>{let e=(0,r.useQueryClient)();return(0,s.useMutation)({mutationFn:v,onMutate:async()=>{await e.cancelQueries({queryKey:["memories"]});let t=e.getQueryData(["memories"]);try{e.setQueryData(["memories"],()=>({pages:[{memories:[],totalCount:0}],pageParams:[0]}))}catch(e){d.vF.log("Error in onMutate deleteAllMemories (".concat((0,o.dx)(),"):"),e)}return{previousData:t}},onError:(t,a,l)=>{(null==l?void 0:l.previousData)&&e.setQueryData(["memories"],l.previousData)},onSuccess:()=>{e.invalidateQueries({queryKey:["memories"]})}})},f=async e=>{let{entryUuid:t,shouldForget:a,feedback:l,feedbackEntryUuid:r,reason:s}=e;try{return(await n.By.POST("/rest/memories/toggle_entry_feedback",s,{params:{query:{entry_uuid:t,should_forget:null===a?void 0:a,feedback:l,feedback_entry_uuid:r}}})).data}catch(e){d.vF.log("Error in forgetEntry:",e);return}},y=e=>{let{entryUuid:t,reason:a}=e,l=(0,r.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>{let{shouldForget:l,feedback:r,feedbackEntryUuid:s}=e;return f({entryUuid:t,shouldForget:l,feedback:r,feedbackEntryUuid:s,reason:a})},onMutate:async e=>{let{shouldForget:a}=e;await l.cancelQueries({queryKey:(0,o.xw)(t)});let r=l.getQueryData((0,o.xw)(t));return l.setQueryData((0,o.xw)(t),a),{previousFeedback:r}},onError:(e,a,r)=>{(null==r?void 0:r.previousFeedback)!==void 0&&l.setQueryData((0,o.xw)(t),r.previousFeedback)},onSuccess:()=>{l.invalidateQueries({queryKey:(0,o.xw)(t)})}})},x=async e=>{let{entryUuid:t,reason:a}=e;try{var l,r,s;let e=await n.By.GET("/rest/memories/get_entries",a,{params:{query:{entry_uuid:t}}});return null===(s=e.data)||void 0===s?void 0:null===(r=s.entries)||void 0===r?void 0:null===(l=r[0])||void 0===l?void 0:l.is_thumbs_down}catch(e){d.vF.log("Error in getEntry:",e);return}},b=e=>{let{entryUuid:t,enabled:a,reason:l}=e;return(0,i.useQuery)({queryKey:(0,o.xw)(null!=t?t:""),queryFn:()=>t?x({entryUuid:t,reason:l}):null,enabled:!!t&&a})},w=async e=>{let{memoryKey:t,reason:a}=e;try{var l,r;let e=await n.By.GET("/rest/memories/get",a,{params:{query:{memory_key:t}}});return null===(r=e.data)||void 0===r?void 0:null===(l=r.memories)||void 0===l?void 0:l[0]}catch(e){d.vF.log("Error in getMemoryDetail:",e);return}},_=e=>{let{memoryKey:t,enabled:a,reason:l}=e;return(0,i.useQuery)({queryKey:["memory-detail",t],queryFn:()=>t?w({memoryKey:t,reason:l}):null,enabled:!!t&&a,retry:2})}},74128:(e,t,a)=>{"use strict";a.d(t,{c:()=>l});let l=(0,a(27773).w)({path:"M3 8m0 1a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1z M12 8l0 13 M19 12v7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7 M7.5 8a2.5 2.5 0 0 1 0 -5a4.8 8 0 0 1 4.5 5a4.8 8 0 0 1 4.5 -5a2.5 2.5 0 0 1 0 5",name:"IconGift",variant:"stroked"})},74251:(e,t,a)=>{"use strict";a.d(t,{h:()=>o});var l=a(85860),r=a(15492),s=a(11129),i=a(71849);let n=e=>{let{enabled:t,reason:a}=e,l=async()=>(0,i.I_)({reason:a}),{data:n}=(0,r.useQuery)({enabled:void 0===t||t,queryKey:(0,s.Tl)(),queryFn:l,networkMode:"always"});return null!=n?n:{isGovernmentRequestOrigin:void 0}};function o(){var e,t;let a=n({enabled:!0,reason:"user-capabilities"}),{data:o}=(e=a.isGovernmentRequestOrigin?"us_government_or_military":"",t="user-capabilities",(0,r.useQuery)({enabled:!!e,queryKey:(0,s.kP)(e),queryFn:async()=>(0,i.n2)({profileName:e,reason:t})}));return(0,l.useMemo)(()=>({isGovernmentRequestOrigin:a.isGovernmentRequestOrigin,specialCapabilities:{unlimitedProSearch:!!(null==o?void 0:o.unlimitedProSearch),maxModelSelection:!!(null==o?void 0:o.maxModelSelection),unlimitedResearch:!!(null==o?void 0:o.unlimitedResearch),fileUpload:!!(null==o?void 0:o.fileUpload)}}),[a.isGovernmentRequestOrigin,o])}},74638:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(27773).w)({path:"M9 15l6 -6 M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464 M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",name:"IconLink",variant:"stroked"})},74858:(e,t,a)=>{"use strict";a.d(t,{U:()=>l});let l=(0,a(27773).w)({path:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0 M3.6 9h16.8 M3.6 15h16.8 M11.5 3a17 17 0 0 0 0 18 M12.5 3a17 17 0 0 1 0 18",name:"IconWorld",variant:"stroked"})},74924:(e,t,a)=>{"use strict";a.d(t,{k:()=>i});var l=a(85860),r=a(46972),s=a(5826);function i(){let{firstResult:{backend_uuid:e,context_uuid:t,read_write_token:a}={}}=(0,r.E)();return(0,l.useMemo)(()=>(0,s.dg)({context_uuid:t,read_write_token:a,backend_uuid:e}),[t,a,e])}},75131:(e,t,a)=>{"use strict";a.d(t,{n:()=>l});let l={type:"spring",stiffness:700,damping:50}},75546:(e,t,a)=>{"use strict";a.d(t,{q:()=>l});let l=(0,a(27773).w)({path:"M15 15m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0 M18.5 18.5l2.5 2.5 M4 6h16 M4 12h4 M4 18h4",name:"IconListSearch",variant:"stroked"})},75796:(e,t,a)=>{"use strict";a.d(t,{s:()=>l});let l=(0,a(27773).w)({path:"M16 10h4a2 2 0 0 1 0 4h-4l-4 7h-3l2 -7h-4l-2 2h-3l2 -4l-2 -4h3l2 2h4l-2 -7h3z",name:"IconPlane",variant:"stroked"})},75919:(e,t,a)=>{"use strict";a.d(t,{n:()=>c});var l=a(25576),r=a(83081),s=a(60410),i=a(26085),n=a(20041),o=a(38683),d=a(43627);let c=e=>{let{promo:t,setPromo:a,clearPromoError:c,applyPromotionCode:u,isApplyingPromo:m,handleOnKeyDown:p,paymentMethodType:h,promoError:v,discountTerms:g}=e,{isMobileUserAgent:f}=(0,o.al)(),{$t:y}=(0,r.A)();return(0,l.jsxs)("div",{className:"grow",children:[(0,l.jsx)(n.Ay,{isMobileUserAgent:f,className:"w-full",type:"text",pill:!1,placeholder:y({defaultMessage:"Enter discount code",id:"7bFfHJMwPX",description:"Placeholder for promo code input"}),value:t,onChange:e=>{a(e),null==c||c()},onKeyDown:p,isLoading:!u||m,onClear:()=>null==u?void 0:u(null!=t?t:"",h),ClearIcon:e=>{let{onClear:t}=e;return(0,l.jsx)(i.A,{text:y({defaultMessage:"Apply",id:"V/2my4yjzO",description:"Clear button for promo code input"}),onClick:()=>t(),size:d.or.small})},enterKeyHint:"done"}),v&&(0,l.jsx)(s.A,{className:"mt-sm",variant:"tinyRegular",color:"red",children:v}),g&&(0,l.jsx)(s.A,{className:"mt-sm",variant:"tinyRegular",color:"light",children:g})]})}},76197:(e,t,a)=>{"use strict";a.d(t,{s:()=>o});var l=a(85860),r=a(57936),s=a(51244),i=a(46524),n=a(62615);let o=e=>{let{mode:t}=e,a=(0,n.a8)(),o=(0,i.g)(),{currentOpenedModal:d}=(0,s.u)(),c=(0,l.useMemo)(()=>(null==a?void 0:a.startsWith("/collections"))||(null==a?void 0:a.startsWith("/spaces"))?"uploadFilesModal"===d?"space_sources":"space":(null==a?void 0:a.startsWith("/search"))?"thread":(null==a?void 0:a.startsWith("/settings"))?null:"ask",[a,d]),u=(0,l.useMemo)(()=>{if(null===o)return null;if((null==a?void 0:a.startsWith("/collections"))||(null==a?void 0:a.startsWith("/spaces"))){var e;return o.slug?"string"==typeof o.slug?o.slug:null!==(e=o.slug[0])&&void 0!==e?e:null:null}if(null==a?void 0:a.startsWith("/search")){let e=a.split("/").pop();return null!=e?e:null}return(null==a?void 0:a.startsWith("/settings"))?null:null!=t?t:null},[a,o,t]),m=(0,r.F)(),p=(0,l.useMemo)(()=>{let e="".concat(m,"/connectors"),t=new URLSearchParams;if(c){let e=Array.isArray(u)?u[0]:u;t.append("referrer",c),e&&t.append("referrerId",e)}return e+"?"+t.toString()},[c,u,m]);return(0,l.useMemo)(()=>({referrer:c,referrerId:u,redirectPath:p}),[p,c,u])}},76523:(e,t,a)=>{"use strict";a.d(t,{j:()=>o});var l=a(85860),r=a(6866),s=a(43627),i=a(30002),n=a(62615);let o=()=>{let e=(0,n.ok)();return(0,l.useMemo)(()=>{let t=null==e?void 0:e.get(i.cp2),a=!!(0,r.bo)({searchParams:e,cleanRedirect:!1}),l=t===s.Kw.STUDENT_REFERRAL_LANDING_PAGE,n=t===s.Kw.STUDENT_LANDING_PAGE,o=t===s.Kw.GROW_COMET_STUDENTS_COUNTRY;return{loginSource:t,isFromStudentCometGrowth:a,isFromStudentCometGrowthCountry:o,isFromStudentReferral:l,isFromStudentLanding:n,isFromStudentFlow:a||l||n||o}},[e])}},76825:(e,t,a)=>{"use strict";a.d(t,{L:()=>l});let l=(0,a(27773).w)({path:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0 M12 17l0 .01 M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4",name:"IconHelp",variant:"stroked"})},77266:(e,t,a)=>{"use strict";a.d(t,{Bz:()=>b,C_:()=>g,IN:()=>p,Pe:()=>x,g:()=>f,hw:()=>h,ru:()=>y,z6:()=>u});var l=a(57023),r=a(14963),s=a(70614),i=a(78364),n=a(79756),o=a(31049),d=a(80661),c=a(3041);function u(e,t){let a=null!=t?t:new Date;switch(e.kind){case"ONCE":{let t=new Date(e.year,e.month,e.day,e.hour,e.minute);return t>a?t:a}case"DAILY":return new d.p3({freq:d.p3.DAILY,dtstart:new Date(a.getFullYear(),a.getMonth(),a.getDate(),e.hour,e.minute),byhour:e.hour,byminute:e.minute}).after(a)||a;case"WEEKLY":{let t=0===e.dayOfWeek?d.p3.SU:e.dayOfWeek-1;return new d.p3({freq:d.p3.WEEKLY,dtstart:new Date(a.getFullYear(),a.getMonth(),a.getDate(),e.hour,e.minute),byweekday:t,byhour:e.hour,byminute:e.minute}).after(a)||a}case"MONTHLY":return new d.p3({freq:d.p3.MONTHLY,dtstart:new Date(a.getFullYear(),a.getMonth(),1,e.hour,e.minute),bymonthday:e.day,byhour:e.hour,byminute:e.minute}).after(a)||a;case"YEARLY":return new d.p3({freq:d.p3.YEARLY,dtstart:new Date(a.getFullYear(),0,1,e.hour,e.minute),bymonth:e.month+1,bymonthday:e.day,byhour:e.hour,byminute:e.minute}).after(a)||a;case"WEEKDAYS":return new d.p3({freq:d.p3.WEEKLY,dtstart:new Date(a.getFullYear(),a.getMonth(),a.getDate(),e.hour,e.minute),byweekday:[d.p3.MO,d.p3.TU,d.p3.WE,d.p3.TH,d.p3.FR],byhour:e.hour,byminute:e.minute}).after(a)||a;default:return a}}let m=(0,l.YK)({kindOnce:{defaultMessage:"Once",id:"DqTQOpG2Me"},kindDaily:{defaultMessage:"Daily",id:"zxvhnETmn2"},kindWeekly:{defaultMessage:"Weekly",id:"/clOBUs/wZ"},kindWeekdays:{defaultMessage:"Every weekday",id:"8Hjql2wdJG"},kindMonthly:{defaultMessage:"Monthly",id:"wYsv4ZHu+B"},kindYearly:{defaultMessage:"Yearly",id:"dqD39hnoA/"}});function p(){let e=new Date;return e.setHours(e.getHours()+1,e.getMinutes(),0,0),{kind:"ONCE",minute:e.getMinutes(),hour:e.getHours(),day:e.getDate(),month:e.getMonth(),year:e.getFullYear(),dayOfWeek:e.getDay()}}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Im.PRO,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["web"];return{title:"",prompt:e,schedule:p(),searchModel:t,sources:a,expiryDate:void 0,defaultExpiryDate:b(t)}}m.kindOnce,m.kindDaily,m.kindWeekly,m.kindMonthly,m.kindYearly,m.kindWeekdays;let v=()=>Intl.DateTimeFormat().resolvedOptions().timeZone;function g(e){var t;let a="ONCE"===(t=e).kind?new Date(t.year,t.month,t.day,t.hour,t.minute):new Date;return{start_at:(0,r.A)(a,"yyyy-MM-dd'T'HH:mm:ss"),rrule:function(e){switch(e.kind){case"ONCE":return"FREQ=DAILY;COUNT=1";case"DAILY":return"FREQ=DAILY;BYHOUR=".concat(e.hour,";BYMINUTE=").concat(e.minute);case"WEEKLY":{let t=["SU","MO","TU","WE","TH","FR","SA"][e.dayOfWeek];return"FREQ=WEEKLY;BYDAY=".concat(t,";BYHOUR=").concat(e.hour,";BYMINUTE=").concat(e.minute)}case"MONTHLY":return"FREQ=MONTHLY;BYMONTHDAY=".concat(e.day,";BYHOUR=").concat(e.hour,";BYMINUTE=").concat(e.minute);case"YEARLY":return"FREQ=YEARLY;BYMONTH=".concat(e.month+1,";BYMONTHDAY=").concat(e.day,";BYHOUR=").concat(e.hour,";BYMINUTE=").concat(e.minute);case"WEEKDAYS":return"FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR;BYHOUR=".concat(e.hour,";BYMINUTE=").concat(e.minute)}}(e),tzid:v()}}function f(e){if(null!==e&&e)return(0,r.A)(e,"yyyy-MM-dd'T'HH:mm:ss")}function y(e){let t=new Date(e.start_at),a={kind:"ONCE",minute:t.getMinutes(),hour:t.getHours(),day:t.getDate(),month:t.getMonth(),year:t.getFullYear(),dayOfWeek:t.getDay()};if(e.rrule.includes("FREQ=DAILY;COUNT=1"))return a;let l=d.p3.parseString(e.rrule),r=e=>Array.isArray(e)?e[0]:e,s=r(l.byhour),i=r(l.byminute),n=r(l.bymonth),o=r(l.bymonthday),u=r(l.byweekday);switch(l.freq){case d.p3.DAILY:if(void 0===s||void 0===i)return c.vF.error("DAILY schedule missing required BYHOUR or BYMINUTE parameter"),{...a};return{...a,kind:"DAILY",hour:s,minute:i};case d.p3.WEEKLY:{if(void 0===u||void 0===s||void 0===i)return c.vF.error("WEEKLY schedule missing required parameters"),{...a};if(Array.isArray(l.byweekday)&&5===l.byweekday.length)return{...a,kind:"WEEKDAYS",hour:s,minute:i};let e=6===u.weekday?0:u.weekday+1;return{...a,kind:"WEEKLY",dayOfWeek:e,hour:s,minute:i}}case d.p3.MONTHLY:if(void 0===o||void 0===s||void 0===i)return c.vF.error("MONTHLY schedule missing required BYMONTHDAY parameter"),{...a};return{...a,kind:"MONTHLY",day:o,hour:s,minute:i};case d.p3.YEARLY:if(void 0===n||void 0===o||void 0===s||void 0===i)return c.vF.error("YEARLY schedule missing required BYMONTH parameter"),{...a};return{...a,kind:"YEARLY",month:n-1,day:o,hour:s,minute:i}}return c.vF.error("Invalid task schedule"),{...a}}function x(e){let{expiryDate:t,schedule:a,defaultExpiryDate:l}=e;return null!==t&&t&&a&&u(a)>t?null!=l?l:null:t}function b(e,t){if(t&&(e===n.Im.BETA||e===n.Im.ALPHA)&&("DAILY"===t.kind||"WEEKLY"===t.kind||"WEEKDAYS"===t.kind)&&(e===n.Im.BETA||e===n.Im.ALPHA)){let e=u(t);return(t=>{switch(t){case"DAILY":return(0,s.A)(e,14);case"WEEKLY":return(0,i.A)(e,14);case"WEEKDAYS":return(0,s.A)(e,21);case"ONCE":case"MONTHLY":case"YEARLY":return;default:(0,o.s)(t)}})(t.kind)}}},77268:(e,t,a)=>{"use strict";a.d(t,{w:()=>p});var l=a(25576),r=a(85860),s=a(83081),i=a(64299),n=a.n(i),o=a(12839),d=a(60410);let c=0,u=(0,a(27773).w)({path:"M4 20l16 0 M12 14l0 -10 M12 14l4 -4 M12 14l-4 -4",name:"IconArrowBarToDown",variant:"stroked"});var m=a(49427);let p=r.memo(e=>{let{onDrop:t,disabled:a=!1,children:i,dropZoneClassName:p,dropLabel:h,dropIcon:v=u,allowDropAnywhere:g=!1,hideContent:f=!1,...y}=e,{$t:x}=(0,s.A)(),{isDraggingFile:b,isFileOver:w,rootProps:_}=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],[l,s]=(0,r.useState)(!1),[i,n]=(0,r.useState)(!1),o=(0,r.useCallback)(e=>{e.preventDefault()},[]),d=(0,r.useCallback)(e=>{var t;(null==e?void 0:null===(t=e.dataTransfer)||void 0===t?void 0:t.types.includes("Files"))&&(e.preventDefault(),s(!0),c++)},[]),u=(0,r.useCallback)(e=>{e.preventDefault(),0===(c=Math.max(0,c-1))&&s(!1)},[]),m=(0,r.useCallback)(l=>{var r;l.preventDefault(),s(!1),n(!1),c=0,!t&&a&&(null===(r=l.dataTransfer)||void 0===r?void 0:r.items.length)&&e(l.dataTransfer.items)},[t,e,a]),p=(0,r.useCallback)(e=>{var t;(null==e?void 0:null===(t=e.dataTransfer)||void 0===t?void 0:t.types.includes("Files"))&&(e.preventDefault(),n(!0))},[]),h=(0,r.useCallback)(e=>{e.preventDefault(),n(!1)},[]),v=(0,r.useCallback)(l=>{var r;l.preventDefault(),s(!1),n(!1),t||a||!((null==l?void 0:null===(r=l.dataTransfer)||void 0===r?void 0:r.items.length)>0)||e(l.dataTransfer.items)},[t,e,a]);return(0,r.useEffect)(()=>(document.addEventListener("dragover",o),document.addEventListener("dragenter",d),document.addEventListener("dragleave",u),document.addEventListener("drop",m),()=>{document.removeEventListener("dragover",o),document.removeEventListener("dragenter",d),document.removeEventListener("dragleave",u),document.removeEventListener("drop",m)}),[o,d,u,m]),(0,r.useMemo)(()=>({isDraggingFile:l,isFileOver:i,rootProps:{onDragOver:p,onDragLeave:h,onDrop:v}}),[h,p,v,l,i])}(t,a,g),M=null!=h?h:x(g?{defaultMessage:"Dropped files appear here.",id:"9WR4elgZix"}:{defaultMessage:"Drop your files here.",id:"llIM82nPs+"});return(0,l.jsxs)("div",{className:"relative",..._,...y,children:[b&&a?(0,l.jsx)(o.Ay,{className:n()("border-subtler bg-subtler absolute inset-0 z-20 flex items-center justify-center rounded-2xl border-2 border-dashed",{"!border-caution":w},null==p?void 0:p(b,w)),children:(0,l.jsxs)(d.A,{color:"red",children:[(0,l.jsx)(m.e,{icon:v,className:"mr-2"}),"Drop zone disabled"]})}):b?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.Ay,{variant:"background",className:"absolute inset-0 z-20 rounded-2xl opacity-80"}),(0,l.jsx)(o.Ay,{className:n()("gap-x-sm animate-in fade-in border-subtler absolute inset-0 z-20 flex items-center justify-center rounded-2xl border-2 border-dashed transition-all duration-200",{"!border-super":w},null==p?void 0:p(b,w)),children:!f&&(0,l.jsxs)(d.A,{color:"super",children:[(0,l.jsx)(m.e,{icon:v,className:"mr-2"}),M]})})]}):null,i]})});p.displayName="DropZone"},77594:(e,t,a)=>{"use strict";a.d(t,{N:()=>R});var l=a(25576),r=a(85860);a(77917),a(56447),a(47575),a(83105),a(98188),a(17304),a(14337),a(96867),a(74924),a(24227),a(79756);var s=a(89334);a(24915),a(21017),a(62440),a(74251),a(10023),a(86482);var i=a(83081),n=a(64299),o=a.n(n),d=a(62615);let c=()=>{let e=(0,d.a8)();return(0,s.EJ)()&&(null==e?void 0:e.startsWith("/b/home"))};var u=a(55776),m=a(80892);let p=["/?","/search","/discover"],h=["/"],v=e=>!e||!h.some(t=>e===t)&&!p.some(t=>e.startsWith(t));var g=a(87147),f=a(12839),y=a(60410),x=a(26085),b=a(69744),w=a(66410),_=a(43627),M=a(30002),C=a(30571),j=a(94105),A=a(12422);let E=()=>"true"!==g.h.getItem("signUpBannerDismissed"),S=()=>g.h.setItem("signUpBannerDismissed","true");r.memo(e=>{let{portalTarget:t}=e,{$t:a}=(0,i.A)(),[s,n]=(0,r.useState)(!1),p=(0,d.a8)(),{trackEvent:h}=(0,m.yw)(),{keysRequiringRerender:g,removeKeyRequiringRerender:k,addKeyRequiringRerender:N}=(0,j.wn)(),T=c(),[I,R]=(0,r.useState)(""),P=(0,r.useCallback)(()=>{R((0,C.Qv)(window.location.href,M.cp2,_.Kw.FLOATING_SIGNUP))},[]);if((0,r.useEffect)(()=>{P()},[P]),(0,r.useEffect)(()=>{n(E())},[]),(0,r.useEffect)(()=>{g.includes("floating-signup")&&(n(E()),P()),k("floating-signup")},[k,g]),(0,r.useEffect)(()=>{s&&h("floating sign up shown",{})},[s,h]),v(p)&&!T||!s)return null;let O=()=>{n(!1),S(),h("floating sign up dismissed",{}),N("sidebar-sign-in-button")};return(0,l.jsx)(w.Z,{portalTarget:null!=t?t:void 0,children:(0,l.jsx)("div",{className:"bottom-md right-md fixed hidden w-[300px] md:block",children:(0,l.jsx)(f.Ay,{variant:"background",className:o()("px-md py-lg animate-in fade-in ring-subtle rounded-xl shadow-md ring-1 duration-300 ease-out"),children:(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"right-sm top-sm absolute",children:(0,l.jsx)(x.A,{pill:!0,size:"small",icon:A.M,onClick:O,testId:"floating-signup-close-button"})}),(0,l.jsx)("div",{className:"pb-md flex justify-center",children:(0,l.jsx)(b.g,{variant:"mark",color:"super",size:"small"})}),(0,l.jsx)(y.A,{variant:"baseSemi",className:"mb-xs text-center",children:a({defaultMessage:"Sign in or create an account",id:"eN8MTJfuKA"})}),(0,l.jsx)(y.A,{variant:"small",color:"light",className:"text-center",children:a({defaultMessage:"Unlock {proSearch} and History",id:"azC54WXvtr"},{proSearch:"Pro Search"})}),(0,l.jsx)("div",{className:"mt-md",children:(0,l.jsx)(u.A,{onClose:O,redirectUrl:I,showCloseButton:!1,autoFocus:!1,loginButtonsStyle:"highlightPrimary"})})]})})})})}).displayName="FloatingSignUp",a(63447),a(60760),a(16079),a(46972),a(97113),a(14475);var k=a(92988);a(21978);var N=a(66516);(0,N.Ip)(),(0,k.j)("PerformanceContext",{markTTV:()=>{},addPageTiming:()=>{},getPageStartTime:()=>0,getPageTimer:()=>(0,N.Ip)(),addPageTimingOnce:()=>{}}),(0,k.j)("PagePerformanceContext",{markTTV:()=>{}}),a(36206),a(91866),a(26941),a(6602),a(7685),a(2241),a(84447),a(51568).X,a(53220);var T=a(3041);a(24915);let I=(0,k.j)("PplxQueryStateContext",{submitQuery:()=>{T.vF.error("submitQuery must be used within PerplexityQueryStateProvider")},handleBotStep:()=>{T.vF.error("handleBotStep must be used within PerplexityQueryStateProvider")},deleteLastResult:()=>{T.vF.error("deleteLastResult must be used within PerplexityQueryStateProvider")},shouldShowProductFeedback:!1,shouldShowRecruitmentBanner:!1,feedbackEntryUUID:null,quote:null,setQuote:()=>void 0,updateLocalStatePostStream:()=>void 0}),R=()=>{let e=(0,r.useContext)(I);if(!e)throw Error("usePerplexityQueryState must be used within PerplexityQueryStateContext");return e}},77936:(e,t,a)=>{"use strict";a.d(t,{AY:()=>s,Aw:()=>i,Dl:()=>w,Gp:()=>C,HL:()=>y,HN:()=>c,J6:()=>j,LK:()=>n,O8:()=>m,RQ:()=>v,Rh:()=>p,W1:()=>f,WR:()=>u,Zy:()=>M,bN:()=>b,bO:()=>d,eQ:()=>g,he:()=>_,l2:()=>r,oh:()=>h,qP:()=>o,x9:()=>x});var l=a(82297);let r=e=>e.trim().replace(/\/+$/,"").replace(/^(?:https?:\/\/)?(?:www\.)?/,""),s=e=>!!RegExp("^((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,})(\\/[\\w\\-._~:/@!$&'()*+,;=%.]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e);function i(e){let t=e.match(/(?:https?:\/\/)?(?:www\.)?([a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*(?:\.[a-zA-Z]{2,})?|localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::\d+)?/);return t&&t.length>0?t[1]||t[0]:"unknown"}function n(e){let t=i(e);return"unknown"===t?"unknown":t.replace(/\.[^.]*$/,"")}function o(e){return e.includes("calendar.google.com")||e.includes("google.com/calendar")?"https://calendar.google.com":e.includes("mail.google.com")||e.includes("google.com/mail")?"https://mail.google.com":x(e)?"www.perplexity.ai":i(e)}function d(e){return e.startsWith("http://")||e.startsWith("https://")?e:"https://".concat(e)}function c(e){let t=RegExp("(?:youtube?\\.com\\/(?:[^/\\n\\s]+\\/\\S+\\/|(?:v|e(?:mbed)?)\\/|\\S*?[?&]v=)|youtu\\.be\\/)([a-zA-Z0-9_-]{11})"),a=e.match(t);return a&&11==a[1].length?a[1]:void 0}function u(e){return e.startsWith("https://pplx-res.cloudinary.com/")||e.startsWith("https://api.cloudinary.com/v1_1/pplx/image/download")}function m(e){return e.startsWith("https://image-ppubs.uspto.gov/")}function p(e){return e.replace(/\/s--[^/]+--\/v\d+\//,"/")}function h(e){return!(0,l.xE)(e)&&!!e.url&&!c(e.url)&&!u(e.url)&&!e.is_memory&&!e.is_conversation_history}let v=e=>{try{let t=new URL(e).pathname.replace(/^\//,"").split("/"),a=t[t.length-1];return decodeURIComponent(a)}catch(e){return"File"}},g=e=>{let t=Math.max(23,e.indexOf("/")+16);return e.length>t?e.substring(0,t-1)+"…":e},f=(e,t)=>{let a=encodeURIComponent([e,t].filter(Boolean).join(", "));return"https://www.google.com/maps/dir/?api=1&destination=".concat(a)},y=(e,t)=>{let a=encodeURIComponent([e,t].filter(Boolean).join(", "));return"https://www.google.com/maps/search/?api=1&query=".concat(a)};function x(e){return e.startsWith("chrome://")||e.startsWith("chrome-extension://")||e.startsWith("browser-extension://")||e.startsWith("browser://")||e.startsWith("comet://")}let b=e=>e.replace("comet://","chrome://"),w=e=>{if(!e)return null;try{return new URL(e)}catch(e){return null}},_=async e=>{let t=[];return await Promise.all(e.map(async e=>{try{(await fetch(e,{method:"HEAD"})).ok&&t.push(e)}catch(t){console.debug("URL ".concat(e," is not reachable:"),t)}})),t},M=e=>{try{let t=new URL(e);return["AWSAccessKeyId","Signature","Expires"].every(e=>t.searchParams.has(e))}catch(e){return!1}},C=e=>{if(!e)return"";let t=e.indexOf("?");return(-1===t?e:e.substring(0,t)).replace(/\/+$/,"")},j=e=>{try{return new URL(e).origin===window.location.origin}catch(e){return!1}}},78052:(e,t,a)=>{"use strict";a.d(t,{y:()=>l});let l=(0,a(27773).w)({path:"M8 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h5.697 M18 12v-5a2 2 0 0 0 -2 -2h-2 M8 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z M8 11h4 M8 15h3 M16.5 17.5m-2.5 0a2.5 2.5 0 1 0 5 0a2.5 2.5 0 1 0 -5 0 M18.5 19.5l2.5 2.5",name:"IconReportSearch",variant:"stroked"})},78744:(e,t,a)=>{"use strict";a.d(t,{Q:()=>l});let l=(0,a(27773).w)({path:"M12 9v4 M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z M12 16h.01",name:"IconAlertTriangle",variant:"stroked"})},79095:(e,t,a)=>{"use strict";a.d(t,{ThreadLossAversionModal:()=>M,c:()=>j});var l=a(25576),r=a(85860),s=a(83081),i=a(70714),n=a(18743),o=a(18507),d=a(83105),c=a(55776),u=a(80892),m=a(51244),p=a(16502),h=a(16672),v=a(89412),g=a(60410),f=a(17147),y=a(43627),x=a(30002),b=a(30571),w=a(91866),_=a(62615);let M=r.memo(e=>{let{$t:t}=(0,s.A)(),a=(0,r.useMemo)(()=>(0,b.Qv)(window.location.href,x.cp2,y.Kw.LOSS_AVERSION_MODAL),[]),{trackEvent:d}=(0,u.yw)(),[m,p]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{d("loss aversion modal opened",{origin:e.origin})},[d,e.origin]),(0,l.jsx)(f.A,{title:t(m?{defaultMessage:"Sign up or log in",id:"Qv2KGSr1CQ"}:{defaultMessage:"Lose your answer?",id:"BxKmht5dD3"}),actionList:m?void 0:[{text:t({defaultMessage:"Sign up or log in",id:"Qv2KGSr1CQ"}),onClick:()=>{p(!0)},variant:"primary"}],...e,children:(0,l.jsx)("div",{className:"grid grid-cols-1 grid-rows-1",children:(0,l.jsx)(v.bL,{initial:!1,mode:"popLayout",transition:{type:"spring",duration:.2},children:m?(0,l.jsx)(v.q7,{transition:{ease:n.vT,duration:.1,delay:.1},children:(0,l.jsxs)(o.P.div,{className:"relative col-start-1 row-start-1",children:[(0,l.jsx)(g.A,{className:"mb-md",textCenter:!0,children:(0,l.jsx)(i.A,{defaultMessage:"Log in to save this answer",id:"Ngtk6vEw7T"})}),(0,l.jsx)(c.A,{redirectUrl:a,showCloseButton:!1})]})},"login"):(0,l.jsx)(v.q7,{transition:{ease:n.vT,duration:.1},children:(0,l.jsx)(o.P.div,{className:"col-start-1 row-start-1",children:(0,l.jsx)(g.A,{children:t({defaultMessage:"To save this answer, sign up or log in.",id:"9Ha7YBI+Yh"})})})},"initial")})})})});M.displayName="ThreadLossAversionModal";let C=()=>{let e=(0,r.useCallback)(e=>{(0,h.Kp)(e)},[]),t=(0,w.Ri)(p.YF),a=(0,r.useCallback)(()=>(0,w.zs)(p.YF),[]);return(0,r.useMemo)(()=>({lossAversionStatus:t,setLossAversionStatus:e,unsetLossAversion:a}),[t,e,a])},j=()=>{let{lossAversionStatus:e,setLossAversionStatus:t}=C(),a=(0,_.a8)(),l=(0,d.L)(),s=(0,r.useMemo)(()=>!l&&"allowed"===e&&(null==a?void 0:a.startsWith("/search")),[l,e,a]),{openModal:i}=(0,m.u)(),n=(0,r.useCallback)(e=>{let{args:a,openModalOverride:l}=e;l?l("lossAversionModal",a):i("lossAversionModal",a),t("cooldown")},[i,t]);return(0,r.useMemo)(()=>({shouldShowLossAversionModal:s,handleOpenLossAversion:n}),[s,n])}},80182:(e,t,a)=>{"use strict";a.d(t,{t:()=>y});var l=a(25576),r=a(85860),s=a(16842),i=a(83081),n=a(51568),o=a(12839),d=a(60410),c=a(28554),u=a(82841),m=a(12835),p=a(3041);let h=()=>(0,m.S)("Error boundary"),v=e=>{let{resetErrorBoundary:t}=e,{$t:a}=(0,i.A)(),s=(0,r.useCallback)(()=>{t()},[t]);return(0,l.jsx)(o.Ay,{variant:"background",className:"overflow-hidden rounded-xl",children:(0,l.jsxs)(o.Ay,{variant:"subtler",className:"px-md flex w-full items-center justify-between py-3",children:[(0,l.jsx)(d.A,{variant:"smallBold",children:a({defaultMessage:"Something went wrong.",id:"iuY8kxCDQT"})}),(0,l.jsx)(c.A,{size:"tiny",text:a({defaultMessage:"Retry",id:"62nsdyMyIO"}),type:"button",onClick:s})]})})},g=r.memo(()=>null);g.displayName="NullFallback";let f=/load(.*?)chunk/i,y=r.memo(e=>{let{fallback:t=v,children:a,onError:i,code:o="REACT_RENDERING_ERROR"}=e,d=(0,r.useCallback)((e,t)=>{let a;if(null==i||i(e,t),e instanceof n.X)a=e;else{var l;let t=o;f.test(null!==(l=null==e?void 0:e.message)&&void 0!==l?l:"")&&(t="CHUNK_LOADING_ERROR"),a=new u.i(t,{message:e.message,cause:e})}a.stack=t.componentStack||void 0,p.vF.error(a)},[i,o]);return(0,l.jsx)(s.tH,{FallbackComponent:t||g,onError:d,onReset:h,children:a})});y.displayName="ErrorBoundary"},80314:(e,t,a)=>{"use strict";a.d(t,{EB:()=>d,WZ:()=>n,_J:()=>m,hR:()=>i,h_:()=>c,nN:()=>o,sn:()=>u});var l=a(77150),r=a(77917),s=a(3041);let i=async e=>{let{request:t,reason:a}=e,{fileRepositoryInfo:i,limit:n,offset:o,searchTerm:d,fileStates:c,email:u}=t;try{var m,p;let e;e=c.includes("COMPLETE")?{file_repository_info:i,limit:n,offset:null!=o?o:0,search_term:d,file_states_in_filter:c}:{file_repository_info:i,limit:n,offset:null!=o?o:0,search_term:d,file_states_in_filter:c,email_in_filter:[u]};let{data:t,error:s}=await r.By.POST("/rest/file-repository/list-files",a,{headers:{"content-type":"application/json"},body:e,timeoutMs:(0,r.e4)(),numRetries:1});if(s)throw new l.T("API_CLIENTS_ERROR",{cause:s});return{files:null!==(m=null==t?void 0:t.files)&&void 0!==m?m:[],numTotalFiles:null!==(p=null==t?void 0:t.num_total_files)&&void 0!==p?p:0}}catch(e){return s.vF.error(e),null}},n=async e=>{let{request:t,reason:a}=e,{data:l,error:s}=await r.By.POST("/rest/file-repository/get-file-upload-urls",a,{body:t,timeoutMs:5e3,numRetries:1});if(s)throw Error("Failed to get fileUploadUrl",{cause:s});return l},o=async e=>{let{request:t,reason:a}=e,{data:l,error:s}=await r.By.POST("/rest/files/list",a,{body:t,timeoutMs:(0,r.e4)(),numRetries:1});if(s)throw Error("Failed to get connector files",{cause:s});return l},d=async e=>{let{request:t,reason:a}=e,{data:l,error:s}=await r.By.POST("/rest/files/delete",a,{body:t,timeoutMs:(0,r.e4)(),numRetries:1});if(s)throw Error("Failed to delete connector files",{cause:s});return l},c=async e=>{let{request:t,reason:a}=e,{data:l,error:s}=await r.By.POST("/rest/files/resync",a,{body:t,timeoutMs:(0,r.e4)(),numRetries:1});if(s)throw Error("Failed to resync connector files",{cause:s});return l},u=async e=>{let{request:t,reason:a}=e;try{let{data:e,error:s}=await r.By.POST("/rest/file-repository/uploads",a,{headers:{"content-type":"application/json"},body:t,timeoutMs:(0,r.e4)(),numRetries:1});if(s)throw new l.T("API_CLIENTS_ERROR",{cause:s});return null!=e?e:null}catch(e){return s.vF.error(e),null}};async function m(e){let{request:t,reason:a}=e;return new Promise((e,l)=>{r.By.SSE("/rest/sse/index_files",a,{params:t,headers:{"content-type":"application/json",accept:"text/event-stream"},handlers:{message:t=>{"success"===t.status?e():l(Error("Indexing failed"))}}}).catch(l)})}},81467:(e,t,a)=>{"use strict";a.d(t,{n:()=>l});let l=(0,a(27773).w)({path:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2 M7 9l5 -5l5 5 M12 4l0 12",name:"IconUpload",variant:"stroked"})},81685:()=>{},82297:(e,t,a)=>{"use strict";a.d(t,{Qh:()=>u,_8:()=>d,k5:()=>c,u9:()=>m,xE:()=>p});var l,r,s=a(57023),i=a(77936);let n=["ppl-ai-file-upload","ppl-ai-sandbox-file-upload","ppl-ai-experimental-file-upload"],o=e=>n.some(t=>e.url.includes("".concat(t,".s3.amazonaws.com/web/direct-files")));!function(e){e.token_limit_exceeded="token_limit_exceeded",e.parsing_error="parsing_error",e.unknown_error="unknown_error",e.unauthorized="unauthorized",e.no_data_received="no_data_received",e.file_type_not_supported="file_type_not_supported",e.image_failed_moderation="image_failed_moderation"}(l||(l={})),function(e){e.generic_upload_error="generic_upload_error",e.unsupported_type="unsupported_type",e.too_large="too_large",e.too_small="too_small",e.no_name="no_name",e.failed_moderation="failed_moderation",e.rate_limited="rate_limited",e.over_file_count="over_file_count",e.over_image_count="over_image_count"}(r||(r={}));let d=e=>{var t;if((0,i.O8)(e))return"application/pdf";let a=null===(t=e.split("?")[0].split("#")[0].split(".").pop())||void 0===t?void 0:t.toLowerCase();return a&&({png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jp2:"image/jp2",gif:"image/gif",bmp:"image/bmp",tiff:"image/tiff",tif:"image/tiff",svg:"image/svg+xml",webp:"image/webp",ico:"image/x-icon",avif:"image/avif",heic:"image/heic",heif:"image/heif",pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",txt:"text/plain",csv:"text/csv",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",md:"text/markdown"})[a]||"application/octet-stream"},c=e=>{var t,a;let l=null===(t=e.file_metadata)||void 0===t?void 0:t.file_repository_type;return e.is_attachment&&!l&&!(null===(a=e.meta_data)||void 0===a?void 0:a.file_uuid)};(0,s.YK)({token_limit_exceeded:{id:"cnFlyTXVDl",defaultMessage:"File {filename} exceeds the model's token limit."},parsing_error:{id:"RdRRX8+YG/",defaultMessage:"Failed to parse file {filename}."},file_type_not_supported:{id:"IaflMSTTq6",defaultMessage:"File type not supported for {filename}."},unknown_error:{id:"zhy7qBi3Eu",defaultMessage:"Unknown error for file {filename}."},unauthorized:{id:"6bOe+cTUhc",defaultMessage:"User not authorised to access file {filename}."},no_data_received:{id:"34PXW7VvKh",defaultMessage:"No data received for file {filename}."},generic_upload_error:{id:"xVFvYDY5wK",defaultMessage:"File upload failed"},unsupported_type:{id:"VUOyYEDS96",defaultMessage:"The file type you uploaded is not supported."},too_large:{id:"XBcIjOYq8V",defaultMessage:"File too large: {max} maximum."},too_small:{id:"ZUyiNCx0Aw",defaultMessage:"File too small."},no_name:{id:"IkAmckATMw",defaultMessage:"File name is required."},image_failed_moderation:{id:"YCCLnMQDPb",defaultMessage:"File {filename} failed moderation."},failed_moderation:{id:"hnN6c9ExET",defaultMessage:"File upload failed moderation."},rate_limited:{id:"el7NlqcDQZ",defaultMessage:"You have reached the daily upload limit for your plan."},over_file_count:{id:"2+5sg16GUy",defaultMessage:"You are allowed up to {maxNumFiles, plural, one {# file} other {# files}} at once."},over_image_count:{id:"FIudmpgA1s",defaultMessage:"You are allowed up to {maxNumImages, plural, one {# image} other {# images}} at once."}});let u=e=>e.startsWith("/rest/connectors/wiley/")?"WILEY":e.includes("drive.google.com")||e.includes("connectors/google-drive")||e.includes("docs.google.com")?"GOOGLE_DRIVE":e.includes("onedrive.live.com")||e.includes("1drv.ms")||e.includes("connectors/onedrive")?"ONEDRIVE":e.includes(".sharepoint.com")||e.includes("connectors/sharepoint")?"SHAREPOINT":e.includes("dropbox.com/preview")||e.includes("connectors/dropbox")?"DROPBOX":e.includes("app.box.com/file")||e.includes("connectors/box")?"BOX":void 0,m=e=>{var t;return!!((null==e?void 0:null===(t=e.meta_data)||void 0===t?void 0:t.connection_type)&&(null==e?void 0:e.meta_data.connection_type)!=="LOCAL")||e.is_attachment&&!!u(e.url)},p=e=>e.is_attachment&&(o(e)||(0,i.WR)(e.url)||(0,i.O8)(e.url))},82841:(e,t,a)=>{"use strict";a.d(t,{i:()=>s});var l=a(84447),r=a(51568);class s extends r.X{constructor(...e){super(...e),(0,l._)(this,"name","ReactRenderingError")}}},83312:(e,t,a)=>{"use strict";a.d(t,{y:()=>o});var l=a(85860),r=a(46304),s=a(46972),i=a(46524),n=a(62615);let o=e=>{let{reason:t,collectionSlugOverride:a}=e,o=(0,n.a8)(),d=(0,i.g)(),{firstResult:{collection_info:{uuid:c}={}}={}}=(0,s.E)(),u=(null==o?void 0:o.includes("/search/"))&&!!c,m=null!=a?a:Array.isArray(null==d?void 0:d.slug)?d.slug[0]:null==d?void 0:d.slug,{collection:p}=(0,r.U)({collectionSlug:m,reason:t}),h=(0,l.useMemo)(()=>{let e,t;return u?(e="COLLECTION",t=null!=c?c:""):(null==o?void 0:o.includes("/collections"))||(null==o?void 0:o.includes("/spaces"))||(null==o?void 0:o.includes("/classroom"))?(e="COLLECTION",t=(null==p?void 0:p.uuid)||""):(e="ORG",t=""),{file_repository_type:e,owner_id:t}},[u,o,c,null==p?void 0:p.uuid]);return(0,l.useMemo)(()=>({fileRepoInfo:h}),[h])}},83453:(e,t,a)=>{"use strict";a.d(t,{f:()=>c});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(60410),o=a(35052);let d=e=>{let{symbol:t}=e;return(0,l.jsx)(n.A,{color:"light",children:(0,l.jsx)("span",{className:"font-mono opacity-70",children:t.slice(0,1)})})},c=e=>{let{image:t,imageDark:a,alt:s,watchlistType:n,className:c,imageClassName:u}=e,{colorScheme:m}=(0,o.U)(),p="FINANCE"===n&&"dark"===m&&a?a:t,[h,v]=(0,r.useState)(()=>{if(!p)return!1;let e=new Image;return e.src=p,e.complete&&e.naturalWidth>0}),[g,f]=(0,r.useState)(!1),y=!h||g;return(0,l.jsxs)("div",{className:i()("relative flex size-6 items-center justify-center",{"bg-subtler":y},c),children:[y&&(0,l.jsx)(d,{symbol:null!=s?s:""}),!g&&(0,l.jsx)("div",{className:i()("absolute",u),children:(0,l.jsx)("img",{src:p,alt:s,width:32,height:32,className:i()("inset-0 size-full object-contain",{"opacity-0":!h}),onLoad:()=>v(!0),onError:()=>f(!0)})})]})}},83674:(e,t,a)=>{"use strict";a.d(t,{w:()=>l});let l={should_send_email:!0,should_send_in_app:!0,should_send_push:!0}},83991:(e,t,a)=>{"use strict";a.d(t,{L:()=>l});let l=(0,a(27773).w)({path:"M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0 M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0 M3 6l0 13 M12 6l0 13 M21 6l0 13",name:"IconBook",variant:"stroked"})},84011:(e,t,a)=>{"use strict";a.d(t,{$:()=>s});var l=a(85860),r=a(80892);let s=e=>{let{assetType:t,entryUUID:a,answerMode:s,reason:i,skip:n}=e,{trackEventOnce:o}=(0,r.yw)();(0,l.useEffect)(()=>{n||o("generated asset viewed",{assetType:t,entryUUID:a,answerMode:s,reason:i})},[o,t,a,s,i,n])}},86482:(e,t,a)=>{"use strict";a.d(t,{Y:()=>s}),a(24065),a(89334),a(16672);var l=a(36206),r=a(30002);a(77936),a(74884),a(49515),a(24915);let s=()=>{let e=(0,l.t5)();return(null==e?void 0:e.ios_version)?r.yI2:(null==e?void 0:e.android_version)?r.Gh4:r.o8x}},86661:(e,t,a)=>{"use strict";a.d(t,{b:()=>n,q:()=>o});var l=a(25576),r=a(85860),s=a(60410);let i=e=>{let{children:t}=e;return(0,l.jsx)(l.Fragment,{children:t})},n=e=>{let{children:t,className:a,delimiter:n="\xb7",...o}=e,d=r.Children.toArray(t),c=d.map((e,t)=>{if(r.isValidElement(e)&&e.type===i){let a=e.props.id;return(0,l.jsxs)(r.Fragment,{children:[e,t!==d.length-1&&(0,l.jsxs)(s.A,{className:"inline-flex !text-inherit",children:[" ",n," "]})]},a)}return null});return(0,l.jsx)("div",{className:"gap-sm flex items-center ".concat(a),...o,children:c})},o=i},86924:(e,t,a)=>{"use strict";a.d(t,{_:()=>c});var l=a(25576),r=a(85860),s=a(83081),i=a(12839),n=a(60410),o=a(50665),d=a(49427);let c=r.memo(e=>{let{children:t,timestamp:a,timestampProps:r,includeIcon:c=!0}=e,u=(0,s.A)();if(!a)return null;let m=(null==a?void 0:a.endsWith("Z"))?a:"".concat(a,"Z");return(0,l.jsxs)(i.Ay,{className:"gap-x-xs flex",children:[c?(0,l.jsx)(n.A,{variant:"tiny",color:"super",children:(0,l.jsx)(d.e,{icon:o.N,size:"xs"})}):null,(0,l.jsxs)(n.A,{variant:"tinyRegular",color:"light",...r,children:[t&&(0,l.jsxs)(l.Fragment,{children:[t," "]}),function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{numeric:"auto",style:"long"},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:864e5;if(!t)return"";let r=new Date(t);if(isNaN(r.getTime()))return"";let s=r.getTime()-Date.now(),i=Math.abs(s);return i<=1e3?"":i<6e4?e.formatRelativeTime(Math.round(s/1e3),"second",a):i<36e5?e.formatRelativeTime(Math.round(s/6e4),"minute",a):i<l&&i<864e5?e.formatRelativeTime(Math.round(s/36e5),"hour",a):i<l&&i>=864e5?e.formatRelativeTime(Math.round(s/864e5),"day",a):e.formatDate(r,{month:"short",day:"numeric",year:"numeric"})}(u,m)]})]})});c.displayName="CitationUpdatedAt"},87327:(e,t,a)=>{"use strict";a.d(t,{E:()=>D});var l=a(25576),r=a(85860),s=a(83081),i=a(64299),n=a.n(i),o=a(12839),d=a(60410),c=a(6433),u=a(9758),m=a(96610),p=a(4732),h=a(77936),v=a(27773);let g=(0,v.w)({path:"M1.88 6.063c-.496 0-.88.385-.88.824v6.92a4.208 4.208 0 0 0 4.229 4.12 4.323 4.323 0 0 0 3.79-2.253c.714 1.318 2.142 2.252 3.735 2.252 2.362 0 4.284-1.867 4.284-4.228.055-2.253-1.867-4.12-4.229-4.12-1.593 0-3.02.878-3.734 2.197-.715-1.319-2.143-2.198-3.79-2.198-.99 0-1.869.33-2.583.824V6.887a.843.843 0 0 0-.823-.824Zm15.255 3.425a.871.871 0 0 0-.645.145c-.33.275-.44.824-.165 1.208l2.197 2.857-2.196 2.855c-.275.385-.22.88.165 1.155.384.275.931.273 1.206-.112l1.87-2.416 1.92 2.472c.276.33.825.384 1.209.11.33-.275.385-.77.11-1.154l-2.143-2.855 2.144-2.803c.275-.384.273-.933-.111-1.208-.44-.275-.934-.22-1.209.165l-1.92 2.362-1.87-2.47a.919.919 0 0 0-.562-.31ZM5.23 11.225c1.428 0 2.582 1.155 2.582 2.528 0 1.428-1.154 2.526-2.582 2.526-1.429 0-2.582-1.098-2.582-2.526 0-1.373 1.153-2.528 2.582-2.528Zm7.58 0c1.429 0 2.582 1.155 2.582 2.528-.055 1.428-1.208 2.526-2.582 2.526-1.428 0-2.582-1.098-2.582-2.526 0-1.373 1.154-2.528 2.582-2.528Z",name:"IconBrandBox",variant:"filled"}),f=(0,v.w)({path:"M16.145 4.2a.875.875 0 0 1 .816.057l4.5 2.79a.875.875 0 0 1 .003 1.485l-3.333 2.083 3.334 2.092a.876.876 0 0 1-.002 1.484l-4.088 2.545v.637a.876.876 0 0 1-.338.691l-.096.065-4.5 2.627a.877.877 0 0 1-.882 0l-4.5-2.627a.876.876 0 0 1-.434-.756v-.637l-4.088-2.545a.875.875 0 0 1-.002-1.484l3.316-2.081-3.315-2.071a.875.875 0 0 1 0-1.485l4.5-2.812.11-.058a.875.875 0 0 1 .818.058L12 6.78l4.036-2.522.11-.058Zm-7.77 12.536v.135L12 18.986l3.625-2.115v-.135L12 14.48l-3.625 2.257Zm-3.725-3.29 2.85 1.772 2.849-1.773L7.5 11.657l-2.85 1.788Zm9 0 2.85 1.772 2.849-1.773-2.849-1.788-2.85 1.788Zm-4.502-2.82L12 12.415l2.864-1.797-2.862-1.775-2.854 1.783ZM4.651 7.813 7.5 9.593l2.849-1.78L7.5 6.03 4.651 7.813Zm9.004-.003 2.843 1.762 2.847-1.779-2.843-1.763-2.847 1.78Z",name:"IconBrandDropbox",variant:"filled"}),y=(0,v.w)({path:"M16.265 19.352h.1l4.933-12.484c.485-1.201.927-1.792 1.369-2.056V4.69h-2.97v.122c.622.346.762 1.283.34 2.361l-3.03 7.698-4.115-10.223h-.099L8.458 14.853 5.347 6.826c-.361-.956-.26-1.67.32-2.014V4.69H1.334v.122c.462.244.803.753 1.224 1.792l5.098 12.748h.1L12.05 9.027l4.215 10.325Z",name:"IconBrandWiley",variant:"filled"}),x=(0,v.w)({path:"M12 10l-6 10l-3 -5l6 -10z M9 15h12l-3 5h-12 M15 15l-6 -10h6l6 10z",name:"IconBrandGoogleDrive",variant:"stroked"}),b=(0,v.w)({path:"M11 17.5v-6.5h.5l4 6h.5v-6.5 M19.077 20.071l-11.53 .887a1 1 0 0 1 -.876 -.397l-2.471 -3.294a1 1 0 0 1 -.2 -.6v-10.741a1 1 0 0 1 .923 -.997l11.389 -.876a2 2 0 0 1 1.262 .33l1.535 1.023a2 2 0 0 1 .891 1.664v12.004a1 1 0 0 1 -.923 .997z M4.5 5.5l2.5 2.5 M20 7l-13 1v12.5",name:"IconBrandNotion",variant:"stroked"}),w=(0,v.w)({path:"M18.456 10.45a6.45 6.45 0 0 0 -12 -2.151a4.857 4.857 0 0 0 -4.44 5.241a4.856 4.856 0 0 0 5.236 4.444h10.751a3.771 3.771 0 0 0 3.99 -3.54a3.772 3.772 0 0 0 -3.538 -3.992z",name:"IconBrandOnedrive",variant:"stroked"});var _=a(65076),M=a(1407),C=a(1861),j=a(90768);let A=(0,v.w)({path:"M6.5 7h11 M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z",name:"IconHourglassHigh",variant:"stroked"});var E=a(75546),S=a(50458),k=a(89450);let N=(0,v.w)({path:"M15 6l.01 0 M3 3m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z M3 13l4 -4a3 5 0 0 1 3 0l4 4 M13 12l2 -2a3 5 0 0 1 3 0l3 3 M8 21l.01 0 M12 21l.01 0 M16 21l.01 0",name:"IconSlideshow",variant:"stroked"});var T=a(49427);let I={[u.X.GOOGLE_DRIVE]:x,[u.X.ONEDRIVE]:w,[u.X.SHAREPOINT]:_.m,[u.X.DROPBOX]:f,[u.X.BOX]:g,[u.X.GENERATED_IMAGE]:k.Q,[u.X.GENERATED_VIDEO]:N,[u.X.NOTION]:b,[u.X.WILEY]:y,[u.X.LOCAL]:j.g},R=r.memo(e=>{let{url:t,isConversationHistory:a,isMemory:s,isInlineAttachment:i,connectionType:n,isAttachment:o,isPatent:d,isClientContext:u}=e,m=(0,r.useMemo)(()=>{let e=(0,h.qP)(t),r=o?(0,p.I3)(t):null;if(a)return(0,l.jsx)(T.e,{icon:E.q,size:"xs"});if(d)return(0,l.jsx)(T.e,{icon:C.V,size:"xs"});if(s)return(0,l.jsx)(T.e,{icon:M.b,size:"xs"});if(i)return(0,l.jsx)(T.e,{icon:S.E,size:"xs"});if(n){let t=I[n];return t?(0,l.jsx)(T.e,{icon:t}):(0,l.jsx)(c.S,{domain:e})}else if(o)return(0,l.jsx)(T.e,{icon:r||j.g,size:"xs"});else if(u)return(0,l.jsx)(T.e,{icon:A,size:"xs"});else return(0,l.jsx)(c.S,{domain:e})},[t,a,s,i,n,o,d,u]);return(0,l.jsx)("div",{className:"flex size-4 items-center justify-center",children:m})});R.displayName="Icon";let P=r.memo(e=>{let{url:t,source:a,isAttachment:i,connectionType:n,isConversationHistory:o}=e,d=(0,s.A)(),c=(0,r.useMemo)(()=>{let e;return o?d.formatMessage({defaultMessage:"library",id:"B7J+pmy9R5"}):null!=a?a:(i?(0,h.RQ)(t):n?(0,m.m)(n):(0,h.Aw)(t)).replace(/\.[^.]*$/,"")},[t,a,i,n,o,d]);return(0,l.jsx)(l.Fragment,{children:c})});P.displayName="Source";let O=r.memo(e=>{let{url:t,source:a,isAttachment:r,isClientContext:s,variant:i="small",color:c="default",truncate:u=!0,className:m,connectionType:p,isInlineAttachment:h,isMemory:v,isPatent:g,isConversationHistory:f,name:y,snippet:x,...b}=e;return(0,l.jsxs)(o.Ay,{className:"flex items-center gap-x-1.5",children:[(0,l.jsx)(d.A,{variant:i,className:"relative -mt-px flex-none",color:v||f?"light":c,children:(0,l.jsx)(R,{url:t,isConversationHistory:f,isMemory:v,isInlineAttachment:h,connectionType:p,isAttachment:r,isPatent:g,isClientContext:s})}),y&&(0,l.jsx)(d.A,{variant:i,color:c,...b,className:n()(m,"min-w-0 truncate"),children:y}),(0,l.jsx)(d.A,{variant:i,color:y?"light":c,className:n()("line-clamp-1 min-w-0 grow break-all leading-none transition-all duration-300",{"max-w-[150px]":null!=a&&u},m),...b,children:(0,l.jsx)(P,{url:t,source:a,isAttachment:r,connectionType:p,isMemory:v,isConversationHistory:f})})]})});O.displayName="CitationDomainRoot";let D=Object.assign(O,{Icon:R,Source:P})},87569:(e,t,a)=>{"use strict";a.d(t,{V:()=>l});let l=(0,a(27773).w)({path:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0 M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0 M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0 M8.7 10.7l6.6 -3.4 M8.7 13.3l6.6 3.4",name:"IconShare",variant:"stroked"})},88209:(e,t,a)=>{"use strict";a.d(t,{qE:()=>s});var l=a(77150),r=a(77917);a(30002);let s=async e=>{let{reason:t}=e,a=await r.By.GET("/rest/collections/list_space_templates",t,{timeoutMs:(0,r.e4)(),numRetries:1});if(a.error)throw new l.T("API_CLIENTS_ERROR",{message:"Failed to list space templates",cause:a.error});return a.data}},88364:(e,t,a)=>{"use strict";var l,r;a.d(t,{Wl:()=>r,Wm:()=>d,bq:()=>l,cA:()=>s,hd:()=>i,qj:()=>c}),function(e){e.MACOS="macos",e.WINDOWS="windows"}(l||(l={})),function(e){e.NEW_THREAD="NEW_THREAD",e.STOP_GENERATING="STOP_GENERATING",e.TOGGLE_INCOGNITO="TOGGLE_INCOGNITO",e.SHOW_SHORTCUTS="SHOW_SHORTCUTS",e.FOCUS_ASK_INPUT="FOCUS_ASK_INPUT",e.TOGGLE_DICTATION="TOGGLE_DICTATION",e.TOGGLE_V2V="TOGGLE_V2V"}(r||(r={}));let s="keyboard-shortcuts",i=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return[{type:r.NEW_THREAD,label:e.formatMessage({defaultMessage:"New Thread",id:"76XSxT3hV8"}),macos:["⌘","K"],windows:t?["Ctrl","Shift","P"]:["Ctrl","I"],editable:!0,global:!0},{type:r.TOGGLE_V2V,label:e.formatMessage({defaultMessage:"Toggle Voice Mode",id:"ulahVrf1h4"}),macos:["⌘","Shift","B"],windows:["Ctrl","Shift","B"],editable:!0,global:!0,requiresAuth:!0,windowsAppOnly:!0},{type:r.TOGGLE_DICTATION,label:e.formatMessage({defaultMessage:"Toggle Voice Dictation",id:"tWip/8rlIv"}),macos:["⌘","D"],windows:["Ctrl","D"],editable:!1,windowsAppOnly:!0},{type:r.TOGGLE_INCOGNITO,label:e.formatMessage({defaultMessage:"Toggle Incognito",id:"YNMg3vd9IG"}),macos:["⌘",";"],windows:["Ctrl",";"],editable:!1},{type:r.SHOW_SHORTCUTS,label:e.formatMessage({defaultMessage:"Show Shortcuts",id:"8o6rUVckYq"}),macos:["⌘","/"],windows:["Ctrl","/"],editable:!1},{type:r.FOCUS_ASK_INPUT,label:e.formatMessage({defaultMessage:"Focus Ask Input",id:"RP5ybIk9wM"}),macos:["⌘","J"],windows:["Ctrl","J"],editable:!1}].filter(e=>(!e.requiresAuth||a)&&(!e.windowsAppOnly||t))},n={Meta:"⌘",Shift:"⇧",ArrowUp:"↑",ArrowDown:"↓",ArrowLeft:"←",ArrowRight:"→",Enter:"⏎",Period:".",Semicolon:";",Slash:"/",Escape:"Esc"},o={"⌘":"Meta","⇧":"Shift","↑":"ArrowUp","↓":"ArrowDown","←":"ArrowLeft","→":"ArrowRight","⏎":"Enter"},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.MACOS;return"Meta"===e?t===l.WINDOWS?"Win":"⌘":n[e]||e},c=e=>"Win"===e?"Meta":o[e]||e},88574:(e,t,a)=>{"use strict";a.d(t,{T:()=>o});var l=a(85860),r=a(85109),s=a(98188),i=a(46972),n=a(89334);let o=()=>{let{session:e}=(0,s.N)(),t=(0,n.EJ)(),{firstResult:{backend_uuid:a,context_uuid:o}={}}=(0,i.E)(),d=(0,l.useCallback)((l,s)=>{(0,r.sx)({name:l,data:{entryUUID:a,threadUUID:o,...s,isPerplexityBrowser:t},session:null!=e?e:void 0})},[a,o,t,e]);return(0,l.useMemo)(()=>({trackEvent:d}),[d])}},89450:(e,t,a)=>{"use strict";a.d(t,{Q:()=>l});let l=(0,a(27773).w)({path:"M15 8h.01 M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5 M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3",name:"IconPhoto",variant:"stroked"})},89573:(e,t,a)=>{"use strict";a.d(t,{h:()=>n});var l=a(25576),r=a(64299),s=a.n(r);let i=(0,a(27773).w)({path:"M12 3l8 4.5l0 9l-8 4.5l-8 -4.5l0 -9l8 -4.5 M12 12l8 -4.5 M12 12l0 9 M12 12l-8 -4.5",name:"IconBox",variant:"stroked"}),n=e=>{let{serverName:t,iconUrl:a,size:r="md",border:n=!1}=e;return a?(0,l.jsx)("img",{src:a,alt:"".concat(t," Logo"),className:s()("object-contain","sm"===r&&"size-5","md"===r&&"p-xs size-12",n&&"ring-subtlest rounded-md ring-1")}):(0,l.jsx)(i,{className:s()("sm"===r&&"size-4","md"===r&&"p-xs size-12",n&&"ring-subtlest rounded-md ring-1")})}},89744:(e,t,a)=>{"use strict";a.d(t,{g:()=>P});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(12839),o=a(11237),d=a(83081),c=a(70714),u=a(60410),m=a(87327),p=a(46884),h=a(37813),v=a(9758),g=a(82297),f=a(96610),y=a(60380),x=a(23508),b=a(41697),w=a(49427);let _=r.memo(function(e){var t,a,r,s,o,_,M,C,j,A,E,S,k,N,T,I,R;let{$t:P}=(0,d.A)(),{result:O,additionalMetadata:D,variant:L}=e,U=O.url,F=null!==(I=null===(t=O.meta_data)||void 0===t?void 0:t.generated_file_description)&&void 0!==I?I:O.snippet,z=null!==(R=null===(a=O.meta_data)||void 0===a?void 0:a.generated_file_title)&&void 0!==R?R:O.name,B=null==O?void 0:O.is_client_context,H=!!(null===(r=O.meta_data)||void 0===r?void 0:r.connection_type),q="string"==typeof(null===(s=O.meta_data)||void 0===s?void 0:s.quoteBeforeContext)?null===(o=O.meta_data)||void 0===o?void 0:o.quoteBeforeContext:"",G="string"==typeof(null===(_=O.meta_data)||void 0===_?void 0:_.quoteEmphasisText)?null===(M=O.meta_data)||void 0===M?void 0:M.quoteEmphasisText:"",Q="string"==typeof(null===(C=O.meta_data)||void 0===C?void 0:C.quoteAfterContext)?null===(j=O.meta_data)||void 0===j?void 0:j.quoteAfterContext:"",V=q.length>0||G.length>0||Q.length>0,K="grid"!==L&&F&&V,W=null===(A=O.file_metadata)||void 0===A?void 0:A.file_repository_type,Y="string"==typeof(null===(E=O.meta_data)||void 0===E?void 0:E.wiley_book_uuid),X="string"==typeof(null===(S=O.meta_data)||void 0===S?void 0:S.domain_name)?null===(k=O.meta_data)||void 0===k?void 0:k.domain_name:void 0,Z=(0,g.k5)(O),J=(0,h.LN)(O),$=O.is_memory,ee=(0,h.Lt)(O);return(0,l.jsxs)("div",{className:i()("gap-xs pointer-events-none relative flex h-full max-w-full select-none flex-col",{"px-sm pb-sm pt-sm w-full":"grid"===L},{"p-md":"grid"!==L}),children:[(0,l.jsxs)("div",{className:"flex w-full items-center justify-between",children:[J&&!ee?(0,l.jsx)(p.j,{variant:"small",searchType:$?"memory":"conversation-history"}):(0,l.jsxs)("div",{className:"space-x-xs flex",children:[D||null,(0,l.jsx)(m.E,{variant:"tiny",color:"light",url:U,isAttachment:O.is_attachment,connectionType:null===(N=O.meta_data)||void 0===N?void 0:N.connection_type,source:(()=>{var e,t,a,l,r,s;if(H&&(null===(e=O.meta_data)||void 0===e?void 0:e.connection_type)!==v.X.WILEY)return(0,f.m)(null===(t=O.meta_data)||void 0===t?void 0:t.connection_type);if(O.is_attachment){if(null==O?void 0:null===(a=O.meta_data)||void 0===a?void 0:a.patent_name)return O.meta_data.patent_name;if(!(null==O?void 0:null===(l=O.meta_data)||void 0===l?void 0:l.file_uuid)){let e=null!==(s=null==O?void 0:null===(r=O.file_metadata)||void 0===r?void 0:r.connector_type)&&void 0!==s?s:(0,g.Qh)(O.url),t=e?(0,f.m)(e):void 0;if(t)return t}return"USER"==W?P({defaultMessage:"Local Files",id:"FBnEWaGOHR"}):"ORG"==W?P({defaultMessage:"Org Files",id:"DaFSYzpM1Q"}):"COLLECTION"==W?P({defaultMessage:"Space Files",id:"Thy4/SbBwD"}):P({defaultMessage:"Attachment",id:"eLCAEP8LHj"})}return X})(),isInlineAttachment:Z,isPatent:!!(null==O?void 0:null===(T=O.meta_data)||void 0===T?void 0:T.patent_name),truncate:!1})]}),(0,l.jsxs)("div",{children:[Y&&(0,l.jsx)(u.A,{variant:"tiny",color:"super",children:(0,l.jsx)(w.e,{size:"sm",icon:y.S})}),B&&"grid"===L?(0,l.jsx)(u.A,{variant:"tiny",color:"super",children:(0,l.jsx)(w.e,{size:"sm",icon:x.Q})}):null]})]}),(0,l.jsx)(u.A,{variant:"grid"===L?"tiny":"list"===L?"small":"base",className:i()("",{"":"grid"===L,"pr-1":"list"===L}),children:$&&!ee?(0,l.jsx)(u.A,{variant:"tiny",className:"line-clamp-2 h-8",children:null==O?void 0:O.snippet}):(0,l.jsx)("span",{className:"line-clamp-1 text-left md:line-clamp-2",children:z||(0,l.jsx)("div",{children:"\xa0"})})}),z!==O.name?(0,l.jsx)(u.A,{variant:"small",color:"light",className:"line-clamp-1",children:O.name}):null,K&&(0,l.jsxs)(u.A,{variant:"list"===L?"tiny":"small",className:"mt-two border-super line-clamp-[8] border-l-4 pl-2 font-normal",children:[(0,l.jsx)("span",{children:q}),(0,l.jsx)("span",{className:"bg-super/30",children:G}),(0,l.jsx)("span",{children:Q})]}),"grid"!==L&&F&&!V&&(0,l.jsx)(u.A,{variant:"list"===L?"tiny":"small",className:"mt-two line-clamp-1 font-normal md:line-clamp-4",children:F}),ee&&"grid"!==L?(0,l.jsxs)(n.Ay,{className:"gap-xs pt-sm mt-xs flex items-center border-t",children:[(0,l.jsx)(u.A,{variant:"tiny",color:"super",children:(0,l.jsx)(w.e,{size:"sm",icon:b.p})}),(0,l.jsx)(u.A,{variant:"tiny",color:"super",children:(0,l.jsx)(c.A,{defaultMessage:"Personal Search",id:"7+aLCEyqS2",description:"title"})})]}):null]})});_.displayName="CitationDefaultCard";var M=a(15925);let C=r.memo(function(e){let{result:t,imageURL:a,citationNumber:r,useLightBoxModal:s=!0}=e,n=i()(" w-full relative max-h-[76px]");return(0,l.jsxs)("div",{className:n,children:[(0,l.jsx)(M.A,{includeLightBoxModal:s,alt:t.name,containerClassName:"w-full h-full p-xs",imageClassName:"object-cover object-center w-full h-full rounded-md",src:a}),r&&(0,l.jsx)(u.A,{className:"bottom-sm left-sm px-xs absolute z-[1] inline-flex rounded-sm bg-black/50",variant:"tiny",color:"white",children:r})]})});C.displayName="CitationImageCard";var j=a(86924),A=a(90915),E=a(66157),S=a(50665);let k=r.memo(e=>{var t;let{result:a,imageURL:s}=e,n=a.url,o=(0,d.A)(),c=(0,r.useMemo)(()=>({color:"white"}),[]),p=(0,r.useMemo)(()=>{var e;return(0,l.jsx)(j._,{recentlyUpdatedLabel:o.$t({defaultMessage:"just now",id:"I90sbWU03C"}),timestamp:null===(e=a.meta_data)||void 0===e?void 0:e.published_date,timestampProps:c,includeIcon:!1,children:o.$t({defaultMessage:"Updated",id:"xrk6zgu9jU"})})},[o,null===(t=a.meta_data)||void 0===t?void 0:t.published_date,c]);return(0,l.jsxs)("div",{className:i()("p-sm gap-sm flex h-full max-h-[190px]"),children:[(0,l.jsxs)("div",{className:"gap-xs flex flex-col",children:[(0,l.jsxs)("div",{className:"space-x-xs flex justify-between",children:[(0,l.jsx)(m.E,{variant:"tiny",color:"light",url:n,isAttachment:a.is_attachment}),E.o.isRecentlyTrending(a)?(0,l.jsx)(A.A,{tooltipText:p,children:(0,l.jsx)(S.N,{className:"text-super size-3.5"})}):null]}),(0,l.jsx)("div",{children:(0,l.jsx)(u.A,{variant:"tiny",className:"line-clamp-2",children:a.name})})]}),s?(0,l.jsx)("div",{className:"relative -my-1 -mr-1 size-[60px] shrink-0",children:(0,l.jsx)(M.A,{includeLightBoxModal:!1,alt:a.name,containerClassName:"w-full h-full",imageClassName:"object-cover object-center w-full h-full  rounded-md",src:s})}):null]})});k.displayName="CitationTrendingCard";var N=a(18811),T=a(98540),I=a(77936),R=a(90037);let P=r.memo(e=>{var t,a;let{result:s,idx:d,isSelected:c,testId:u,additionalMetadata:m,isTrendingLayout:p=!1,trackEvent:h,downloadCitation:v,getImageUrl:f,variant:y,isSidecar:x,onClick:b,useLightBoxModal:w=!0}=e,M=(null===(t=s.meta_data)||void 0===t?void 0:t.file_uuid)?"fileRepositoryFile":s.is_attachment?"fileAttachment":"sourceCard";(0,r.useEffect)(()=>{let e=setTimeout(()=>null==h?void 0:h("source card viewed",{citation_url:s.url,position:d,title:s.name,source:M}),100);return()=>clearTimeout(e)},[h,s.name,s.url,d,M]);let j=s.url,[A,E]=(0,r.useState)(()=>!s.is_memory&&(0,I.Zy)(s.url)?s.url:null),[S,P]=(0,r.useState)(!1),O=(0,r.useMemo)(()=>j&&!x&&(0,I.HN)(j),[j,x]),[D,L]=(0,r.useState)(!1),U=(0,g.u9)(s),F=(0,T.wu)(s.url),z=!O&&!s.is_attachment&&!F,B=p&&(null===(a=s.meta_data)||void 0===a?void 0:a.client)==="trending",H=(0,r.useMemo)(()=>{if(B){var e,t,a;return(0,l.jsx)(k,{result:s,authors:null===(e=s.meta_data)||void 0===e?void 0:e.authors,imageURL:null===(a=s.meta_data)||void 0===a?void 0:null===(t=a.images)||void 0===t?void 0:t[0]})}return F&&A?(0,l.jsx)(C,{result:s,imageURL:A,useLightBoxModal:w}):F&&!A?(0,l.jsx)(N.A,{blockCount:1,size:"large"}):(0,l.jsx)(_,{result:s,variant:y,additionalMetadata:m,isSelected:c})},[B,F,A,s,w,y,m,c]),q=(0,r.useCallback)((e,t)=>{P(t),E(e)},[]),G=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&F&&null===A&&!S&&(null==f||f(s,q))})},{threshold:.1}),t=G.current;return t&&F&&e.observe(t),()=>{t&&F&&e.unobserve(t)}},[G,j,f,s,A,q,S,F]),(0,l.jsxs)(o.m,{result:s,trackEvent:h,children:[(0,l.jsx)("div",{ref:G,onClick:e=>{var t,a,l,r,i,n;let o="string"==typeof(null===(t=s.meta_data)||void 0===t?void 0:t.quoteBeforeContext)?null===(a=s.meta_data)||void 0===a?void 0:a.quoteBeforeContext:"",d="string"==typeof(null===(l=s.meta_data)||void 0===l?void 0:l.quoteEmphasisText)?null===(r=s.meta_data)||void 0===r?void 0:r.quoteEmphasisText:"",c="string"==typeof(null===(i=s.meta_data)||void 0===i?void 0:i.quoteAfterContext)?null===(n=s.meta_data)||void 0===n?void 0:n.quoteAfterContext:"",u=o.length>0||d.length>0||c.length>0;O&&!D?L(!0):!v||F||U?null==b||b(e):(e.preventDefault(),v(s)),null==h||h("click citation",{source:M,citation_url:j}),u&&(null==h||h("click check sources citation",{source:M,citation_url:j,quoteBeforeContext:o,quoteEmphasisText:d,quoteAfterContext:c}))},className:i()("group relative flex w-full items-stretch",{"h-full":"grid"===y,"cursor-pointer":!!v||!!O||!!b}),"data-test-id":u,children:(0,l.jsx)(n.Ay,{variant:"subtler",bgHover:z||O?"subtle":void 0,className:i()("flex w-full rounded-lg",{"bg-super/10 ring-super/80 hover:!bg-super/10 dark:bg-super/20 dark:ring-super/80 dark:hover:!bg-super/20 ring-1":c}),children:H},s.name)}),O&&j&&s.name&&(0,l.jsx)(R.Q,{isOpen:D,name:s.name,url:j,setisOpen:L})]})});P.displayName="CitationCard"},90037:(e,t,a)=>{"use strict";a.d(t,{Q:()=>x});var l=a(25576),r=a(85860),s=a(80567),i=a(62869),n=a(39866),o=a(64299),d=a.n(o),c=a(18507),u=a(38806),m=a(28554),p=a(9844),h=a(39053),v=a(77936),g=a(12422);let f={fadeIn:{opacity:1},fadeOut:{opacity:0}},y={width:"100%",height:"100%",playerVars:{autoplay:1,color:"white",playsinline:1}},x=r.memo(e=>{let{isOpen:t,name:a,setisOpen:o,url:x}=e,b=x?(0,v.HN)(x):void 0,w=(0,r.useRef)(void 0),[_,M]=(0,r.useState)(!1),C=(0,r.useCallback)(e=>{w.current=e.target,M(!0)},[w]),j=(0,r.useCallback)(e=>{if(w.current)switch(e.key){case" ":w.current.getPlayerState()===n.A.PlayerState.PLAYING?w.current.pauseVideo():w.current.playVideo();break;case"ArrowRight":w.current.seekTo(w.current.getCurrentTime()+5,!0);break;case"ArrowLeft":w.current.seekTo(w.current.getCurrentTime()-5,!0)}},[w]);(0,r.useEffect)(()=>(t?window.addEventListener("keydown",j):window.removeEventListener("keydown",j),()=>{window.removeEventListener("keydown",j)}),[j,t]);let A=(0,r.useCallback)(e=>{o(e)},[o]);return b?(0,l.jsx)(p.x,{open:t,onOpenChange:A,children:(0,l.jsx)(s.hJ,{className:"z-10",asChild:!0,children:(0,l.jsxs)(c.P.div,{className:"bg-backdrop dark fixed inset-0 flex items-center justify-center backdrop-blur-md",initial:"fadeOut",animate:"fadeIn",exit:"fadeOut",variants:f,transition:{duration:.2},children:[(0,l.jsx)(s.bm,{asChild:!0,children:(0,l.jsx)(m.A,{extraCSS:"!fixed top-md right-md shadow-sm",icon:g.M,pill:!0,size:"small",variant:"common"})}),(0,l.jsxs)(s.UC,{className:"grid outline-none","aria-describedby":void 0,children:[(0,l.jsx)(i.s6,{children:(0,l.jsx)(s.hE,{children:a})}),(0,l.jsxs)(u.N,{children:[!_&&(0,l.jsx)(c.P.div,{className:"grid place-items-center [grid-area:1/-1]",initial:"fadeOut",animate:"fadeIn",exit:"fadeOut",transition:{duration:.2},variants:f,children:(0,l.jsx)(h.y,{size:24})},"youtube-player-loading"),(0,l.jsx)(c.P.div,{className:d()("aspect-video overflow-hidden rounded-2xl shadow-lg [grid-area:1/-1] *:size-full","w-[calc(100dvw-(2*var(--size-md)))] sm:w-[75vw]"),initial:{opacity:0},animate:{opacity:+!!_},transition:{duration:.2},children:(0,l.jsx)(n.A,{onReady:C,opts:y,title:a,videoId:b})},"youtube-player-content")]})]})]},"youtube-player-overlay")})}):null});x.displayName="YoutubeVideoPlayer"},90768:(e,t,a)=>{"use strict";a.d(t,{g:()=>l});let l=(0,a(27773).w)({path:"M14 3v4a1 1 0 0 0 1 1h4 M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",name:"IconFile",variant:"stroked"})},90773:(e,t,a)=>{"use strict";a.d(t,{A:()=>w});var l=a(25576),r=a(85860),s=a(64299),i=a.n(s),n=a(38806),o=a(18507),d=a(90873),c=a(12839),u=a(60410),m=a(26085),p=a(66410),h=a(75131),v=a(59584),g=a(51058),f=a(63825),y=a(12422),x=a(49427);let b=r.memo(e=>{let{keyProp:t=0,message:a,variant:s,description:b,ctaText:w,ctaOnClick:_,closeOnCtaClick:M=!0,isVisible:C=!1,timeout:j,handleClick:A,handleClose:E,onTimeout:S=d.A,position:k="top",iconOverride:N,...T}=e,[I,R]=(0,r.useState)(C);(0,r.useEffect)(()=>{R(C)},[C]),(0,r.useEffect)(()=>{let e;return C&&j&&(e=setTimeout(()=>{R(!1),S()},1e3*j)),()=>{clearTimeout(e)}},[I,j,C,S]);let P=(0,r.useCallback)(()=>{R(!1),null==E||E()},[E]),O=(0,r.useCallback)(()=>{null==_||_(),M&&P()},[_,P,M]),D=(0,r.useMemo)(()=>{if(N)return N;switch(s){case"success":return g.i;case"error":case"warning":return v.G;case"refresh":return f.H}},[N,s]);return(0,l.jsx)(n.N,{children:I&&(0,l.jsx)(p.Z,{children:(0,l.jsx)(o.P.div,{className:i()("right-toastHMargin erp-sidecar:top-[114px] fixed ".concat("top"===k?"top-toastVMargin":"bottom-toastVMargin"," z-30 flex items-center justify-center ").concat(A?"cursor-pointer":"")),initial:{opacity:0,x:6},animate:{opacity:1,x:0},exit:{opacity:0,x:6},transition:h.n,...T,children:(0,l.jsxs)(c.Ay,{variant:"raised",className:i()("gap-x-sm p-md shadow-overlay flex items-center rounded-lg",{"cursor-pointer":"refresh"===s}),onClick:null!=A?A:d.A,children:[(0,l.jsx)(c.Ay,{variant:"subtler",className:"p-sm dark:bg-subtle rounded-md",children:(0,l.jsx)(u.A,{variant:"smallBold",color:"error"===s?"red":"warning"===s?"yellow":"super",children:(0,l.jsx)(x.e,{icon:D,size:"sm"})})}),(0,l.jsxs)(c.Ay,{className:"flex-1",children:[(0,l.jsx)(u.A,{variant:"small",color:"default",children:a}),b&&(0,l.jsx)(u.A,{variant:"tinyRegular",color:"light",className:"mt-1 whitespace-pre-line",children:b})]}),w&&_&&(0,l.jsx)(m.A,{text:w,variant:"subtle",onClick:O,size:"small",extraCSS:"ml-xl"}),void 0===j&&(0,l.jsx)(m.A,{variant:"primary",size:"tiny",icon:y.M,onClick:P,extraCSS:"ml-sm",noPadding:!0})]})},t)})})});b.displayName="Toast";let w=b},91360:(e,t,a)=>{"use strict";a.d(t,{A:()=>y});var l=a(25576),r=a(85860),s=a(83081),i=a(11500),n=a(12839),o=a(60410),d=a(28554),c=a(35052),u=a(89479),m=a(41290),p=a(6366),h=a(12422),v=a(49427);let g=(0,m.Q)(()=>a.e(9072).then(a.bind(a,79072)),{nextFrame:!0}),f=r.memo(e=>{let{emoji:t,setEmoji:a,size:m="large"}=e,{$t:f}=(0,s.A)(),{colorScheme:y}=(0,c.U)(),[x,b]=(0,r.useState)(!1),w=(0,r.useCallback)(e=>{b(!1),a(e.unified)},[a]),_=(0,r.useCallback)(()=>b(!1),[]),M=(0,r.useMemo)(()=>({showPreview:!1}),[]),C=(0,r.useMemo)(()=>(0,l.jsx)(g,{emojiStyle:"native",onEmojiClick:w,autoFocusSearch:!0,width:"100%",theme:"dark"===y?"dark":"light",previewConfig:M}),[y,w,M]),j=(0,r.useCallback)(()=>a(""),[a]),A=(0,r.useCallback)(()=>b(e=>!e),[]);return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(o.A,{variant:"smallBold",children:f({defaultMessage:"Emoji",id:"34NuzGC3+4"})}),(0,l.jsxs)("div",{className:"mt-sm relative inline-block",children:[""!==t&&(0,l.jsx)("div",{className:"-right-sm -top-sm absolute",children:(0,l.jsx)(d.A,{pill:!0,size:"tiny",icon:h.M,onClick:j})}),(0,l.jsx)(u.A,{isOpen:x,onClose:_,content:C,hasInteractiveContent:!0,children:(0,l.jsx)(n.Ay,{onClick:A,variant:"subtler",bgHover:"subtle",className:"p-sm flex cursor-pointer items-center justify-center rounded-full ".concat({small:"h-8 w-8",medium:"h-11 w-11",large:"h-14 w-14"}[m]),children:""===t?(0,l.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,l.jsx)(v.A,{icon:p.u,size:"md"})}):(0,l.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,l.jsx)(i.Z,{unified:t,size:"regular"})})})})]})]})});f.displayName="CollectionEmojiPicker";let y=f},91458:(e,t,a)=>{"use strict";a.d(t,{m:()=>l});let l=(0,a(27773).w)({path:"M14 3v4a1 1 0 0 0 1 1h4 M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4 M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6 M17 18h2 M20 15h-3v6 M11 15v6h1a2 2 0 0 0 2 -2v-2a2 2 0 0 0 -2 -2h-1z",name:"IconFileTypePdf",variant:"stroked"})},91487:()=>{},91679:(e,t,a)=>{"use strict";a.d(t,{j:()=>l});let l=".pdf,.txt,.csv,.xlsx,.docx,.pptx,.md,.json"},91766:(e,t,a)=>{"use strict";a.d(t,{l:()=>n});var l=a(85860),r=a(15492),s=a(11129),i=a(16540);let n=e=>{let{reason:t}=e,{data:a,isLoading:n,refetch:o}=(0,r.useQuery)({queryKey:(0,s.rO)(),queryFn:()=>(0,i.Yl)({reason:t})});return(0,l.useMemo)(()=>{var e;return{userTryOnPhotoUrl:null!==(e=null==a?void 0:a.try_on_photo_url)&&void 0!==e?e:null,isUserTryOnPhotoLoading:n,refetchUserTryOnPhoto:o}},[a,n,o])}},92093:(e,t,a)=>{"use strict";a.d(t,{U:()=>W});var l=a(25576),r=a(85860);a(28202);var s=a(64299),i=a.n(s);a(47575),a(37652),a(77917);var n=a(95772),o=a(94749),d=a(2751),c=a(63270),u=a(31570),m=a(7957);d.U,o.M,c.J,u.d,n.N,m.j;var p=a(80892);a(50663),a(4327),a(34113),a(51244),a(99364);var h=a(38683),v=a(12839),g=a(60410),f=a(26085),y=a(39053),x=a(90915),b=a(25739),w=a(12422),_=a(49427);let M={good:"super",bad:"red",info:"subtler",orange:"orange"},C=r.memo(e=>{let{variant:t,title:a,actionLabel:s,onClick:n,onClose:o,toolTip:d,icon:c,isMobileStyle:u,isLoading:m}=e,p="info"===t?"default":"defaultInverted",h="info"===t?"super":p,C=(0,r.useCallback)(e=>{e.stopPropagation(),null==o||o(e)},[o]),j=(0,l.jsxs)(v.Ay,{className:i()("h-bannerHeight rounded-sm","gap-xs px-md md:gap-sm relative flex w-full cursor-pointer items-center transition duration-200 hover:opacity-80","info"===t?"justify-between":"justify-center",{"px-lg":o}),variant:M[t],onClick:n,children:[m?(0,l.jsx)(g.A,{color:p,children:(0,l.jsx)(y.y,{})}):c&&(0,l.jsx)(g.A,{color:p,className:"mr-xs md:mr-0",children:(0,l.jsx)(_.e,{icon:c,size:u?"sm":"md"})}),(0,l.jsx)(g.A,{color:p,className:"leading-[1.1]",variant:u?"tiny":"small",children:a}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[s&&(0,l.jsx)(g.A,{color:h,variant:u?"tiny":"small",className:i()("decoration-inverse/30 hidden font-bold md:inline-flex",{"underline underline-offset-2":"info"!==t}),children:s}),n&&"info"!==t&&(0,l.jsx)(g.A,{color:p,className:"inline-flex",children:(0,l.jsx)(_.e,{icon:b.h,size:"xs"})})]}),o&&(0,l.jsx)(f.A,{icon:w.M,extraCSS:i()("!absolute right-sm opacity-50","info"===t?"text-foreground dark:!text-white":"!text-white"),variant:"noHover",size:"tiny",onClick:C})]});return d?(0,l.jsx)(x.A,{tooltipText:d,children:j}):j});C.displayName="SiteBanner",a(43627),a(30002);var j=a(27773);(0,j.w)({path:"M12 1.67c.955 0 1.845 .467 2.39 1.247l.105 .16l8.114 13.548a2.914 2.914 0 0 1 -2.307 4.363l-.195 .008h-16.225a2.914 2.914 0 0 1 -2.582 -4.2l.099 -.185l8.11 -13.538a2.914 2.914 0 0 1 2.491 -1.403zm.01 13.33l-.127 .007a1 1 0 0 0 0 1.986l.117 .007l.127 -.007a1 1 0 0 0 0 -1.986l-.117 -.007zm-.01 -7a1 1 0 0 0 -.993 .883l-.007 .117v4l.007 .117a1 1 0 0 0 1.986 0l.007 -.117v-4l-.007 -.117a1 1 0 0 0 -.993 -.883z",name:"IconAlertTriangleFilled",variant:"filled"}),a(21978),a(83105),a(85722),a(61851),a(38481),a(74884),a(78744),a(74128),a(98188),a(18126),a(18360),a(94105),a(63149),a(14036),a(93062);var A=a(83081),E=a(99390),S=a(30950);(0,r.memo)(e=>{let{orgName:t,invitationUUID:a}=e,{$t:s}=(0,A.A)(),{isMobileStyle:i}=(0,h.al)(),n=(0,r.useCallback)(()=>{(0,E.x)("/onboarding/org/join/".concat(a),"Organization invitation")},[a]),o=(0,r.useMemo)(()=>s({defaultMessage:"{orgName} invited you to join their organization",id:"xAk8Drb2hE"},{orgName:t}),[s,t]),d=(0,r.useMemo)(()=>s({defaultMessage:"View invite",id:"TDWT6zhMKG"}),[s]);return(0,l.jsx)(C,{isLoading:!1,variant:"good",title:o,actionLabel:d,icon:S.A,isMobileStyle:i,onClick:n})}).displayName="OrgInvitationBanner";a(47719),a(91866);var k=a(92988);let N=(0,k.j)("AppLayoutContext",void 0),T=()=>{let e=(0,r.useContext)(N);if(!e)throw Error("useAppLayout must be used within an AppLayoutProvider");return e};var I=a(62615);let R=(0,k.j)("CanonicalPageContext",{inApp:!1,preferredColorScheme:null,deviceId:null,appVersion:null,isIOS:!1,isAndroid:!1,client:null});r.memo(e=>{let{children:t,inApp:a}=e,s=(0,I.ok)(),i=(0,I.a8)(),n=(null==s?void 0:s.get("mobile.deviceId"))||null,o=(null==s?void 0:s.get("mobile.appVersion"))||null,d=(null==s?void 0:s.get("mobile.preferredColorScheme"))||null,c=(null==s?void 0:s.get("mobile.client"))||null;return(0,r.useEffect)(()=>{if(!(null==i?void 0:i.startsWith("/app"))||!s)return;let e=["mobile.","version"],t=new URL(window.location.href.replace("/app",""));t.searchParams.forEach((a,l)=>{e.some(e=>l.startsWith(e))&&t.searchParams.delete(l)}),t.searchParams.set("referrer","canonical"),function(e){var t,a,l,r,s;let{type:i,data:n}=e,o=window,d={type:i,data:n};(null==o?void 0:null===(l=o.webkit)||void 0===l?void 0:null===(a=l.messageHandlers)||void 0===a?void 0:null===(t=a.pplx)||void 0===t?void 0:t.postMessage)?(o.webkit.messageHandlers.pplx.postMessage(d),!0):null!=o&&null!==(s=o.Android)&&void 0!==s&&null!==(r=s.pplx)&&void 0!==r&&!!r.postMessage&&(o.Android.pplx.postMessage(d),!0)}({type:"pplx.url.share",data:{url:t.href}})},[i,s]),(0,l.jsx)(R.Provider,{value:{inApp:a,preferredColorScheme:d,deviceId:n,appVersion:o,isIOS:"ios"===c,isAndroid:"android"===c,client:c},children:t})}).displayName="CanonicalPageProvider",a(89412);let P=(0,j.w)({path:"M4 6l16 0 M4 12l16 0 M4 18l16 0",name:"IconMenu2",variant:"stroked"}),O=e=>{let{className:t}=e,{inApp:a}=(0,r.useContext)(R),{isMobileSidebarOpen:s,setMobileSidebarOpen:i}=T();return a?null:(0,l.jsx)(f.A,{icon:P,pill:!0,onClick:()=>i(!s),extraCSS:t})};var D=a(32971),L=a(6271),U=a(54192),F=a(96359),z=a(28554),B=a(26941),H=a(69744),q=a(2928),G=a(36234);let Q=(0,j.w)({path:"M18.497 4.409a10 10 0 0 1 -10.36 16.828l-.223 -.098l-4.759 .849l-.11 .011a1 1 0 0 1 -.11 0l-.102 -.013l-.108 -.024l-.105 -.037l-.099 -.047l-.093 -.058l-.014 -.011l-.012 -.007l-.086 -.073l-.077 -.08l-.067 -.088l-.056 -.094l-.034 -.07l-.04 -.108l-.028 -.128l-.012 -.102a1 1 0 0 1 0 -.125l.012 -.1l.024 -.11l.045 -.122l1.433 -3.304l-.009 -.014a10 10 0 0 1 1.549 -12.454l.215 -.203a10 10 0 0 1 13.226 -.217m-8.997 3.09a1.5 1.5 0 0 0 -1.5 1.5v1a6 6 0 0 0 6 6h1a1.5 1.5 0 0 0 0 -3h-1l-.144 .007a1.5 1.5 0 0 0 -1.128 .697l-.042 .074l-.022 -.007a4.01 4.01 0 0 1 -2.435 -2.435l-.008 -.023l.075 -.041a1.5 1.5 0 0 0 .704 -1.272v-1a1.5 1.5 0 0 0 -1.5 -1.5",name:"IconBrandWhatsappFilled",variant:"filled"});var V=a(72811);r.memo(e=>{let{}=e,{$t:t}=(0,A.A)(),{trackEvent:a}=(0,p.yw)(),s=(0,r.useCallback)(()=>{a("click logo",{})},[a]),{device:{isIOS:i}}=(0,B.L)(),{handleAppDownloadClicked:n}=(0,L.D)("mobile-header"),o=(0,D.V)({origin:"mobile-header"}),{mwebUpsellWhatsApp:d,loadingMwebUpsellWhatsApp:c}=(0,F.a)(),u=(0,r.useMemo)(()=>d?Q:i?q.P:G.A,[d,i]);return(0,l.jsx)(v.Ay,{variant:"background",className:"px-sm h-headerHeight sticky inset-x-0 top-0 z-10 flex w-full items-center md:mb-0",children:(0,l.jsxs)("div",{className:"gap-x-sm pl-xs flex w-full items-center justify-between md:hidden",children:[(0,l.jsxs)("div",{className:"gap-x-sm flex items-center",children:[(0,l.jsx)(O,{className:"-ml-sm"}),(0,l.jsx)(V.N,{href:"/",onClick:s,children:(0,l.jsx)(H.g,{variant:"text",size:"small"})})]}),!c&&(0,l.jsx)(U.w,{isSamsungBrowser:!0,isFirefoxDefaultSearch:!0,children:(0,l.jsx)("div",{className:"animate-in fade-in duration-300",children:(0,l.jsx)(z.A,{size:"small",pill:!0,variant:"primary",icon:u,text:t(d?{defaultMessage:"Chat in WhatsApp",id:"jXqSBQcpKC"}:{defaultMessage:"Open in App",id:"fo3x6hDxdZ"}),onClick:d?o:n})})})]})})}).displayName="MobileProductHeader",a(10023),a(52865);var K=a(24065);r.memo(e=>{let{children:t,inRenderingPlace:a}=e,r=(0,K.x)().erp;return a&&a===r?null:a||void 0===r?(0,l.jsx)(l.Fragment,{children:t}):null}).displayName="HideInEntropy",a(89334);a(36206),a(49515),a(81080),a(27836),a(31814),a(68203),a(62928),a(30760),a(13484),a(75919),a(36733),a(97376),a(16077),a(24877),a(93902),a(61058);let W="USD"},92132:(e,t,a)=>{"use strict";a.d(t,{y:()=>_});var l=a(25576),r=a(85860),s=a(83081),i=a(18606),n=a(44152),o=a(11129),d=a(71849),c=a(18360);let u=e=>{var t,a;let{skip:l,filters:s,reason:i}=e,u=(0,n.useInfiniteQuery)({enabled:!l,initialPageParam:null,queryKey:(0,o.dT)(s),queryFn:e=>{let{pageParam:t}=e;return(0,d.m0)({filters:s,skipToken:t,reason:i})},getNextPageParam:e=>e&&e.sites.length?e.skipToken:void 0}),m=null!==(a=null===(t=u.data)||void 0===t?void 0:t.pages.map(e=>{var t;return null!==(t=null==e?void 0:e.sites)&&void 0!==t?t:[]}).flat())&&void 0!==a?a:c.Ml;return(0,r.useMemo)(()=>({...u,sites:m}),[u,m])};var m=a(64265),p=a(12839),h=a(60410),v=a(28554),g=a(26085),f=a(20041),y=a(38683),x=a(18811),b=a(11702),w=a(49427);let _=r.memo(e=>{let{onNext:t,onCancel:a}=e,n=(0,r.useRef)(null),{$t:o}=(0,s.A)(),d=o({defaultMessage:"Next",id:"9+DdtuCqLw"}),c=o({defaultMessage:"Cancel",id:"47FYwba+bI"}),[g,b]=(0,r.useState)(null),w=(0,r.useCallback)(e=>b(e.name!==(null==g?void 0:g.name)?e:null),[g]),{isMobileUserAgent:_}=(0,y.al)(),[C,j]=(0,r.useState)(!1),[A,E]=(0,r.useState)(""),[S,k]=(0,r.useState)(A),N=(0,r.useCallback)(e=>{b(null),E(e)},[E]),{fetchNextPage:T,hasNextPage:I,isFetchingNextPage:R,sites:P,isLoading:O}=u({skip:!1,filters:{search_term:S},reason:"sharepoint-site-selector"}),D=(0,r.useMemo)(()=>(0,i.A)(()=>{I&&!R&&T()},500),[I,R,T]);(0,m.B)(n,D,{threshold:.5}),(0,r.useEffect)(()=>{O||""!==S||j(P.length>11)},[O,S,P]),(0,r.useEffect)(()=>{let e=setTimeout(()=>k(A),250);return()=>clearTimeout(e)},[A]);let L=(0,r.useCallback)(()=>{var e;return t(null!==(e=null==g?void 0:g.webUrl)&&void 0!==e?e:"")},[t,null==g?void 0:g.webUrl]);return(0,l.jsxs)(p.Ay,{variant:"transparent",className:"px-md gap-y-sm grid sm:w-full md:w-[515px]",children:[C&&(0,l.jsx)(f.Ay,{type:"text",isMobileUserAgent:_,placeholder:o({defaultMessage:"Search sites",id:"Nxbc+cXNbW"}),value:A,className:"bg-subtle rounded-md border-none",onChange:N,pill:!1}),(0,l.jsxs)(p.Ay,{variant:"subtler",className:"gap-y-sm scrollbar-subtle p-sm mb-md h-56 flex-col overflow-y-scroll rounded-lg",children:[O&&(0,l.jsx)(x.A,{className:"gap-y-sm grid",blockCount:5,size:"small",noLines:!0}),P.length>0&&P.map((e,t)=>(0,l.jsx)(M,{site:e,index:t,handleSelectSite:w,selectedSiteName:null==g?void 0:g.name,sitesLength:P.length,lastSiteRef:n},t)),!O&&!R&&0===P.length&&(0,l.jsx)(h.A,{variant:"small",color:"light",textCenter:!0,children:o({defaultMessage:"No results",id:"jHJmjfxD4s"})}),R&&(0,l.jsx)(x.A,{blockCount:1,size:"small"})]}),(0,l.jsxs)(p.Ay,{className:"gap-x-md flex justify-end",children:[(0,l.jsx)(v.A,{variant:"common",text:c,onClick:a}),(0,l.jsx)(v.A,{variant:"primary",text:d,textClassName:"",disabled:null===g,onClick:L})]})]})});_.displayName="SharepointSiteSelector";let M=r.memo(e=>{let{site:t,index:a,handleSelectSite:s,selectedSiteName:i,sitesLength:n,lastSiteRef:o}=e,d=(0,r.useCallback)(()=>s(t),[s,t]),c=(0,r.useMemo)(()=>(0,l.jsx)(w.e,{icon:b.i,className:"text-super"}),[]);return(0,l.jsx)(g.A,{ref:a===n-1?o:null,variant:"common",layout:"split",text:t.name,size:"small",onClick:d,extraCSS:"pl-sm",trailingComponent:i===t.name?c:null,textClassName:"!text-left w-5/6 text-foreground",fullWidth:!0})});M.displayName="TextButtonFactory"},93062:(e,t,a)=>{"use strict";var l;a.d(t,{i:()=>l}),function(e){e.NONE="none",e.ACTIVE="active",e.TRIALING="trialing",e.PAST_DUE="past_due",e.INVOICE_PAST_DUE="invoice_past_due",e.WHITE_GLOVE_PAST_DUE="white_glove_past_due",e.CANCELED="canceled"}(l||(l={}))},93887:(e,t,a)=>{"use strict";a.d(t,{t:()=>g});var l=a(25576),r=a(85860),s=a(83081);a(67121);var i=a(88574),n=a(80892),o=a(98030),d=a(89744);let c=r.memo(e=>{let{onSelect:t,isSelected:a,result:r,idx:s}=e,{trackEvent:i}=(0,n.yw)();return(0,l.jsxs)("div",{className:"gap-sm flex w-full flex-row-reverse",children:[(0,l.jsx)("div",{className:"w-full min-w-0",children:(0,l.jsx)(d.g,{result:r,idx:s,isSelected:a,variant:"modal",trackEvent:i})}),t&&(0,l.jsx)("div",{className:"mt-[6px] shrink-0",children:(0,l.jsx)(o.A,{checked:a,toggleChecked:(e=>{null==t||t(e)}).bind(null,r.url)})})]})});c.displayName="ManageCitationRow";var u=a(12839),m=a(38683),p=a(17147),h=a(6602),v=a(70919);let g=r.memo(e=>{var t,a,n;let{webResults:o,isOpen:d,submit:g,onClose:f,entry:y}=e,{$t:x}=(0,s.A)(),{isMobileStyle:b}=(0,m.al)(),[w,_]=(0,r.useState)([]),{trackEvent:M}=(0,i.T)(),C=e=>{_(t=>t.includes(e)?t.filter(t=>t!==e):t.concat(e))},j=(0,r.useCallback)(()=>{_([]),f()},[_,f]),A=(0,r.useCallback)(e=>{var t;M("click apply curation",{toDelete:e,entryUUID:null!==(t=null==y?void 0:y.backend_uuid)&&void 0!==t?t:void 0}),null==g||g(e)},[M,y,g]),E=(0,r.useCallback)(()=>{w.length>0&&A([...w]),j()},[w,j,A]),S=(0,r.useMemo)(()=>w.length>0?[{text:0===w.length?x({defaultMessage:"No sources",id:"tN3HZvczgp"}):x({defaultMessage:"{sources, plural, one {Remove # source} other {Remove # sources}}",id:"aRfiMe0V3R"},{sources:w.length}),disabled:0===w.length,onClick:E}]:[],[w.length,x,E]),k=null!==(a=null==y?void 0:y.query_str)&&void 0!==a?a:"",N=k?(0,h.e$)(k).actualQuery:"";y&&"article_info"in y&&(null===(t=y.article_info)||void 0===t?void 0:t.title)&&(N=y.article_info.title);let T=null!==(n=null==o?void 0:o.length)&&void 0!==n?n:0;return(0,l.jsx)(p.A,{actionList:S,title:0===T?x({defaultMessage:"No sources",id:"tN3HZvczgp"}):x({defaultMessage:"{sources, plural, one {# source} other {# sources}}",id:"oWRBjE1HK2"},{sources:T}),subtitle:null!=N?N:void 0,isOpen:d,variant:b?"bottom-left-sheet":"side-sheet",onClose:j,icon:v._,children:(0,l.jsx)(u.Ay,{className:"gap-md flex h-full flex-col items-start",children:null==o?void 0:o.map((e,t)=>(0,l.jsx)(c,{onSelect:y&&g?C:void 0,isSelected:w.includes(e.url),idx:t,result:e},e.url))})})});g.displayName="CitationListModal"},94122:(e,t,a)=>{"use strict";a.d(t,{l:()=>g,n:()=>f});var l=a(85860),r=a(95641),s=a(15492),i=a(87475),n=a(44152),o=a(98188),d=a(80314),c=a(11129),u=a(14036);let m=async e=>{let{fileRepositoryType:t,ownerId:a,limit:l,offset:r,searchTerm:s,email:i,reason:n}=e,[o,c]=await Promise.all([(0,d.hR)({request:{fileRepositoryInfo:{file_repository_type:t,owner_id:a},limit:l,offset:r,searchTerm:s,fileStates:["COMPLETE"],email:i},reason:n}),(0,d.hR)({request:{fileRepositoryInfo:{file_repository_type:t,owner_id:a},limit:100,offset:0,searchTerm:"",fileStates:["PROCESSING","FAILED"],email:i},reason:n})]),u=e=>{var t,a,l;return{name:e.filename,file_uuid:e.file_uuid,file_s3_url:null!==(t=e.file_s3_url)&&void 0!==t?t:"",file_title:e.file_title,file_description:e.file_description,uploadedBy:e.uploaded_by,state:e.file_state,size:null!==(a=e.file_size)&&void 0!==a?a:0,date:new Date(e.time_created).toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"}),error:null!==(l=e.error)&&void 0!==l?l:void 0,isOptimistic:!1}};if(o||c){var m,p;let e=(null==o?void 0:null===(m=o.files)||void 0===m?void 0:m.map(u))||[],t=(null==c?void 0:null===(p=c.files)||void 0===p?void 0:p.map(u))||[];return{completedFiles:e,processingFiles:t.filter(e=>"PROCESSING"===e.state),failedFiles:t.filter(e=>"FAILED"===e.state),numTotalFiles:(null==o?void 0:o.numTotalFiles)||0}}return{completedFiles:[],processingFiles:[],failedFiles:[],numTotalFiles:0}},p=e=>{var t,a,n;let{fileRepositoryType:d,limit:p,offset:h,searchTerm:v,ownerId:g,reason:f}=e,y=(0,r.useQueryClient)(),{session:x}=(0,o.N)(),b=null!==(n=null==x?void 0:null===(t=x.user)||void 0===t?void 0:t.email)&&void 0!==n?n:"",{isEnterprise:w}=(0,u.fE)({reason:f}),_=!!("COLLECTION"===d&&g||"ORG"===d&&w),M=(0,c.$8)(d,g,p,h,v),C=(0,s.useQuery)({queryKey:M,queryFn:()=>_?m({fileRepositoryType:d,ownerId:g,limit:p,offset:h,searchTerm:v,email:b,reason:f}):Promise.reject(),enabled:_,placeholderData:i.rX,staleTime:3e5,gcTime:6e5});return(0,l.useEffect)(()=>{var e,t;_&&(null!==(t=null===(e=C.data)||void 0===e?void 0:e.numTotalFiles)&&void 0!==t?t:0)>h+p&&y.prefetchQuery({queryKey:M,queryFn:()=>m({fileRepositoryType:d,ownerId:g,limit:p,offset:h+p,searchTerm:v,email:b,reason:f}),staleTime:3e5,gcTime:6e5})},[M,_,y,d,p,h,v,null===(a=C.data)||void 0===a?void 0:a.numTotalFiles,b,g,f]),C},h=e=>{var t,a;let{fileRepositoryType:l,limit:r,searchTerm:s,ownerId:i,reason:d}=e,{session:p}=(0,o.N)(),h=null!==(a=null==p?void 0:null===(t=p.user)||void 0===t?void 0:t.email)&&void 0!==a?a:"",{isEnterprise:v}=(0,u.fE)({reason:d}),g=!!("COLLECTION"===l&&i||"ORG"===l&&v),f=(0,c.$8)(l,i,r,void 0,s,!0);return(0,n.useInfiniteQuery)({enabled:g,initialPageParam:0,queryKey:f,queryFn:e=>{let{pageParam:t}=e;return g&&void 0!==t?m({fileRepositoryType:l,ownerId:i,limit:r,offset:t,searchTerm:s,email:h,reason:d}):Promise.reject()},getNextPageParam:(e,t)=>{let a=t.length*r+r;if(!(a>=e.numTotalFiles))return a}})};var v=a(63137);let g=e=>{let{fileRepoInfo:t,offset:a,setOffset:r,searchTerm:s,reason:i}=e,n=t.file_repository_type,o=t.owner_id,{data:d,isLoading:c}=p({fileRepositoryType:n,limit:v.g8,offset:a,searchTerm:s,ownerId:o,reason:i}),{completedFiles:u,processingFiles:m,failedFiles:h,totalFiles:g}=(0,l.useMemo)(()=>{var e;return{completedFiles:(null==d?void 0:d.completedFiles)||[],processingFiles:(null==d?void 0:d.processingFiles)||[],failedFiles:(null==d?void 0:d.failedFiles)||[],totalFiles:null!==(e=null==d?void 0:d.numTotalFiles)&&void 0!==e?e:0}},[d]),f=a>0,y=g>a+v.g8,x=Math.floor(a/v.g8)+1,b=Math.max(1,Math.ceil(g/v.g8)),w=(0,l.useCallback)(()=>{f&&r(Math.max(0,a-v.g8))},[f,a,r]),_=(0,l.useCallback)(()=>{y&&r(a+v.g8)},[y,a,r]);return(0,l.useMemo)(()=>({completedFiles:u,processingFiles:m,failedFiles:h,totalFiles:g,isLoadingFileDirectory:c,hasPreviousPage:f,hasNextPage:y,searchTerm:s,offset:a,currentPage:x,totalPages:b,setOffset:r,handlePrevPage:w,handleNextPage:_}),[u,x,h,_,w,y,f,c,a,m,s,r,g,b])},f=e=>{let{fileRepoInfo:t,searchTerm:a,limit:r=v.g8,reason:s}=e,{data:i,isLoading:n,hasNextPage:o,fetchNextPage:d}=h({fileRepositoryType:t.file_repository_type,limit:r,searchTerm:a,ownerId:t.owner_id,reason:s}),{completedFiles:c,processingFiles:u,failedFiles:m,totalFiles:p}=(0,l.useMemo)(()=>{var e;let t=i?i.pages[i.pages.length-1]:null;return{completedFiles:(null==i?void 0:i.pages.map(e=>e.completedFiles).flat())||[],processingFiles:(null==i?void 0:i.pages.map(e=>e.processingFiles).flat())||[],failedFiles:(null==i?void 0:i.pages.map(e=>e.failedFiles).flat())||[],totalFiles:null!==(e=null==t?void 0:t.numTotalFiles)&&void 0!==e?e:0}},[i]);return(0,l.useMemo)(()=>({completedFiles:c,processingFiles:u,failedFiles:m,totalFiles:p,isLoading:n,hasNextPage:o,searchTerm:a,fetchNextPage:d}),[c,m,d,o,n,u,a,p])}},94749:(e,t,a)=>{"use strict";a.d(t,{M:()=>l});let l=(0,a(27773).w)({path:"M22.1475 2.00586C22.1569 2.00616 22.1663 2.00721 22.1758 2.00781L22.209 2.00977C22.2435 2.01325 22.2773 2.01899 22.3105 2.02637C22.3158 2.02753 22.3209 2.02901 22.3262 2.03027C22.3568 2.03766 22.3858 2.04906 22.415 2.05957C22.5326 2.10177 22.6441 2.16668 22.7383 2.26074C22.7468 2.26924 22.7546 2.27835 22.7627 2.28711C22.7657 2.29033 22.7686 2.29361 22.7715 2.29688C22.8041 2.33334 22.8329 2.37193 22.8584 2.41211C22.8612 2.41654 22.8635 2.4213 22.8662 2.42578C22.8909 2.46628 22.9132 2.50759 22.9307 2.55078C22.972 2.65239 22.9951 2.76339 22.9951 2.87988V17.75C22.9951 18.2332 22.6033 18.6249 22.1201 18.625H7.6123L4.99219 21.2451H16.875C16.8776 20.7642 17.2684 20.3751 17.75 20.375C18.2332 20.3751 18.625 20.7668 18.625 21.25V22.1201C18.6249 22.6033 18.2332 22.9951 17.75 22.9951H2.87988C2.39673 22.9951 2.00495 22.6033 2.00488 22.1201V7.25L2.00977 7.16016C2.05476 6.71917 2.42703 6.37506 2.87988 6.375H17.3867L20.0068 3.75488H8.125C8.12231 4.23583 7.73158 4.625 7.25 4.625C6.76679 4.625 6.37506 4.2332 6.375 3.75V2.87988L6.37988 2.79004C6.42488 2.34901 6.7971 2.00488 7.25 2.00488H22.1201L22.1475 2.00586ZM18.625 7.6123V14.25C18.625 14.7332 18.2332 15.1249 17.75 15.125C17.2668 15.1249 16.875 14.7332 16.875 14.25V8.125H3.75488V20.0068L6.375 17.3867V10.75C6.375 10.2668 6.76675 9.875 7.25 9.875C7.73325 9.875 8.125 10.2668 8.125 10.75V16.875H21.2451V4.99219L18.625 7.6123ZM12.5 10.75C13.4665 10.75 14.25 11.5335 14.25 12.5C14.25 13.4665 13.4665 14.25 12.5 14.25C11.5335 14.25 10.75 13.4665 10.75 12.5C10.75 11.5335 11.5335 10.75 12.5 10.75Z",name:"IconPerplexityCollection",variant:"filled"})},95317:()=>{},95734:(e,t,a)=>{"use strict";a.d(t,{I:()=>l});let l=(0,a(27773).w)({path:"M14 3v4a1 1 0 0 0 1 1h4 M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4 M5 15v6h1a2 2 0 0 0 2 -2v-2a2 2 0 0 0 -2 -2h-1z M20 16.5a1.5 1.5 0 0 0 -3 0v3a1.5 1.5 0 0 0 3 0 M12.5 15a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1 -3 0v-3a1.5 1.5 0 0 1 1.5 -1.5z",name:"IconFileTypeDoc",variant:"stroked"})},95809:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,F:()=>s});var l=a(85860),r=a(35052);let s=()=>{let{colorScheme:e}=(0,r.U)();return(0,l.useMemo)(()=>({rules:{".Input":{..."dark"===e?{backgroundColor:"#191A1A",borderColor:"#3D3F40"}:{borderColor:"#D9D9D0",backgroundColor:"#fcfcf9"}}},variables:{fontFamily:"fkGroteskNeue,  ui-sans-serif, system-ui",fontLineHeight:"1.5",borderRadius:"4px",fontSizeBase:"16px",..."dark"===e?{colorBackground:"#202222",colorPrimary:"#1FB8CD",colorText:"#E8E8E6",colorDanger:"#FF5459"}:{colorBackground:"#F3F3EE",colorPrimary:"#20808D",colorText:"#13343B",colorDanger:"#FF5459"}}}),[e])},i=()=>[{family:"fkGroteskNeue",src:"url(https://www.perplexity.ai/fonts/FKGroteskNeue.woff2)"}]},95920:(e,t,a)=>{"use strict";a.d(t,{_:()=>l});let l=(0,a(27773).w)({path:"M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z M16 3v4 M8 3v4 M4 11h16 M11 15h1 M12 15v3",name:"IconCalendar",variant:"stroked"})},96359:(e,t,a)=>{"use strict";a.d(t,{a:()=>s});var l=a(85860),r=a(94105);let s=()=>{let{value:e,loading:t}=(0,r.mu)({flag:"mweb-upsell-to-whatsapp",defaultValue:!1});return(0,l.useMemo)(()=>({mwebUpsellWhatsApp:e,loadingMwebUpsellWhatsApp:t}),[e,t])}},96420:(e,t,a)=>{"use strict";a.d(t,{W:()=>i});var l=a(85860),r=a(15492),s=a(47167);let i=e=>{let{email:t,reason:a}=e,{data:i,isLoading:n}=(0,r.useQuery)({queryKey:["user_student",t,a],queryFn:()=>(0,s.u9)({email:t,reason:a}),enabled:!!t});return(0,l.useMemo)(()=>{var e;return{isStudent:null!==(e=null==i?void 0:i.valid)&&void 0!==e?e:null,loading:n}},[null==i?void 0:i.valid,n])}},96610:(e,t,a)=>{"use strict";a.d(t,{m:()=>r});var l=a(30002);let r=e=>{switch(e){case"GOOGLE_DRIVE":return l.kP_;case"ONEDRIVE":return l.g9K;case"SHAREPOINT":return l.Hhd;case"DROPBOX":return l.mSO;case"BOX":return l.PHf;case"WILEY":return l.U7J;case"GCAL":return l.eoE;case"NOTION":case"NOTION_MCP":return l.$Em;case"LINEAR":case"LINEAR_ALT":return l.$q$;case"SLACK":return l.ijc;case"SLACK_DIRECT":return l.kLR;case"GITHUB_MCP_DIRECT":return l.VyW;case"ASANA_MCP_DIRECT":case"ASANA_MCP_MERGE":return l.uSN;case"ATLASSIAN_MCP_DIRECT":return l.WJt;case"JIRA_MCP_MERGE":return l.M$;case"CONFLUENCE_MCP_MERGE":return l.w_4;case"MICROSOFT_TEAMS_MCP_MERGE":return l.FEj;case"OUTLOOK":return l.fwX;case"FACTSET":return l.W22;default:return""}}},96867:(e,t,a)=>{"use strict";a(74251),a(10023),a(14036)},97376:(e,t,a)=>{"use strict";a.d(t,{o:()=>l});let l=(0,a(27773).w)({path:"M6 15l6 -6l6 6",name:"IconChevronUp",variant:"stroked"})},97618:(e,t,a)=>{"use strict";a.d(t,{cC:()=>d,cS:()=>p,jO:()=>n,oP:()=>o,tj:()=>m,v7:()=>i,wg:()=>u,xx:()=>c}),a(96610);var l=a(30002),r=a(90768),s=a(57162);function i(e){if(0===e)return"0 bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return Math.ceil(e/Math.pow(1024,t))+" "+["bytes","KB","MB","GB","TB"][t]}let n=e=>{let t=e.file_metadata.file_type;return"FOLDER"===t||"DATABASE"===t||"WORKSPACE"===t||"PAGE"===t};function o(e){let t=e.file_metadata.file_type;return"FOLDER"===t||"DATABASE"===t||"WORKSPACE"===t?s.k:r.g}let d=e=>{switch(e){case"GOOGLE_DRIVE":return l.D_m;case"ONEDRIVE":return l.L84;case"SHAREPOINT":return l.YAi;case"DROPBOX":return l.Tiv;case"BOX":return l.Mgl;case"GCAL":return l.tHf;case"NOTION":case"NOTION_MCP":return l.Aje;case"OUTLOOK":return l.O0l;case"LINEAR":case"LINEAR_ALT":return l.m8P;case"SLACK":case"SLACK_DIRECT":return l.TXX;case"GITHUB_MCP_DIRECT":return l.ICF;case"ASANA_MCP_DIRECT":case"ASANA_MCP_MERGE":return l.$GL;case"ATLASSIAN_MCP_DIRECT":return l.NuM;case"JIRA_MCP_MERGE":return l.Flb;case"CONFLUENCE_MCP_MERGE":return l.rHQ;case"MICROSOFT_TEAMS_MCP_MERGE":return l.U8Q;default:return null}},c=e=>{switch(e){case"crunchbase":return l.JR3;case"factset":return l.FTe;case"wiley":case"wiley_mcp_cashmere":return l.xVD;case"google_drive":return l.D_m;case"onedrive":return l.L84;case"sharepoint":return l.YAi;case"gcal":return l.tHf;case"dropbox":return l.Tiv;case"box":return l.Mgl;case"gmail":return l.xrc;case"notion":case"notion_mcp":return l.Aje;case"outlook":return l.O0l;case"linear":case"linear_alt":return l.m8P;case"slack":case"slack_direct":return l.TXX;case"github_mcp_direct":return l.ICF;case"asana_mcp_direct":case"asana_mcp_merge":return l.$GL;case"atlassian_mcp_direct":return l.NuM;case"jira_mcp_merge":return l.Flb;case"confluence_mcp_merge":return l.rHQ;case"microsoft_teams_mcp_merge":return l.U8Q;case"cbinsights_mcp_cashmere":return l.FLR;case"pitchbook_mcp_cashmere":return l.AP4;case"statista_mcp_cashmere":return l.olY;default:return null}},u=e=>{switch(e){case"crunchbase":return l.MHo;case"factset":return l.W22;case"google_drive":return l.kP_;case"onedrive":return l.g9K;case"sharepoint":return l.Hhd;case"gcal":return l.eoE;case"dropbox":return l.mSO;case"box":return l.PHf;case"gmail":return l.Q3M;case"notion":case"notion_mcp":return l.$Em;case"outlook":return l.fwX;case"linear":case"linear_alt":return l.$q$;case"slack":return l.ijc;case"slack_direct":return l.kLR;case"github_mcp_direct":return l.VyW;case"asana_mcp_direct":case"asana_mcp_merge":return l.uSN;case"atlassian_mcp_direct":return l.WJt;case"jira_mcp_merge":return l.M$;case"confluence_mcp_merge":return l.w_4;case"microsoft_teams_mcp_merge":return l.FEj;case"wiley_mcp_cashmere":return l.VZl;case"cbinsights_mcp_cashmere":return l.wvu;case"pitchbook_mcp_cashmere":return l.n66;case"statista_mcp_cashmere":return l.l9S;default:return e}},m=(e,t)=>new Date(e+"Z").toLocaleString(t,{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}),p=(e,t)=>{switch(e){case"RECEIVED":case"QUEUED":case"RATE_LIMITED":return t.formatMessage({id:"Cnm0QAkWnp",defaultMessage:"Queued"});case"SYNCING":return t.formatMessage({id:"eOnwqs6QFY",defaultMessage:"Syncing"});case"SYNC_ERROR":return t.formatMessage({id:"N1cqoEe4CZ",defaultMessage:"Sync error"});case"EVALUATING_RESYNC":case"READY":return t.formatMessage({id:"IZFEUgrg25",defaultMessage:"Ready"})}}},98030:(e,t,a)=>{"use strict";a.d(t,{A:()=>h});var l=a(25576),r=a(85860),s=a(69236),i=a(64299),n=a.n(i),o=a(38806),d=a(18507),c=a(12839),u=a(11702),m=a(49427);let p=r.memo(e=>{let{checked:t,toggleChecked:a,className:r="",variant:i="default",unselectedCheckboxClassName:p,...h}=e;return(0,l.jsx)(s.bL,{className:n()("inline-flex cursor-pointer items-center justify-center duration-150",{"size-[24px]":"large"===i,"size-[18px]":"default"===i,"size-[14px]":"small"===i},r),checked:t,onCheckedChange:a,...h,children:(0,l.jsx)(c.Ay,{variant:t?"super":"background",noBorder:!0,className:n()("border-subtle inline-flex size-full items-center justify-center rounded border",{"!border-super bg-super":t},!t&&p),children:(0,l.jsx)(s.C1,{children:(0,l.jsx)(o.N,{children:t&&(0,l.jsx)(d.P.div,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.6},transition:{type:"spring",bounce:.2,duration:.2},children:(0,l.jsx)(m.A,{icon:u.i,size:"small"===i?"xs":"sm",className:"text-inverse"})})})})})})});p.displayName="Checkbox";let h=p},98540:(e,t,a)=>{"use strict";a.d(t,{Ld:()=>s,wu:()=>r});var l=a(82297);function r(e){return"string"==typeof e?(0,l._8)(e).startsWith("image/"):e.type.startsWith("image/")}let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;return"https://www.google.com/s2/favicons?sz=".concat(t,"&domain=").concat(e)}},99364:(e,t,a)=>{"use strict";a.d(t,{j:()=>u});var l=a(85860),r=a(63149),s=a(46418),i=a(14036),n=a(79756),o=a(74884),d=a(21978),c=a(3041);let u=e=>{let{reason:t}=e,a=(0,d.rd)(),{organization:u}=(0,i.fE)({reason:t}),{trackOrgPaymentPortalEntered:m}=(0,s.n)(),p=(0,l.useCallback)(async e=>{let{source:l}=e,s=await (0,r.e3)({source:l,locale:(0,o.t)(),reason:t});s?(m({orgUUID:null==u?void 0:u.uuid,source:l,intent:"portal",success:!0}),a.push(s)):(m({orgUUID:null==u?void 0:u.uuid,source:l,intent:"portal",success:!1}),c.vF.log("could not open Stripe portal"))},[m,null==u?void 0:u.uuid,a,t]),h=(0,l.useCallback)(e=>{let{interval:t="monthly",subscriptionTier:l,source:s,onErrorCallback:i,reason:d}=e,c=(0,o.t)();(0,r.UL)({subscriptionTier:"enterprise_pro"===l?n.i.PRO:n.i.MAX,interval:t,origin:s,locale:c,reason:d}).then(e=>{e&&"success"===e.status&&null!=e.url&&""!==e.url?(m({orgUUID:null==u?void 0:u.uuid,source:s,intent:"checkout",success:!0}),e.url&&a.push(e.url)):(m({orgUUID:null==u?void 0:u.uuid,source:s,intent:"checkout",success:!1}),null==i||i())})},[a,null==u?void 0:u.uuid,m]),v=(0,l.useCallback)(async e=>{let{interval:t,subscriptionTier:a,collectionMethod:l,source:s,billingAddress:i,reason:d}=e,c=(0,o.t)(),u=await (0,r.EM)({interval:t,subscriptionTier:"enterprise_pro"===a?n.i.PRO:n.i.MAX,origin:s,locale:c,collectionMethod:l,billingAddress:i,reason:d});return await (0,r.x$)({reason:d}),u},[]);return(0,l.useMemo)(()=>({manageExistingBillingClick:p,navigateToCheckout:h,createInvoicedSubscription:v}),[v,p,h])}}}]);
//# sourceMappingURL=9303-121b172b03dffbfe.js.map